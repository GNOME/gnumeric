2003-12-23  Jody Goldberg <jody@gnome.org>

	* Release 1.2.3

2003-12-23  Jody Goldberg <jody@gnome.org>

	* gnumeric.keys.in : expand our claims.
	* gnumeric.mime : apparently duplicates are not a good idea.

2003-12-23  Jody Goldberg <jody@gnome.org>

	* src/graph.c (gnm_go_data_preferred_fmt) : simplify to handle both
	  scalar and vector and use the auto-format code.

2003-12-22  Morten Welinder  <terra@gnome.org>

	* src/gutils.c (gnm_get_real_name): Fix $NAME case.

2003-12-21  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=128611
	* src/formats.c (cell_format_classify): ignore case when comparing
	  with general format

2003-12-21  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=129049
	* src/session.c (interaction_function): stick dialogs and workbook
	  windows to ensure they are visible for logout conversation

2003-12-21  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=129444
	* src/print-cell.c (cell_split_text_no_wrap): new
	(print_cell): check for non-word-wrapped cells with line breaks
	  and handle them like word-wrapped ones.

2003-12-20  Jody Goldberg <jody@gnome.org>

	* src/format.c (style_format_account) : quote currencies as necessary.
	(fmt_general_float) : decimal points are generally narrower.

2003-12-21  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/stf-export.c (stf_export_options_set_format_mode): new
	(stf_export_options_new): initialize new fields
	(stf_export_options_set_format_mode): new
	(stf_export_cell): use rendered text if required
	* src/stf-export.h (StfExportOptions_t): add preserve_format
	(stf_export_options_set_format_mode): new

2003-12-20  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/gui-util.c (gnumeric_popup_menu): handle NULL event.

2003-12-19  Jon K Hellan  <hellan@acm.org>

	* src/format-template.c (format_template_new): Use gnm_get_real_name.

	* src/summary.c (summary_info_default): UTF-8 encode author name.
	(summary_item_new_string): Validate string as utf-8.

	* src/gutils.[ch] (gnm_get_real_name): New function.

2003-12-18  Jody Goldberg <jody@gnome.org>

	* src/graph.c (gnm_go_data_scalar_preferred_fmt) : new.

2003-12-18  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (wbcg_scroll_wheel_support_cb) : add some
	  bounds checks to avoid listing things like 'zoom -10' in the ui.

2003-12-18  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (wbcg_scroll_wheel_support_cb) : support
	  scroll wheel zoom, and horizontal scrollwheels.

	* src/xml-io.c (xml_workbook_read) : fix xml import of manual recalc
	  flag.

2003-12-17  Jody Goldberg <jody@gnome.org>

	* src/number-match.c (value_is_error) : no need to use strncmp

2003-12-14  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* debian/changelog, debian/control: Updated.

2003-12-13  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=128169
	* src/item-edit.c (ie_layout) : Use the actual font description, not
	  the default associated with the context.

2003-12-11  Emmanuel Pacaud <emmanuel.pacaud@univ-poitiers.fr>

	* src/xml-io.c (xml_read_sheet_object): Do not try to get the class of
	object before its instantiation.

2003-12-10  Morten Welinder  <terra@gnome.org>

	* src/format.c (append_hour_elapsed): Re-fix display of negative
	values.

2003-12-06  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=128565
	* src/sheet-object.c (sheet_object_read_xml) : patch one direction.
	  new can now load old.  We'll need more work to get back to using old
	  name.
	(sheet_object_class_init) : init new xml_export_name member to NULL.
	(sheet_object_write_xml) : use it here.
	* src/sheet-object-cell-comment.c (cell_comment_class_init) : Use it
	  here to keep exporting comments as CellComment rather than the newly
	  renamed class.

2003-12-02  Morten Welinder  <terra@gnome.org>

	* configure.in: Fix checks for fdopen, M_PI, and various other
	library symbols.  (From bunk@fs.tum.de <Adrian Bunk>)
	http://bugzilla.gnome.org/show_bug.cgi?id=128136

2003-12-01  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=128166
	* src/commands.c (cmd_reorganize_sheets_undo): dirty workbook
	(cmd_reorganize_sheets_redo): ditto

2003-12-01  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/gnumeric-gconf.c (gnm_conf_init_essential): add
	  prefs.printer_config, since it is needed for first workbook
	(gnm_conf_init_extras): remove prefs.printer_config
	* src/print.c (sheet_print): remove some unused variables and code

2003-11-26  Jody Goldberg <jody@gnome.org>

	* configure.in : post release bump

2003-11-26  Jody Goldberg <jody@gnome.org>

	* Release 1.2.2

2003-11-25  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/print.c (print_job_info_destroy): plug leak

2003-11-24  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (sheet_colrow_group_ungroup) : when adding a group
	  calculate the global max gutter, not just the max in the changed
	  region.

2003-11-23  Jody Goldberg <jody@gnome.org>

	* src/item-cursor.c (item_cursor_draw) : Use not xor.

2003-11-20  Jody Goldberg <jody@gnome.org>

	* src/colrow.c (colrow_is_empty) : new.

2003-11-19  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/print-info.c (print_info_new): don't read n_copies from
	  gnome_config
	(print_info_save): don't bother writing n_copies to gnome_config
	(print_info_set_n_copies): new
	* src/print-info.h: remove n_copies field from PrintInformation
	(print_info_set_n_copies): new

2003-11-18  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=64297
	* src/item-cursor.c (item_cursor_draw) : invert selection rectangle
	  outlining the content to keep it visible on dark backgrounds.

2003-11-18  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/print-info.c (print_info_new): disable page setup continuity
	  again. The bug seems to be still in libgnomeprint 2.4.x (it is gone
	  from 2.5.x, at least so it seems).

2003-11-17  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/print-info.c (print_info_new): re-enable page setup continuity

2003-11-18  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=127262
	* src/item-grid.c (item_grid_draw) : Avoid 16bit overflow when drawing
	  the divider line,  just draw the visible bit.

2003-11-17  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=127238
	* src/format-template.c (format_template_transform_edges) : fix.

	http://bugzilla.gnome.org/show_bug.cgi?id=127211
	* src/style.c (style_default_halign) : errors appear to have default
	  horizontal alignment of center.  This is ancient code, I wonder why
	  no one ever noticed.

	http://bugzilla.gnome.org/show_bug.cgi?id=127199
	* src/gui-file.c (gui_file_read) : do a sheet_update after a
	  successful read.

2003-11-16  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-canvas.c (gnm_canvas_key_mode_sheet) : no need to
	  sheet_update on queued movement.

	* src/sheet-control-gui.c (scg_queue_movement) : call sheet_update as
	  necessary.
	(cb_scg_queued_movement) : ditto.

2003-11-16  Morten Welinder  <terra@gnome.org>

	* src/mathfunc.c (random_01): Optionally generate pseudo-random
	(as opposed to random) numbers.

2003-11-16  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (xml_parse_ctx_new) : set the workbook here.

2003-11-15  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=116090
	* src/normal-args.c (gnumeric_arg_parse) : function info dumps do not
	  require libgnomui.
	* src/main-application.c (main) : only init session when we have a gui.

	* gnumeric.xsd : Add the Calculation info

	* src/xml-io.c (xml_workbook_write) : Save manual recalc and iteration
	  preferences.
	(xml_workbook_read) : And read them.

	http://bugzilla.gnome.org/show_bug.cgi?id=126907
	* src/commands.c (cmd_set_text_redo) : even when using manual recalc
	  we should calculate newly entered expression.

2003-11-14  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=68794
	* src/selection.c (sv_selection_to_plot) : default to rows
	  when rows == cols

2003-11-06  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=126389
	* src/commands.c (cmd_format_redo) : dirty the sheet.

2003-11-05  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c : ditto.
	* src/GNOME_Gnumeric.xml : Enable select inputs

2003-11-03  Morten Welinder  <terra@gnome.org>

	* src/print.c (sheet_print): Plug leak.

	* src/gui-util.c (gnumeric_error_info_dialog_new): Plug leak.

2003-11-03  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=126056
	* src/graph.c (cb_assign_val) : failed string conversion is inf,
	  rather than nan.

2003-11-03  Jody Goldberg <jody@gnome.org>

	* gnumeric.mime : add more.

2003-11-02  Jody Goldberg <jody@gnome.org>

	* src/main-application.c (main) : init before calling
	  handle_paint_events.

	* src/application.c: s/g_assert/g_return_if_fail/

	* src/ssconvert.c :  Add --list-importers
	* doc/C/ssconvert.1 : document it.

2003-11-02  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/gnumeric-gconf.c (gnm_conf_init_printer_decoration_font): new
	(gnm_conf_init_extra): call gnm_conf_init_printer_decoration_font
	  rather than doing the work itself.
	(gnm_conf_shutdown): new
	* src/gnumeric-gconf.h: printer_decoration_font replaces
	  printer_decoration_font_*
	* src/libgnumeric.c (gnm_common_init): gnm_conf_init requires
	  mstyle_init
	(gnm_shutdown): call gnm_conf_shutdown
	* src/print.c (print_job_info_get): printer_decoration_font replaces
	  printer_decoration_font_*

2003-11-02  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* src/application.c: Added g_assert()s to ensure app is not NULL prior
	to being dereferenced, to make crashes like Debian #217368 less
	spectacular.

2003-10-31  Jody Goldberg <jody@gnome.org>

	* configure.in : disable deprecated is only for development releases.

2003-10-29  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/stf.c (stf_init): csv means "... values"

2003-10-29  Jody Goldberg <jody@gnome.org>

	* gnumeric.desktop.in : Add a new String 'Spreadsheet' to conform to
	  freedesktop standards with a 'GenericName' entry.

2003-10-27  Morten Welinder  <terra@gnome.org>

	* src/gnumeric-gconf.c (gnm_gconf_get_float): Avoid double->float
	precision loss.  Quiet gcc.

2003-10-27  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=125577
	* src/sheet.c (cb_collect_cell) : preserve the recalc state.

2003-10-26  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (xml_probe) : rework to use sax.
	(xml_dom_read_warning) : new.
	(xml_dom_read_error) : new.
	(xml_init) : setup.
	(gnumeric_xml_read_workbook) : cheesy mechanism to send errors to the
	  iocontext.

2003-10-25  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* schemas/gnumeric-dialogs.schemas.in: add schemas for header/footer
	  font
	* src/gnumeric-gconf-priv.h: new keys:
	  PRINTSETUP_GCONF_HF_FONT_NAME, PRINTSETUP_GCONF_HF_FONT_SIZE,
	  PRINTSETUP_GCONF_HF_FONT_BOLD, PRINTSETUP_GCONF_HF_FONT_ITALIC
	* src/gnumeric-gconf.c (gnm_conf_init_extras): initialize new fields
	* src/gnumeric-gconf.h: new fields for preference structure
	* src/print.c (print_job_info_get): use preference info and fallback
	  fonts

2003-10-25  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=125421
	* src/sheet-view.c (sv_panes_insdel_colrow) : don't move the top when
	  the insert happens before it

2003-10-25  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* debian/changelog, debian/control, debian/rules: Updated.

2003-10-24  Morten Welinder  <terra@gnome.org>

	* src/regression.c (general_linear_regression): Handle a
	loss-of-precision case for xdim==2.

2003-10-24  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=125230
	* src/format.c (append_hour_elapsed) : Add epsilon _before_ we scale

2003-10-24  Jody Goldberg <jody@gnome.org>

	* src/clipboard.c (clipboard_paste_region) : Fill in increasing order
	  to avoid the dreaded ultra deep stack caused by recalcing starting
	  at the end.  It is a bandaid.  During 1.3 we'll need something more
	  robust.

2003-10-23  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c : Ensure that all actions with
	  accelerators attempt to finish any edits in progress.

2003-10-22  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=77303
	* src/sheet-control-gui.c (scg_cursor_move) : don't scroll the other
	  panes unless we absolutely have to.

2003-10-21  Morten Welinder  <terra@gnome.org>

	* src/format.c (append_hour_elapsed): Get sign right, even when
	the hour is zero.

2003-10-20  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=124975
	* src/commands.c (CmdPasteCut) : handle undo for paste from a deleted
	  external sheet.  Only fixes first order problem.  We'll need a more
	  invasive approach later.

2003-10-20  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=123325
	* src/value.c (criteria_test_greater_or_equal) : NULL args are valid.
	(criteria_test_less_or_equal) : ditto.
	(criteria_test_greater) : ditto.
	(criteria_test_less) : ditto.
	(criteria_test_equal) : ditto.

2003-10-16  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-gconf.c : rework to catch missing schemas and delay non
	  essential loads until later.

2003-10-14  Morten Welinder  <terra@gnome.org>

	* src/stf-parse.c (stf_parse_general): Add maxlines argument.  All
	callers changed.

2003-10-13  Jody Goldberg <jody@gnome.org>

	* src/number-match.c (format_match_init) : trivial optimization to
	  avoid checking against the same regexp multiple times.

2003-10-13  Morten Welinder  <terra@gnome.org>

	* src/stf-parse.c (stf_parse_fixed_cell, stf_parse_csv_cell,
	stf_parse_general, stf_parse_lines): Switch to allocating from a
	GStringChunk.

2003-10-12  Jody Goldberg <jody@gnome.org>

	* configure.in : remove GTK_DISABLE_DEPRECATED for now.  gtk head has
	  changed alot recently and this breaks the build.

2003-10-12  Rodrigo Moya <rodrigo@gnome-db.org>

	* configure.in: bumped requirements for libgda and libgnomedb.

2003-10-10  Jody Goldberg <jody@gnome.org>

	* src/stf.c (stf_write_csv) : new to write csv files without
	  intervention.
	(stf_init) : Use it.

2003-10-09  Jody Goldberg <jody@gnome.org>

	* src/libgnumeric.c : pull the ancient if BONOBO checks

	* src/io-context-gtk.c (icg_show_gui) : mark the window as a splash.

	* schemas/Makefile.am : make friendlier for rpm builders

2003-10-08  Jody Goldberg <jody@gnome.org>

	* configure.in : post release version bump

2003-10-08  Jody Goldberg <jody@gnome.org>

	* Release 1.2.1

2003-10-07  Jody Goldberg <jody@gnome.org>

	* src/graph.c (gnm_go_data_get_dep) : Its ok to have other GOData's.
	(gnm_go_data_set_sheet) : ditto.

2003-10-06  Jody Goldberg <jody@gnome.org>

	* src/value.c (criteria_test_equal) : privatize
	(criteria_test_less) : privatize
	(criteria_test_greater) : privatize
	(criteria_test_less_or_equal) : privatize
	(criteria_test_greater_or_equal) : privatize
	(criteria_test_unequal) : privatize and have it handle empty.
	(parse_criteria) : avoid replicated code.  Handle the trivial ==number
	  case here too.
	(parse_criteria_range) : use the new simplified interface.

2003-10-05  Jody Goldberg <jody@gnome.org>

	* src/workbook-control.c (wb_control_parse_and_jump) : skip blanks

	* src/func.c (function_def_get_arg_type_string) : handle 'B' a scalar
	  that can even be blank.
	(function_call_with_list) : ditto.

2003-10-05  Jody Goldberg <jody@gnome.org>

	* src/ssconvert.c : if no export file name is specified try to
	  generate one based on the exporter.

2003-10-05  Jon K Hellan  <hellan@acm.org>

	* src/sheet-object-graphic.c (sheet_object_graphic_user_config):
	gtk_combo_box renamed to gnm_combo_box.

	* src/workbook-control-gui.c (ur_stack, wbcg_undo_redo_clear,
	wbcg_undo_redo_truncate, wbcg_undo_redo_pop,
	wbcg_undo_redo_push, workbook_create_standard_toolbar,
	workbook_create_standard_toolbar): Ditto.

	* src/workbook-format-toolbar.c (workbook_create_format_toolbar):
	Ditto.

2003-09-29  Morten Welinder  <terra@gnome.org>

	* src/format.c (render_number): Keep track of number of
	significant digits so we don't show garbage.

2003-09-27  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* src/ssconvert.c: Handle bad command lines in a sensible manner.

2003-09-27  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* configure.in: Updated ALL_LINGUAS as po/hi.po has been removed.

2003-09-25  Jody Goldberg <jody@gnome.org>

	* src/style.c (gnm_pango_context_get) : simple wrapper to enable
	  windowless operation.
	(font_init) : move the global_font crap here temporarily to enable
	  windowless operation.
	(font_shutdown) :  new merged in global_font_shutdown.

	* src/ssconvert.c : stick this ins CVS as an incentive to someone to
	  polish it up a bit and finish it.

	* src/sheet.c (sheet_new) : Use the new gnm_pango_context_get.

	* src/libgnumeric.c (gnm_common_init) : global_gnome_font_init is gone
	(gnm_shutdown) : ditto global_gnome_font_shutdown.

	* src/global-gnome-font.c : rip the init and shutdown logic out of here

	* src/style-color.c (gnumeric_color_init) : allow this to work with no
	  display.

	* src/command-context-stderr.c (command_context_stderr_new) : change
	  return type to the more useful and popular base class.

2003-09-25  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=123226
	* gnumeric.spec.in : patch the bugs mentioned and some general cleanup

2003-09-24  Morten Welinder  <terra@gnome.org>

	* src/number-match.c (compute_value): Reduce the number of
	localtime calls when matching partial dates.

2003-09-23  Jody Goldberg <jody@gnome.org>

	* src/str.h : Start of the big renaming s/String/GnmString/

2003-09-23  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (xml_probe) : revert need to change libgsf api.  That
	  was a bug in libxml-2.6.0-beta2
	* configure.in :  ditto
	* gnumeric.spec.in : ditto
	* README : ditto

2003-09-22  Jody Goldberg <jody@gnome.org>

	From John Gill :
	* src/sheet-filter.c (sheet_filter_guess_region) : Some heuristics to
	  guess the region to autofilter when only 1 cell or row is selected.
	* src/workbook-control-gui.c (cb_auto_filter) : Use it.

2003-09-22  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_graph_dim_editor_update) : ignore if
	  dataset has already been deleted.
	(cb_dim_editor_weakref_notify) : new.
	(graph_dim_editor_free) : new.
	(wbcg_data_allocator_editor) : add a weakref to handle situation where
	  the dataset is deleted before the widget.

2003-09-22  Jody Goldberg <jody@gnome.org>

	* configure.in :  require libgsf 1.9.0 because it works around changes
	  in libxml2 semantics for 2.6.0 that break our sax based importers.

	* src/style.c (style_font_new_simple) : cache the font height too.

	* src/sheet.c (cb_max_cell_height) : be smarter.  There is no need to
	  render a cell whose value does not wrap.

2003-09-22  Morten Welinder  <terra@gnome.org>

	* src/format.c (format_boolean): Use function.
	(format_value_gstring): Use format_boolean.

	* src/number-match.c (format_match_simple): Ditto.
	* src/value-sheet.c (value_dump): Ditto.
	* src/value.c (value_get_as_gstring): Ditto.

2003-09-22  Jody Goldberg <jody@gnome.org>

	* src/stf.c (csv_tsv_probe) : probe only by name.  Always accepting
	  content turned this into a catch all importer.

	* src/plugin-service.c (gnm_plugin_file_opener_can_probe) : new.
	(gnm_plugin_file_opener_class_init) : hook it up.

	* src/file.c (gnm_file_opener_can_probe_real) : new.
	(gnm_file_opener_class_init) : link it up.
	(gnm_file_opener_can_probe) : call it here.

	* src/workbook-view.c (wb_view_new_from_input) : be more explicit
	  about when not to probe for content.  The underlying code is in
	  desperate need of cleanup.

2003-09-21  Jody Goldberg <jody@gnome.org>

	* src/stf.c (stf_text_to_columns) : relax requirements, blanks and
	  hidden are ok.  It might be nice to skip hidden, or filter blanks
	  but we have no capabilities to paste into 'non-hidden' region.  So
	  it makes sense to ignore hidden for consistency.
	(cb_get_content) : accept blanks.

2003-09-18  Jody Goldberg <jody@gnome.org>

	* src/gui-util.c (cb_free_keyed_dialog_context) : remove the
	  unnecessary precondition.  If we're being called during wbcg::finalize
	  then the data is already gone.

2003-09-16  Jody Goldberg <jody@gnome.org>

	* src/expr.c (do_expr_as_string) : fill in ParsePos::sheet too so that
	  names get properly qualified.

2003-09-15  Jody Goldberg <jody@gnome.org>

	* src/graph.c (gnm_go_data_vector_load_len) : don't get confused by
	  references to empty sheets.
	(gnm_go_data_vector_load_values) : set flags and min/max even for
	  empty vectors.

2003-09-15  Jon K Hellan  <hellan@acm.org>

	* configure.in: Require libgsf-gnome-1 >= 1.8.2. No big deal, we
	were already requiring libgsf-1 >= 1.8.2 elsewhere.
	Remove big bad "unstable branch" warning.

2003-09-15  Jody Goldberg <jody@gnome.org>

	* configure.in : bump the gsf-gnome req to 1.8.2 also.

2003-09-15  Jody Goldberg <jody@gnome.org>

	* configure.in : post release version bump

2003-09-15  Jody Goldberg <jody@gnome.org>

	* Release 1.2.0

2003-09-15  Jody Goldberg <jody@gnome.org>

	* configure.in : Call it 1.2.0

	* src/style.c (gnm_font_find_closest_from_weight_slant) : put in some
	  fallbacks.

	* schemas/gnumeric-general.schemas.in : return to using 'Sans' rather
	  than 'Sans Regular'. The later does not make gnome-print any happier
	  and it is not listed in the default fontconfig list.

	* src/graph.c (cb_assign_val) : Only clip empty cells, not invalid
	  cells.  We might be interested in the strings even if they're not
	  useful as numbers.  This can happen when using a vector of strings
	  as the X axis in a scatter plot.

2003-09-14  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/gui-file.c (make_format_chooser): expect to receive the
	  correct list of formats.
	(gui_file_save_as): filter out FILE_SAVE_RANGE savers

2003-09-14  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/style.c: fix format warnings
	(gnm_font_find_closest_from_weight_slant): new
	* src/style.h (gnm_font_find_closest_from_weight_slant): new

2003-09-13  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/print-info.c (render_path): &[PATH] should not include
	  basename

2003-09-13  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/print-info.h: remove unused enumeration items
	* src/print-info.c (render_tab): simplify default name
	(render_file): show basename only and provide default
	(render_path): new
	(render_opcode): remove unused code, don't strip and
	  forget subformatting, don't use g_ascii_strcasecmp on
	  tranlated text.

2003-09-13  Jody Goldberg <jody@gnome.org>

	* src/graph.c (gnm_go_data_vector_load_values) : typo broke horizontal
	  data.

	* src/workbook-control-gui.c (cb_graph_dim_entry_unmap) : only fire if
	  the widget is sensitive.  We have data displayed that the user
	  did not enter.

2003-09-13  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-gui.c (cb_graph_dim_entry_unmap): New name
	for cb_graph_dim_entry_destroy. We now connect it to the "unmap"
	signal.
	(wbcg_data_allocator_editor): Connect cb_graph_dim_entry_unmap to
	the "unmap" signal.

2003-09-13  Jody Goldberg <jody@gnome.org>

	* gnumeric.spec.in:
	* README :
	* configure.in : require gsf 1.8.2 to ensure that libole2 based
	  gnumeric-1.0.x can read our xls files.

2003-09-12  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-gui.c (cb_graph_dim_editor_destroy): New
	callback invoked when expr entry is destroyed.
	(wbcg_data_allocator_editor): Use it.

2003-09-12  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/print.c (print_range_down_then_right) equalize the scaling parameters
	(print_range_right_then_down): ditto

2003-09-12  Jody Goldberg <jody@gnome.org>

	* gnumeric.spec.in : install the plugin schema too.

2003-09-12  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/print.c (compute_scale_fit_to): adjust for the case that some
	  columns may not fit on a page.

2003-09-12  Jody Goldberg <jody@gnome.org>

	* src/style.c (font_init) : be more verbose when we can't find fonts.

2003-09-12  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/print.c (compute_scale_fit_to): only use real range

2003-09-11  Jody Goldberg <jody@gnome.org>

	* src/workbook-view.c (wb_view_sendto) : the gnm-sendto dir is what
	  we're creating, do not assume it exists.

2003-09-11  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/print.c (compute_group): don't scale already scaled values

2003-09-11  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-cell-comment.c (cell_comment_finalize) : only
	  attempt to clear the state if we are connected to some views.

2003-09-10  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* README: Updated Debian package names.

2003-09-10  Christian Neumair  <chris@gnome-de.org>

	* src/sheet-object-graphic.c (sheet_object_graphic_user_config): Add
	  ATK relation information.
	(sheet_object_filled_user_config): ditto.

2003-09-10  Jody Goldberg <jody@gnome.org>

	* src/gui-util.c (gnm_setup_label_atk) : weaken requirement to
	  GtkWidget from GtkLabel for Manny.

2003-09-10  Jody Goldberg <jody@gnome.org>

	* configure.in : bump to 1.1.91 just in case

2003-09-10  Jody Goldberg <jody@gnome.org>

	* Release 1.1.90

2003-09-09  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=121873
	* src/format.c (style_format_number) : g_string_append (str, str->str)
          is a bad idea.
	(style_format_delocalize) : handle "" cleanly.
	* src/formats.c (cell_format_classify) : ditto.

2003-09-08  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-graph.c (cb_save_as) : Use gsf more extensively.
	  Use the new SVG renderer.

2003-09-07  Jody Goldberg <jody@gnome.org>

	* configure.in : Bump version reqs to at least gnome-2.0 to make
	  things nice and clear.

2003-09-06  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/sort.c (sort_permute): move comments

2003-09-06  Jody Goldberg <jody@gnome.org>

	* src/dependent.c (dependent_clear_dynamic_deps) : Just remove the
	  DynamicDep record from the hash that will free it as necessary.
	(dynamic_dep_free) : free the containing DynDep too, not just content.
	(invalidate_refs) : Ignore dynamic deps, we could not delete them with
	  things disconnected.
	(cb_find_dynamic_deps) : new.
	(dep_hash_destroy) : split out to cleanly handle dynamic deps
	(do_deps_destroy) : Collect dyn deps before invalidating, then queue
	  any of them that are external for recalc.

2003-09-06  Jon K Hellan  <hellan@acm.org>

	* src/sheet-object-graph.c (sheet_object_graph_populate_menu):
	Push "Save as image" down to 2nd place.

2003-09-03  Jody Goldberg <jody@gnome.org>

	* src/format.c (format_value_gstring) : be more expansive about
	  exactly what constitutes 'General'

	* src/graph.c (gnm_go_data_vector_load_values) : handle empty sheets.

	* src/ranges.c (range_normalize) : minor optimization

2003-09-03  Morten Welinder  <terra@gnome.org>

	* src/stf.c (stf_open_and_read): Fix zero-size check.

	* src/number-match.c (compute_value): Handle negative hh:mm.

2003-09-02  Jody Goldberg <jody@gnome.org>

	* src/func.c (function_call_with_list) : always pass something to
	  optional args with supplied values, even if the supplied value is
	  empty.

2003-09-01  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_graph_dim_editor_update) : If the
	  parse fails, popup an error for vectors, and fall back to a string
	  for scalars.

2003-09-01  Metin Amiroff  <metin@karegen.com>

	configure.in: Added "az" in ALL_LINGUAS.

2003-08-30  Jon K Hellan  <hellan@acm.org>

	* src/sheet-object-graph.c (cb_save_as): New. Save graph as image.
	(sheet_object_graph_populate_menu): New. Add 'Save as image' menu
	item.
	(sheet_object_graph_class_init): Use
	sheet_object_graph_populate_menu.

2003-08-27  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/gui-util.c (gnm_pixbuf_intelligent_scale): use height and
	  width arguments
	* src/gui-util.h (gnm_pixbuf_intelligent_scale): ditto
	* src/workbook-control-gui.c: add #include

2003-08-27  Jody Goldberg <jody@gnome.org>

	* src/sheet-control-gui.c (scg_mode_edit) : reset the menu/toolbar.
	(scg_mode_edit_object) : ditto.
	(scg_mode_create_object) : ditto.

	* src/workbook-control-gui.c (wbcg_sheet_to_page_index) : handle
	  invocation before there is a notebook.
	(wbcg_menu_state_update) : enable and disable clipboard operations
	  depending on object editing state.
	(cb_edit_cut) : remove asymmetry of deleting during the cut command.
	(workbook_create_standard_toolbar) : store the clipboard toolbar
	  widgets for the non-bonobo case.
	(workbook_control_gui_init) : store the clipboard menu items for the
	  non-bonobo case.

	* src/dependent.c (dependent_link) : keep a tail pointer and append
	  new dependents to the list.  This is a slightly better fit to the
	  common idiom of starting at the top and working down, and papers
	  over the most common case of ultra deep recursion blowing the stack.
	  We'll need to solve this more rigorously during 1.3.
	(dependent_unlink) : ditto.
	(gnm_dep_container_new) : ditto.

2003-08-27  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/gui-util.c (gnm_pixbuf_intelligent_scale): new
	* src/gui-util.h (gnm_pixbuf_intelligent_scale): new

2003-08-26  Jody Goldberg <jody@gnome.org>

	* configure.in : remove duplicate call to AM_PROG_LIBTOOL

	* src/expr.c (cellrange_relocate) : don't confuse Sheet:NULL as a 3d
	  reference.

2003-08-25  Jody Goldberg <jody@gnome.org>

	* schemas/gnumeric-general.schemas.in : Use 'Sans Regular' as the
	  default font, just Sans confuses gnome-print

2003-08-26  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/gui-util.c (gnumeric_dialog_image_file_selection): deleted
	(selchanged_foreach) : deleted
	(cb_file_open_selchanged) : deleted
	* src/gui-util.h (gnumeric_dialog_image_file_selection): deleted
	* src/workbook-control-gui.c (cb_insert_image):  use
	  preview_file_selection_new and not
	  gnumeric_dialog_image_file_selection

2003-08-25  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/gui-util.c (gnumeric_dialog_file_selection):
	  watch for NULL wbcg

2003-08-25  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/gui-util.c (selchanged_foreach): new
	(cb_file_open_selchanged): new
	(gnumeric_dialog_image_file_selection): new
	* src/gui-util.h (gnumeric_dialog_image_file_selection): new
	* src/workbook-control-gui.c (cb_insert_image): use
	  gnumeric_dialog_image_file_selection

2003-08-25  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/GNOME_Gnumeric.xml: enable DataImportText
	* src/gui-file.c (gui_file_open): add format argument
	(file_opener_find_by_id): new
	* src/gui-file.h (gui_file_open): add format argument
	* src/workbook-control-gui.c: enable DataImportText
	(cb_file_open): add argument to gui_file_open
	(cb_data_import_text): enable and implement

2003-08-24  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=120562
	* src/style.h (DEFAULT_FONT): change to "Sans Regular"

2003-08-24  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/sheet-object-graph.c (cmd_so_graph_config): use
	  sheet_object_graph_user_config_t
	(sheet_object_graph_user_config_free_data): new
	(sheet_object_graph_user_config): use gclosure
	(sheet_object_graph_guru): ditto
	* src/sheet-object-graph.h (sheet_object_graph_guru): use gclosure
	* src/workbook-control-gui.c (cb_launch_chart_guru): use gclosure

2003-08-24  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=120541
	* src/sheet.c (sheet_delete_cols) : we were only flagging the residual
	  that moved as having changed, not the source.
	(sheet_delete_rows) : ditto.

2003-08-24  Jody Goldberg <jody@gnome.org>

	* src/commands.c (cmd_so_graph_config_redo) : no need to diddle with
	  references.  set_gog adds and unrefs as necessary internally.
	(cmd_so_graph_config_undo) : all we need to do is watch our
	  references.

	* src/sheet-object-graph.c (sheet_object_graph_set_gog) : beef this up
	  a bit to handle connecting and disconnecting the data.  Remove the
	  'attach_signals' flag.  That exposes more implementation than I'm
	  comfortable with.
	(sog_datas_set_sheet) : new.  Split out of new.  Split out of.
	(sheet_object_graph_set_sheet) : here.
	(sheet_object_graph_remove_from_sheet) : and here.

2003-08-23  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_so_graph_config_redo): use
	  sheet_object_graph_set_gog
	(cmd_so_graph_config_undo): ditto
	(cmd_so_graph_config): initialize me->first_time
	* src/sheet-object-graph.h (sheet_object_graph_reassign_gog):
	  export sheet_object_graph_set_gog instead
	(sheet_object_graph_reassign_gog): delete
	(sheet_object_graph_set_gog): allow this function to be called
	  even with a second (or later) graph.

2003-08-23  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c
	(cmd_reorganize_sheets_delete_get_this_sheet_info): do not
	  exclude graphs

2003-08-23  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_so_graph_config*): new
	* src/commands.h (cmd_so_graph_config): new
	* src/sheet-object-graph.c (sheet_object_graph_reassign_gog): new
	(cb_update_graph): use cmd_so_graph_config
	(sheet_object_graph_user_config): store wbcg on sheetobject
	* src/sheet-object-graph.h (sheet_object_graph_reassign_gog): new

2003-08-23  Jody Goldberg <jody@gnome.org>

	* src/formats.c : Use english form of plural, not polish for Zlotys

	* src/workbook-control-gui.c (cb_edit_cut) : if we're goign to delete
	  an object don't cut the selection too.

2003-08-22  Jody Goldberg <jody@gnome.org>

	* src/graph.c (gnm_go_data_get_dep) : new.
	  Use it to clear up all sorts of related concepts.
	(gnm_go_data_dup) : new.

2003-08-22  Morten Welinder  <terra@gnome.org>

	* src/gnumeric-canvas.c (gnm_canvas_key_mode_sheet): Support
	End+Home.

2003-08-21  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=120436
	* schemas/Makefile.am : simplfy.
	* gnumeric.spec.in : the other half of the schema installation
	  delete bogus gal req

2003-08-21  Jody Goldberg <jody@gnome.org>

	* configure.in : post release bump to 1.1.90 in prep for beta status
	  next week.

2003-08-21  Jody Goldberg <jody@gnome.org>

	* Release 1.1.20

2003-08-21  Jody Goldberg <jody@gnome.org>

	* src/main-component.c (main) : bind the encoding to utf8 here.
	* src/main-application.c (main) : and here.
	* src/libgnumeric.c (init_init) : rather than here, which is too
	  early.  It can't be done until after popt does its stuff.

	* src/sheet-object.c (sheet_object_clone) : set_sheet adds a
	  reference, we don't need to keep the original.

2003-08-19  Jody Goldberg <jody@gnome.org>

	* src/workbook-edit.c (wbcg_edit_attach_guru_main) : clear END-mode
	(wbcg_edit_detach_guru) : ditto.

	From John Gill :
	* src/gnumeric-canvas.c (gnm_canvas_key_mode_sheet) : Enable support
	  for END-mode keystrokes.  The transition keys do something a bit
	  funky though, disabled by default.
	* src/workbook-control-gui.c (wbcg_toggle_end_mode) : new.
	(wbcg_set_end_mode) : new.  To handle display of 'END-mode' keys.

2003-08-19  Jody Goldberg <jody@gnome.org>

	* src/value.c : Add #UNKNOWN! to avoid problems.

	* src/expr.c (bin_cmp) : split out of.
	(gnm_expr_eval) : here, in preparation for support implicit iteration
	  for operators.

	* schemas/gnumeric-general.schemas.in : disable transition keys by
	  default because they make the ctrl-arrow movement odd.

	* src/sheet-object-graph.c (sheet_object_graph_read_xml) : be more
	  lenient about invalid xml.
	* src/sheet-object.c (sheet_object_read_xml) : produce better
	  warnings for unknown objects, and recognize that a GnmGraph is a
	  graph even though we don't call it that anymore.

2003-08-20  Morten Welinder  <terra@gnome.org>

	* src/dependent.c (dependent_add_dynamic_dep): Identify
	single-cell dependencies and record them as such.  (Fixes
	performance problem 120290.)

2003-08-18  Morten Welinder  <terra@gnome.org>

	* src/main-application.c (main): s/printf/g_print/, see 120124.

2003-08-17  Jody Goldberg <jody@gnome.org>

	* src/selection.c (characterize_vec) : handle empty cells at the end
	  when characterizing.

2003-08-16  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=117711
	* src/sheet-view.c (sv_panes_insdel_colrow) : be smarter during
	  deletetion.
	* src/sheet-control-gui.c (scg_resize) : stave off some warnings while
	  unfreezing by not resizing the panes that we're about to delete.

2003-08-16  Jody Goldberg <jody@gnome.org>

	A bit of tidying to make 70184 simpler
	* src/cell.c (cell_is_empty) : renamed from cell_is_blank.  All
	  callers changed.
	(cell_is_blank) : new function that handles "" too.

	* src/sheet-filter.c (cb_collect_unique) : Use it here.
	(cb_filter_non_blanks) : here.
	(cb_filter_blanks) : and here.

2003-08-15  Danilo Šegan  <dsegan@gmx.net>

	* configure.in: Added "sr" and "sr@Latn" to ALL_LINGUAS.

2003-08-15  Morten Welinder  <terra@gnome.org>

	* src/workbook-view.c (wbv_save_to_file): Handle output errors
	that happen after the initial open.

2003-08-14  Carlos Perelló Marín <carlos@gnome.org>

	* configure.in: We need intltool 0.27.2 to be able to work with UTF-8
	strings inside source code.

2003-08-12  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/workbook-control.c (wb_control_parse_and_jump): make the range
	  also visible

2003-08-12  Morten Welinder  <terra@gnome.org>

	* src/sheet-filter.c (filter_expr_init): Set ->date_conv before we
	use it.

2003-08-11  Jody Goldberg <jody@gnome.org>

	* src/sheet-private.h : Add filters_changed flag.

	* src/sheet-filter.c (gnm_filter_new) : set it here.
	(gnm_filter_remove) : here.
	(sheet_filter_insdel_colrow) : and here.  Only add a new field if a
	  col is inserted in the midst of a filter range.  Inserting before or
	  after just ignores moves them.

	(gnm_filter_add_field) : fix inserting fields in the middle.

	* src/sheet.c (sheet_update_only_grid) : regenerate the menu here if
	  it's set.

	* src/workbook-control-gui.c (cb_auto_filter) : sheet_update handles
	  it now.

2003-08-11  Carlos Perelló Marín <carlos@gnome.org>

	* configure.in: Added a dependency with intltool 0.27 because
	this project needs UTF-8 strings inside source code. (#85718)

2003-08-10  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/session.c (set_clone_restart): new
	(interaction_function): call set_clone_restart
	(client_save_yourself_cb): call set_clone_restart

2003-08-09  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/sheet-object-graphic.c: replace helpfile address
	  with #define from help.h
	* src/sheet-object-widget.c: ditto

2003-08-08  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/sheet-filter.c (cb_filter_blanks): hide non-blanks
	(cb_filter_non_blanks): hide blanks

2003-08-08  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/session.c: new
	* src/session.h: new
	* src/Makefile.am: add src/session.[ch]
	* src/main-application.c (main): call gnm_session_init

2003-08-04  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (xml_read_solver) : beef up error checking.

2003-08-07  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c
	(cmd_reorganize_sheets_delete_get_this_sheet_info):
	  save sheet object and colrow info
	(cmd_reorganize_sheets_delete_recreate_sheet): also
	  recreate sheet objects and set colrow info
	(cmd_reorganize_sheets_delete_free): free sheet object
	  and colrow info
	(cmd_reorganize_sheets): increade command size if sheets
	  are being deleted.

2003-08-06  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_reorganize_sheets): add
	  argument to call of workbook_sheet_rename_check
	* src/workbook.c (workbook_sheet_rename_check):
	  ignore sheets to be deleted
	* src/workbook.c (workbook_sheet_rename_check):
	  add argument

2003-08-06  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c: revert all the sheet pointer/index
	  changes thoughout

2003-08-06  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_search_replace_undo): update
	  sheet pointer in cells
	(cmd_search_replace_redo): ditto
	(cmd_search_replace): initialize sri->sheet_idx
	(cmd_search_replace_update_sheet_pointer): new
	(cmd_define_name_undo): update sheet pointer in ParsePos
	(cmd_define_name_redo): ditto
	(cmd_define_name): use an appropriate cmd.sheet

2003-08-06  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_sort_redo): adjust sheet pointer
	(cmd_sort_undo): ditto

2003-08-05  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_analysis_tool_undo): add argument
	  to dao_update_sheet_pointer
	(cmd_analysis_tool_redo): ditto

2003-08-05  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_merge_data_destroy_rrlist): new
	(cmd_merge_data_delete_sheets): delete
	(cmd_merge_data_vallist_to_rrlist): new
	(cmd_merge_data_update_rrlist): new
	(cmd_merge_data_undo): use sheet indices
	(cmd_merge_data_redo): ditto
	(cmd_merge_data): store sheet indices

2003-08-05  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_text_to_columns_impl): save sheet
	  index and update sheet pointer

2003-08-04  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_set_text_redo): use cmd->sheet rather than
	  pos.sheet

2003-08-04  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_analysis_tool_undo): call
	  dao_update_sheet_pointer before causing the sheet pointer to
	  be used
	(cmd_analysis_tool_redo): ditto

2003-08-04  Jon K Hellan  <hellan@acm.org>

	* configure.in: Make Python plugin depend on python >= 2.0 and
	pygtk-2.0. Remove WITH_PYGTK and BROKEN_PY_INITIALIZE
	conditionals.

2003-08-04  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_ins_del_colrow*): use sheet info in
	  me->cmd,sheet
	(cmd_resize_colrow): ditto
	(cmd_colrow_std_size): ditto

2003-08-04  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/workbook-view.c (wb_view_selection_desc): don't include
	  the number of rows (or columns) for full columns (or rows)

2003-08-04  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.h (cmd_tabulate): new
	* src/commands.c (cmd_tabulate*): new

2003-08-03  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/consolidate.c (consolidate_check_destination):
	  implement

2003-08-03  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_consolidate*): delete
	* src/commands.h (cmd_consolidate): delete
	* src/consolidate.c (consolidate_free): add argument
	(consolidate_set_destination): delete
	(consolidate_get_dest_bounding_box): delete
	(consolidate_apply): make static
	(tool_consolidate_engine): new
	(set_cell_expr): delete
	(set_cell_value): delete
	(redraw_respan_and_select): delete
	(simple_consolidate): use dao
	(cb_row_tree): ditto
	(row_consolidate): ditto
	(cb_col_tree): ditto
	(col_consolidate): ditto
	(colrow_consolidate): use dao and write values only once
	* src/consolidate.h (consolidate_free): add argument
	(consolidate_set_destination): delete
	(consolidate_get_dest_bounding_box): delete
	(consolidate_apply): delete
	(tool_consolidate_engine): new
	(consolidate_check_destination): new

2003-08-03  Jon K Hellan  <hellan@acm.org>

	* src/sheet-object-graphic.c (sheet_object_graphic_user_config):
	Remove preview from tab sequence, yielding sane tabbing behaviour.

2003-08-01  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_set_comment_redo): don't keep a sheet
	  pointer across undo/redo.
	(cmd_set_comment): ditto

2003-08-01  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_reorganize_sheets_delete_recreate_sheet):
	  paste content back
	(cmd_reorganize_sheets_delete_get_this_sheet_info): get content
	(cmd_reorganize_sheets_delete_free): free content
	* src/workbook-control-gui.c (delete_sheet_if_possible):
	  Do not ask for confirmation.

2003-08-01  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=118830
	* src/sheet.c (sheet_dup): convert to zoom factor 1 before
	  duplicating

2003-08-01  Morten Welinder  <terra@gnome.org>

	* src/workbook-control-gui.c (wbcg_data_allocator_editor): Plug
	leak.

2003-07-31  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_clone_sheet*): new command
	* src/commands.h (cmd_clone_sheet): new
	* src/workbook-control-gui.c (sheet_action_clone_sheet):
	  use cmd_clone_sheet
	(cb_edit_duplicate_sheet): use cmd_clone_sheet

2003-07-31  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c: switch from sheet pointer to sheet indices
	  throughout
	(cmd_reorganize_sheets_delete_sheets): deleted
	(cmd_reorganize_sheets_delete_get_this_sheet_info): new
	(cmd_reorganize_sheets_delete_shift_list): new
	(cmd_reorganize_sheets_delete_cmp_f): new
	(cmd_reorganize_sheets_delete_get_all_sheets_info): new
	(cmd_reorganize_sheets_delete_recreate_sheet): new
	(cmd_reorganize_sheets_delete_free): new
	(cmd_reorganize_sheets_fix_list): new
	(cmd_reorganize_sheets_undo): do most of the work here rather than
	  in workbook_sheet_reorganize
	(cmd_reorganize_sheets_redo): ditto
	(cmd_reorganize_sheets): handle deletion
	(cmd_reorganize_sheets_finalize): handle deletion
	* src/commands.h: change arguments to cmd_reorganize_sheets
	* src/workbook-control-gui.c (insert_sheet_at): new
	(cb_insert_sheet): use insert_sheet_at
	(cb_append_sheet): change call to cmd_reorganize_sheets
	(delete_sheet_if_possible): use cmd_reorganize_sheets
	(sheet_action_clone_sheet): temporarily append clone sheet (rather
	  than insert) to protect the undo-chain
	(cb_edit_duplicate_sheet): ditto
	(cb_sheet_label_drag_data_received): change arguments to
	  cmd_reorganize_sheets
	* src/workbook.c (workbook_sheet_by_index): handle index -1
	  separately
	(workbook_sheet_reorder): drop last argument
	(workbook_sheet_reorder_by_idx): new
	(workbook_sheet_recolor): new
	(workbook_sheet_rename): new
	(workbook_sheet_rename_check): new
	(workbook_sheet_change_protection): new
	(workbook_sheet_reorganize): delete
	* src/workbook.h (workbook_sheet_reorder): drop last argument
	(workbook_sheet_reorder_by_idx): new
	(workbook_sheet_recolor): new
	(workbook_sheet_rename): new
	(workbook_sheet_rename_check): new
	(workbook_sheet_change_protection): new
	(workbook_sheet_reorganize): delete

2003-07-31  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (maybe_convert) : seek back to the start if we don't
	  need to convert things.  Assume we were already at the start on
	  arrival.
	(maybe_gunzip) : ditto.
	* plugins/xml_sax/xml-sax-read.c (maybe_convert) : ditto.
	(maybe_gunzip) : ditto.

2003-07-31  Jody Goldberg <jody@gnome.org>

	* src/graph.c (gnm_go_data_vector_get_value) : implement.
	(gnm_go_data_vector_get_str) : implement and adjust to signature
	  change.

2003-07-31  Morten Welinder  <terra@gnome.org>

	* src/xml-io.c (maybe_gunzip, maybe_convert): New functions.
	(xml_probe, gnumeric_xml_read_workbook): Use above to handle 1.0
	documents (lacking encoding).

2003-07-30  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=118723
	* src/xml-io.c (copy_hash_table_to_ptr_array) : always export cells
	  with expressions, even if it's value is blank,

	* src/sheet-object.c (sheet_object_register) : add sheet-object-image.

2003-07-30  Jody Goldberg <jody@gnome.org>

	For : Emmanuel Pacaud <emmanuel.pacaud@univ-poitiers.fr>
	* icons/Makefile.am: add chart_{line,area}*.png icons, and a pile of
	  svg for the future.

2003-07-30  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* samples/test-math.gnumeric: add apostrophes around PASS and NO.

2003-07-30  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/workbook-control-gui.c: Change verb name ToolsScenario to
	  ToolsScenarioAdd

2003-07-28  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=118261
	* src/sheet-object-image.c (sheet_object_image_update_bounds) : fix
	  when there really is an image.

2003-07-28  Jody Goldberg <jody@gnome.org>

	* src/graph.c (gnm_go_data_scalar_eq) : handle the delayed connection
	  to the sheet where the expression is still NULL because we have not
	  parsed it yet.
	(gnm_go_data_vector_eq) : ditto.

	* src/func.c (function_call_with_list) : allow implicit iteration that
	  does not start at the first argument.

2003-07-27  Jon K Hellan  <hellan@acm.org>

	* src/sheet-object-graphic.c (sheet_object_filled_user_config,
	sheet_object_graphic_user_config): Make <return> in text entry,
	spin button fields activate default.

	* src/sheet-object-widget.c (sheet_widget_adjustment_user_config,
	sheet_widget_checkbox_user_config): Make <return> in text entry,
	expression entry fields activate default.

2003-07-26  Jon K Hellan  <hellan@acm.org>

	* src/plugin.c (gnm_plugin_try_unref): New function. Unref plugin
	object if it is legal to destroy it.
	(plugins_shutdown): Use it. Fixes
	http://bugzilla.gnome.org/show_bug.cgi?id=114211.

2003-07-25  Morten Welinder  <terra@gnome.org>

	* src/gui-util.c (gnumeric_clist_moveto): Finally delete this.

	* src/stf-parse.c (stf_parse_options_fixed_splitpositions_clear):
	Add terminator here.
	(stf_parse_options_fixed_splitpositions_add): Insert sorted.
	(stf_parse_options_fixed_splitpositions_remove,
	stf_parse_options_fixed_splitpositions_count,
	stf_parse_options_fixed_splitpositions_nth): New functions.

2003-07-23  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_goal_seek*): new
	* src/commands.h (cmd_goal_seek): new

2003-07-23  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_solver*): new
	* src/commands.h (cmd_solver): new

2003-07-23  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_text_to_columns*): new
	* src/commands.h (cmd_text_to_columns): new
	* src/gui-clipboard.c
	(text_to_cell_region): use stf_dialog_result_attach_formats_to_cr
	* src/stf.c (stf_text_to_columns) use stf_parse_region and
	  stf_dialog_result_attach_formats_to_cr rather than
	  stf_store_results

2003-07-22  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-widget.c (sheet_widget_button_set_label) : remove
	  debug spew.

2003-07-22  Morten Welinder  <terra@gnome.org>

	* src/sheet-object-image.c (sheet_object_image_update_bounds):
	Take care of placeholder tiling here.

	* src/gui-util.c (gnm_pixbuf_tile): New function.

2003-07-21  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=117409
	* src/stf-parse.c (stf_parse_region): fix one-off error in
	  number of columns

2003-07-21  Morten Welinder  <terra@gnome.org>

	* src/sheet-object-image.c (soi_get_pixbuf): Stop making silly
	files.  Show a "?" image instead of files we do not understand.

2003-07-18  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-widget.c (sheet_widget_slider_create_widget) : Mark
	  the object as being in the process of an update when a new widget is
	  created.  Otherwise the assignment of the new adjustment will look
	  like an update and dirt the workbook.
	(sheet_widget_spinbutton_create_widget) : ditto.
	(sheet_widget_scrollbar_create_widget) : ditto.

2003-07-18  Jody Goldberg <jody@gnome.org>

	For Joseph Pingenot <trelane@digitasaru.net>
	* src/sheet-object-widget.c : Add Spinner and Slider.

2003-07-18  Jody Goldberg <jody@gnome.org>

	* src/mstyle.c (mstyle_hash_internal) : renamed from mstyle_hash,
	  internalized and generalized.
	(mstyle_hash_XL) : new.
	(mstyle_hash) : new.

2003-07-17  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (wbcg_sheet_add) : no need to set the
	  zoom again  sheet_control_gui_new already did.

	* src/sheet-control-gui.c (scg_finalize) : remove the comment window
	  if it is displayed.

2003-07-17  Morten Welinder  <terra@gnome.org>

	* src/io-context-gtk.c (icg_user_is_impatient): Improve
	large-latency case.

	* src/io-context.c (io_progress_update): Make sure we update at
	the end, so the display doesn't stop at, say, 95%.
	(value_io_progress_update): Ditto.
	(count_io_progress_update): Ditto.

	* src/number-match.c (format_create_regexp): Approach working
	state for fractions.
	(compute_value): Handle fractions.

	* src/workbook-control-gui.c (cb_sheet_label_drag_begin): Get
	marker from application.

	* src/application.c (gnumeric_application_setup_pixbufs): Add
	sheet_move_marker.

	* src/item-bar.c (item_bar_calc_size): Calculate the width based
	on SHEET_MAX_ROWS.  (This makes it slightly narrower than it used to,
	probably a good thing.)

2003-07-16  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c : include gog-data-set.h

	* src/stf.c (csv_tsv_probe) : probe content must be true or we won't
	  accept the match.

	* src/sheet-view.c (sv_init_sc) : set the zoom early to avoid problems
	  when attaching an existing control to a new sheet.

2003-07-16  Morten Welinder  <terra@gnome.org>

	* src/io-context-gtk.c (icg_show_gui): Load splash from
	application.  (So it can be displayed fast.)

	* src/application.c (gnumeric_application_setup_pixbufs): Add line
	and background patterns.  Ditto for splash and borders.

	* src/format.c (style_format_equal): Just compare pointers.

2003-07-15  Jody Goldberg <jody@gnome.org>

	From John Gill :
	* schemas/gnumeric-general.schemas.in : Add core/gui/editing/transitionkeys
	* src/application.c (application_history_add) : new.
	(application_set_transition_keys) : new.
	* src/gnumeric-gconf.c (gnm_conf_init) : load the new pref.
	(gnm_gconf_set_transition_keys) : new.

	* src/item-cursor.c (item_cursor_selection_event) : Improve the
	  heuristics even further.

2003-07-15  Morten Welinder  <terra@gnome.org>

	* src/format.c (style_format_build): New function.
	(style_format_number, style_format_account, style_format_science,
	style_format_percent, style_format_fraction): Move from format.c
	and make static.  Change to returning StyleFormat* instead of
	building a string.  All callers changed.

	* src/auto-format.c (is_date): Use precomputed family.
	* src/sheet-autofill.c (fill_item_new): Ditto.

	* src/formats.c (cell_format_classify): Don't use
	style_format_is_general since this function must work early.

	* src/format.h (struct _StyleFormat): Add family and family_info
	members.

	* src/format.c (style_format_new_XL): Init family stuff.
	(style_format_is_general, style_format_is_text): Make these
	macros.

2003-07-15  Morten Welinder  <terra@gnome.org>

	* src/format.h: Suck in formats.h and remove that file.  All
	includers fixed.

	* src/format.c (style_format_str_as_XL): Avoid a gazillion strlen
	calls.
	(style_format_new_XL): Don't free strings that aren't ours to
	free.

	* src/commands.c (cmd_selection_clear): Avoid a pointless strlen.

	* src/clipboard.c (cellregion_to_string): Avoid a silly copy of
	the result (and a few pointless strlens).

	* src/formats.c (style_format_number): Avoid making a copy of the
	format.

	* src/format.c (format_number): Fix sign position for fractions.
	Align fractions.
	(append_year, append_month, append_day, append_hour,
	append_hour_elapsed, append_minute, append_minute_elapsed,
	append_second, append_second_elapsed, format_number): Simplify
	using g_string_append_printf.

2003-07-14  Morten Welinder  <terra@gnome.org>

	* src/auto-format.c (is_date): New function.
	(do_af_suggest): Be smarter about date differences.  They're
	common and formatting them as dates is irritating.

2003-07-13  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/commands.c (cmd_analysis_tool_redo): recalc
	(cmd_analysis_tool_undo): ditto

2003-07-10  Jody Goldberg <jody@gnome.org>

	* src/func.c (function_dump_defs) : tack on category
	  and make the generated links for the state dump uppercase to match
	  the results from yelp.

2003-07-10  Jody Goldberg <jody@gnome.org>

	* src/stf.c (csv_tsv_probe) : quicky bogus probe for csv/tsv suffixes.
	  We really need to merge the plugin service and the Openers for 1.3

2003-07-09  Jody Goldberg <jody@gnome.org>

	* configure.in : we're not going to be finished in time.  Make bonobo
	  the default.

2003-07-11  Morten Welinder  <terra@gnome.org>

	* src/formats.c (style_format_fraction): Handle fixed-denominator
	fractional formats.
	(cell_format_fraction): Add three-digit general and several
	fixed-denominator fractional formats.
	(currency_date_format_init): Recognize fractional formats with
	explicit denominator.
	(cell_format_is_fraction): Recognize explicit denominator.

	* src/format.c (format_add_decimal, format_remove_decimal): Do
	something sensible for fixed-denominator fractional formats.

2003-07-11  Morten Welinder  <terra@gnome.org>

	* src/format.c (format_toggle_thousands, format_add_decimal,
	format_remove_decimal, reformat_decimals): Return a StyleFormat,
	not a [vile XL format] string.  All callers changed.

2003-07-10  Morten Welinder  <terra@gnome.org>

	* src/format.c (format_toggle_thousands): New function.

	* src/workbook-format-toolbar.c (cb_format_with_thousands): Toggle
	thousands separator instead of just applying a random format.

	* src/formats.c (style_format_account): Do not discard old part of
	result.
	(currency_date_format_init): Add optional quotes around currency
	symbol.

	* src/workbook-view.c (wb_view_format_feedback): Take cell value's
	format into account.

	* src/format.c (style_format_equal): New function.

2003-07-09  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/stf.c (stf_text_to_columns): do not pass null data to stf_dialog

2003-07-09  Morten Welinder  <terra@gnome.org>

	* src/formats.c (currency_date_format_shutdown): Free regexps.
	(currency_date_format_init): Build regexp for fractions.
	(cell_format_is_fraction): New function.
	(cell_format_classify): Recognize fraction with precision.

	* src/format.c (format_remove_decimal, format_add_decimal): Handle
	fraction formats too.

	* src/formats.c (style_format_fraction): New function.

2003-07-09  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/stf.c (stf_text_to_columns): do not post an error on user cancel.

2003-07-09  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/stf.c (stf_read_workbook): do not post a cancelled "error"
	* src/workbook-view.c (wb_view_new_from_input): if the workbook
	  has no sheet but we didn't have an error, the user must have
	  cancelled

2003-07-08  Jody Goldberg <jody@gnome.org>

	* src/application.c (gnumeric_application_setup_icons) : add
	  spinbutton

	* src/pixmaps/Makefile.am : Add spin button and use the icons from
	  glade for button and radio button.

2003-07-08  Morten Welinder  <terra@gnome.org>

	* src/datetime.c (days_between_basis): Handle new basis
	BASIS_MSRB_30_360_SYM.
	(days_between_BASIS_MSRB_30_360_SYM): New function.
	(days_between_BASIS_MSRB_30_360): Handle end-of-February
	correctly.

2003-07-07  Morten Welinder  <terra@gnome.org>

	* src/datetime.c (yearfrac): Even get February 29 right.

	* src/mathfunc.c (lbeta3): Gimme a brown paper bag.  (Thanks to
	deaddog for spotting.)

	* src/sheet-style.c: Use pool allocation.

	* src/value.c (value_equal): Change to eq-style semantics
	(matching the hash function).

	* src/expr.c (gnm_expr_equal): Use value_equal.

	* src/workbook-control-gui.c (workbook_control_gui_init): Fix
	numbering after separator.
	(workbook_control_gui_init): Remove assignments to members
	menu_item_sheets_edit_reorder and menu_item_sheets_format_reorder.
	(Wrong, but unused anyway.)

	* src/workbook-view.c (wb_view_sendto): Fix encoding confusion.
	(wb_view_sendto): Fix uninitialized use of "problem".

2003-07-06  Jody Goldberg <jody@gnome.org>

	For John Gill <jng@renre.com>
	* src/item-cursor.c (item_cursor_selection_event) : More XLish
	  heuristics for autofill range selection when double clicking.

2003-07-06  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/stf-parse.c (stf_parse_sheet): no col_import_array means
	  we want to import all columns
	(stf_parse_region): ditto
	* src/stf.c (stf_apply_formats): ditto

2003-07-06  Rodrigo Moya <rodrigo@gnome-db.org>

	* configure.in:
	* plugins/Makefile.am: added gnome-db plugin directory, built only
	when Bonobo is compiled in.

2003-07-06  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/GNOME_Gnumeric.xml: clean up the sheet insert/append issue
	* src/workbook-control-gui.c: ditto
	(cb_insert_sheet): insert the sheet after the current sheet
	  rather than append
	(cb_append_sheet): append a new sheet
	(sheet_action_add_sheet): use cmd_... via cb_append_sheet rather
	  than adding without undo
	(sheet_action_insert_sheet): new

2003-07-05  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/gui-clipboard.c: change dialogresult->formats to
	  dialogresult->parseoptions->formats thoughout
	* src/stf-parse.c (stf_parse_options_new): initialize formats
	(stf_parse_options_free (stf_parse_region): rewrite
	* src/stf-parse.h: add formats list to parseoptions
	* src/stf.c (stf_store_results): split into stf_store_results
	  and stf_apply_formats
	(stf_apply_formats): new

2003-07-05  Morten Welinder  <terra@gnome.org>

	* src/position.c (cellref_hash): Use hash space much better.

	* src/expr.c (expr_tree_sharer_destroy): Provide a sane hash for
	cell refs!

2003-07-05  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/GNOME_Gnumeric.xml: adding ellipses to the stat analysis
	  menu items
	* src/workbook-control-gui.c: ditto

2003-07-04  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/GNOME_Gnumeric.xml: fix tooltip inconsistence and
	  add stock item to delete
	* src/workbook-control-gui.c: ditto

2003-07-04  Rodrigo Moya <rodrigo@gnome-db.org>

	* configure.in: require libgnomedb CVS version, for
	gnome_db_login_set_dsn.

2003-07-04  Rodrigo Moya <rodrigo@gnome-db.org>

	* configure.in: added check for libgnomedb.

2003-07-04  Jody Goldberg <jody@gnome.org>

	* src/workbook-view.c (wb_view_sendto) : quick implementation that
	  hard codes evolution-1.4, and its syntax.  Will leak the file if we
	  exit too soon after sending.

	* src/sheet-object-graphic.c (cb_dialog_graphic_config_destroy) : fix leak.
	(cb_dialog_graphic_config_ok_clicked) : delete.
	(cb_fill_color_changed) : simplify.
	(sheet_object_graphic_user_config) : tidy and set mnemonics for the
	  colour combos.
	(sheet_object_filled_user_config) : ditto.
	(cb_dialog_filled_config_destroy) : fix leaks.
	(cb_fillcolor_changed) : simplify
	(cb_outlinecolor_changed) : ditto.

2003-07-03  Jon K Hellan  <hellan@acm.org>

	* src/sheet-object-graphic.c (sheet_object_graphic_user_config)
	(sheet_object_filled_user_config)
	(sheet_object_filled_user_config): Turn off color combo
	tearoff behaviour in dialogs.

2003-07-02  Jody Goldberg <jody@gnome.org>

	* src/sheet-control-gui.c (scg_comment_display) : Use gtk_window_move
	  in place of the deprecated gtk_widget_set_uposition.

2003-07-02  Morten Welinder  <terra@gnome.org>

	* src/datetime.c (yearfrac): Swap args if incorrectly ordered.
	Make it clear that we're counting February 29ths, not leap days.
	(Leap days are February 24ths, if you must know.)  Get the less
	than one year special case right.

2003-07-02  Jody Goldberg <jody@gnome.org>

	* po/Makefile.in.in : As suggested by tino, try to do a release
	  without the .gmo files.

2003-07-02  Jody Goldberg <jody@gnome.org>

	* src/print.c (print_sheet_objects) : translate to the upper left
	  corner of the object and pass in its width and height.
	* src/sheet-object.c (sheet_object_print) : adjust print interface to
	  only pass width and height in pts.  print context is already at 0,0
	  and scaled.
	* src/sheet-object-graph.c (sheet_object_graph_print) : Use new
	  cleaner interface.
	* src/sheet-object-image.c (sheet_object_image_print) : ditto.
	* src/sheet-object-graphic.c (sheet_object_graphic_print) :
	  Save the graphics context before filling and just resuse it for the
	  outline.  Fix the direction handling for the new interface
	  semantics.
	(sheet_object_filled_print) : ditto.

2003-07-01  Morten Welinder  <terra@gnome.org>

	* src/datetime.c (yearfrac): New function.

2003-07-01  Jody Goldberg <jody@gnome.org>

	* src/Makefile.am : Be even more delicate about changeing built
	  sources.  Be very anal about not including generated files in the
	  release.
	* src/gnumeric-paths.sh.in : No need to handle paths here.  Do it in
	  the make file.

2003-07-01  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=115929
	For gjc@inescporto.pt (Gustavo Carneiro)
	* autogen.sh : Use gnome-common's libtool version test rather than the
	  antiquated version in here that did not handle libtool-1.5

2003-07-01  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=116447
	* src/formats.c (style_format_account) : fix typo.

	* src/GNOME_Gnumeric.xml : Add FileSend

2003-06-30  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-paths.sh.in : Add exec_prefix

2003-06-30  Jody Goldberg <jody@gnome.org>

	For Ben Liblit
	* configure.in : add src/gnumeric-paths.sh
	* src/Makefile.am : Use src/gnumer-paths.sh and remove the all-local
	  kludge.

2003-07-01  Morten Welinder  <terra@gnome.org>

	* src/graph.c (gnm_go_data_vector_load_values): Always set minimum
	and maximum.

	* src/stf-parse.c (stf_parse_csv_cell): Don't use O(n^2) UTF-8
	validation.

	* src/sheet-control-gui.c (cb_table_destroy): Properly release
	panes.

2003-06-30  Morten Welinder  <terra@gnome.org>

	* src/libgnumeric.c (gnm_common_init, gnm_shutdown): Style depends
	on colours.

	* src/commands.c (cmd_set_text_redo): Don't override a user
	format.

	* src/gui-clipboard.c (text_to_cell_region): Handle column
	selection here too.
	* src/stf-parse.c (stf_parse_region): Ditto.

2003-06-29  Morten Welinder  <terra@gnome.org>

	* src/formats.c (style_format_percent, style_format_science,
	style_format_account, style_format_number): Simplify using
	g_string_append_len.

	* src/stf.c (stf_store_results): Don't switch locales here.

2003-06-28  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/stf-parse.c (stf_parse_options_new): initialize new fields
	(stf_parse_options_free): free new fields
	(stf_parse_csv_line): show all columns
	(stf_parse_sheet): only store selected rows (and formats vary within
	  each row!)
	* src/stf-parse.h: add col_import_array to parse_options
	* src/stf.c (stf_store_results): apply only the format of selected
	  columns

2003-06-27  Jody Goldberg <jody@gnome.org>

	* src/datetime.c (days_between_basis) : tidy up a bit.
	(annual_year_basis) : move this here from the date plugin and use the
	  enum to improve clarity.

2003-06-27  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=115503
	* src/formats.c (cell_format_classify): set the date related
	  FormatCharacteristics to something valid (not just to something sane)

2003-06-27  Morten Welinder  <terra@gnome.org>

	* src/rendered-value.c (cell_get_entered_text): Always quote
	string values starting with a quote.

2003-06-26  Jody Goldberg <jody@gnome.org>

	* src/gui-file.c (ask_for_file_saver) : ditto.
	* src/file.c (gnm_file_saver_save_to_stream_real) : delete.  We can
	  handle this via libgsf now.

	* src/workbook-control-gui-priv.h : some cleanup.

2003-06-27  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-gui-priv.h (struct _WorkbookControlGUI):
	Remove clipboard_paste_callback_data.

2003-06-26  Jon K Hellan  <hellan@acm.org>

	* src/gui-clipboard.c (struct GnmGtkClipboardCtxt): New struct,
	clipboard paste context.
	(complex_content_received): Request fallback format if paste
	doesn't succeed.
	(x_clipboard_received): Choose a table or spreadsheet format as
	preferred paste format, and a string format to fall back to.

2003-06-26  Morten Welinder  <terra@gnome.org>

	* src/stf-parse.c (stf_parse_options_guess): Improve separator
	guessing.

2003-06-25  Morten Welinder  <terra@gnome.org>

	* src/gui-util.c (gdk_cursor_new_from_pixbuf): Please leaks in
	stolen code...

	* src/expr.c (do_expr_as_string): Make this produce "(-2)^2", not
	"-2^2", to cut down on surprises.  Fix old bug in other
	()-insertion.

2003-06-25  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/func-builtin.c: change category name to match previous change
	  in fn-math plugin

2003-06-25  Jon K Hellan  <hellan@acm.org>

	* src/gui-clipboard.c (x_clipboard_get_cb): Use
	gtk_selection_data_set_text when pasting as string. Makes pasting
	non Latin-1 work.

2003-06-24  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=115853
	* src/formats.c (style_format_number) : generate an _un_translated
	  format.

2003-06-24  Jon K Hellan  <hellan@acm.org>

	* src/gui-clipboard.c (x_clipboard_get_cb): Call
	gtk_selection_data_set with correct data flavour.

2003-06-24  Morten Welinder  <terra@gnome.org>

	* src/application.c (application_get_pixbuf): New function.

	* src/pixmaps/Makefile.am (VARIABLES): Extra gnm_cursor_cross from
	gui-util.c.

	* src/sheet-control-gui.c (scg_set_display_cursor): Use
	gnm_widget_set_cursor methods.

	* src/item-grid.c (cb_cursor_motion): Use
	gnm_pane_mouse_cursor_set.

	* src/gnumeric-pane.h (GnumericPane): Replace cursor_type member
	by mouse_cursor.

	* src/gnumeric-pane.c (gnm_pane_release): Free mouse_cursor.
	(gnm_pane_mouse_cursor_set): New function.

	* src/gui-util.c (gdk_cursor_new_from_pixbuf)
	[!HAVE_GDK_CURSOR_NEW_FROM_PIXBUF]: New function.
	(CursorDef, cursor_cross_xpm, gnm_cursor_init1, gnm_cursor_create,
	gnm_cursor_set_widget): Delete.
	(gnm_widget_set_cursor_type): Rename from gnm_widget_set_cursor.
	All callers changed.
	(gnm_widget_set_cursor): New function.
	(gnm_fat_cross_cursor): New function.

	* configure.in: Check for gdk_cursor_new_from_pixbuf.

	* src/workbook-format-toolbar.c (workbook_create_format_toolbar):
	Use application_get_pixbuf to get icons for color_combo_new.

2003-06-24  Jon K Hellan  <hellan@acm.org>

	* src/plugin-service.c (plugin_service_file_saver_read_xml):
	Recognize save_scope value "range".

	* src/gui-file.c (make_format_chooser): Leave savers with scope
	'range' out from menu.

	* src/gui-clipboard.c (table_cellregion_write): New
	function. Convert to memory buffer in format wanted by clipboard
	by pasting into a temporary workbook, saving that to a memory
	output stream.
	(x_clipboard_get_cb): Export to clipboard as xhtml.

	* src/file.h (enum FileSaveScope): Add FILE_SAVE_RANGE, used when
	exporting to clipboard.

	* src/file.[ch] (gnm_file_saver_get_save_scope): Constify.

2003-06-23  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/main-application.c (warn_about_ancient_gnumerics): change
	  Gnumeric URL

2003-06-23  Morten Welinder  <terra@gnome.org>

	* src/item-edit.c (item_edit_event): Use gnm_widget_set_cursor.

	* src/item-cursor.c (item_cursor_set_cursor): Use
	gnm_widget_set_cursor.

	* src/sheet-object-cell-comment.c (cell_comment_event): Use
	gnm_widget_set_cursor.

	* src/gui-util.c (gnm_widget_set_cursor): New function.

	* src/gui-util.h (GnmCursorType): Eliminate unused _SIZE cursors.

	* src/gnumeric-pane.c (cb_control_point_event): Change "cursor"
	data to a GdkCursorType.
	(set_acetate_coords): Ditto.
	(new_control_point): Ditto.  Arg type changed.  All callers
	changed.
	(set_item_x_y): Ditto.

	* src/gui-util.h (GnmCursorType): Eliminate unused zoom and hand
	cursors.

	* src/number-match.c (format_create_regexp): Simplify using
	gnumeric_regexp_quote1.
	(char_to_re): Delete.
	(str_to_re): Replace by gnumeric_regexp_quote.

	* src/search.c (search_replace_compile): Simplify using
	gnumeric_regexp_quote.

	* src/regutf8.c (gnumeric_regexp_quote, gnumeric_regexp_quote1):
	New functions.
	(gnumeric_regcomp_XL): Simplify using gnumeric_regexp_quote1.

2003-06-23  Jon K Hellan  <hellan@acm.org>

	* src/gui-clipboard.c (OOO11_ATOM_NAME, complex_content_received,
	x_clipboard_received): New name in OpenOffice.org 1.1 Beta for
	OpenOffice XML clipboard target. Add it.

2003-06-21  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* schemas/gnumeric-dialogs.schemas.in: add printsetup/header and
	  printsetup/footer schemas
	* src/gnumeric-gconf-priv.h: add more keys
	* src/gnumeric-gconf.c (gnm_gconf_set_printer_footer): new
	(gnm_gconf_set_printer_header): new
	(gnm_gconf_set_printer_config): change name of key
	(gnm_conf_init): initialize header and footer from gconf
	* src/gnumeric-gconf.h (gnm_gconf_set_printer_footer): new
	(gnm_gconf_set_printer_header): new
	(GnmAppPrefs): add header and footer fields
	* src/print-info.c (print_info_save): save footer and header to
	  gconf
	(print_info_new): read footer and header to gconf

2003-06-22  Jon K Hellan  <hellan@acm.org>

	* src/file.c (gnm_file_saver_save): Don't check for overwrite if
	not saving to a file.

2003-06-22  Jody Goldberg <jody@gnome.org>

	* src/sheet-object.c (sheet_object_register) : register the graph
	  types to allow loading.

	* src/sheet-object-graph.c (sheet_object_graph_read_xml) : enable.
	(sheet_object_graph_write_xml) : enable.

	* src/graph.c (gnm_go_data_from_str) : new utility shared by vector
	  and scalar that can parse, and handle delaying the parse until the
	  data source is linked to a sheet to provide context.
	(gnm_go_data_set_sheet) : ditto.
	(gnm_go_data_scalar_from_str) : new requirement for interface.
	(gnm_go_data_scalar_set_sheet) : use gnm_go_data_set_sheet.
	(gnm_go_data_vector_from_str) : new requirement for interface.
	(gnm_go_data_vector_set_sheet) : use gnm_go_data_set_sheet.

	* src/application.c (application_history_add) : GObject::notify seems
	  to prefer hyphens to underscores.
	(gnumeric_application_class_init) : ditto.

2003-06-18  Jody Goldberg <jody@gnome.org>

	* src/hlink.c (gnm_hlink_cur_wb_activate) : jump to the target sheet,
	  not the current sheet.

2003-06-21  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/stf-parse.c (stf_parse_options_new): initialize locale
	(stf_parse_options_free): free locale
	(stf_parse_sheet): setup locale
	(stf_parse_region): setup locale
	* src/stf-parse.h : add locale to parseoptions
	* src/stf.c (stf_store_results): setup locale

2003-06-21  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/formats.c (currency_date_format_shutdown): free allocated
	  memory since currency_date_format_init/shutdown may be called
	  multiple time
	(currency_date_format_init): Do not assume that data structures
	  are in pristine state

2003-06-20  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/print-info.c (print_info_new): set up (but disable) load of
	  print-config from configuration string
	* src/print.c (print_job_info_set_one_time_defaults): delete
	(print_job_info_save_one_time_defaults): delete

2003-06-20  Jon K Hellan  <hellan@acm.org>

	* src/io-context-gtk.c (cb_realize): New. Called when splash is
	realized. Move placement logic here, and use natural size.
	(icg_show_gui): Register realize handler, move placement logic
	out, and get rid of explicit sizing.

2003-06-20  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/print.c (print_job_info_get): don't overwrite page layout
	  info with default.

2003-06-19  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/print-info.c (print_info_new): protect all parts of the
	  locale from libcups

2003-06-19  Morten Welinder  <terra@gnome.org>

	* src/format.c (format_get_decimal, format_get_thousand): Return a
	UTF-8 string, not a char.  All callers changed.

2003-06-19  Jon K Hellan  <hellan@acm.org>

	* src/main-application.c (main): Don't load any more workbooks if
	user closed splash.

	* src/io-context-gtk.c (struct _IOContextGtk): Add 'interrupted'
	member.
	(cb_icg_window_destroyed): Don't abort, set 'interrupted' flag
	instead, when user closes splash after the first file has been
	shown.
	(icg_init): Initialize 'interrupted'.

	* src/io-context-gtk.[ch] (icg_get_interrupted): New. Return
	'interrupted'.

2003-06-19  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* format.c (update_lc): set locale_info_cached to TRUE

2003-06-18  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/GNOME_Gnumeric.xml: spelling fixes
	* schemas/gnumeric-general.schemas.in: spelling fixes

2003-06-18  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/file.c: spelling fixes
	* src/format-template.c: spelling fixes
	* src/formats.c: spelling fixes
	* src/func-builtin.c: spelling fixes
	* src/sheet-style.c: spelling fixes

2003-06-18  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/gui-clipboard.c: call stf_dialog with new arguments
	* src/stf.c: call stf_dialog with new arguments

2003-06-18  Jon K Hellan  <hellan@acm.org>

	* src/io-context-gtk.c (struct _IOContextGtk): Add 'latency'
	member to help in startup time prediction.
	(icg_user_is_impatient): Try to predict startup time after
	ICG_POPUP_DELAY/3, and pop up splash if we predict startup to take
	> ICG_POPUP_DELAY.
	(icg_progress_set): Update progress before checking if it is time
	to show splash.
	(icg_init): Initialize latency.

2003-06-18  Jon K Hellan  <hellan@acm.org>

	* src/print-info.c: Include locale.h

2003-06-18  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/print-info.c (print_info_new): preserve the locale across
	  the call to gnome_print_config_default.
	  (A workaround for a library bug.)

2003-06-17  Morten Welinder  <terra@gnome.org>

	* src/format.c (update_lc): New function to extract all lc info
	right away.
	(format_get_decimal, format_get_thousand, format_get_currency):
	Use it.

	* src/stf-parse.c (stf_parse_options_guess): Set sepchar in all
	cases.

2003-06-16  Morten Welinder  <terra@gnome.org>

	* src/gutils.c (gnm_guess_encoding): New function.

	* src/stf.c (stf_read_workbook_auto_csvtab): Properly decode file
	before inspecting.  Use stf_parse_options_guess.

	* src/stf-parse.c (stf_parse_options_guess): New function.

	* src/parse-util.c (sheetref_parse): Base on gnm_strunescape like
	parser.y's equivalent code.  Avoid unbounded stack usage.

2003-06-14  Jon K Hellan  <hellan@acm.org>

	* src/sheet-object-graphic.c (sheet_object_graphic_user_config)
	(sheet_object_filled_user_config): Fix typo

2003-06-13  Jon K Hellan  <hellan@acm.org>

	* src/sheet-object-graphic.c (sheet_object_graphic_user_config)
	(sheet_object_filled_user_config): Turn off instant apply for
	color combos.

2003-06-13  Morten Welinder  <terra@gnome.org>

	* src/gui-clipboard.c (text_to_cell_region): Stop assuming
	nul-termination and stop copying the string.

	* src/workbook-control-gui.c (register_xml_ui): Change signature
	to using GCallback, not a bonobo type.

2003-06-12  Morten Welinder  <terra@gnome.org>

	* src/gui-clipboard.c (text_to_cell_region): Add fixed_encoding
	argument as for stf_dialog.  All callers changed.

	* src/stf-parse.c (compile_terminators): New function.
	(stf_parse_options_add_line_terminator,
	stf_parse_options_remove_line_terminator,
	stf_parse_options_clear_line_terminator): Call
	compile_terminators, fix memory ownership.
	(stf_parse_options_new): Set terminators using
	stf_parse_options_add_line_terminator.
	(compare_terminator): Speed up using compiled terminators.

2003-06-12  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* configure.in: added en_CA

2003-06-12  Andreas J. Guelzow <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=114099
	* src/clipboard.h: change PASTE_DEFAULT to include comments

2003-06-12  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/workbook-control-gui.c: Correct the description of the mean
	  test.
	* src/GNOME_Gnumeric.xml: ditto

2003-06-12  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/workbook-control-gui.c: Improve the description of the mean
	  test.

2003-06-11  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (workbook_setup_sheets) : Fix my
	  incorrect replacement on 2003-06-05.  show_border is something
	  completely different.  Use the properties instead of the old
	  accessors.

2003-06-11  Andreas J. Guelzow <aguelzow@taliesin.ca>

	for Evert Verhellen
	* src/GNOME_Gnumeric.xml: change Insert->Add/Modify Comment to
	  Edit->Comment
	* src/workbook-control-gui.c: ditto
	* src/sheet-control-gui.c: change pop-up Add/Modify comment to
	  Edit Comment

2003-06-11  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-plugins.schemas.in: new
	* schemas/Makefile.am: added schemas/gnumeric-plugin.schemas.in
	* src/gnumeric-gconf-priv.h: add gconf keys
	* src/gnumeric-gconf.c (gnm_gconf_set_latex_use_utf8): new
	* src/gnumeric-gconf.h: add latex_use_utf field
	(gnm_gconf_set_latex_use_utf8): new
	* schemas/.cvsignore: add schemas/gnumeric-plugin.schemas

2003-06-11  Morten Welinder  <terra@gnome.org>

	* src/stf-parse.h (StfParseOptions_t): Remove parselines member.

	* src/stf-parse.c (stf_parse_get_longest_row_width): Take a
	data_end pointer too.  Callers changed.
	(stf_parse_general): Ditto.
	(stf_parse_sheet): Ditto, but optional.
	(stf_parse_region): Ditto, but optional.
	(stf_parse_options_fixed_autodiscover): Ditto.  Remove data_lines arg.
	(stf_parse_options_set_lines_to_parse): Delete.

2003-06-11  Jody Goldberg <jody@gnome.org>

	* schemas/gnumeric-general.schemas.in : Make the default number of
	  sheets 3 to make things clearer in the documentation.

2003-06-11  Morten Welinder  <terra@gnome.org>

	* src/stf-parse.c (stf_parse_convert_to_unix): Delete.

	* src/gui-clipboard.c (text_to_cell_region): Don't muck with line
	endings.

	* src/stf-parse.c (stf_parse_options_fixed_autodiscover): Handle
	line terminators correctly.
	(stf_parse_get_longest_row_width): Ditto.
	(stf_parse_general): Properly skip line endings.
	(stf_parse_lines): Add parse option argument and use standard line
	ending parsing.  All callers changed.

	* src/gui-clipboard.c (complex_content_received): Handle all kinds
	of strings here too.
	(text_to_cell_region): Rename from x_clipboard_to_cell_region.
	Add optional encoding parameter and let data be in that encoding.
	Only allow simple one-line paste if we can translate to UTF-8.
	(x_clipboard_received): Put string targets into prioritized list.
	(text_received): Delete.

2003-06-11  Andreas J. Guelzow <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=114777
	* src/stf-export.c (stf_export_cell): quote content before
	converting it into some other encoding. (fix leaks on the side)

2003-06-10  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-image.c (sheet_object_image_print) : fix.

	* src/sheet-object-graph.c (sheet_object_graph_update_bounds) :
	  Handle inversion.
	(sheet_object_graph_print) : implement.

	* src/format-template.c (format_template_transform_edges) : minor
	  pedantic reordering.

	* src/print.c (print_sheet_objects) : handle inverted objects.

2003-06-10  Morten Welinder  <terra@gnome.org>

	* src/workbook-edit.c (wbcg_edit_start): Make sure we only mark
	ranges when we are dealing with a formula.

	* src/format-template.c: Apply flame thrower.

	* src/stf.c (stf_read_workbook): Make filename handling UTF-8
	safe.
	* src/workbook-view.c (wb_view_attach_control): Ditto.
	(wb_view_save): Ditto.
	(workbook_view_new): Ditto.
	(wbv_save_to_file): Ditto.
	* src/workbook.c (workbook_set_filename): Ditto.
	* src/print-info.c (render_file): Ditto.
	* src/gui-file.c (can_try_save_to): Ditto.

	* src/workbook.c (workbook_get_filename_utf8): New function.

	* src/gutils.c (gnumeric_valid_filename): Delete.  No longer useful.

2003-06-10  Abel Cheung  <maddog@linux.org.hk>

	* configure.in: Removed en_CA and en_AU from ALL_LINGUAS. They are
	  dummy translations now.

2003-06-09  Jody Goldberg <jody@gnome.org>

	* src/format-template.c (xml_read_format_col_row_info) : remove use of
	  get_child_by_name.
	(xml_read_format_template_member) : ditto.

2003-06-09  Morten Welinder  <terra@gnome.org>

	* src/format-template.c (format_template_transform_edges): Plug
	leak.
	* src/gnm-marshalers.list: Add stuff from gal.
	* src/*.c: change to use imported gal widgets.

2003-06-09  Jody Goldberg <jody@gnome.org>

	* src/application.c (gnumeric_application_finalize) : patch a leak.

2003-06-09  Jody Goldberg <jody@gnome.org>

	* src/preview-grid.c : Major reorg.
	  Convert the signals into virtuals.
	  Add default value, and style methods
	  Convert from GtkArg -> GParam
	  Begin fixing _draw to support positions other than 0,0
	  Update queus a redraw

	* src/file-autoft.c (category_group_list_find_category_by_name) : delete
	* src/Makefile.am : add preview-grid-impl.h

2003-06-09  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* debian/*: Updated from latest package.

2003-06-09  Morten Welinder  <terra@gnome.org>

	* src/mathfunc.c (mathfunc_init): Turn off SIGFPE in here.

2003-06-08  Jody Goldberg <jody@gnome.org>

	* src/style.h : DEFAULT size in the schemas is 10, use it here too.

	* schemas/gnumeric-general.schemas.in : Use valid english.

	* Makefile.am : do not include the .server or .server.in files in the
	  distribution.
	* src/Makefile.am (ui_DATA) : be absolutely anal about
	  gnumeric-paths.h, generate it early, and do not include it in the
	  distribution.

2003-06-07  Jody Goldberg <jody@gnome.org>

	* configure.in : bump again

2003-06-07  Jody Goldberg <jody@gnome.org>

	* Release 1.1.19

2003-06-07  Jody Goldberg <jody@gnome.org>

	* src/Makefile.am : Suck it up and ignore the make warnings about
	  circular dependencies.   automake-1.4 pisses me off.

2003-06-07  Jody Goldberg <jody@gnome.org>

	* src/dependent.c (link_expr_dep) : be more anal in case something
	  unexpected gets in.

2003-06-07  Jody Goldberg <jody@gnome.org>

	* configure.in : post release bump

2003-06-07  Jody Goldberg <jody@gnome.org>

	* Release 1.1.18

2003-06-06  Morten Welinder  <terra@gnome.org>

	* src/style-border.c (style_border_set_gc_dash): Work around a
	missing const in gdk.
	(*_line, *_pattern): constify.

	* src/style-color.c (gnumeric_color_shutdown): Unref
	black/white/grid colors.  Print leaks.

	* src/format.c (number_format_shutdown): Print leaks.
	(number_format_shutdown): Unref default formats.
	(format_destroy): Make static.

2003-06-06  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (sheet_colrow_delete_finish) : This is bad practice and
	  should not really be here.  However, we need to ensure that update is
	  run before sv_panes_insdel_colrow plays with frozen panes, updating
	  those can trigger redraws before sheet_update has been called.
	(sheet_colrow_insert_finish) : ditto.

	* configure.in : bump gsf req.
	* README : ditto.

2003-06-06  Jody Goldberg <jody@gnome.org>

	* src/bonobo-io.c (gnm_persist_stream_load) : warning suppression.

2003-06-06  Morten Welinder  <terra@gnome.org>

	* src/item-bar.c (struct _ItemBar): Add normal_font_ascent and
	bold_font_ascent fields.  Change normal_font and bold_font to
	PangoFonts.
	(item_bar_calc_size): Set font and ascent fields.
	(ib_draw_cell): Use them.
	(item_bar_normal_font): Change to return a pango font.
	(ib_fonts_unref): Use g_object_unref, not style_font_unref.
	(ib_draw_cell): Use the right font for shaping.  (This prevents
	the bold dancing effect.)

	* src/sheet-control-gui.c (scg_setup_group_buttons): Match
	item_bar_normal_font change.

	* src/style.c (font_init): Don't export gnumeric_default_font, but
	gnumeric_default_font_width instead.  Single user changed.
	(style_font_string_width): Make static.
	(style_font_get_height): Delete.

2003-06-05  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-gconf.c (gnm_gconf_rm_notification) : delete.

	* src/plugin.c (gnumeric_extra_plugin_dirs) : clarify the ownership of
	  the lists.
	(plugins_init) : ditto.
	(plugins_shutdown) : ditto.

	* src/application.c (application_history_get_list) : const the output
	  to be clear on the ownership semantics.  Add a 'force_reload'
	  argument to force the list to reload and clip from the underlying
	  gconf source.  Should not be necessary later when we clear up the
	  relationship between application, and the config.
	(application_history_update_list) : deleted.
	(application_history_add) : new.  merge in some of the old
	  application_history_update_list, and some of the history_menu stuff
	  and emit a notifuy even on the newly created file_history_list
	  property of the application.  We should do the same for other
	  properties rather than requiring direct gconf connections.
	(application_history_list_shrink) : delete.
	(application_history_write_config) : delete.
	(gnumeric_application_get_property) : new.
	(gnumeric_application_class_init) : install the property.

	* src/workbook.c (workbook_finalize) : Just call
	  application_history_add directly rather than
	  workbook_history_update that was a pointless layer of indirection.
	  No need to directly call application_history_write_config
	  history_add handles that.

	* src/sheet-object-widget.c (sheet_widget_list_create_widget) : If
	  we're going to throw in a stub widget, it might as well a treeview
	  rather than a deprecated list widget.

	* src/workbook.c (workbook_history_update) : delete the vast majority
	  of this moving what little remained into.

	* src/history.c : delete everything but history_item_label.
	  greatly simplify the logic and move the majority of it into.
	* src/workbook-control-gui.c : here.  While we're at it simplify our
	  lives in preparation for turning the bonobo mess into virtuals on
	  wbcg.  Use a simpler approach to creation and removal that let
	    - monitors the application::notify::file-history-list rather than
	      requiring explicit calls from a non-gui layer.
	    - removes everything even the seperator then reinserts the new
	      entries.
	(wbcg_file_history_setup) : renamed from wbcg_history_setup.
	(change_menu_label) : Use gtk_label_set_text with use_underline
	  set to true in place of the deprecated parse_uline gunk.  While
	  we're in here set the tooltip too.  Its a hack, setting the data
	  directly based on knownledge of the implementation in libgnomeui.
	  However, there aren't many choices other than fixing libgnomeui
	  which is just too long a wait.
	(cb_edit_paste_special) : move call to cmd_paste_to_selection in to
	  the dialog like every other implementation.
	(wbcg_finalize) :  Use g_signal_handlers_disconnect_by_func in place
	  of the deprecated gtk_signal_disconnect_by_func.
	(workbook_setup_sheets) : Use gtk_notebook_set_show_border (FALSE) in
	  place of the deprecated gtk_notebook_set_tab_border (0).
	(workbook_control_gui_init) : use allow_grow, and allow_shrink
	  properties in place of deprecated gtk_window_set_policy.  And
	  g_idle_add, in place of deprecated gtk_idle_add.

	* src/sheet-control-gui.c (context_menu_handler) :
	  dialog_paste_special now calls cmd_paste_to_selection itself
	  like all the other dialogs.

	* src/gutils.c (g_slist_map) : constify to make life easier.

	* src/gnumeric-pane.c : some minor property renaming in the custom
	  canvas-items when we removed the deprecated gunk.
	* src/item-bar.c : remove deprecated GtkArg gunk in favour of
	  GObject::Param stuff.
	* src/item-grid.c : ditto.

	* src/gnumeric-gconf.h : Make the public GSLists const just to be
	  absolutely clear about who owns what.

	* src/gnumeric-gconf.c (gnm_gconf_set_plugin_extra_dirs) : make list
	  ownership semantics absolutely clear.
	(gnm_gconf_set_plugin_extra_dirs) : ditto.
	(gnm_gconf_set_file_history_files) : ditto.
	(gnm_gconf_add_notification_plugin_directories) : delete unused.
	(gnm_gconf_set_autoformat_extra_dirs) : delete unused.

	* src/gnumeric-gconf-priv.h : no need to publicly include gconf anymore

2003-06-05  Morten Welinder  <terra@gnome.org>

	* src/stf.c (stf_read_default_probe): Delete.

	* src/stf-parse.c (stf_parse_get_rowcount): Delete.
	(stf_parse_fixed_cell): Make UTF-8 safe.
	(stf_parse_get_longest_row_width): Ditto.
	(stf_parse_is_valid_data): Delete.

	* src/stf.c (stf_preparse): Butcher this.  Don't do encodings
	here.

2003-06-04  Morten Welinder  <terra@gnome.org>

	* src/stf.c (stf_store_results): Fix off-by-one and missing base
	error in setting formats.

	* src/gui-clipboard.c (x_clipboard_to_cell_region): Fix off-by-one
	error in setting formats.

	* src/stf-parse.c (stf_parse_region): Quote anything that might be
	an expression.  Still not brilliant, but better.

2003-06-04  Jody Goldberg <jody@gnome.org>

	* src/sheet-filter.c (cb_filter_button_press) : this seems simpler,
	  and catches clicking on other buttons to close the popup.

2003-06-03  Jody Goldberg <jody@gnome.org>

	For Emmanuel Pacaud <emmanuel.pacaud@univ-poitiers.fr>
	http://bugzilla.gnome.org/show_bug.cgi?id=112713
	* src/gui-utils.[ch]
	(gnumeric_button_new_with_stock_image) : new
	(gnumeric_add_dialog_button) : new
	(gnumeric_message_dialog_new) : new
	* src/workbook-control-gui.c
	(workbook_close_if_user_permits) : build a HIG compliant
	confirmation dialog

2003-06-03  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (sheet_row_size_fit_pixels) : delete the old hack to
	  work around granular font sizes and take out the +1 for the grid
	  line

	* src/sheet-filter.c (gnm_filter_remove) : make filterered rows
	  visible.
	* src/workbook-control-gui.c (cb_auto_filter) : sheet_update on remove
	  too.

	* src/item-cursor.c : clear out deprecated GtkObject::Arg goo.
	(item_cursor_draw) : pixel noise drawing zero sized animated cursors.

2003-06-03  Jody Goldberg <jody@gnome.org>

	* src/sheet.h : delete some non-existant decls.

	* src/sheet-object.c (sheet_objects_relocate) : kludgy tweak so that
	  ins/del col/row moves things and cut-n-paste does not.

2003-06-03  Jody Goldberg <jody@gnome.org>

	* src/sheet-filter.c (gnm_filter_overlaps_range) : new.
	(gnm_filter_contains_row) : delete.
	* src/sheet-view.c (sv_first_selection_in_filter) : new.
	(sv_edit_pos_in_filter) : delete.
	* src/workbook-control-gui.c (wbcg_menu_state_update) : use here.
	(cb_auto_filter) : and here.

2003-06-03  Jody Goldberg <jody@gnome.org>

	* src/expr-name.c (gnm_named_expr_collection_insert) : ease
	  requirements and allow active names to be inserted.  This is the
	  majority case for all the places we up/dowgrade placeholders and
	  change scope.
	(expr_name_check_for_loop) : rename from name_refer_circular and make
	  public.
	(expr_name_downgrade_to_placeholder) : new.
	(expr_name_set_scope) : no need to diddle ::active now that
	  collection_insert is less anal.
	(expr_name_cmp_by_name) : renamed from expr_name_by_name.

	* src/commands.c (cmd_define_name*) : add more checking at the start.
	  Don't bother keeping a ref to the nexpr.
	  handle undo for defining an existing placeholder.

2003-06-03  Morten Welinder  <terra@gnome.org>

	* src/stf-parse.c (stf_parse_lines): New function.
	(stf_parse_next_token): Move UTF-8 from here to callers to avoid
	insane slowdown.

2003-06-02  Jody Goldberg <jody@gnome.org>

	* src/expr-name.c (expr_name_set_scope) : if the new scope does not
	  have any names initialize it.  Don't remove the name from the old
	  scope if it already exists in the newscope.  Return an error message
	  in the case of problems.

2003-06-02  Morten Welinder  <terra@gnome.org>

	* src/stf-parse.c (stf_parse_general_free): New function.
	(stf_parse_general): Switch from list <list<string>> to
	ptrarray<ptrarray<string>>, gaining random access.  All callers
	changed.

	* src/style.c (style_font_new_simple): Take a pango context
	argument also instead of producing a bogus one.
	(style_font_new): Ditto.  Improve fall-back scheme.
	(font_init): For now, create the default font on the default
	screen.  The need for the default is almost gone.

	* src/mstyle.c (mstyle_get_font, mstyle_get_pango_attrs): Take a
	pango context also to produce fonts.
	* src/rendered-value.c (calc_indent, rendered_value_render): Ditto.
	* src/sheet-control-gui.c (scg_get_style_font): Ditto.

	* src/print.c (sheet_print): Display preview on the right display.

	* src/gui-util.c (gnm_link_button_and_entry): New function.

	* src/commands.c (cmd_analysis_tool): Clarify memory ownership
	rules and adhere to them.  Plug leak.

	* src/item-edit.c (ie_layout): Handle ->layout properly so it
	doesn't get leaked.

2003-06-01  Jody Goldberg <jody@gnome.org>

	* src/sheet-object.c (sheet_objects_relocate) : check for
	  move_with_cells.
	(sheet_object_init) : init move_with_cells.

	* src/sheet-filter.c (filter_field_init) : new.

	* src/workbook-control-gui.c (cb_auto_filter) : update the menu when
	  adding or removing a filter.

2003-05-31  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=114084
	* src/parser.y (find_matching_close) : Generated spurious paren errors
	  because gnm_strunescape points to the first char after the string
	  then we incremented.
	(yylex) : As long as we're down here tack on a bit of user
	  friendliness in the face of spaces.  If we know they can't be
	  operators based on the token we're returning ignore them to help the
	  users out.

	http://bugzilla.gnome.org/show_bug.cgi?id=114147.
	* src/sheet.c (sheet_clone_colrow_info) : copy max outline level too.

	http://bugzilla.gnome.org/show_bug.cgi?id=114151.
	* src/commands.c (cmd_selection_outline_change) : minor thinko when
	  implementing inverted placement.

	* src/sheet-control-gui.c (scg_setup_group_buttons) : honour the
	  sheet::display_outline flag.  We could probably move these to the
	  SheetView.

	* src/parser.y (parser_sheet_by_name) : don't leak the arguments when
	  attempting to parse an expression with an unknown function name.

	http://bugzilla.gnome.org/show_bug.cgi?id=114144.
	* src/workbook-control-gui.c (wbcg_validation_msg) : add accelerators
	  for the buttons.

	http://bugzilla.gnome.org/show_bug.cgi?id=114097.
	* src/sheet-object-widget.c : while we're in here clean up a bit.
	(cb_checkbox_label_changed) : doh!

	http://bugzilla.gnome.org/show_bug.cgi?id=114079.
	* src/colrow.c (colrow_get_states) : a difference in the default state
	  will also split a run. (fixes crash #2)
	* src/sheet-merge.c (sheet_merge_remove) : don't free range until
	  after we're through using r.  Just in case they are the same.

	* src/workbook-control-gui.c (cb_view_freeze_panes) : base the
	  decision to use default position on the last visible, not last full.

	* src/gnumeric-pane.c (cb_sheet_object_canvas_event) : don't freak out
	  if we can't edit the selected object.

	* src/xml-io.c (xml_read_style) : target needs a function, it is not a
	  GObject::param.

	* src/dialogs/dialog-hyperlink.c (dialog_hyperlink) : we need to
	  register the types earlier.  Move the calls from here.
	* src/libgnumeric.c (gnm_common_init) : to here.

	* src/gui-util.c (gnumeric_error_info_dialog_new) : make the close
	  button the default.

	* src/validation.c (validation_eval) : fix typo that passed the type
	  as the style. Unique to 1.1.x

2003-05-31  Jody Goldberg <jody@gnome.org>

	* src/workbook-edit.c (wbcg_edit_finish) : add an optional flag to
	  indicate if a dialog was displayed.  This is necessary for only 1
	  caller.
	* src/validation.c (validation_eval) : add the dialog needed flag here
	  too.
	* src/item-grid.c (item_grid_button_press) : don't start dragging or
	  showing a menu.  If there was a validation dialog we already ignored
	  the corresponding button release.

	* src/tools/fill-series.c (do_row_filling) : only clip the fill with
	  the selection if the stoping value is not set.  Add a bounds test.
	(do_column_filling) : ditto.

	* src/GNOME_Gnumeric.xml : disable unimplemented import external.
	  Give Fill -> Series & Merge mnemonics
	  s/Graph/Chart/
	* src/workbook-control-gui.c : ditto.

2003-05-30  Morten Welinder  <terra@gnome.org>

	* src/workbook-control.c (wb_control_parse_and_jump): Fix 114045.

	* src/style.c: Eliminate gnumeric_default_bold_font and
	gnumeric_default_italic_font.
	(style_font_new): Apply a simpler fall-back scheme that will work
	for bold & italic also.
	(style_shutdown): Greatly simplify now that
	gnumeric_default_bold_font and gnumeric_default_italic_font are
	gone.

	* src/mstyle.c (mstyle_link_sheet): Avoid referring to
	possibly-freed pointer.

2003-05-30  Morten Welinder  <terra@gnome.org>

	* src/mstyle.c (mstyle_init, mstyle_shutdown): New functions.
	(mstyle_new, mstyle_copy, mstyle_copy_merge, mstyle_unref): Use
	mstyle pool.

	* src/libgnumeric.c (gnm_common_init): Init mstyles.
	(gnm_shutdown): Shut them down.

2003-05-28  Jody Goldberg <jody@gnome.org>

	* configure.in : Add he to ALL_LINGUAS

2003-05-27  Jon K Hellan  <hellan@acm.org>

	* src/main-component.c: Include gnumeric-paths.h.

2003-05-27  Morten Welinder  <terra@gnome.org>

	* src/style-border.c (style_border_none_set_color): Fix ref count
	leak.

	* src/style.c (style_font_new_simple): Fix warning text.

	* src/gnumeric-pane.h (struct _GnumericPane): cursor_type is of
	type GnmCursorType, not int.

	* src/item-grid.c (cb_cursor_motion): Ditto for cursor.
	* src/sheet-control-gui.c (scg_set_display_cursor): Ditto.

2003-05-24  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_sheet_label_drag_begin) : remove
	  deprecation.

2003-05-23  Jody Goldberg <jody@gnome.org>

	* src/selection.c (sv_selection_to_plot) : skip the dimension if its
	  can't be filled, don't just keep looking for data to put in it.

2003-05-23  Morten Welinder  <terra@gnome.org>

	* src/style-border.c (style_border_get_gc): Fix ref count error.

	* src/gnumeric-pane.c (set_acetate_coords): Create bitmap on the
	right display.

	* src/pattern.c (gnumeric_pattern_get_stipple): Take drawable
	argument for identifying screen that bitmaps need to be valid on.

	* src/workbook-format-toolbar.c (workbook_create_format_toolbar):
	Switch font and size selectors to gnm_combo_text.

	* src/gui-util.c (gnm_cursor_set_widget): New function, cloned
	from GAL's e_cursor_set_widget which isn't multihead safe.  Some
	GAL stuff imported.  All callers changed.

	* src/pattern.c (gnumeric_background_set_gc): Batching is back per
	Jody's request.  The multihead issues remain fixed, though.

2003-05-22  Morten Welinder  <terra@gnome.org>

	* src/style-color.c (style_color_new_uninterned): Set bogus .pixel
	values.

	* src/pattern.c (gnumeric_background_set_gc): Don't batch, gdk
	already does that.  Don't assume .pixel for colours.

	* src/gui-clipboard.c (x_claim_clipboard): Get the clipboard from
	the right display.
	(x_request_clipboard): Ditto.

	* src/clipboard.c (cellregion_to_string): Take a pango context
	parameter.  Use that instead of faking it.

	* src/gui-clipboard.c (x_clipboard_get_cb): Make this take a wbcg
	which is what it already gets.  Use that to get a pango context to
	send to cellregion_to_string.

	* src/item-bar.c (item_bar_realize): Set cursor for the right
	display.

	* src/workbook-control-gui.c (workbook_control_gui_new): Extra
	argument here is a GdkScreen pointer.  Supply that to
	workbook_control_gui_init.  All callers changed.

	* src/workbook-control-priv.h (WorkbookControlClass): Add extra
	parameter to control_new method.

	* src/workbook-control.c (wb_control_wrapper_new): Add "extra"
	argument here also and supply it to control_new.  All callers
	changed.

	* src/workbook-control-gui.c (workbook_control_gui_init): Make
	static.  Take extra GdkScreen parameter and set the new screen
	asap before we go creating pango contexts and gcs relating to the
	default screen.  All callers changed.

2003-05-22  Jody Goldberg <jody@gnome.org>

	* src/dependent.c (dependents_relocate) : cells optionally don't
	  relink, but objects must for now.

	* src/expr.c (cellrange_relocate) : fix logic inversion introduced
	  when I removed the unnecessary heuristic on 2003-05-16.

2003-05-22  Morten Welinder  <terra@gnome.org>

	* src/workbook-control-gui.c (workbook_menu_view): Combine the two
	New-View entries into one.
	(workbook_control_gui_init): Fix reference to freeze-panes menu
	entry.
	(cb_view_new): New function just calling the dialog.

2003-05-21  Jody Goldberg <jody@gnome.org>

	* src/item-edit.c : General de-cruftification.
	  - Move from GtkObject -> GObject
	  - Use set_property rather than set_args
	  - Remove pointless inclusion of sheet-control-gui-priv.h
	  (ie_layout) : rename from recalc_spans, move the
	  PangoLayout generation from _draw in here because it was more
	  advanced and cache the layout.

	* Makefile.am : don't clean the .server file it is generated by
	autoconf and a real pain to regenerate

2003-05-21  Morten Welinder  <terra@gnome.org>

	* src/gui-util.c (cb_free_keyed_dialog_context): Set the
	KeyedDialog property on the right object.

	* src/style-border.h (struct _StyleBorder): Add gc_screen field to
	track the screen that gc belongs to.

	* src/style-border.c (style_border_get_gc): Manage gc_screen.
	(style_border_unref): Ditto.

	* src/workbook-control-gui.c (workbook_create_standard_toolbar):
	Get pango context from toplevel widget.

	* src/preview-grid.c (preview_grid_draw): Get pango context from
	widget and pass it to pg_construct_cell.
	(pg_construct_cell): Remove bogus context construction from here.

2003-05-20  Morten Welinder  <terra@gnome.org>

	* src/style-border.c (style_border_set_gc_dash): Set the
	background colour as previosly, not the foreground.  Ugh.

	* src/sheet-control-gui.c (sheet_control_gui_new): Use
	g_object_set_data, not gtk_object_set_data.

	* src/style-border.c (style_border_set_gc_dash): Use
	gdk_gc_set_rgb_fg_color, not gdk_gc_set_foreground.  USe
	gdk_gc_set_rgb_bg_color, not gdk_gc_set_background.
	(style_border_none_set_color): Ditto.
	(style_border_get_gc): Ditto.

	* src/item-grid.c (item_grid_realize): Ditto.
	* src/item-cursor.c (item_cursor_draw): Ditto.
	* src/pattern.c (gnumeric_background_set_pc): Ditto.  (#if 0'ed.)
	(gnumeric_background_set_gc): Ditto, more or less.

	* src/preview-grid.c (preview_grid_realize): Plug "white" out of
	the style.  Use gdk_gc_set_rgb_fg_color, not
	gdk_gc_set_foreground.

	* src/gnumeric-canvas.c (gnm_canvas_realize): Plug "white" out of
	the style.

	* src/style-color.c (gnumeric_color_init): Make gs_yellow,
	gs_white, gs_black, gs_dark_gray, gs_light_gray, and gs_lavender
	unallocated colours.  Eliminate unused gs_red.

	* src/item-bar.c (item_bar_realize): Use gdk_gc_set_rgb_fg_color,
	not gdk_gc_set_foreground for multi-head support.

	* src/style-color.h (struct _StyleColor): Remove redundant red,
	green, and blue members.  All users changed to use color member.

	* src/style-color.c (color_hash): Improve hash function (as if it
	mattered).

2003-05-20  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-graph.c (sheet_object_graph_remove_from_sheet) : new.
	(sheet_object_graph_class_init) : hook it up.

	* src/graph.c (gnm_go_data_vector_finalize) : free the values too.
	(gnm_go_data_scalar_set_sheet) : handle unlinking too.
	(gnm_go_data_vector_load_len) : only free the buffer if the length
	  changed.
	(gnm_go_data_vector_set_sheet) : ditto.
	(cb_assign_val) : be smarter and collect min/max and do decent end
	  checking.
	(nm_go_data_vector_load_values) : use the additional information.

2003-05-19  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (wbcg_sheet_focus) : set the scg earlier
	  as soon as the sheet gets focus.

	* configure.in : remove -Wsign-promo according to gcc-3.3 it is only
	  valid for C++ now.

2003-05-19  Morten Welinder  <terra@gnome.org>

	* src/history.c (file_history_cmd): Use GObject methods.
	(history_menu_item_create): Ditto.
	* src/gui-util.c (popup_item_activate): Ditto.

	* src/workbook-control-gui.c (workbook_create_standard_toolbar):
	Use gtk_widget_set_size_request, not gtk_widget_set_usize.
	(workbook_setup_auto_calc): Ditto.
	(show_gui): Ditto.
	(workbook_setup_edit_area): Ditto.  Also don't use an arbitrary
	pixel count.

	* src/workbook-format-toolbar.c (workbook_create_format_toolbar):
	Use gtk_widget_set_size_request, not gtk_widget_set_usize.

	* src/gui-util.c (gnumeric_error_info_dialog_new): Use
	gtk_widget_set_size_request, not gtk_widget_set_usize.  Also base
	size of window on screen size, not arbitrary pixel counts.

	* src/sheet-control-gui.c (scg_setup_group_buttons, scg_resize,
	scg_resize): Use gtk_widget_set_size_request, not
	gtk_widget_set_usize.

	* src/workbook-format-toolbar.c: Avoid GNOME deprecated pixmaps.

	* src/libgnumeric.c (gnm_common_init): Use glade_init, not
	glade_gnome_init.

	* src/gui-util.c (gnumeric_position_tooltip): Use gtk_window_move,
	not deprecated gtk_widget_set_uposition.
	(gnumeric_clist_moveto): Use "void *" as arg instead of deprecated
	"GtkCList *" so the many includers of gui-util.h do not get
	punished.

2003-05-18  Morten Welinder  <terra@gnome.org>

	* src/*.c: Eliminate obvious deprecated stuff.

2003-05-16  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=106148.
	* src/expr.c (cellrange_relocate) : remove previous hack.  We're not
	  changing the expression so don't pretend to.  The right solution is.
	* src/dependent.c (dependents_relocate) : here.
	  Even if the expression does not change queue it for recalc.  We know
	  it depends on the region, so it needs to recalc.

	* src/sheet.c (sheet_move_range) : queue dependencies of target region
	  for recalc their expressions may not change but the content will.

2003-05-16  Morten Welinder  <terra@gnome.org>

	* src/workbook-control-gui.c (workbook_setup_auto_calc,
	workbook_create_standard_toolbar): Use gnm_measure_string instead
	of incorrect and deprecated GdkFont stuff.

	* src/workbook-format-toolbar.c (workbook_create_format_toolbar):
	Ditto.

	* src/gui-util.c (gnm_measure_string): New function.

2003-05-15  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/stf-parse.c (stf_parse_csv_cell): remove debug spew

2003-05-14  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/GNOME_Gnumeric.xml: Fix spelling
	* src/workbook-control-gui.c: ditto

2003-05-14  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_notebook_switch_page) : set the edit
	  line's scg if we are not in the middle of a rangesel.

	* src/xml-io.c (xml_read_names) : revert my previous error.
	  We can't use parse_pos_init_sheet here because it will fail in the
	  context of workbook level names.

	* src/position.c (parse_pos_init_sheet) : check for that.

2003-05-14  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui-file.c (gui_file_open): change in charmap_selector_new
	  arguments

2003-05-14  Morten Welinder  <terra@gnome.org>

	* src/gutils.c (ldexpgnum): Use gnm_pinf and gnm_ninf.
	* src/regression.c (general_linear_regression): Ditto.

	* src/mathfunc.c (mathfunc_init): Generate gnm_pinf and gnm_ninf
	also.  Try much harder at making a NaN.

	* src/stf-export.c (stf_export_can_transliterate): Don't use
	fallback.  I think we want it to fail if it cannot transliterate
	the test string.

	* src/stf-export.h (StfExportOptions_t): Make quoting_char and
	cell_separator gunichars.

	* src/stf-export.c (stf_export_options_set_quoting_char,
	stf_export_options_set_cell_separator): Ditto.
	(stf_export_cell): Handle gunichar quoting.

2003-05-13  Jody Goldberg <jody@gnome.org>

	* schemas/gnumeric-general.schemas.in : Sans 10 is the default font

2003-05-13  Morten Welinder  <terra@gnome.org>

	* src/stf.c (stf_read_workbook): Set an error message so cancels
	won't cause blank books.

	* src/mathfunc.c (random_binomial): Use qbinom for sane time
	consumption.
	(random_negbinom): Use qnbinom for sane time consumption.

2003-05-13  Jody Goldberg <jody@gnome.org>

	* src/gui-file.c (gui_file_open) : add mnemonics for the type and
	  encoding selector.
	(file_format_changed_cb) : desensitize the label as well as the menu.

2003-05-13  Jody Goldberg <jody@gnome.org>

	* src/pattern.c (gnumeric_pattern_get_stipple) : fence post.

2003-05-13  Morten Welinder  <terra@gnome.org>

	* src/stf-parse.c (trim_spaces_inplace): Make UTF-8 safe.

2003-05-12  Morten Welinder  <terra@gnome.org>

	* src/stf.c (stf_open_and_read): Fix crash on errors and empty
	files.  Fix return value for empty files.

	* src/xml-io.c (gnumeric_xml_write_workbook): Fix broken object
	handling.

2003-05-12  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/stf-parse.c (compare_terminator) : return the byte
	  length of the used terminator
	(stf_parse_paresoptions_new): initialize the string indicator
	  to our default
	(stf_parse_next_token): pass all parse options, check also for
	  separators and terminators
	(stf_parse_options_csv_set_stringindicator): the string
	  indicator could be a non-ascii character
	(stf_parse_csv_cell): use the type information returned by
	  stf_parse_next_token
	(stf_parse_eat_separators): Don't eat null bytes.
	(stf_parse_get_rowcount): use stf_parse_next_token to avoid
	  counting in-string newlines
	* src/stf-parse.h (stf_parse_next_token): pass all parse
	  options
	(stf_parse_options_csv_set_stringindicator): the string
	  indicator could be a non-ascii character
	* src/stf.c (stf_read_workbook_auto_csvtab): stf_parse_next_token
	  now needs a parseoption

2003-05-12  Jody Goldberg <jody@gnome.org>

	* omf-install/Makefile.am : add missing ;

2003-05-12  Jody Goldberg <jody@gnome.org>

	* configure.in : post release version bump

2003-05-11  Jody Goldberg <jody@gnome.org>

	* Release 1.1.17

2003-05-09  Jody Goldberg <jody@gnome.org>

	* src/item-edit.c (item_edit_set_arg) : Use connect_object and
	  simplify the detroy function
	(item_edit_destroy) : by not having to recall the handler ids.

2003-05-09  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_data_pivottable) : disable until it
	  does something.
	* src/GNOME_Gnumeric.xml : ditto.

2003-05-10  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/stf-parse.c (comp_term): handle multibyte terminals
	(compare_terminator): check all terminators
	(stf_parse_options_new): initialize terminator list
	(stf_parse_options_free): free terminator list
	(long_string_first): new
	(stf_parse_options_set_line_terminator_char): deleted
	(stf_parse_options_set_line_terminator): deleted
	(stf_parse_options_clear_line_terminator): new
	(stf_parse_options_add_line_terminator): new
	(stf_parse_options_remove_line_terminator): new
	* src/stf-parse.h: Change type of StfParseOptions_t->
	  terminator
	(stf_parse_options_set_line_terminator_char): deleted
	(stf_parse_options_set_line_terminator): deleted
	(stf_parse_options_clear_line_terminator): new
	(stf_parse_options_add_line_terminator): new
	(stf_parse_options_remove_line_terminator): new


2003-05-10  Andreas J. Guelzow <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=99649
	* src/GNOME_Gnumeric.xml: insert separator between Open and
	  Save of the File menu.
	* src/workbook-control-gui.c (workbook_menu_file): ditto


2003-05-10  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* stf-export.c (stf_export_cell): transliterate if
	  requested
	(stf_export_options_set_transliterate_mode): new
	(stf_export_can_transliterate): new

	* stf-export.h: Add StfTransliterateMode_t
	(stf_export_options_set_transliterate_mode): new
	(stf_export_can_transliterate): new

2003-05-09  Morten Welinder  <terra@gnome.org>

	* src/format.h: Use gnumeric_regex_t, not regex_t.

	* configure.in: Check for memmove.  Add
	src/cut-n-paste-code/pcre/Makefile.

	* src/Makefile.am (gnumeric_app_libs): Add
	cut-n-paste-code/pcre/libpcre.a.

	* src/formats.c (currency_date_format_init): Switch to pcre
	(==perl) syntax in regular expressions.
	(cell_format_is_number): Use UTF-8 regexp
	routines.

	* src/number-match.c (char_to_re): Take a gunichar, just in case.
	(format_create_regexp): Take an unsigned char *.  Make UTF-8 safe.

	* src/regutf8.c: Switch to using pcre.

2003-05-08  Morten Welinder  <terra@gnome.org>

	* src/cell-draw.c (cell_draw): Fix HALIGN_CENTER case when a cell
	overflows.

2003-05-08  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/stf.c (stf_read_workbook_auto_csvtab): use a locale dependent
	separator (same as argument separator)

2003-05-07  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/stf.c (stf_read_workbook): add encoding argument
	(stf_init): set configurable text import to accept encoding

2003-05-07   Andreas J. Guelzow <aguelzow@taliesin.ca>

	For Emmanuel Pacaud <emmanuel.pacaud@univ-poitiers.fr>
	http://bugzilla.gnome.org/show_bug.cgi?id=111075
	* src/stf-export.c
	(stf_export_options_set_charset): new
	(stf_export_cell): add conversion to selected charset

	* src/stf-export.h
	(StfExportOptions_t): add charset

2003-05-07  Andreas Guelzow <aguelzow@taliesin.ca>

	* src/regutf8.c (ISASCII): last ASCII is 0x7f

2003-05-07  Andreas Guelzow <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=100529
	* src/GNOME_Gnumeric.xml: Change `Open a....' to `Open a file'
	  and `Create a new spreadsheet' to `Create a new workbook'
	* src/workbook-control-gui.c: Change `Opena....' to `Opena file'

2003-05-06  Jody Goldberg <jody@gnome.org>

	* src/item-cursor.c (item_cursor_realize) : Use g_timeout_add
	  directly.
	(item_cursor_unrealize) : shutdown the animation here, not at
	  destruction.

2003-05-03  Jody Goldberg <jody@gnome.org>

	For Martin Hoffmann <nvnc-relay@gmx.net>
	* src/workbook-edit.c (auto_complete_matches) : fix autocompletion in
	  the face of multi byte characters.

2003-05-03  Jody Goldberg <jody@gnome.org>

	* src/gui-util.c (color_combo_get_style_color) : fix leak.

2003-05-02  Jody Goldberg <jody@gnome.org>

	* configure.in  : Tack on libart for the graphing.

2003-05-01  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-pane.c (cb_control_point_event) : make things a bit
	  prettier.

2003-05-06  Andreas Guelzow <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=80806
	* src/stf-parse.h (StfTokenType_t): new enumeration
	(stf_parse_options_set_line_terminator): change argument type
	(stf_parse_options_set_line_terminator_char): new
	(stf_parse_next_token): new

	* src/stf-parse.c
	(stf_parse_options_set_line_terminator): change argument type
	(stf_parse_options_set_line_terminator_char): new
	(stf_parse_next_token): new
	(comp_term): new inline
	(compare_terminator): new inline and use throughout the file
	(stf_parse_csv_is_separator): rewrite
	(stf_parse_csv_cell): rewrite
	(stf_parse_eat_separators): new
	(stf_parse_csv_line): make UTF-8 clean

	* src/stf.c (stf_read_workbook): fix released memory access (thanks Morten)
	(stf_read_workbook_auto_csvtab): make UTF-8 clean and adjust guess to make
	  it more likely to guess tsv rather than csv

2003-05-06  Morten Welinder  <terra@gnome.org>

	* src/mathfunc.c (qbeta): Improve guess in log_p and lower_tail
	cases.
	(random_gaussian_pdf): Delete and use dnorm instead.
	(random_normal): Use the unit-circle method to generate two
	normally distributed numbers at a time.
	(random_lognormal): Use our own method based on random_normal.

2003-05-06  Guntupalli Karunakar  <karunakar@freedomink.org>

	* configure.in: Added "hi" in ALL_LINGUAS.

2003-05-05  Andreas Guelzow <aguelzow@taliesin.ca>

	* stf.c (stf_read_workbook_auto_csvtab): make guesswork UTF-8
	  clean and make it more likely to guess tsv

2003-05-05  Morten Welinder  <terra@gnome.org>

	* src/mathfunc.c (pfuncinverter): New function, extracted from
	qgamma.
	(qgamma): Use pfuncinverter.
	(qbeta): Replace R's version by pfuncinverter-based one.
	(dbeta): New from R.

2003-05-05  Andreas Guelzow <aguelzow@taliesin.ca>

	* src/Makefile.am: removed src/charset.[ch]
	* src/charset.[ch]: removed (replaced by
	  src/widgets/widget-charmap-selector.[ch])
	* src/gui-file.c: replaced data block CharmapChooser by
	  widget CharmapSelector including the corresponding
	  function calls

2003-05-05  Andreas Guelzow <aguelzow@taliesin.ca>

	* src/charset.c (make_charmap_chooser): move declarations
	  where they belong

2003-05-05  Andreas Guelzow <aguelzow@taliesin.ca>

	* src/charset.c (set_encodings_menu): handle unknown
	  locale encoding

2003-05-05  Andreas Guelzow <aguelzow@taliesin.ca>

	* src/bonobo-io.c (gnm_persist_stream_load): add argument
	  to call of wb_view_new_from_input

	* src/charset.c: new file
	* src/charset.h: new file
	* src/file-priv.h: (_GnmFileOpenerClass): add argument to
	  declaration of open method
	(_GnmFileOpener): add encoding_dependent field
	(gnm_file_opener_setup): add argument

	* src/file.c (gnm_file_opener_open_real): new argument to pass
	  to open call
	(gnm_file_opener_setup): new argument to be used for
	  initialization of added field
	(gnm_file_opener_new): add argument to call of
	  gnm_file_opener_setup
	(gnm_file_opener_new_with_enc): new function
	(gnm_file_opener_is_encoding_dependent): new function
	(gnm_file_opener_open): new argument

	* src/file.h (GnmFileOpenerOpenFuncWithEnc): new type
	(gnm_file_opener_new_with_enc): new function
	(gnm_file_opener_open): new argument
	(gnm_file_opener_is_encoding_dependent): new function

	* src/gui-clipboard.c (table_cellregion_read): add argument
	  to call of wb_view_new_from_input

	* src/gui-file.c (file_format_changed_cb_data): new type
	(make_format_chooser): only make option menu
	(gui_file_read): new argument to be passed to call of
	  wb_view_new_from_file
	(file_format_changed_cb): new callback
	(gui_file_open): add encoding selector to load file dialog

	* src/gui-file.h (gui_file_read): new argument
	* src/history.c (file_history_cmd): add argument to call of
	  gui_file_read

	* src/main-application.c (main): add argument to call of
	  wb_view_new_from_file

	* src/plugin-service.c (gnm_plugin_file_opener_open): new
	  argument
	(gnm_plugin_file_opener_new): add argument to call of
	  gnm_file_opener_setup

	* src/stf.c (stf_open_and_read): new argument
	(stf_preparse): handle encoding conversion
	(stf_read_workbook_auto_csvtab): new argument to be passed to
	  the call of stf_parse
	(stf_init): setup encoding

	* src/workbook-view.c (wb_view_new_from_input): new argument to be
	  passed to the call of gnm_file_opener_open
	(wb_view_new_from_file): new argument to be passed to the call of
	  wb_view_new_from_input

	* src/workbook-view.h (wb_view_new_from_input): new argument
	(wb_view_new_from_file): new argument

2003-05-02  Morten Welinder  <terra@gnome.org>

	* src/gnumeric-canvas.h (GNUMERIC_CANVAS_FACTOR_Y): Up size to
	6000000 which seems to be enough for acuster.  It's a kludge,
	though.

2003-05-01  Morten Welinder  <terra@gnome.org>

	* src/mathfunc.c (fmin2, fmax2, imin2, imax2): Make these inline
	functions instead of macros.  (The R versions are functions.)
	(gammafn): Delete.

	* src/mstyle.c (mstyle_get_pango_attrs): Add zoom parameter.
	* src/rendered-value.c (rendered_value_new): Supply zoom.

2003-05-01  Jody Goldberg <jody@gnome.org>

	* src/sheet-object.c (sheet_object_default_size) : simplify.
	(sheet_object_update_bounds) : call position_changed to let the model
	  know the size/position have changed not just the views.


	* src/sheet-object-graph.c (sheet_object_graph_position_changed) :

2003-05-01  Morten Welinder  <terra@gnome.org>

	* src/gutils.c (g_unichar_strstr_utf8, g_unichar_strchr,
	g_unichar_strncmp, g_unichar_strlen): Delete.

	* src/sheet.c (cb_sheet_get_extent): Per Jody, let's respan here
	when needed.

2003-04-29  Morten Welinder  <terra@gnome.org>

	* src/mathfunc.c (mathfunc_init): New function.

	* src/libgnumeric.c (gnm_common_init): Call mathfunc_init.

2003-04-28  Jody Goldberg <jody@gnome.org>

	* configure.in : I'm a lazy bugger and will just commit the
	  directories for the goffice work.

	* src/sheet-object-graph.c (sheet_object_graph_default_size) : Use the
	  graph's notion of its default size.
	(sheet_object_graph_class_init) : init here.

2003-04-28  Morten Welinder  <terra@gnome.org>

	* src/commands.c (cmd_area_set_text_undo): Restore formats too.
	(cmd_set_text_redo): Handle auto-format.
	(cmd_set_text_undo): Undo via pasting.

	* src/auto-format.c (auto_style_format_suggest): Ref the result.

	* src/format.c (style_format_default_money): Make the default
	format be the one using ()s and red negatives.

2003-04-26  Jody Goldberg <jody@gnome.org>

	* src/position.c (parse_pos_init_sheet) : new convenience routine.
	  Use it all over the place.

	* src/gui-util.c (gnm_setup_label_atk) : update.

	* src/workbook-control-gui.c (cb_graph_dim_editor_update) : signature
	  change for the GnmExprEntry::update signal.

2003-04-25  Jody Goldberg <jody@gnome.org>

	* configure.in : bump gsf version req to force the use of CVS.

	* src/ranges.c (range_trim) : do a pre-emptive clip to the existing
	  region to ameliorate the cost.

2003-04-25  Morten Welinder  <terra@gnome.org>

	* src/Makefile (gnm-marshalers.c): Add an #include to the
	generated file.

2003-04-23  Jody Goldberg <jody@gnome.org>

	* src/workbook-edit.c (wbcg_edit_ctor) : set the wbcg early.

2003-04-22  Jody Goldberg <jody@gnome.org>

	* src/gnm-marshalers.list : add NONE:BOOLEAN

	* src/sheet-control-gui.c (scg_select_all) : pretend that we
	  drag selected the range to fire an update signal even if the
	  exprentry's update_policy is discontinuous.
	(scg_rangesel_extend) : keyboard changes cause an update too.
	(scg_rangesel_move) : ditto.
	* src/item-bar.c (item_bar_event) : ditto.

2003-04-22  Morten Welinder  <terra@gnome.org>

	* src/gui-clipboard.c (x_request_clipboard): Follow cut-and-paste
	preference.

	* src/gnumeric-gconf.c (gnm_conf_init): Set initial cut-and-paste
	preference.
	(gnm_gconf_set_prefer_clipboard_selection): New function.

	* src/formats.c (currency_date_format_init): Improve error
	messages.

2003-04-22  Jody Goldberg <jody@gnome.org>

	* doc/xmldocs.make : install docs where libgnome expects them
	  now something actually happens, although it is dog slow.

2003-04-21  Jody Goldberg <jody@gnome.org>

	* src/mstyle.c (mstyle_hash) : adjust to allow styles from different
	  sheets to hash the same despite auto colours that have different
	  instances.
	(mstyle_element_equal) : ditto.

	* src/sheet.c (sheet_destroy) : free the names last to make debugging
	  easier.

2003-04-19  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/commands.c: Implemented Undo/Redo for data shuffling.

	* src/commands.c: Implemented Undo/Redo for scenario->manager.

2003-04-18  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/sheet.c (sheet_move_range): Added a call to update scenarios.

	* src/commands.c: Implemented Undo/Redo for scenario->add.

2003-04-16  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/xml-io.c (xml_read_scenarios): Use global_range_parse
	instead of parse_range.

2003-04-15  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/xml-io.c (xml_read_scenarios): Wrote. Reads scenarios of a
	sheet.
	(xml_write_scenarios): Wrote. Stores scenarios of a sheet.
	(xml_node_set_value): Wrote.
	(xml_node_get_value): Wrote.
	(xml_sheet_write): Added a call to write scenarios.
	(xml_sheet_read): Added a call to read scenarios.

2003-04-12  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_graph_guru_done) : new.
	(cb_launch_graph_guru) : simplify the DataAllocator interface.
	  The whole edit_{begin/end} was needed for wbcg.  We can handle that
	  here directly without extending the interface.

2003-04-12  Jody Goldberg <jody@gnome.org>

	* icons/chart* : fix the background transparency.
	* *.c : Use g_type_class_peek_parent and tidy up upchaining a bit
	  to be more consistent across all classes.

	* schemas/Makefile.am :  no need to install or translate the
	  plot-types file those are migrating to the plot plugins.

2003-04-11  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/sheet.c (sheet_delete_rows, sheet_delete_cols,
	sheet_insert_rows, sheet_insert_cols): Update scenarios.

2003-04-11  Morten Welinder  <terra@gnome.org>

	* src/print.c (print_job_info_get): Use
	gnome_font_face_find_closest for a 0.1% drop in suckage.

2003-04-11  Morten Welinder  <terra@gnome.org>

	* src/print-info.c (print_info_save): Store the printer
	configuration too.

	* src/gnumeric-gconf.c (gnm_gconf_set_printer_config): New
	function replacing all other gnm_gconf_set_printer_* functions.
	(gnm_conf_init): Get new printer-config key, not the old printer
	config keys.

	* src/print.c (print_job_info_set_one_time_defaults): Just use
	gnome_print_config_from_string.
	(print_job_info_save_one_time_defaults): Just use
	gnome_print_config_to_string.

2003-04-10  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/workbook-control-gui.c: Added scenario tool.

	* src/sheet.c (sheet_destroy): Added scenarios free call.
	(sheet_dup): Added scenarios copy call.

2003-04-09  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/sheet.c (sheet_new): Initialize scenarios field.

	* src/sheet.h: Added scenarios field.

2003-04-06  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (wbcg_go_plot_data_allocator_init) :
	  conditionalize the graphing extensions.

2003-04-04  Jody Goldberg <jody@gnome.org>

	* schemas/Makefile.am : remove plot-types.xml that will be handled in
	  the plotting plugins now.  Remove file and move images later.

2003-04-02  Jody Goldberg <jody@gnome.org>

	* src/plugin-loader-module.c : remove gobject loader capabilities and
	  just sponge off of gobject directly.

2003-04-03  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/workbook-control-gui.c, src/GNOME_Gnumeric.xml: Added a new
	filling tool just like in XL.

2003-04-02  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/workbook-control-gui.c: Added a new tool for data shuffling.

2003-03-30  Morten Welinder  <terra@diku.dk>

	* src/func.c (function_remove): Prevent crash if the function is
	no longer there.

2003-03-27  Jody Goldberg <jody@gnome.org>

	* src/xml-io.h : add missing decls for
	  xml_node_get_bool, xml_node_set_bool.

	* src/style.c (style_font_new_simple) : doh!  Thanks Morten.

2003-03-26  Morten Welinder  <terra@diku.dk>

	* src/style.c (style_font_string_width): Dont'ask for height just
	to throw it away.

2003-03-26  Jody Goldberg <jody@gnome.org>

	* src/pattern.c (gnumeric_background_set_gc) : trivial optimization to
	  avoid multiple calls to gdk_gc_set_values.
	(gnumeric_pattern_get_stipple) : no need to publicize this for now.
	  simply a bit.

	* src/commands.c (command_register_undo) : handle 0 sized command
	  queues by keeping a ref to the current command in case the
	  truncation unrefs it.

	* src/workbook-control-gui.c (workbook_control_gui_ctor_class) : be
	  more resilient in the face of incomplete installs.

2003-03-21  Morten Welinder  <terra@diku.dk>

	* src/rendered-value.c (cell_get_render_color): Work around the
	work-around for bug 105322.

2003-03-20  Morten Welinder  <terra@diku.dk>

	* src/xml-io.c (gnumeric_xml_write_workbook): Remove gratuitous
	const cast.

2003-03-18  Jody Goldberg <jody@gnome.org>

	* src/gui-util.c (gnumeric_inject_widget_into_bonoboui) : make it more
	  forgiving in the face of installation problems.

2003-03-17  Jody Goldberg <jody@gnome.org>

	* src/dependent.c (name_dep_debug_name) : new.
	(dynamic_dep_eval) : new.
	(dependent_types_init) : register name pseudo type a name is not
	  really a dependent, but it is useful for relocation to have a unique
	  type for it.

	* src/dependent.h : Add relocation flavour to handle the needs of
	  names and potentially eventually sorting.

	* src/clipboard.c (clipboard_paste_region) : set relocation flavour.
	* src/sheet-autofill.c (autofill_cell) : ditto.
	* src/sheet.c (cb_set_cell_content) : ditto.
	* src/workbook.c (workbook_sheet_detach) : ditto.

	* src/item-edit.c (recalc_spans) : support the use of partial columns
	  at the edges.
	* src/sheet-control-gui.c (gnm_canvas_make_cell_visible) : don't
	  scroll past the requested col/row if it is larger than the screen.

2003-03-15  Jody Goldberg <jody@gnome.org>

	* src/file.h : fix the naming of a few methods (Still needs cleanup)
	  and add gnm_file_saver_for_file_name.

2003-03-19  Guntupalli Karunakar  <karunakar@freedomink.org>

	* configure.in: Added "ml" in ALL_LINGUAS

2003-03-14  Jody Goldberg <jody@gnome.org>

	* src/gutils.h (GNM_SIZEOF_ARRAY) : delete and use G_N_ELEMENTS

2003-03-13  Jody Goldberg <jody@gnome.org>

	* src/stf.c (stf_text_to_columns) : patch warning.

	* src/plugin-service.c : Add ServiceSimple as a convenience base for
	  plugin services that are only data, no exectution.

	* src/plugin-loader.c (gnumeric_plugin_loader_load_service) : add
	  simple service as a convenience base class.
	(gnumeric_plugin_loader_unload_service) : ditto.

	* src/main-application.c : underscores in command line args are ugly.

2003-03-12  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=108225
	* src/format.c (append_hour_elapsed) : why did I round this ?
	  Ideally we need to know the display precision to round correctly.

	* src/gui-util.c (cb_keyed_dialog_keypress) : new.
	(gnumeric_keyed_dialog) : initialize it here so that all the keyed
	  dialogs get support for quiting when Escape is pressed.

2003-03-07  Morten Welinder  <terra@diku.dk>

	* src/value.c (value_peek_string): Use G_N_ELEMENTS.
	* src/regutf8.c (test): Ditto.
	* src/gnumeric-pane.c (gnm_pane_init): Ditto.

	* src/main-component.c (n_zoom_levels): Replace with use of
	G_N_ELEMENTS macro.

2003-03-06  Jody Goldberg <jody@gnome.org>

	* src/sheet-control-gui.c (scg_queue_movement) : new.
	(cb_scg_queued_movement) : ditto.
	(scg_init) : init the delayed movement handler.
	(scg_finalize) : clear the delayed movment handler.

	* src/gnumeric-canvas.c (gnm_canvas_key_mode_sheet) : use the motion
	  compression here for paging.

2003-03-05  Jody Goldberg <jody@gnome.org>

	* src/test-pango.c (main) : init initial_workbook_open_complete so
	  that things exit on last unref.

	* src/item-grid.c (item_grid_button_press) : more morton warnings.

2003-03-05  Morten Welinder  <terra@diku.dk>

	* src/format-template.c (format_template_save): Fix grave
	integer/gboolean confusion.

	* src/workbook-control-gui.c (workbook_close_if_user_permits): Fix
	grave integer/gboolean confusion.

	* src/xml-io.c (xml_node_set_color): Fix pointer/integer
	confusion.

	* src/consolidate.c (cb_col_tree): Fix return type.

	* src/style-border.c (style_border_fetch): Fix pointer/integer
	confusion.

	* src/workbook.c (workbook_date_conv): Fix pointer/gboolean
	confusion.

2003-02-28  Morten Welinder  <terra@diku.dk>

	* src/mathfunc.c (random_01): Get larger chunks of randomness.
	People who need randomness tend to need a lot.

2003-02-26  Morten Welinder  <terra@diku.dk>

	* src/rendered-value.h: No more rendered_text member.

	* src/rendered-value.c (rendered_value_destroy): Don't release
	rendered_text.
	(rendered_value_new): Don't set rendered_text.  Change to using
	format_value_gstring.  Recycle the GString.
	(rendered_value_get_text): Don't check rendered_text because we
	don't use it.
	(cb_rendered_value_pool_leak): Use the pango text.

	* src/print-cell.c (print_cell): Use the pango text.

	* src/print-info.c (render_value_with_format): Use
	format_value_gstring.

	* src/format.c (format_number): Change to take a GString *
	argument.  All callers changed.
	(fmt_general_float): Ditto.
	(fmt_general_int): Ditto.
	(format_value_gstring): New function copied from format_value.
	(format_value): Changed to a simple wrapper around
	format_value_gstring.

	* src/formats.c (cell_format_is_number): Don't redefine macro.

2003-02-24  Morten Welinder  <terra@diku.dk>

	* src/sheet-object-bonobo.c (sheet_object_bonobo_set_object_iid):
	Don't use '== TRUE'.

	* src/rendered-value.c (rendered_value_new): Don't specify the
	text length for the layout text.  strlen takes time and
	pango_layout_set_text is going to walk over the string anyway.

2003-02-24  Morten Welinder  <terra@diku.dk>

	* src/xml-io.c (xml_read_styles): Count blank nodes too for
	progress update purposes.
	(xml_sheet_read): Ditto.

2003-02-23  Morten Welinder  <terra@diku.dk>

	* src/format.c (render_number): Use g_string_append_len instead of
	g_string_append a few places where we know the length.  That saves
	a strlen call.

	* */*.c */*/*.c: s/g_string_new ("")/g_string_new (NULL)/.
	The latter saves a strlen call.

2003-02-21  Morten Welinder  <terra@diku.dk>

	* src/style.c (style_font_new_simple): Set language on pango
	context.
	* src/clipboard.c (cellregion_to_string): Ditto.
	* src/sheet.c (sheet_new): Ditto.

2003-02-18  Jody Goldberg <jody@gnome.org>

	* src/workbook-view.c (wb_view_new_from_input) : you can't probe
	  content if there is no probe function.

2003-02-17  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=106148.
	* src/expr.c (cellrange_relocate) : In situations where only part of a
	  range ref is moving we may not need to change the expression.
	  However, thiings will not be queued for recalc if the expression is
	  not changed, so pretend to change it.

2003-02-15  Jody Goldberg <jody@gnome.org>

	* src/plugin-loader-module.c
	(gnumeric_plugin_loader_module_load_service_plugin_loader) : simplify.

2003-02-11  Jody Goldberg <jody@gnome.org>

	* src/plugin-service.c (plugin_service_new) : use a hash table for the
	  service types.
	(plugin_services_init) : new to define the builtin services.
	(plugin_services_shutdown) : new.
	(plugin_service_define) : allow the definition of new service types.

2003-02-10  Morten Welinder  <terra@diku.dk>

	* src/xml-io.c (xml_read_cell_copy): Fix 104669.

2003-02-09  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* schemas/gnumeric-dialogs.schemas.in,
	schemas/gnumeric-general.schemas.in: Added <list_type>s to fix the
	warnings on schema installation.

2003-02-08  Jody Goldberg <jody@gnome.org>

	* configure.in : Remove tests for evolution.  We can use the simpler
	  command line interface with far fewer worries.
	* configure.in : remove mr_IN until there is content

2003-02-07  Morten Welinder  <terra@diku.dk>

	* src/rendered-value.h: Store a GdkColor here in order to work
	around http://bugzilla.gnome.org/show_bug.cgi?id=105322.

2003-02-03  Jody Goldberg <jody@gnome.org>

	* src/workbook-view.c (wb_view_new_from_input) : A name match needs to
	  be a content match too.
	(wb_view_new_from_file) : suppress warnings.

2003-02-02  Jody Goldberg <jody@gnome.org>

	* src/mstyle.c (mstyle_get_pango_attrs) : The mstyle uses the ref to
	  the new list so we need to add a ref for the result.

2003-02-01  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* README: Updated; added Debian package names.

2003-01-28  Jody Goldberg <jody@gnome.org>

	* src/commands.c (cmd_area_set_text_redo) : fix minor warning from
	  autoformatting.

2003-01-28  Morten Welinder  <terra@diku.dk>

	* src/mstyle.c (mstyle_get_pango_attrs): Cache attributes.
	(struct _MStyle): new member pango_attrs.
	(mstyle_pango_clear): New function.
	(mstyle_new): Set pango_attrs.
	(mstyle_copy): Duplicate pango_attrs.
	(mstyle_unref): Clear pango_attrs.
	(mstyle_set_color): Ditto.
	(mstyle_set_font_name): Ditto.
	(mstyle_set_font_bold): Ditto.
	(mstyle_set_font_italic): Ditto.
	(mstyle_set_font_uline): Ditto.
	(mstyle_set_font_strike): Ditto.
	(mstyle_set_font_size): Ditto.

2003-01-28  Morten Welinder  <terra@diku.dk>

	* src/workbook-control-gui.c (cb_rerender_zeroes): Rerender cells
	that are zero when toggling the hide-zeroes flag.

	* src/value.c (find_column_of_field): Don't refer to rendered
	text, because that is not what is meant.  Use value_get_as_string
	for now.

	* src/style.c (style_font_new_simple): Create a
	PangoFontDescription also (for the benefit of
	mstyle_get_pango_attrs.)
	(style_font_unref): Get rid of it.
	(style_font_text_width): Delete.

	* src/stf-export.c (stf_export_cell): Don't use rendered text, use
	the result of value_get_as_string.  Perhaps this should be a
	format call.

	* src/sheet.c (sheet_new): Create a PangoContext and store it in
	the sheet.
	(sheet_destroy): Unref it.

	* src/rendered-value.c (rendered_value_new): Take and use a
	PangoContext for creating layouts.  Place the string into the
	layout.  Handle zero-blanking here.  Process and store all mstyle
	info, either in layout or in RenderedValue itself.  Implement
	HALIGN_JUSTIFY modulo a Pango bug.  Implement HALIGN_FILL
	correctly for multi-line cells.

	* src/preview-grid.c (pg_construct_cell): Changed to match new
	conventions for rendering cells.

	* src/mstyle.c (mstyle_get_pango_attrs): Handle font also.

	* src/cell-draw.c (cell_draw): Rework to let Pango handle much of
	the alignment and line-breaking issues.  Clean out #includes.
	Move gdk_gc_set_fill calls into callers.  (Or rather into their
	setup routines.)

	* configure.in: post release bump.

2003-01-28  Jody Goldberg <jody@gnome.org>

	* Release 1.1.16

2003-01-27  Jody Goldberg <jody@gnome.org>

	* schemas/gnumeric-general.schemas.in : Override the default toolbar
	  layout to be icon only.  It can still be changed by clicking on the
	  toolbar, but at least the default is less ugly.

2003-01-26  Jody Goldberg <jody@gnome.org>

	* src/gui-file.h : remove unnecessary bonobo specific interface.
	  libgsf wraps all of that now.

2003-01-27  Morten Welinder  <terra@diku.dk>

	* src/print.c (print_page, print_job_info_get,
	print_job_info_destroy): Make robust with respect to missing
	fonts.

2003-01-25  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* configure.in: Consistently require libgsf 1.7.1. Thanks Christian
	Biesinger.

2003-01-24  Morten Welinder  <terra@diku.dk>

	* src/format.c (format_number): Allow more digits in fractions and
	use continued_fraction.

	* src/mathfunc.c (continued_fraction): New function.

2003-01-23  Jody Goldberg <jody@gnome.org>

	For Murray Cumming  <murrayc@usa.net>
	* configure.in: Now uses libgnomeprint*-2.2 instead of 2.0, for GNOME
 	2.2. It is an API-incompatible, parallel-installable separate library.
 	* src/print.c, src/dialogs/dialog-printer-setup.c:
 	Made code changes (search/replace) as per Chema's instructions.

2003-01-23  Jon K Hellan  <hellan@acm.org>

	* src/gui-clipboard.c (table_cellregion_read): Initalize wb and
	wb_view to NULL, check against NULL before unrefing.
	(complex_content_received): const char* reader_id.
	(x_clipboard_clear_cb): Remove incorrect comment.
	(x_request_clipboard): Update confusing variable name 'primary' to
	'clipboard'.

2003-01-23  Jody Goldberg <jody@gnome.org>

	For Wayne Schuller  <k_wayne@linuxpower.org>
	* src/print-info.c (print_info_new, print_info_save): Implement the 'fit-to' feature.
	  Scaling is now broken into x and y. They are equal when normal
	  scaling is being used (so we just use the x value)
	 * src/print.c (print_page_cells, setup_scale, print_page,
	   compute_group, compute_scale_fit_to,
	   print_range_down_then_right, print_range_right_then_down): Ditto.
	* src/xml-io.c (xml_write_print_info), (xml_read_print_info): We
	  don't save the x and y attributes, but just the x attribute for
	  general percentage scaling.

	* plugins/excel/ms-excel-read.c (excel_read_SETUP): Ditto.
	* plugins/xml_sax/xml-sax-read.c (xml_sax_print_scale): Ditto.

2003-01-22  Jody Goldberg <jody@gnome.org>

	* configure.in : bump the gsf req to reflect the updated xml api
	  names.

2003-01-21  Jody Goldberg <jody@gnome.org>

	* src/format.c (append_hour_elapsed) : rewrite to use rounding and to
	  handle negatives.  Still not really correct and cannot handle
	  fractional seconds.
	(append_minute_elapsed) : ditto.
	(append_second_elapsed) : ditto.
	(split_time) : remove vile static variable.

	For Nicolas Peninguy :
	http://bugzilla.gnome.org/show_bug.cgi?id=102236
	* src/formats.c : decrease dependence on glibc regexp extensions.

2003-01-20  Jon K Hellan  <hellan@acm.org>

	* src/gui-clipboard.c (table_cellregion_read): New function. Read
	from selection, interpreting as table.
	(text_received): New function. Receive text from
	gtk_clipboard_receive_text.
	(complex_content_received): New function. Receive non-textual
	content from clipboard. Factored out of x_clipboard_received.
	Fix leak of clipboard_paste_callback_data.
	(x_clipboard_received): Accept html and OpenOffice archive
	format. Factor out receipt of text and other formats to
	text_received and complex_content_received.

2003-01-14  Jon K Hellan  <hellan@acm.org>

	* src/io-context-gtk.[ch] (icg_set_transient_for): New
	function. Set transient_parent attribute, and call
	gtk_window_set_transient if we already have a window. On most
	window managers, this will put the splash screen on top of the
	transient parent.

	* src/io-context-gtk.c (struct _IOContextGtk): Add
	transient_parent attribute.
	(cb_icg_window_destroyed): Clear transient_parent attribute.
	(icg_show_gui): Call gtk_window_set_transient if transient_parent
	attribute is set.

	* src/main-application.c (main): Call icg_set_transient_for after
	each workbook is opened - yet another hack to keep the splash
	screen on top of the workbooks.

2003-01-14  Morten Welinder  <terra@diku.dk>

	* src/rendered-value.h: Delete render_color member.

	* src/rendered-value.c (cell_get_render_color): Change to return a
	PangoColor pointer that includes any explicit foreground colour.
	All callers changed.
	(rendered_value_new): Don't store render_color.
	(rendered_value_destroy): Don't release render_color.

	* src/print-cell.c (print_cell): Use cell_get_render_color (for
	now).

2003-01-13  Morten Welinder  <terra@diku.dk>

	* src/rendered-value.c (rendered_value_new): Create a matching
	PangoAttrList.
	(rendered_value_calc_size_ext): Constify.

	* src/cell-draw.c (cell_draw): Use the rendered value's
	attributes.

	* src/mstyle.c (mstyle_get_pango_attrs): New function.

	* src/style.c (style_font_new_simple): Explicitly set a colour map
	for the pango context.

	* src/item-grid.c (cb_cursor_come_to_rest): Constify.

2003-01-10  Morten Welinder  <terra@diku.dk>

	* src/workbook-control-gui.c (zoom_changed): buffer size paranoia.

	* src/workbook-format-toolbar.c (workbook_create_format_toolbar):
	Ditto.
	(workbook_feedback_set): Ditto.

2003-01-08  Jody Goldberg <jody@gnome.org>

	Patch from Theppitak Karoonboonyanan for
	http://bugzilla.gnome.org/show_bug.cgi?id=84062
	* src/gnumeric-canvas.c (gnm_canvas_retrieve_surrounding_cb) : new.
	(gnm_canvas_delete_surrounding_cb) : new.
	(gnm_canvas_init) : connect them up.

2003-01-07  Morten Welinder  <terra@diku.dk>

	* src/parse-util.h (GnmParseFunctionHandler): don't take a user
	pointer, but the conventions instead.

	* src/parser.y: Supply convs to handlers.  Look up functions in
	rewriter hash and act accordingly.

2003-01-07  Morten Welinder  <terra@diku.dk>

	* src/regression.c (matrix_invert): Return value was transposed.
	Not good.

2003-01-04  Jon K Hellan  <hellan@acm.org>

	* src/sheet-object-widget.c (sheet_widget_scrollbar_user_config)
	(sheet_widget_checkbox_user_config): Remove grab_focus. Not needed
	in GTK2, plus didn't work since expr_entry no longer is a subclass
	of GtkEntry.

2003-01-03  Jon K Hellan  <hellan@acm.org>

	* src/item-grid.c (cb_cursor_come_to_rest): Don't display empty
	tooltip.

	* src/hlink.c (gnm_hlink_cur_wb_activate): Test and complain if
	target is neither range nor name.

2003-01-03  Jody Goldberg <jody@gnome.org>

	* src/position.h : Some minor arg name cleanup.

	* src/commands.c (cmd_area_set_text_redo) : really fix it this time.

	* src/sheet.c (sheet_foreach_cell_in_range) : fix minor typo.

	* src/rendered-value.c (rendered_value_new) : handle preview grid's
	  use without a sheet.

2003-01-02  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (xml_workbook_write) : export quick hack for 1904 date
	  convention.  The positioning is silly.
	(xml_workbook_read) : read it back.

2003-01-01  Jody Goldberg <jody@gnome.org>

	* gnumeric.desktop.in : Add StartupNotify=true

2003-01-02  Morten Welinder  <terra@diku.dk>

	* src/regression.c (matrix_invert): New function.
	(matrix_determinant): New function.
	(LUPDecomp): Add an argument in which to return determinant.
	(rescale): Add an argument in which to return determinant scaling.

	* src/mathfunc.c (mdeterm, minverse): Delete.

2003-01-01  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* debian/changelog, debian/control, debian/gnumeric-doc.dirs,
	debian/rules: Updated.

2003-01-01  Jody Goldberg <jody@gnome.org>

	* configure.in : post release bump

2002-12-31  Jody Goldberg <jody@gnome.org>

	* Release 1.1.15

2002-12-31  Jody Goldberg <jody@gnome.org>

	* src/commands.c (cmd_area_set_text_redo) : fix.  It is an error to
	  pass NULL as the parse text.

2002-12-30  Morten Welinder  <terra@diku.dk>

	* src/format-template.c: Import CC2XML and CXML2C macros from
	xml-io.c and use them.
	(xml_read_format_col_row_info): Constify.

	* src/parse-util.h: Delete
	GNM_EXPR_PARSE_CREATE_PLACEHOLDER_FOR_UNKNOWN_FUNC flag.

	* src/parser.y: Delete create_placeholder_for_unknown_func flag.

2002-12-30  Jody Goldberg <jody@gnome.org>

	* src/parser.y (parser_sheet_by_name) : fix allocation handling of
	  unknown functions.

	* src/print-info.c (render_file) : add FILE

2002-12-30  Jon K Hellan  <hellan@acm.org>

	* src/application.c (gnumeric_application_setup_icons): Add
	Gnumeric_Protection_Yes_Dialog.

	* src/pixmaps/protection_yes_48.png: Add.

	* src/pixmaps/Makefile.am:  Add protection_yes_48.png.

	* src/workbook-control-gui.c (cb_accept_password): Move to
	dialogs/dialog-password.c.
	(wbcg_get_password): Most of it moved to dialog_get_password in
	dialogs/dialog-password.c.

	* src/io-context-gtk.c (icg_get_password): New function which
	implements CommandContext::get_password.
	(icg_class_init): Connect icg_get_password.

	* src/command-context.[ch] (cmd_context_get_password): Rename 2nd
	parameter from 'msg' to 'filename'.

	* src/command-context-priv.h (CommandContextClass.get_password):
	Ditto.

	* src/command-context-stderr.c (ccs_get_password): Ditto.

	* src/workbook-control-component.c (wbcc_get_password): Ditto.

	* src/io-context.c (ioc_get_password): Ditto.

2002-12-30  Morten Welinder  <terra@diku.dk>

	* src/formats.c (currency_date_format_init): Don't use undefined
	\? pattern.

	* src/sheet-style.c (cell_tile_style_new): Don't use res
	uninitialized, even if we compile with no checks.

	* src/gui-util.c (gnumeric_dialog_raise_if_exists): Return NULL on
	failure, not FALSE.
	* src/ranges.c (range_init_value): Ditto.
	* src/sheet-object-widget.c (sheet_widget_scrollbar_get_ref,
	sheet_widget_checkbox_get_ref): Ditto.
	* src/value-sheet.c (value_area_foreach): Ditto.

2002-12-29  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=64969
	* src/sheet-merge.c (sheet_merge_add) : update bounds.

	* src/sheet-control-gui.c (scg_set_panes) : handle freezing already
	  frozen panes to support adjustments after ins/del col/row.

	* src/sheet-view.c (sv_panes_insdel_colrow) : new.

2002-12-29  Morten Welinder  <terra@diku.dk>

	* src/ranges.c (range_parse): Return NULL on failure, not FALSE.

2002-12-28  Rodrigo Moya <rodrigo@gnome-db.org>

	* configure.in: require libgda >= 0.10, needed for the read-only
	connections.

2002-12-28  Jody Goldberg <jody@gnome.org>

	* src/format.c (style_format_delocalize) : tweak.

	* src/sheet-filter.c (filter_field_arrow_format) : be less polite to
	  styles, but at least it will work in the vast majority of cases.

2002-12-27  Morten Welinder  <terra@diku.dk>

	* src/parse-util.c (cellpos_parse): Change calling convention.
	All callers changed.
	(test_cellpos_stuff): New function.
	(parse_util_init) [TEST]: Call it.

2002-12-27  Jody Goldberg <jody@gnome.org>

	* src/parse-util.c (cellpos_parse) : fix.

	* src/workbook-control-gui.c (cb_auto_filter) : do a sheet update.

	* src/sheet.c (sheet_colrow_insert_finish) : relocate filters.
	(sheet_colrow_delete_finish) : relocate filters.

	* src/sheet-filter.c : Use the sheetobject anchor as the normative
	  source of the field index to simplify things.
	(sheet_filter_insdel_colrow) : new.
	(gnm_filter_add_field) : new split out from.
	(gnm_filter_new) : here.

2002-12-27  Morten Welinder  <terra@diku.dk>

	* src/commands.c (truncate_undo_info): Handle undo_max_number==0
	also.

2002-12-26  Morten Welinder  <terra@diku.dk>

	* src/xml-io.c (xml_workbook_read): Don't call textdomain.
	(xml_workbook_write): Ditto.

2002-12-24  Jody Goldberg <jody@gnome.org>

	* schemas/plot-types.xml.in : fix some typos, and some consistency
	  improvements
	* schemas/gnumeric-dialogs.schemas.in : more typos.

	* src/sheet-object-image.c (soi_get_pixbuf) : minor readability
	  improvement.

2002-12-23  Morten Welinder  <terra@diku.dk>

	* src/parse-util.c (col_parse, row_parse): Change to return NULL
	in the failure case.  All callers changed.
	(test_col_stuff, test_row_stuff): New functions.
	(parse_util_init) [TEST]: Call them.

2002-12-23  Morten Welinder  <terra@diku.dk>

	* src/parse-util.c (row_parse): Don't allow sign or initial
	white-space.  Don't allow numbers starting with '0'.  Fix
	potential overflow problem on machines wherer long>int.  No need
	to fiddle with errno.
	(cellref_as_string): Simplify using col_name_internal and
	row_name_internal.  (Making it work for larger SHEET_MAX_COLS
	also.)
	(cellref_a1_get, cellpos_parse): Simplify greatly using col_parse
	and row_parse.  (Thus making them work for larger SHEET_MAX_COLS
	also.)

2002-12-23  Jon K Hellan  <hellan@acm.org>

	* configure.in: Require libgda >= 0.9 for gda plugin.

2002-12-22  Jody Goldberg <jody@gnome.org>

	* configure.in : post release version bump

2002-12-22  Jody Goldberg <jody@gnome.org>

	* Release 1.1.14

2002-12-22  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_auto_filter) : aarrrggghhh typo.

2002-12-22  Jody Goldberg <jody@gnome.org>

	* configure.in : post release version bump

2002-12-22  Jody Goldberg <jody@gnome.org>

	* Release 1.1.13

2002-12-20  Jody Goldberg <jody@gnome.org>

	* src/stf-parse.c (stf_parse_sheet) : use cell_set_value and simplify.

	* src/clipboard.c (paste_cell) : fix leak.

2002-12-20  Morten Welinder  <terra@diku.dk>

	* src/workbook-view.c (wb_view_new_from_input): Add a ref-count
 	check for probes.

	* src/parser.y: Check for failure from build_intersect.

2002-12-19  Morten Welinder  <terra@diku.dk>

	* src/parse-util.h (GnmExprConventions): Add cell_ref_handler
	and range_ref_handler members.

	* src/expr.c (do_expr_as_string): Call cell_ref_handler and
	range_ref_handler.

	* src/parse-util.c (gnm_expr_conventions_new): Set default
	cell_ref_handler and range_ref_handler.
	(col_name_internal): Change to take an accumulator GString.  All
	callers changed.
	(row_name_internal): Ditto.
	(rangeref_as_string): Ditto.
	(cellref_as_string): Ditto.

2002-12-19  Morten Welinder  <terra@diku.dk>

	* src/parse-util.c (gnm_expr_conventions_default_1_0): Delete.
	(parse_util_init): Don't set up gnm_expr_conventions_default_1_0.
	(parse_util_shutdown): Don't free it.

2002-12-17  Morten Welinder  <terra@diku.dk>

	* src/value.c (value_new_from_string): Take new "translated"
	argument and respect it for booleans and errors.  All callers
	changed.

	* src/format.c (format_get_currency): Make really sure not to
	return NULL.

	* src/xml-io.c (xml_io_conventions): New function.
	(xml_parse_ctx_new): Add exprconv member to our context.
	(xml_parse_ctx_destroy): Free it.
	(xml_write_style, cb_xml_write_name, xml_read_names,
	xml_read_style, xml_write_cell_and_position,
	xml_cell_set_array_expr, xml_read_cell, xml_read_cell_copy): Use
	exprconv.
	(xml_cell_set_array_expr, xml_not_used_old_array_spec): Add parse
	context argument.  All callers changed.
	(xml_write_cell_and_position): Use value_get_as_gstring to get
	non-local error names.
	(xml_write_filter_expr): Ditto.

	* src/gutils.c (gnm_strunescape): New function.

	* src/parser.y (yylex): Handle error constants that don't end in
	"!", such as "#NAME?".  Catch unterminated error tokens.  Return
	token CONSTANT for errors.
	(find_matching_close): Use gnm_strunescape.
	(find_char): Delete.

	* src/value.c (value_get_as_gstring): Use untranslated error
	messages when requested.

2002-12-16  Morten Welinder  <terra@diku.dk>

	* src/number-match.c (format_match_init): Don't setup error
	variables any more.
	(gnumeric_error_init): Delete.

	* src/value.c (value_error_name): New function.

	* src/parse-util.c (def_expr_name_handler): Use value_error_name
	to get proper spelling of the REF error.

	* src/collect.c (float_range_function, float_range_function2,
	string_range_function): Take a GnmStdError, not a string.

	* src/value.c (value_error_classify): New function.

	* src/expr.c (gnm_expr_is_err): Take a GnmStdError, not a string.
	All callers changed.

	* src/value.c (value_init): Build table of translated error names.
	(value_shutdown): Tear it down.
	(value_new_error_NULL, value_new_error_DIV0,
	value_new_error_VALUE, value_new_error_REF, value_new_error_NAME,
	value_new_error_NUM, value_new_error_NA, value_new_error_RECALC):
	New functions.
	* */*.c */*/*.c: Elminate most occurrences of gnumeric_err_*.

	* src/libgnumeric.c (gnm_common_init): Move string initialization
	to before values.
	(gnm_shutdown): Similarly.

2002-12-15  Morten Welinder  <terra@diku.dk>

	* src/expr.c (gnm_expr_as_gstring): New function.

	* src/rendered-value.c (rendered_value_new): Use
	gnm_expr_as_gstring to avoid extra copy of result.  Use
	string_get_nocopy to avoid yet another copy.
	(cell_get_entered_text): Use gnm_expr_as_gstring to avoid extra
	copy of result.

2002-12-14  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_auto_filter) : It makes no sense to
	  create a filter for 1 header row.

	* src/sheet-filter.c (filter_field_apply) : be more resilient about
	  bogus filters.

2002-12-13  Jody Goldberg <jody@gnome.org>

	* src/input-msg.c (gnm_input_msg_get_msg) : new.
	(gnm_input_msg_get_title) : new.

2002-12-12  Jody Goldberg <jody@gnome.org>

	* src/sheet-style.c (cb_hash_to_list) : improve placement of debug
	  info to ignore irrelevent ranges that were merged into something else.

	* tools/import-foocanvas : do not install foocanvas

	* src/sheet-style.c (sheet_style_get_validation_list) : new.
	(cb_style_list_add_validation) : simple filter.
	(cb_style_list_add_node) : generalize slightly to make the comparison
	  routine dynamic.
	(cb_hash_merge_horiz) : ditto.
	(sheet_style_get_list) : adjust to the new generalized utilities.

2002-12-13  Morten Welinder  <terra@diku.dk>

	* src/value.c (value_get_as_gstring): New function.
	(value_get_as_string): Use that.

	* src/expr.c (do_expr_as_string): Use value_get_as_gstring.

	* src/xml-io.c (gnumeric_xml_read_workbook): Grammar fix.

	* src/parse-util.h (struct _GnmExprConventions): New members
 	expr_name_handler, output_sheet_name_sep, output_argument_sep,
 	output_array_col_sep, and output_translated.  Eliminate
 	use_locale_C.

	* src/expr.c (do_expr_as_string): Use new expr_name_handler in
	conventions.

	* src/parse-util.c (def_expr_name_handler): New function, mostly
	extracted from do_expr_as_string.
	(gnm_expr_conventions_new): Attach def_expr_name_handler.

2002-12-13  Morten Welinder  <terra@diku.dk>

	* src/gutils.c (gnm_strescape): Rename from gnumeric_strescape and
	take GString accumulator argument.  All callers changed.

2002-12-13  Morten Welinder  <terra@diku.dk>

	* src/expr.c (gnm_expr_list_as_string): Take accumulator argument
	and no prefix.  All callers changed.
	(do_expr_as_string): Take accumulator argument and clean up
	otherwise.

2002-12-12  Morten Welinder  <terra@diku.dk>

	* src/sheet-filter.c (cb_filter_expr): Fix "and" semantics.

2002-12-11  Jon K Hellan  <hellan@acm.org>

	* src/bonobo-io.c: Remove 10 unnecessary includes.

2002-12-11  Jon K Hellan  <hellan@acm.org>

	* GNOME_Gnumeric.server.in.in (OAFIID:GNOME_Gnumeric_Control):
	Don't pretend to support  Bonobo/PersistFile.

	* src/main-component.c (load_workbook_from_file): Remove.
	(add_interfaces): Don't pretend to support
	Bonobo/PersistFile. Replace deprecated bonobo_persist_stream_new
	with gnm_persist_stream_new.

	* src/bonobo-io.h: Declare gnm_persist_stream_new. Remove
	everything else.

	* src/bonobo-io.c: Add boilerplate for class GnmPersistStream
	implementing Bonobo:PersistStream.
	(gnumeric_bonobo_read_from_stream): Rename to
	gnm_persist_stream_load and change to correct signature for
	PersistStream load method.
	(workbook_persist_file_load, workbook_persist_file_save,
	workbook_bonobo_setup): Dead code. Remove.

	* src/sheet-object-image.c (soi_get_pixbuf): Use
	gdk_pixbuf_loader_new_with_type if type is known. Close pixbuf
	loader before getting pixbuf. Copy image to file on all errors.

2002-12-08  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (xml_write_sheet_filters) : filter export.

	* src/workbook-control-gui.c (wbcg_finalize) : patch leak.

	* src/expr-name.c (expr_name_remove) : removing a name dfrom the hash
	  will already set the expr to NULL and unref.  No need to do it again.

2002-12-09  Morten Welinder  <terra@diku.dk>

	* src/sheet-filter.c (filter_field_apply): Filter out blanks per
	jody.

2002-12-08  Jon K Hellan  <hellan@acm.org>

	* src/sheet-filter.c (do_focus_change): Use stack allocated events
	rather than 2.1.x addition gdk_event_new.

2002-12-08  Jon K Hellan  <hellan@acm.org>

	* src/bonobo-io.c (gnumeric_bonobo_read_from_stream): Bitrot was
	setting in. Fix.

	* src/main-component.c (load_workbook_from_file): Conditionalize
	debug output.
	(gnm_component_factory): Rename from
	gnumeric_component_factory. Conditionalize debug output.
	(main): Use new name of gnm_component_factory.

	* src/workbook-control-gui.c (wbcg_get_gtk_settings): Get screen
	from wbcg->table. Needed for Bonobo component case.

2002-12-08  Jon K Hellan  <hellan@acm.org>

	* src/sheet-filter.c: Include gdkevents.h

2002-12-08  Jon K Hellan  <hellan@acm.org>

	* src/GNOME_Gnumeric.xml: Add Pivot table command.

2002-12-08  Jon K Hellan  <hellan@acm.org>

	* GNOME_Gnumeric.server.in.in: Install gnumeric-component to
	libexec.

	* src/Makefile.am (libexec_PROGRAMS): Ditto.

	* Makefile.am ($(server_in_files)): Substitute for "@LIBEXECDIR@"
	in server.in.in file.

	* configure.in (AC_OUTPUT): Don't output GNOME_Gnumeric.server.in,
	make generates it.

2002-12-08  Jon K Hellan  <hellan@acm.org>

	* src/sheet-filter.c (do_focus_change): New. Copied from
	gtkwindow.c. Send focus_change event to the list
	(filter_popup_destroy): New. Move keyboard focus away from the
	popup and destroy it.
	(cb_filter_key_press, cb_filter_button_press): Take list parameter
	and call filter_popup_destroy.
	(cb_filter_button_release): Call filter_popup_destroy.
	(cb_filter_button_pressed): Pass list argument with
	key_press_event and button_press_event callbacks. Make popup take
	keyboard focus by means of deep runes suggested by Owen and seen
	in gtktreeview.c::gtk_tree_view_real_start_interactive_search.

2002-12-07  Jody Goldberg <jody@gnome.org>

	* src/sheet-filter.c : Initial attempt at expr filters

2002-12-07  Christian Neumair  <chris@gnome-de.org>

	* src/dialogs/sheet-order.glade: Made "_Duplicate" translatable.
	* plugins/derivatives/options.c: Capitalized "@FUNCTION=opt_bs".

2002-12-06  Jon K Hellan  <hellan@acm.org>

	* src/sheet-filter.c (cb_filter_button_release): Use
	gtk_get_event_widget to check if release took place inside list.
	(cb_filter_button_pressed): Call gdk_pointer_grab with
	owner_events TRUE. Connect the motion_notify callback to the list
	rather than the popup.

2002-12-06  Jody Goldberg <jody@gnome.org>

	* src/sheet-filter.c (filter_field_arrow_format) : new to make the
	  arrow more obviously different.

	* src/regutf8.c (gnumeric_regcomp_XL) : moved from
	  plugins/fn-string/functions.c:search_pattern_to_regexp and turned into
	  a wrapper.

2002-12-05  Morten Welinder  <terra@diku.dk>

	* src/xml-io.c: Eliminate most char casts.

2002-12-05  Jody Goldberg <jody@gnome.org>

	* src/sheet-filter.c (cb_filter_button_release) : silence warning.
	(gnm_filter_set_condition) : ditto.

	* src/plugin-service.c : s/gnum_plugin/gnm_plugin/

	* src/Makefile.am (EXTRA_DIST) : add README.gnm_float

2002-12-05  Jody Goldberg <jody@gnome.org>

	* src/style-color.c (gnumeric_color_init) : swap green to yellow

	* src/gui-util.c (gnumeric_create_tooltip) : use gs_yellow.

	* src/tools/filter.c (filter_show_all) : clear filters.

	* src/sheet-filter.c (filter_field_apply) : #$^@# fix inversion of
	  'top' and 'bottom'
	(collect_unique_elements) : Store the value
	(gnm_filter_get_condition) : new.
	(cb_filter_find_percentage) : new.
	(cb_hide_unwanted_percentage) : new.
	(filter_field_apply) : implement top/bottom percentage filters.

2002-12-05  Morten Welinder  <terra@diku.dk>

	* src/workbook-control-gui.c: Attempt to reinstate pixmap for
	print preview in non-bonobo case.

2002-12-04  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (wbcg_menu_state_update) : link filter
	  state to 'show all' state.

	* src/value.c (value_cmp_reverse) : new.

	* src/xml-io.c (xml_write_sheet_filters) : new.
	(xml_sheet_write) : Used here.
	(xml_read_sheet_filters) : new.
	(xml_sheet_read) : Used here.

	* src/gui-util.c (gnumeric_option_menu_get_selected_index) : delete.

	* src/sheet-filter.c (cb_filter_find_minmax) : new.
	(cb_hide_the_rest) : new.
	(filter_field_apply) : support top/bottom N items.
	(cb_filter_button_release) : connect up the dialog stubs.

2002-11-18  Fernando Herrera <fherrera@onirica.com>

	* gnumeric.desktop.in: add X-GNOME-BUGZILLA stuff

2002-12-04  Jody Goldberg <jody@gnome.org>

	* src/expr.c (gnm_expr_as_string) : Add a currently useless
	  conventions argument for future use.

2002-12-03  Jody Goldberg <jody@gnome.org>

	* src/sheet-control-gui.c (sheet_control_gui_new) : take a wbcg as a
	  an argument so that we can assign it at creation rather than later.

	* src/sheet-object.c (sheet_object_new_view) : only create a
	  view if there isn't one already.

	* src/sheet-filter.c (cb_filter_blanks) : Use colrow_set_visibility.
	(cb_filter_non_blanks) : ditto.
	(gnm_filter_set_condition) : ditto.

2002-12-03  Jody Goldberg <jody@gnome.org>

	* src/sheet-filter.c (cb_filter_button_release) : don't die when faced
	  with unsupported filter types.

	* src/GNOME_Gnumeric.xml : Add auto filter
	* src/workbook-control-gui.c : ditto.

2002-12-03  Jon K Hellan  <hellan@acm.org>

	* src/sheet-filter.c (cb_filter_button_release): Check if event
	window is popup window.

2002-12-03  Morten Welinder  <terra@diku.dk>

	* src/xml-io.c (POINT_SIZE_PRECISION): Increase to 4.
	(xml_node_set_print_unit): Just use the GnomePrintUnit name.
	(xml_node_get_print_unit): Use unit_name_to_unit.

	* src/print-info.c (print_unit_new, unit_name_get_short_name,
	unit_name_get_name): Delete.
	(unit_name_to_unit): Return a GnomePrintUnit*.  Remove unused
	"translated" argument.  All callers changed.
	(unit_convert): Take GnomePrintUnit* arguments.  All callers
	changed.

	* src/print-info.h (enum UnitName): Delete.

2002-12-03  Jon K Hellan  <hellan@acm.org>

	* configure.in: Check for gtk_settings_get_for_screen

2002-12-03  Jon K Hellan  <hellan@acm.org>

	* src/item-bar.c (item_bar_calc_size): Use default desktop font of
	screen.

	* src/workbook-control-gui.[ch] (wbcg_get_font_desc): New .Return
	font_desc of default desktop font, looking it up if not
	known. Wire up notification about font changes.

	* src/workbook-control-gui.c: Add PivotTable verb.
	(settings_get_font_desc): New. Get Pango font desc from string.
	(cb_update_item_bar_font): New callback. Called from
	gtk_container_foreach for each notebook tab to update the item bars.
	(cb_desktop_font_changed): New callback. Called when desktop font
	has changed.
	(wbcg_get_gtk_settings): New. Gets GtkSettings - by screen if
	possible.

	(workbook_control_gui_init): Init font_desc to NULL.

	* src/workbook-control-gui-priv.h (struct _WorkbookControlGUI):
	Add font_desc.

2002-12-03  Jody Goldberg <jody@gnome.org>

	* configure.in : bump gsf req

2002-12-03  Jody Goldberg <jody@gnome.org>

	* src/sheet-filter.c : add condition framework
	  select existing conditions
	  provide feedback for which filter is active
	  Support blank/non-blank/All filters

2002-12-02  Jon K Hellan  <hellan@acm.org>

	* src/io-context-gtk.c (icg_inc_files_done): Only increment file
	progress bar if we have one (bug #100081).

2002-12-02  Jon K Hellan  <hellan@acm.org>

	* src/Makefile.am: Don't link component with IOContextGtk.

	* src/io-context-gtk.c (icg_progress_set)
	(icg_progress_message_set): Respect no-splash flag.

	* src/main-application.c: Add no-splash argument.

2002-11-30  Jody Goldberg <jody@gnome.org>

	* src/expr-name.c (cb_check_name) : ignore hidden names.

	* src/io-context-gtk.c (icg_error_error_info) : no need to display the
	  splash if we are going to pop up an error.  Something was screwing
	  up and I don't feel like tracing it.

	* src/expr.c (do_referenced_sheets) : fix nasty typo.
	(gnm_expr_containts_subtotal) : new.

	* src/collect.c (collect_floats) : start support for SUBTOTAL
	* src/sheet.c (sheet_foreach_cell_in_range) : ditto.
	* src/func.c (function_iterate_argument_values) : ditto.

2002-11-29  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (wbcg_menu_state_update) : add auto
	  filter.
	(cb_auto_filter) : initial quicky implementation.
	(cb_data_pivottable) : ditto.
	(workbook_control_gui_init) : init the autofilter.

	* src/value.c (value_equal) : new util.
	(value_cmp) : new.

	* src/style-color.c (gnumeric_color_init) : add green.

	* src/stf.c : quiet a few warnings.

	* src/sheet.c (sheet_new) : init filters and pivots.
	(sheet_destroy_contents) : free the filters and pivots.
	(sheet_range_calc_spans) : no one sets NO_DRAW so don't check for it.
	(sheet_cell_calc_span) : ditto.

	* src/sheet-view.c (sv_edit_pos_in_filter) : new.

	* src/sheet-object.c (sheet_object_print) : no warning if the object
	  does not print.
	(sheet_object_clone) : nor is it a problem if it cannot be cloned.

	* src/sheet-object-widget.c (sheet_widget_button_set_label) : new.
	(sheet_widget_checkbox_set_label) : new.
	(cb_checkbox_config_cancel_clicked) :use sheet_widget_checkbox_set_label
	(cb_checkbox_label_changed) : ditto.
	(sheet_widget_radio_button_finalize) : free the label.
	(sheet_widget_radio_button_set_label) : new.

	* src/ranges.c (setup_range_from_value) : remove ugly release argument.
	(setup_range_from_range_ref) : ditto.
	(value_to_global_range) : take a GlobalRange as an arg.  No need to
	  allocate the result.

	* src/item-bar.c (item_bar_realize) : create a GC for filtered regions
	(item_bar_unrealize) : free it.

	* src/io-context.c (workbook_io_progress_set) : const the workbook.

	* src/gnumeric.h : Add GnmFilter.
	  Remove unused SPANCALC_NO_DRAW.

	* src/file.c (gnum_file_saver_save_real) : view is const not output.
	(gnum_file_saver_save) : ditto.

	* src/file-priv.h (save) : view is const not output.  delete save to
	  stream.

	* src/consolidate.c (consolidate_set_destination) : adjust to less
	  silly interface to setup_range_from_value.
	(consolidate_add_source) : ditto.

	* src/pixmaps/Makefile.am : add the pivottable icons
	* src/application.c (gnumeric_application_setup_icons) : ditto.

	* src/Makefile.am : add pivot table stub and auto filter
	  implementation

2002-11-28  Jody Goldberg <jody@gnome.org>

	* src/expr-name.c (sheet_names_get_available) : document.
	(cb_get_names) honour is_hidden.
	(expr_name_new) : init is_hidden.

2002-11-28  Jon K Hellan  <hellan@acm.org>

	* src/file-priv.h (struct _GnumFileSaverClass::save): Replace
	file_name with GsfOutput *output.

	* src/file.h (GnumFileSaverSaveFunc, gnum_file_saver_save): Ditto.

	* src/file.c:
	(gnum_file_saver_save_real, gnum_file_saver_save): Ditto.

	* src/plugin-service.h
	(PluginServiceFileSaverCallbacks::plugin_func_file_save): Ditto

	* src/plugin-service.c:
	(gnum_plugin_file_saver_save): Ditto

	* src/workbook-view.c: Include gsf/gsf-output-stdio.h.
	(wbv_save_to_file): New function. Creates a gsf output stream from
	file.
	(wb_view_save_as, wb_view_save): Call wbv_save_to_file rather than
	gnum_file_saver_save.

	* src/stf.c (stf_text_to_columns): Call
	gsf_output_memory_get_bytes with new signature.
	(stf_open_for_write): Remove.
	(stf_write_func): Use gsf_output_puts.
	(stf_write_workbook): Replace file_name with GsfOutput *output.
	Don't open and close file. Higher layer does that.

	* src/xml-io.c (gnumeric_xml_write_workbook): Replace file_name
	with GsfOutput *output.  Don't open and close file. Higher layer
	does that.

2002-11-27  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-gui.c (wbcg_progress_set): Deprecation
	cleanup: s/gtk_progress_bar_update/get_progress_bar_set_fraction/.
	(setup_progress_bar): Deprecation cleanup: Remove
	gtk_progress_bar_set_orientation. These are in the changelog for
	2002-11-19, but never actually got committed.

2002-11-27  Morten Welinder  <terra@diku.dk>

	(From Evert's patch in bug #99429.)
	* src/history.c (history_menu_locate_separator): This now needs to
	link to the preferences menu item.

2002-11-27  Christian Neumair  <chris@gnome-de.org>

	* .cvsignore: Updated.

2002-11-26  Morten Welinder  <terra@diku.dk>

	* src/parser.y (gnm_expr_parse_str): Take GnmExprConventions, not
	a ref_parser.  All callers changed.
	(yylex): Flatten structure and use GnmExprConventions options.

	* src/parse-util.h (struct _GnmExprConventions): New structure for
	parsing info.
	(GnmExprParseFlags): Prune lots of flags.

	* src/parse-util.c (parse_util_init, parse_util_shutdown,
	gnm_expr_conventions_new, gnm_expr_conventions_free): New
	functions.
	(gnm_expr_parse_str_simple): New function (was macro).

	* src/libgnumeric.c (gnm_shutdown): Shut down parse_util.
	(gnm_common_init): Init parse_util.

	* src/func.c (gnm_func_placeholder_factory): New function.

2002-11-25  Jody Goldberg <jody@gnome.org>

	* src/main-application.c (main) : create io-context-gtk directly.

	* src/io-context-gtk.c (icg_show_gui) : remove the label, the spash
	  has enough text.  Make the window a popup to keep it at the top
	  with no decoration rather than a toplevel that gets buried as we
	  open new windows. renamed form icg_init_gui, and only call later.
	(gnumeric_io_context_gtk_new) : delete empty method.
	(icg_init) : init the timer here.

	* src/workbook-view.c (wb_view_new_from_input) : move do the recalc
	  here to be more central.
	* src/gui-file.c (gui_file_read) : rather than here.

	* src/expr.c (gnm_expr_rewrite) : fix handling of SET.
	  Make smarter about 3d references.

2002-11-25  Jody Goldberg <jody@gnome.org>

	* src/parse-util.c (rangeref_parse) : init sheet_b in the case where
	  there is no sheet at all.

	* src/workbook.c (cb_tweak_3d) : new.
	(workbook_sheet_detach) : use it here to fix 3d references.

	* src/dependent.c (dependent_changed) : don't relink here.
	(dependent_set_expr) : which cleans up the semantics here.
	(dependent_set_sheet) : relink here instead which is much nicer.

	* src/sheet-control-gui.c (scg_set_left_col) : clip on pane 1
	  but we always need to scroll 3 if it exists.
	(scg_set_top_row) : ditto, but reverse the panes.

	* src/item-grid.c (item_grid_draw_merged_range) : do just in time
	  spanning here too.

2002-11-24  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-graphic.c (sheet_object_text_set_text) : new.

	* src/cut-n-paste-code/foocanvas/libfoocanvas/foo-canvas-text.c
	(foo_canvas_text_set_property) : enable line wrapping.

2002-11-23  Jody Goldberg <jody@gnome.org>

	* src/sheet-view.c (sv_freeze_panes) : Be more robust about handling
	  h/v only freezing that have initial positions > A1

	* src/sheet-object-graphic.c : Move the label widget here.  Inherit it
	  from SheetObjectFilled, and use canvas text.  Still needs some love
	  to handle the outline width nicely but on the whole it works.

2002-11-22  Jody Goldberg <jody@gnome.org>

	* src/commands.c (cmd_selection_group) : Add a bonus heuristic to
	  accept attempts to ungroup a region that erroneously includes the
	  collapse marker.

2002-11-22  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=97691
	* src/workbook-edit.c (wbcg_edit_finish) : detach guru before
	  destroying it.

	* tools/import-foocanvas : add a trailing backslash before the
	  header list.

	* src/commands.c (cmd_global_outline_change) : don't push a useless
	  command.
	(cmd_selection_outline_change) : fix handling of collapse at start.

	* src/item-bar.c (item_bar_draw) : optionally draw collapse markers
	  at the start rather than the end.

	* src/colrow.c (colrow_set_visibility) : Handle collapse at start vs
	  at the end.

2002-11-22  Christian Neumair  <chris@gnome-de.org>

	* src/dialogs/autoformat.glade: Make the menu display mnemotics correctly.

2002-11-21  Jody Goldberg <jody@gnome.org>

	* src/colrow.c (colrow_get_global_outline) : new.

	* src/commands.c (cmd_colrow_hide_correct_selection) : just in case,
	  don't reset the selection unless we are going to set it to something.
	(cmd_colrow_hide_undo) : convert from elements+flag -> 2 lists.
	(cmd_colrow_hide_redo) : ditto.
	(cmd_colrow_hide_finalize) : ditto.
	(cmd_selection_colrow_hide) : ditto.
	(cmd_selection_outline_change) : ditto.
	(cmd_global_outline_change) : new.

2002-11-20  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (sheet_regen_adjacent_spans) : delete.

	* src/sheet-control-gui.c (scg_setup_group_buttons) : hook up the
	  outline buttons to a callback.
	(cb_outline_button) : new.

2002-11-20  Jody Goldberg <jody@gnome.org>

	* src/sheet-control-gui.c (scg_setup_group_buttons) : The outline
	  buttons cannot take focus.

	* src/parse-util.c (rangeref_parse) : fix parsing 3d refs.  When
	  initializing in case the cell is singleton do not over write the sheet
	  in case it was already parsed as 3d.

	* src/gui-util.c (gnumeric_dialog_file_selection) : remove magic
	  directory selector, gtk handles it now and We are already assigning
	  the path earlier.

	* src/workbook-view.c (wb_view_save_as) : only change the filename if
	  the format is changed.
	* src/workbook.c (workbook_set_saveinfo) : remove limitation on file

	* src/bonobo-io.c (gnumeric_bonobo_read_from_stream) : Use
	  wb_view_new_from_input.

2002-11-20  Morten Welinder  <terra@diku.dk>

	* src/gutils.c (gnumeric_ascii_strcase_hash): Use g_ascii_tolower,
	not locale-dependent tolower.

2002-11-19  Jon K Hellan  <hellan@acm.org>

	* src/io-context-gtk.[ch]: (icg_set_files_total): New function:
	set number of files to process. If > 1, an additional progress bar
	is shown so user can monitor both files processed and progress
	within file.
	(icg_inc_files_done): New function: Indicate that a file has been
	processed.

	* src/io-context-gtk.c (struct _IOContextGtk): Add file_bar,
	rename progress_bar to work_bar, add files_total and files_done.
	(icg_progress_set): Use gtk_widget_show instead of
	gtk_widget_show_all so file_bar doesn't show up uninvited.
	Deprecation cleanup:
	s/gtk_progress_bar_update/get_progress_bar_set_fraction/.
		(icg_progress_message_set):
	s/gtk_widget_show_all/gtk_widget_show/. Update per file progress
	bar, which is named work_bar.
	(cb_icg_window_destroyed): NULL out both progress bars.
	(icg_init): Initialize additional attributes.
	(icg_init_gui): Pack an additional progress bar, but don't show
	it. Show the other widgets individually.

	* src/main-application.c (main): Call icg_set_files_total and
	icg_inc_files_done.

	* src/workbook-control-gui.c (wbcg_progress_set): Deprecation
	cleanup: s/gtk_progress_bar_update/get_progress_bar_set_fraction/.
	(setup_progress_bar): Deprecation cleanup: Remove
	gtk_progress_bar_set_orientation.

2002-11-19  Morten Welinder  <terra@diku.dk>

	* src/sheet-autofill.c (autofill_cell): Unify, generalise,
	optimise, and clean up FILL_STRING_WITH_NUMBER case.
	(string_has_number): Add arg to return endpos of number.

2002-11-19  Morten Welinder  <terra@diku.dk>

	* src/sheet-autofill.c (string_has_number): Change to return
	gboolean.  Constify.  Make UTF-8 safe.
	(autofill_cell): Fix for negative numbers as strings.

2002-11-18  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-gui.c (show_gui): This is getting
	embarassing!

2002-11-18  Jon K Hellan  <hellan@acm.org>

	* src/io-context-gtk.c (icg_init_gui): I could have sworn...

2002-11-18  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-gui.c (show_gui): Use window->screen
	instead of default screen.

	* src/io-context-gtk.c (icg_init_gui): Use
	gdk_screen_get_monitor_geometry instead of gdk_screen_get_width.

	* configure.in (LIBS): Check for gdk_screen_get_monitor_geometry
	instead.

2002-11-18  Jon K Hellan  <hellan@acm.org>

	* src/gui-file.c (gui_file_read): Display both errors and warning
	(accidentally left out of commit 2002-11-15).

	* src/main-application.c (main): Clear io context after displaying
	error.

2002-11-18  Morten Welinder  <terra@diku.dk>

	* configure.in (LIBS): Check for gdk_screen_get_width.

	* src/workbook-control-gui.c (wbcg_menu_state_update): Change
	tooltip also.
	(change_menu_label): Handle tooltip changing too.

	* src/io-context-gtk.c (icg_init_gui): Set size and position of
	splash screen.

2002-11-16  Morten Welinder  <terra@diku.dk>

	* src/sheet-autofill.c (autofill_cell): Don't use snprintf for no
 	reason.

2002-11-17   Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* stf.c (stf_open_and_read) : stf expects \0-terminated data. Make
	sure it is in fact \0-terminated.

2002-11-16   Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* stf-parse.c (stf_parse_is_valid_data) : declare wstr only if
	HAVE_WCTYPE_H, don't read past the buffer end even if we encountered
	wide characters.

2002-11-16  Jon K Hellan  <hellan@acm.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=98661
	* src/file.c (gnum_file_opener_open): Set filename. Fixes

	* src/plugin-service.c (gnum_plugin_file_opener_open): No longer
	set filename.

2002-11-15  Jon K Hellan  <hellan@acm.org>

	* src/io-context-gtk.c (icg_init_gui): Make it dialog-like. More
	like a splash screen, but still possible to move it out of the way.

	(gnumeric_io_context_gtk_new): Declare void.

2002-11-15  Jon K Hellan  <hellan@acm.org>

	* src/io-context-gtk.c: Include libgnumeric.h
	(icg_init_gui): Declare static void.

	* src/Makefile.am (GNUMERIC_BASE): Add io-context-gtk.[ch]

2002-11-15  Jon K Hellan  <hellan@acm.org>

	* src/main-application.c (warn_about_ancient_gnumerics): Take an
	IOContext instead of a WorkbookControl.
	(main): Create an initial IOContextGtk if started with GUI, a
	CommandContextStderr otherwise. Call plugins_init earlier, but
	don't create wbcg before reading initial files. Read initial files
	with wb_view_new_from_file, and wrap them in a wbcg if successful.

	* src/io-context-gtk.[ch]: Add. IO Context with GUI for showing
	progress and messages before first wbcg is shown.

	* src/io-context.[ch] (gnumeric_io_warning_occurred): Add.

	* src/io-context.c (io_context_init): Initialize warning_occurred,
	error_info renamed to info.
	(ioc_finalize, gnumeric_io_error_unknown): impl is now optional.
	(gnumeric_io_error_info_set, gnumeric_io_error_push): error_info
	renamed to info.
	(gnumeric_io_error_display, io_progress_update,
	io_progress_message): Display it ourselves if no impl.
	(gnumeric_io_error_clear): Clear warning_occurred, error_info
	renamed to info.
	(gnm_io_warning): Implement.

	* src/io-context-priv.h (struct _IOContext): Rename error_info to
	info, add warning_occurred field.

	* src/gui-util.[ch] (gnumeric_error_info_dialog_new): New
	function. Contains the meat of gnumeric_error_info_dialog_show,
	but doesn't show it or set the parent. Display an error or warning
	dialog depending on the severity of the error_info.

	* src/gui-util.c (gnumeric_error_info_dialog_show): Factor out
	gnumeric_error_info_dialog_new.

	* src/error-info.c (error_info_new_str, error_info_new_printf):
	Set severity to GNM_ERROR.
	(error_info_new_from_error_list): Return NULL for empty list.
	(error_info_print_with_offset): Prefix with 'E' or 'W' for errors
	and warnings.

	* src/error-info.h (enum GnmSeverity): Add with values for
	warnings and errors.

	* src/error-info.[ch] (error_info_new_vprintf): Add severity
	argument.
	(error_info_peek_severity): Add.

	* src/error-info.c (struct _ErrorInfo): Add severity field.

	* src/workbook-control-gui.c (show_gui): Catch incorrectly parsed
	geometry. Include code to fix bug 59902: Window too large with
	xinerama setup, but disable until we depend on gtk2.2.

	* src/gui-file.c (gui_file_read): Display both errors and warnings.

	* src/workbook-view.c (wb_view_save_as, wb_view_save): Ditto.

2002-11-15  Jody Goldberg <jody@gnome.org>

	* src/pixmaps/Makefile.am : convert to new add/remove decimal icons

2002-11-15  Jody Goldberg <jody@gnome.org>

	* configure.in : post release version bump

2002-11-15  Jody Goldberg <jody@gnome.org>

	* Release 1.1.12

2002-11-14  Jon K Hellan  <hellan@acm.org>

	* src/gui-file.c (gui_file_open): Use get_file_openers instead of
	get_file_importers.

	* src/plugin-service.c (struct _PluginServiceFileOpener):
	can_open, can_import, default_importer_priority: Remove.
	(plugin_service_file_opener_read_xml)
	(plugin_service_file_opener_read_xml): Ignore "open" and "import"
	properties.
	(plugin_service_file_opener_activate): Don't use
	register_file_opener_as_importer or
	register_file_opener_as_importer_as_default.

	(plugin_service_file_opener_deactivate): Don't use
	unregister_file_opener_as_importer.

	* src/file.[ch] (get_default_file_importer,
	register_file_opener_as_importer,
	register_file_opener_as_importer_as_default,
	unregister_file_opener_as_importer, get_default_file_importer,
	get_file_importers): Remove

	* src/file.c (default_file_importer_list, file_importer_list,
	default_file_importer_cmp_priority,): Remove.

	* src/stf.c (stf_init):
	s/register_file_opener_as_importer_as_default/
	register_file_opener/

2002-11-14  Jon K Hellan  <hellan@acm.org>

	* src/file.c (gnum_file_opener_probe_real): Seek back
	to start of file after probing.

	* src/plugin-service.c (gnum_plugin_file_opener_probe): Ditto.

2002-11-14  Jody Goldberg <jody@gnome.org>

	* src/gui-util.c (gnumeric_keyed_dialog) : add a weakpointer to the
	  wbcg in case it goes away before the dialog.  Use data_set_full in
	  place of a destroy handler.

2002-11-14  Morten Welinder  <terra@diku.dk>

	* src/search.c (search_replace_compile): Turn on regutf8.

2002-11-13  Jody Goldberg <jody@gnome.org>

	* src/expr.c (gnm_expr_eval) : functions only check for NULL not empty.

2002-11-13  Jon K Hellan  <hellan@acm.org>

	* src/GNOME_Gnumeric.xml: Remove FileImport.

	* src/gui-file.h (gui_file_import): Remove.

	* src/gui-file.c (make_format_chooser): Include an "Automatically
	detected" menu item for NULL in file opener/saver list.
	(gui_file_open, gui_file_import): Merge into one function, named
	gui_file_open. Default to automatically detecting format.

	* src/workbook-control-gui.c (cb_file_import): Remove.
	(workbook_menu_file[]): Remove cb_file_import.
	(verbs[]): Remove FileImport.

2002-11-12  Jody Goldberg <jody@gnome.org>

	* src/mstyle.c (mstyle_element_dump) : polish up a bit.

2002-11-11  Jody Goldberg <jody@gnome.org>

	* src/sheet-style.c (sheet_style_get_extent) : optionally take the
	  most common style into account when calculating extents.  The
	  default style for a column does not contribute to its extent.

	* src/parser.y (fold_negative) : new.
	(unary negative) use it here.
	(array_exp) : and here.
	(yylex) : do _not_ handle negatives here.

2002-11-11  Jody Goldberg <jody@gnome.org>

	* src/preview-grid.c : convert to GObject

2002-11-10  Jody Goldberg <jody@gnome.org>

	* src/rendered-value.c (rendered_value_calc_size_ext) : cells with
	  embedded new lines will potentially be narrower than the cell,
	  but still require multiple lines.

2002-11-10  Jody Goldberg <jody@gnome.org>

	* src/parser.y (yylex) : fix the handling of negative numbers in
	  inline arrays.

2002-11-08  Jody Goldberg <jody@gnome.org>

	* src/stf.c (stf_preparse) : quicky fix for 97672.  Pending removal of
	  this limitation.

2002-11-07  Jody Goldberg <jody@gnome.org>

	* src/item-edit.c (item_edit_draw) : fix bounding box.

2002-11-07   Andreas J. Guelzow  <aguelzow@taliesin.ca> for
	Evert Verhellen <evert.verhellen@advalvas.be>:

	* src/pixmaps/function_selector_24.png : improved
	* src/pixmaps/function_selector_16.png : improved

2002-11-07   Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/file.h (gnum_file_saver_fix_file_name): change signature
	* src/file.c (gnum_file_saver_fix_file_name): change signature
	  and return FALSE if non-matching extension
	* src/gui-file.c (do_save_as): watch for non-matching extensions

2002-11-07  Morten Welinder  <terra@diku.dk>

	* src/mathfunc.c (beta, lbeta): New functions.

2002-11-07  Morten Welinder  <terra@diku.dk>

	* src/file.c (gnum_file_saver_get_description): Fix failure case.
	(gnum_file_saver_get_extension): Ditto.
	(gnum_file_saver_get_mime_type): Ditto.
	(gnum_file_saver_get_id): Ditto.

2002-11-06  Jody Goldberg <jody@gnome.org>

	* src/plugin.c (ghf_collect_new_plugins) : don't bother copying ids
	  for reading later.  Respect the new require_explicit_enabling flag
	  so that a plugin like a real time data feed or corba interface will
	  only be enabled if the user explicitly requests it.
	(plugins_init) : Do active plugins 1st and don't free things, that
	  memory belongs to the Application.  Then do the new plugins and
	  don't bother copying then freeing memory.

2002-11-06  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (cb_clear_rendered_values) : new.
	(sheet_range_calc_spans) : this should be renamed eventually.
	  It no longer calculates the spans, rather it just honours the flags
	  and queues the respan or render as necessary.
	(sheet_clear_region) : just queue things.

	* src/sheet-merge.c (sheet_merge_add) : do it the easy way and just
	  queue all the rows for respan.  No need to do all the work to work
	  out this set.

	* src/clipboard.c (clipboard_paste_region) : just flag the render/span
	  it will happen when necessary.

2002-11-06  Morten Welinder  <terra@diku.dk>

	* src/mathfunc.c (random_exppow_pdf): Use lgammagnum, not lgamma.
	(combin): Ditto.
	(permut): Ditto.
	(fact): Ditto.

2002-11-06  Jody Goldberg <jody@gnome.org>

	* src/item-*, src/*canvas* : convert to foocanvas

	* src/application.c (gnumeric_application_setup_icons) : Use new
	  scaled pngs for formula guru.
	* src/pixmaps/Makefile.am : ditto.

	* src/plugin.c (plugin_info_read) : add 'require_explicit_enabling' flag
	  so that we don't auto enable specialized plugins.

	* src/plugin-service.c (input_file_save_info_read) : delete.
	(plugin_service_file_opener_read_xml) : don't call it here.
	(gnum_plugin_file_opener_open) : And don't try to use it here.
	  It is not useful to hard code the saver if the importer can handle
	  multiple versions of the format.  Only the import process will know
	  enough to be able to select the appropriate exporter.

	* src/item-cursor.c (item_cursor_tip_setlabel) : simplify.
	* src/auto-format.c : tidy up includes.

2002-11-06   Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/stf.c (stf_init) : text export is lossy too. (78356)

2002-11-06   Andreas J. Guelzow  <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=78356
	* src/workbook-view.c (wb_view_save_as) : don't mark the
	  workbook clean unless we saved under the new name.

2002-11-06  Jon K Hellan  <hellan@acm.org>

	* configure.in: Fix gda configure switch.

2002-11-05   Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/workbook-edit.c (wbcg_set_entry) : stop editing before
	  changing the entry.

2002-11-05   Andreas J. Guelzow  <aguelzow@taliesin.ca> for:
	Olaf Till <i7tiol@t-online.de>

	* src/regression.[ch] (logarithmic_regression,
	  logarithmic_fit): New functions.

2002-11-04  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* configure.in (CFLAGS): Switch POSIX and BSD checks.

2002-11-04  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* src/application.c, src/auto-format.c, src/cell.c, src/cellspan.c,
	  src/colrow.c, src/command-context-stderr.c, src/command-context.c,
	  src/commands.c, src/complete.c, src/consolidate.c, src/io-context.c,
	  src/tools/analysis-tools.c, src/tools/auto-correct.c,
	  src/tools/random-generator.c, src/tools/simulation.c,
	  src/dependent.c, src/expr.c, src/expr-name.c src/format-template.c:
	  Annotate unused parameters.
	* src/expr-name.h.c, src/gnumeric-graph.c, src/sheet-view.c: Included
	  headers for some standard library functions.

2002-11-04  Morten Welinder  <terra@diku.dk>

	* src/func.h: Add GNM_FUNC_AUTO_UNKNOWN.

	* configure.in (CFLAGS): Check for magic to get fdopen prototype.

2002-11-03  Morten Welinder  <terra@diku.dk>

	* src/func.h: Add type flags here.
	* src/auto-format.h: Delete from here.

	* src/func-builtin.c (func_builtin_init): Switch to using function
 	flags for SUM's type.

	* src/libgnumeric.c (gnm_common_init): No longer need to init
 	auto-format.
	(gnm_shutdown): No longer need to shut it down either.

2002-11-03  Jody Goldberg <jody@gnome.org>

	* src/mstyle.c : Add hooks for rotation.

	* src/workbook-control-gui.c (workbook_setup_edit_area) : simplify.
	(edit_area_button) : Use stock images, not stock items.

2002-11-03  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* src/gnumeric.h: Make it possible to use __attribute__ even if the
	  compiler happens not to understand it.

2002-11-02  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (workbook_control_gui_ctor_class) :
	  Use gtk_window_set_default_icon_list directly.

2002-11-02  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* acconfig.h: obsoleted.
	* configure.in: Added template descriptions to AC_DEFINE and
	  AC_DEFINE_UNQUOTED to obsolete acconfig.h .
	  Removed AC_ARG_PROGRAM as AM_INIT_AUTOMAKE already calls it on our
	  behalf.
	  Actually honour --enable-compile-warnings=... .
	  Upped libgsf(-gnome) checks to consistently require 1.5.0 or newer.
	* src/parse-util.h, src/regutf8.c, src/regutf8.h: Don't use // comments.
	* src/func.c (gnm_func_group_remove_func),
	  src/parse-util.c (wbref_parse),
	  src/plugin.c (gnm_plugin_type_module_load,
	  gnm_plugin_type_module_unload): Made static.
	* src/gnumeric-gconf.h: Added gnm_gconf_get_printer_command prototype.
	* src/sheet.h: Added sheet_redraw_headers prototype.
	* src/xml-io.c (xml_check_version, xml_workbook_write,
	  xml_workbook_read, gnumeric_xml_read_workbook,
	  gnumeric_xml_write_workbook): Made static.
	* src/xml-io.c: Casts and type changes to fix signedness.

2002-11-01  Jody Goldberg <jody@gnome.org>

	* src/item-grid.c (item_grid_realize) : move setting the background
	  to white from here.
	* src/gnumeric-canvas.c (gnm_canvas_realize) : to here where it makes
	  more sense.

	* src/xml-io.c (xml_write_style) : simplify handling of validation.

	* src/mstyle.c (mstyle_new_default) : store NULL validation.
	(mstyle_set_validation) : accept NULL.

2002-11-01  Morten Welinder  <terra@diku.dk>

	* src/search.c (search_filter_matching): Handle locus.  Search
	expression results if requested.
	(search_replace_cell): Handle locus.
	(search_replace_value): New function.

	* src/search.h: Add possibility of searching expressions' results.

2002-11-01  Jody Goldberg <jody@gnome.org>

	* configure.in : pos release version bump

2002-11-01  Jody Goldberg <jody@gnome.org>

	* Release 1.1.11

2002-10-31  Jody Goldberg <jody@gnome.org>

	* src/rendered-value.c (cell_get_entered_text) : only display the
	 leading quote for strings that might be misinterpretted.

	* src/workbook-control-gui.c (cb_autosum) : force focus back onto the
	  sheet so that we can edit.

2002-10-31  Morten Welinder  <terra@diku.dk>

	* src/mathfunc.c (qgamma): Handle the scale parameter at the very
	end; just work with unit scale.

	* src/func.c (function_def_get_arg_type): Do something sane for
	NODES functions.

2002-10-31  Jody Goldberg <jody@gnome.org>

	* src/item-edit.c (scan_for_range) : merge a pile of 1 time routine
	  together to make it clearer what they are trying to do.  I still
	  don't think this belongs here but at least its getting easier to
	  read.

	* src/workbook-edit.c (wbcg_edit_finish) : allow a user to enter "-"
	  without a hassle.  If a user accepts the result of a parse error
	  as a string restore focus to the sheet.  The patch that focused on
	  the entry would confuse things, and we would pop backinto edit mode.

	* src/gnumeric.h : Bring things back down to 256x64k memory usage is
	  still too high.

2002-10-30  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* debian/TODO, debian/gnumeric.postinst: New.
	* debian/gnumeric-doc.doc-base: Removed.
	* debian/README.Debian, debian/changelog, debian/control,
	  debian/gnumeric-doc.dirs, debian/gnumeric-doc.files, debian/rules:
	  Updated.

2002-10-30  Morten Welinder  <terra@diku.dk>

	* src/workbook-edit.c (entry_changed): Ditto.
	(wbcg_edit_start): Ditto.

	* src/func.c (tokenized_help_new): Make UTF-8 safe.

	* src/cell-draw.c (cell_split_text): Fix isspace check and
	eliminate ctype.h usage.
	* src/print-cell.c (cell_split_text): Ditto.
	* src/rendered-value.c (rendered_value_calc_size_ext): Ditto.

	* src/gutils.c (gnm_mem_chunk_free): Debugging improvement.

	* src/mathfunc.c (qgamma): New implementation.

2002-10-30  Jody Goldberg <jody@gnome.org>

	* src/complete-sheet.c (complete_sheet_search_iteration) : only kick
	  the autofill in after 3 characters.

	* src/item-edit.c (item_edit_draw) : respect more of the style
	  settings including v-alignment, underline, strikethrough, and
	  colours.

2002-10-29  Jody Goldberg <jody@gnome.org>

	* src/workbook-edit.c (workbook_edit_complete_notify) : force an
	  update.  This is kinda ugly but the entire mechanism needs cleanup
	  to make it less gtk specific.

	* src/item-edit.c (item_edit_draw) : create our own layout to handle
	  autocomplete text.

	* src/cell.c (cell_cleanout) : don't crash on cell regions.

2002-10-29  Morten Welinder  <terra@diku.dk>

	* src/dependent.c (dep_collection_release): New macro.
	(unlink_single_dep): Release the collection.
	(MICRO_HASH_hash): Be sane.

2002-10-28  Jody Goldberg <jody@gnome.org>

	* src/dependent.c (link_expr_dep) : DEPENDENT_USES_NAME flag.
	(cb_name_invalidate) : no need to short circuit anything.  All the
	  deps are already unlinked.
	(do_deps_destroy) : make sure to unlink things that use names from
	  other sheets so that they don't have stale deps in their
	  GnmNamedExpr::dependents hash.

2002-10-28  Morten Welinder  <terra@diku.dk>

	* src/xml-io.c (xml_sheet_write): fix number of cells.

2002-10-28  Jody Goldberg <jody@gnome.org>

	* src/ranges.c (global_range_parse) : don't create names.
	(global_range_list_parse) : ditto.

	* src/gnumeric.h : Bump the max size

	* src/cell.c (cell_cleanout) : mark the row for respan.

	* src/func.c (gnm_func_add_placeholder) : init ref_notify to NULL
	  explicitly.
	(function_remove) : free the name if necessary.

	* src/print.c (print_job_info_set_one_time_defaults) : patch warning.

	* src/cellspan.c (row_calc_spans) : even merges need to be rendered.

	* src/cell-draw.c (cell_draw) : item-grid takes care of the
	  render/span.
	* src/print-cell.c (print_cell) : ditto.

	* src/print-cell.c (print_cell_range) : check for render/span _before_
	  merges.
	* src/item-grid.c (item_grid_draw) : ditto.

2002-10-27  Jody Goldberg <jody@gnome.org>

	* src/dependent.c (dependents_link) : new.
	(cb_collect_deps_of_name) : new.
	(cb_collect_deps_of_names) : new.
	(cb_name_invalidate) : short circuit unlink/relink of name deps.
	(do_deps_destroy) : do it en-mass here.

2002-10-27  Jody Goldberg <jody@gnome.org>

	* Release 1.1.10

2002-10-26  Jody Goldberg <jody@gnome.org>

	* src/Makefile.am : Add input-msg.[ch]
	* src/input-msg.c : new.  Quick place holder.

2002-10-26  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (copy_hash_table_to_ptr_array) : Add trivial test to
	  keep blank cells out of the output.

	* src/sheet.c (sheet_regen_adjacent_spans) : Morten found a typo.

2002-10-24  Jody Goldberg <jody@gnome.org>

	* src/dependent.c (link_cellrange_dep) : jonkare found a typo.
	  Thanks that will make life easier when we start using this flag.

2002-10-25  Morten Welinder  <terra@diku.dk>

	* src/sheet-object-image.c (sheet_object_image_new_view): Plug
	leak.

	* src/position.c (cellref_make_abs): Fix col/row confusion.

2002-10-24  Morten Welinder  <terra@diku.dk>

	* src/print-info.c (render_opcode): Unconstify opcode arg since
	it is being changed.
	(hf_format_render): Simplify.

	* configure.in (with_long_double): Check for lgammal.

	* src/numbers.h (lgammagnum): define.

	* src/search.c (search_replace_string): Avoid matching the empty
	string at the end of the source after we have done a replacement.
	(Replace ".*" by "42" in "0.988" should not yield two copies
	of the replacement.)

	* src/xml-io.c (xml_cell_set_array_expr): Create place-holders for
	unknown functions (that were presumably known when we saved the
	file in question).
	(xml_read_cell): Ditto.
	(xml_read_cell_copy): Ditto.
	(xml_read_names): Ditto.
	(xml_read_style): Ditto.

	* src/expr-name.c (gnm_named_expr_collection_check): Compare in a
	different order so purify doesn't misunderstand gcc's smart code.

	* src/expr.c (gnm_expr_eval): Debug default cases.
	(do_gnm_expr_unref): Ditto.

	* src/dependent.c (unlink_expr_dep): Ditto.
	* src/summary.c: Ditto.
	* src/mstyle.c (mstyle_hash): Ditto.
	(summary_item_free): Ditto.
	(summary_item_as_text): Ditto.
	(summary_item_copy): Ditto.

2002-10-23  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c : disable GNM_EXPR_PARSE_UNKNOWN_NAMES_ARE_STRINGS
	  All we really needed was simple value matching before
	  stringification.

	* src/xml-io.c (cb_xml_write_name) : split out of.
	(xml_write_names) : here.  rewritten to handle the hashes.

2002-10-23  Morten Welinder  <terra@diku.dk>

	* src/func.c (functions_shutdown): Get rid of the global symbol
	table.

	* src/style.c (style_font_new_simple): Don't create a layout until
	we know we have a font.  Get rid of pango context for negative
	hash entries.
	(style_shutdown): Complain if we leak style font refs.

2002-10-23  Jody Goldberg <jody@gnome.org>

	* src/sheet-merge.c (sheet_merge_add) : improve warning.

	http://bugzilla.gnome.org/show_bug.cgi?id=96617
	* src/gnumeric-pane.c (cb_sheet_object_canvas_event) : Fully init
	  object drag here too.

	* src/workbook.c (workbook_foreach_cell_in_range) : fix.

	* src/position.c (rangeref_normalize) : fix.

	* src/validation.c (validation_eval) : don't unref the val expr too
	  early.

2002-10-21  Jody Goldberg <jody@gnome.org>

	* src/gui-file.c (gui_file_read) : handle workbooks with no sheets.
	* src/workbook-control-gui.c (wbcg_focus_cur_scg) : ditto.
	(show_gui) : ditto.

2002-10-21  Jody Goldberg <jody@gnome.org>

	* src/rendered-value.h : don't use short for width.

	* src/workbook.c (workbook_set_placeholder) : new.
	(workbook_is_placeholder) : ditto.

	* src/gui-util.c (cb_parent_mapped) : new utility.
	(gnumeric_set_transient) : handle the case where we are a transient
	  child of an unmapped parent.

	* src/expr.c (gnm_expr_equal) : name comparison should take scoping
	  into account too.
	(do_expr_as_string) : and here.
	(ets_hash) : use the name itself as a hash key.

	* src/expr-name.c (expr_name_add) : return a copy of the error
	  message.  And ensure that all NULL returns generate errors.
	(expr_name_new) : make this static and internal.
	(name_print_area) : delete.

	* src/dependent.c (workbook_unlink_3d_dep) : during destruction the
	  order hash may be gone.  This happens with names that contain 3d
	  references.

2002-10-17  Jody Goldberg <jody@gnome.org>

	* src/plugin-service.c (gnum_plugin_file_opener_open) : store the save
	  info before we load so that the file name is valid.

2002-10-20  Morten Welinder  <terra@diku.dk>

	* src/expr-name.c (expr_name_by_name): Sort case insensitively and
	take sheets into account.

	* src/gutils.c (gnumeric_utf8_collate_casefold): New function.

2002-10-18  Morten Welinder  <terra@diku.dk>

	* src/auto-format.c (auto_format_init): Make table case sensitive.

	* src/gui-file.c (file_opener_description_cmp): Make UTF-8 safe.
	(file_saver_description_cmp): Ditto.
	* src/func.c (function_category_compare): Make UTF-8 safe.
	* src/value.c (value_diff): Make UTF-8 safe.

	* src/value.c (value_compare): Make UTF-8 safe.

	* src/plugin-service.c (gnum_plugin_file_opener_probe): Use
	g_utf8_strdown, not g_strdown.

	* src/format.c (format_month_before_day): Eliminate tolower and
	make UTF-8 safe.  Hopefully.
	(append_year): Ditto.
	(append_day): Ditto.
	(format_compile): Ditto.
	(format_number): Ditto.
	* src/number-match.c (format_create_regexp): Ditto.

2002-10-18  Morten Welinder  <terra@diku.dk>

	* src/sheet.c (sheet_name_quote): Make this UTF-8 safe.
	* src/parse-util.c (cellref_a1_get): Eliminate use of toupper and
	isdigit.  Should be UTF-8 safe now.
	(cellpos_parse): Ditto.
	* src/parse-util.c (r1c1_get_item): Ditto for isdigit.

2002-10-18  Morten Welinder  <terra@diku.dk>

	* src/expr.c (gnm_expr_get_constant): New function.

	* src/stf.c (stf_open_and_read): Seek to beginning of input, just
	in case.
	(stf_read_default_probe): Don't probe at file name level.

2002-10-17  Morten Welinder  <terra@diku.dk>

	* src/sheet.c (sheet_rename): Make sure workbook's sheet name hash
	stays valid.

2002-10-17  Morten Welinder  <terra@diku.dk>

	* src/expr-name.c (expr_name_by_name): New function.

2002-10-17  Jody Goldberg <jody@gnome.org>

	* src/expr-name.c (name_print_area) : Print_Area is a command to the
	  print system regarding what to print.  It does not return the area
	  that would be printed.

2002-10-17  Jody Goldberg <jody@gnome.org>

	* src/workbook-edit.c (wbcg_edit_finish) : adjust to changes in
	  ParseError and tweak focus handling when user decides to re-edit so
	  that we actually select what we want to.

	* src/parse-util.c (parse_error_init) : Use a GError for the error
	  message to clarify life cycle.
	(parse_error_free) : ditto.

	* src/item-edit.c (item_edit_cursor_blink_start) : simple support for
	  xsettings.

	* src/expr.c (do_expr_as_string) : sync the precedence with the parser.
	(do_expr_as_string) : Always qualify a sheet local name from another
	  sheet.

2002-10-16  Jody Goldberg <jody@gnome.org>

	* src/parser.y : Fix precedences and associativity
	Revamp error reporting to make sense.
	Tify up the code a bit.
	(sheetref) : remove the 3d productions.  We no longer need them
	(workbookref) : add a new production to simplify error reporting.


2002-10-15  Jody Goldberg <jody@gnome.org>

	* src/value-sheet.c (value_area_foreach) : Add CellIterFlags

2002-10-15 Christopher Benedict <cbenedic@csa.concordia.ab.ca>

	* src/sheet-object-widget.c (cb_frame_config_distroy): new
	(cb_frame_set_focus): new
	(cb_frame_config_ok_clicked): new
	(cb_frame_config_cancel_clicked): new
	(cb_frame_label_changed): new
	(sheet_widget_frame_user_config): new

2002-10-14  Jody Goldberg <jody@gnome.org>

	* src/commands.c (update_after_action) : quick and dirty support for
	  manual recalc.
	(cmd_paste_cut_update_origin) : ditto.

2002-10-14  Morten Welinder  <terra@diku.dk>

	* src/regression.c (non_linear_regression): Use gnumabs.

	* src/mathfunc.c (random_logistic): Use loggnum.

	* src/regression.c (parameter_errors): Use sqrtgnum.

	* src/format.c (fmt_general_int): Handle -2^31 correctly.

	* src/datetime.c (datetime_serial_raw_to_serial): Use floorgnum,
	not floor.
	(datetime_serial_raw_to_seconds): Ditto.

2002-10-14  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c : Have the gnumeric-1.0 importer use that flag

	* src/parser.y (parser_simple_val_or_name) : optionally restore the
	  old 'unknown names are strings' behavior.

2002-10-14  Jody Goldberg <jody@gnome.org>

	* src/workbook.c (workbook_calc_spans) : delete.

	* src/stf.c (stf_read_workbook_auto_csvtab) : use the new delayed
	  respan option.
	(stf_read_workbook) : ditto.

2002-10-14  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c : Add links for
	    Data -> Text To Columns
	    Data -> Import External -> From File
	Only partially implemented in the last hour, but these are just too
	easy to pass up.

	* src/stf.c (stf_store_results) : new, split out of.
	(stf_read_workbook) : here.
	(cb_get_content) : new utility.
	(stf_text_to_columns) : new.  Only partially done.
	  We still need a way to get the target region.

	* src/stf-parse.c (stf_parse_sheet) : take a starting offset for the
	  output, and return a boolean in place of the sheet that was passed in.

	* src/sheet.c (sheet_queue_respan) : new.

	* src/selection.c (selection_first_range) : start cleanup and take a
	  CommandContext rather than a Control.

	* src/gui-util.c (gnumeric_notice) : Cheat and access the private
	  label member to set it to accept markup.

	* src/commands.c (cmd_area_set_text_redo) : a nifty optimization.
	  Just redraw all and queue respanning for the effected regions.

	* src/GNOME_Gnumeric.xml : Add entries for Text to columns and
	  External Data -> Import from File

2002-10-14  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_view_freeze_panes) : only center if
	  we are in the top left, else do H or V only.

	* src/sheet-view.c (sv_freeze_panes) : relax restrictions to allow for
	  H or V only freezing.

	* src/gnumeric-pane.c (gnm_pane_init) : control configuration of col
	  and row headers separately.
	* src/sheet-control-gui.c (scg_resize) : support H or V only freezing.
	(scg_set_panes) : ditto.
	(sheet_control_gui_new) : adjust to the new gnm_pane_init interface.
	(scg_set_left_col) : test for freezing distinctly from the existence
	  of pane 3.
	(scg_set_top_row) : test for freezing distincly from the existence of
	  pane 1.

2002-10-13  Jon K Hellan  <hellan@acm.org>

	* src/func.c (tokenized_help_new): Fix check for empty help string.

2002-10-12  Jody Goldberg <jody@gnome.org>

	* src/workbook-edit.c (wbcg_edit_finish) : clear the guru before
	  destroying it in case the destruction tries to finish editing too.

2002-10-12  Jody Goldberg <jody@gnome.org>

	* src/func-builtin.c (func_builtin_init) : jump to the new interface.

	* src/func.h : some renaming and api cleanup.
	  The big one was
	    s/ModulePluginFunctionInfo/GnmFuncDescriptor/
	  Some extension of that structure to add additional fields (at the
	  end) and api changes to use it pervasively.  This includes
	  placeholders for function flags, and implementation and testing
	  status.

	  Some general cleanup with
	    s/FunctionDefinition/GnmFunc/
	    s/func_lookup_by_name/gnm_func_lookup/
	    s/function_add_placeholder/gnm_func_add_placeholder/
	    s/function_def_get_name/gnm_func_get_name/
	    s/function_def_set_user_data/gnm_func_set_user_data/
	    s/function_def_get_user_data/gnm_func_get_user_data/

	  remove function_add_args vs function_add_nodes and replace them with
	  a GnmFuncDescriptor based gnm_func_add

2002-10-12  Jody Goldberg <jody@gnome.org>

	* src/cellspan.c (row_calc_spans) : some simple optimizations
	  to prune the length we check based on col/row maxima and sparseness.
	  This can be significantly faster when we add per row maxima.

	* src/symbol.c (symbol_install) : use g_warning and table_replace in
	  case of a collison.

	* src/format.c (format_number) : Make UTF-8 clean

	* src/sheet-control-gui.c (scg_set_panes) : more initial work on
	  supporting h/v only freezing.

2002-10-11  Jody Goldberg <jody@gnome.org>

	* src/libgnumeric.c (gnm_dump_func_defs) : add a flag to indicate
	  dumping def or status
	* src/func.c (function_dump_defs) : ditto.
	* src/main-application.c (main) : add --func-state-dump

2002-10-11  Morten Welinder  <terra@diku.dk>

	* configure.in (have_ld): Check for fmodl.
	* src/numbers.h: Supply fmodgnum.
	* src/gutils.c (g_strsplit_to_list): Delete.

2002-10-11  Jon K Hellan  <hellan@acm.org>

	* configure.in: Remove plugins/python/Makefile

2002-10-11  Jon K Hellan  <hellan@acm.org>

	* plugins/Makefile.am: Remove old Python plugin

2002-10-11  Morten Welinder  <terra@diku.dk>

	* src/numbers.h (gnum_int): Kill.  All users fixed.

	* src/numbers.h (finitegnum): Attempt a solution for the
	finite/isfinite/FINITE circus.  (All callers should just use
	finitegnum.)

	* src/mathfunc.c (gpow2): Use ldexpgnum when available.

2002-10-10  Jody Goldberg <jody@gnome.org>

	* src/expr-sheet.c (value_intersection) : move here and privatize.

	* src/func.c (function_call_with_list) : fence post error.  The first
	  missing arg can be empty.  While we're here fix the precedence error
	  that was breaking missing default args.  Remove use of
	  value_intersection.  gnm_expr_eval handles it (I hope)

	* src/expr.c (gnm_expr_eval) : support depends for constructed ranges too.

2002-10-10  Jody Goldberg <jody@gnome.org>

	* src/value-sheet.c (value_intersection) : move here and rework to
	  support singletons.

	* src/parser.y (parser_simple_val_or_name) : rename from
	  parser_lookup_name and restore some of the value matching semantics
	  so that we handle booleans again.  I'm not sure the error handling
	  will kick in but it too is good.  the duble and int comparisons
	  should be useless.  We can optimize things a bit by making a
	  special case routine and removing those.

	* src/expr.c (gnm_expr_eval) : handle dynamic depends and intersection
	  for the results.
	NOTE WARNING WARNING WARNING : change of semantics
	  In the permit_non_scalar case we do _not_ ensure that the content of
	  the range has been evaluated.  The user is required to.  We only
	  handle that in the intersection case.
	For constant cellranges we now use value_intersection too.

	* src/dependent.c (dependent_types_init) : register DynamicDep
	(dependent_queue_recalc_list) : when we find a dynamic depend queue
	  its container.
	(dependent_queue_recalc) : rename from cb_dependent_queue_recalc and
	  remove the ignored argument the compiler can handle it.
	(dynamic_dep_debug_name) : new.
	(dependent_add_dynamic_dep) : new.
	(dynamic_dep_free) : new.
	(dependent_clear_dynamic_deps) : new.
	(dependent_unlink) : clear dynamic depends if they exist.
	(cell_eval_content) : clear dynamic depends before we start to
	  evaluate.  They get regenerated by evaluation and we are already know
	  that we need to recalc, so there is no need to keep them.
	(dependent_eval) : ditto.  duplicate the code to keep the semantics of
	  cell_eval_content tidy.
	(do_deps_destroy) : drop the dynamic depend table.
	(gnm_dep_container_new) : initialize it here.

2002-10-10  Morten Welinder  <terra@diku.dk>

	* src/rangefunc.c (product_helper): New function.
	(range_geometric_mean): Improve precision.
	(range_product): Improve precision.

2002-10-10  Andreas J. Guelzow

	http://bugzilla.gnome.org/show_bug.cgi?id=95333
	* src/item-grid.c (item_grid_button_press): do not start editing if
	  the second half of a double click is in a different cell.

2002-10-09  Morten Welinder  <terra@diku.dk>

	* src/gnumeric-graph.c (struct _GnmGraphVector): Avoid "gboolean
	... : 1".
	* src/item-bar.c (struct _ItemBar): Ditto.
	* src/item-cursor.c (struct _ItemCursor): Ditto.
	* src/formats.h (FormatCharacteristics): Ditto.
	* src/format-template.h (struct _FormatTemplate): Ditto.
	* src/sheet-private.h (struct _SheetPrivate): Ditto.
	* src/sheet-view.h (struct _SheetView): Ditto.
	* src/validation.h (struct _Validation): Ditto.
	* src/workbook-priv.h (struct _Workbook): Ditto.
	* src/expr-name.h (struct _GnmNamedExpr): Ditto.

2002-10-09  Jody Goldberg <jody@gnome.org>

	* src/commands.c (cmd_define_name_redo) : fix ref counting.
	(cmd_define_name_undo) : and here.

2002-10-08  Jody Goldberg <jody@gnome.org>

	* src/format.c (do_render_number) : Use the scale factor.
	(format_number) : init the scale factor when a fmt ends a section with
	  a comma.

2002-10-08  Morten Welinder  <terra@diku.dk>

	* src/workbook-view.c (wb_view_new_from_file): Catch invalid file
	names.

	* src/gutils.c (gnumeric_valid_filename): New function.

2002-10-08  Jody Goldberg <jody@gnome.org>

	Patch from peninguy.nicolas@wanadoo.fr (Nicolas Peninguy)
	* src/formats.c : regexp for accounting too.

2002-10-08  Jody Goldberg <jody@gnome.org>

	* src/parse-util.c (rangeref_parse) : handle relative full col/row
	  references.

2002-10-08  Jody Goldberg <jody@gnome.org>

	* src/parser.y (parser_lookup_name) : default the placeholder to be at
	  workbook scope.

	* src/cellspan.c (row_calc_spans) : new.

	* src/dependent.c (cell_eval_content) : flag the row as needing
	  respan.  I'll probably want to distinguish between span and render
	  somehow.

	* src/sheet.c (sheet_update_only_grid) : test a new idea for doing
	  just in time spanning.  It does not support a true model view split
	  of the rendering.  However, it does delay the render & span until
	  the row is visible, and as a result it is feasible to support
	  spanning expressions.  The key is to flag the row as needing
	  respanning then doing the entire row in the redraw loop.
	* src/item-grid.c (item_grid_draw) : do a span recalc if necessary
	* src/print-cell.c (print_cell_range) : ditto.

	* src/workbook.c (workbook_init) : fix warning.

	* src/parser.y (parser_lookup_name) : remove implicit conversion of
	  unquoted strings that are not names into string values.  Replace it
	  with the creation of a placeholder name.  This is useful for parsing
	  expressions before a name has been declared.

	* src/cell.c (cell_set_value) : fix docs.

	* src/parse-util.c (col_parse) : don't get confused when parsing an
	  absolute _row_ (yes I mean row) ref.  $3 would see the dollar then
	  fail, but would return a col of -1.
	(check_quoted) : fix stupidity.  Return the char after the last quote.

2002-10-07  Morten Welinder  <terra@diku.dk>

	* src/value.c (value_zero): New variable.
	* src/value-sheet.c (value_area_fetch_x_y): Use global value_zero.

2002-10-06  Jody Goldberg <jody@gnome.org>

	Patch from peninguy.nicolas@wanadoo.fr (Nicolas Peninguy)
	* src/formats.c : replace the currency format classification engines
	  with a cleaner, more accurate regexp based approach.

2002-10-04  Jody Goldberg <jody@gnome.org>

	* src/workbook.c (workbook_metadata) : new.

2002-10-04  Jody Goldberg <jody@gnome.org>

	* src/gutils.c (gnumeric_strcase_hash) : Mark for fixing.

	* src/dependent.c (workbook_link_3d_dep) : disable unlinking during
	  reordering.
	(workbook_unlink_3d_dep) : disable unlinking during reordering.

	* src/commands.c (cmd_rename_sheet) : use workbook_sheet_by_name.

	* src/sheet.c (sheet_rename) : store a case insensitive key.
	(sheet_new) : ditto.
	(sheet_destroy) : clear the name.

	* src/workbook.c (workbook_sheet_reorder) : add missing call to
	  pre_sheet_index_change.
	(workbook_init) : No need for case insensitive hashing the callers
	  will do the conversions.
	(pre_sheet_index_change) : flag the reorder so that we do not remove
	  the list of things we're reordering when they get unlinked.
	(post_sheet_index_change) : ditto.
	(workbook_sheet_by_name) : convert the target_name to casefolded form.
	(workbook_sheet_attach) : use the case folded form of the name as key
	  to the hash.
	(workbook_sheet_detach) : ditto.
	(workbook_sheet_reorganize) : ditto.

2002-10-04  Morten Welinder  <terra@diku.dk>

	* src/workbook-control-gui.c (show_gui): Adapt --geometry handling
	to gtk2.

2002-10-04  Jody Goldberg <jody@gnome.org>

	* src/parser.y (yylex) : reinstate optionally forcing abs references
	(yylex) : applix scatters random spaces throughout its
	  expressions but ignores them.
	(yylex) : extend handling of xml quoting and opencalc quoting of
	  strings in expressions.

2002-10-04  Jody Goldberg <jody@gnome.org>

	* src/workbook-control.c (wb_control_parse_and_jump) : use the new
	  undo support and handle assigning to a placeholder.

	* src/gnumeric-canvas.h : Clean up the naming convention to use
	  GnmCanvas in all locations.

	* src/expr-name.c (expr_name_add) : its ok if the expr is NULL create
	  a placeholder.
	(expr_name_is_placeholder) : new.

	* src/commands.c (CmdChangeSummary) : this has no business being
	  control specific.
	(CmdPrintSetup) : ditto.
	(CmdDefineName) : new.

	* src/command-context.c (gnumeric_error_calc) : new.
	(gnm_error_calc) : new.

2002-10-03  Jody Goldberg <jody@gnome.org>

	* src/format.c (format_get_currency) : convert locale's currency
	  symbol to UTF-8.
	(gnumeric_setlocale) : clear the cache currency symbol.

2002-10-03  Jody Goldberg <jody@gnome.org>

	* src/expr.c (gnm_expr_is_err) : new util.

2002-10-03  Morten Welinder  <terra@diku.dk>

	* src/parse-util.c (col_name_internal): Handle larger number of
	columns.

	* src/sheet-style.c (sheet_style_init): Warn if we have a conflict
	between column name TRUE and constant TRUE.

2002-10-03  Morten Welinder  <terra@diku.dk>

	* src/sheet-style.c (TILE_SIZE_COL, TILE_SIZE_ROW): Auto-size.

2002-10-02  Jody Goldberg <jody@gnome.org>

	* src/commands.c (cmd_reorganize_sheets) : DO NOT STORE CONTROL.
	  The command context of the inititing action should never be stored.
	  Undo should use the context from the control that initiated the
	  undo.

	* src/io-context-priv.h : Inherit from CommandContext and make our
	  lives easier.  Also avoid the pointless duplication.

	* src/command-context-priv.h : remove the plethora of err types in
	  favour of GError with a tag and ErrorInfo.
	  Protect cmd_context_progress_set, cmd_context_progress_message_set.
	* src/command-context-stderr.c : Adjust to the changes.

	* src/bonobo-io.c : IOContext inherits from CommandContext now use the
	  error handlers there.
	* src/plugin-util.c : ditto.
	* src/sheet-object-bonobo.c : ditto.
	* src/stf.c : ditto.
	* src/workbook-control-gui.c : ditto.
	* src/workbook-view.c : ditto.
	* src/xml-io.c : ditto.

2002-10-01  Jody Goldberg <jody@gnome.org>

	* src/pixmaps/Makefile.am : add the rest of the new artwork.

2002-10-01  Jody Goldberg <jody@gnome.org>

	* src/workbook.c (workbook_sheet_reorder) : take a workbook not a
	  control.

2002-10-01  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_insert_hyperlink) : hook up the
	  hyperlink dialog.

	* src/sheet-control-gui.c (context_menu_handler) : adjust to new
	  calling convention for dialog_hyperlink.

2002-09-30  Jody Goldberg <jody@gnome.org>

	* src/application.c (gnumeric_application_setup_icons) : add the new
	  icons.
	* src/pixmaps/Makefile.am : add the new protection icons

2002-09-30  Jody Goldberg <jody@gnome.org>

	Patch from : dorami@bu.iij4u.or.jp
	* src/gnumeric-canvas.c : re-enable IM support.

2002-09-30  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_editline_focus_in) : give the entry a
	  chance to handle the focus-in too.

2002-09-30  Morten Welinder  <terra@diku.dk>

	* src/GNOME_Gnumeric.xml: Fix case of Hyperlink.

2002-09-30  Jody Goldberg <jody@gnome.org>

	* configure.in : post release bump

2002-09-30  Jody Goldberg <jody@gnome.org>

	* Release 1.1.9

2002-09-29  Jody Goldberg <jody@gnome.org>

	* src/parse-util.c (gnm_1_0_rangeref_parse) : fix handling of error in
	  3d ref.
	(rangeref_parse) : ditto.

2002-09-29  Jody Goldberg <jody@gnome.org>

	* src/parse-util.c (gnm_1_0_rangeref_parse) : fix.
	(wbref_parse) : implement.

2002-09-29  Jody Goldberg <jody@gnome.org>

	* src/parse-util.c (wbref_parse) : document and fix a bit.  still
	  untested.
	(rangeref_parse) : touch up a bit.
	(gnm_1_0_rangeref_parse) : new, untested.

	* src/parser.y (gnm_expr_parse_str) : add
	  GNM_EXPR_PARSE_USE_OPENCALC_CONVENTIONS.  To hard code the
	  separators rather than extracting them from the locale.  Its quick
	  and dirty, but will do the job for now.  Later it would be nice to
	  abstract the parse state a bit more so that we don't need to
	  re-initialize every time.
	(yylex) : handle xml escaping for opencalc.

	* src/parse-util.c (row_parse) : fix.

2002-09-27  Jody Goldberg <jody@gnome.org>

	* src/expr-name.c (expr_name_create) : delete because it was hard
	  coding which rangeref parser to use.

2002-09-27  Jody Goldberg <jody@gnome.org>

	* src/parser.y : remove bogus error message and fix the other message
	  to be correct when faced with the wrong type of array separator.

2002-09-27  Jody Goldberg <jody@gnome.org>

	* src/value.c (value_coerce_to_number) : new.

2002-09-26  Lutz Müller <lutz@users.sourceforge.net>

	* src/workbook.[c,h]: New signals: "sheet_added" and "sheet_deleted".

2002-09-26  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/workbook.c (workbook_sheet_reorder): new
	(workbook_sheet_reorganize): extract reorder code into
	  workbook_sheet_reorder
	* src/workbook.h (workbook_sheet_reorder): new

2002-09-26  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_realize) : ok, the fix for
	  loading multisheet workbooks breaks if you load them directly.
	  Fix that.

	* src/parser.y (build_set) : remove unnecessary deallocation.

2002-09-26  Jody Goldberg <jody@gnome.org>

	* src/parser.y : Make the error handling more consistent.

	* src/expr.c (gnm_expr_list_as_string) : optimize.

	* src/dependent.c (link_expr_dep) : place holder for intersection.  I
	  think it is ok to palm all of this off until eval time (asusming we get
	  eval time depends working)

2002-09-26  Jody Goldberg <jody@gnome.org>

	* configure.in : add openoffice
	* plugins/Makefile.am (SUBDIRS) : add openoffice

2002-09-26  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_realize) : grab focus for current
	sheet.

2002-09-25  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/workbook.c (workbook_sheet_reorganize): add missing call
	  to post_sheet_index_change

2002-09-25  Jody Goldberg <jody@gnome.org>

	* src/expr.c (gnm_expr_is_rangeref) : new.

	* src/parser.y (yylex) : support space as the intersection operator.

2002-09-25  Jody Goldberg <jody@gnome.org>

	* src/parser.y : begin support for intersection and sets, still needs
	  lots of work, but I don't want to get too out of sync.

	* src/expr.c : handle intersection and sets.
	* src/expr-name.c (name_refer_circular) : ditto.

	* src/workbook.c (post_sheet_index_change) : don't emit the signal
	  during destruction.

2002-09-24  Lutz Müller <lutz@users.sourceforge.net>

	* src/dialogs/dialog-sheet-order.c: Be aware of changes in the
	  sheet order.
	* src/workbook.[c,h]: Provide a "sheet_order_changed" signal.
	* src/workbook-control-gui.c: Remove debugging messages. Allow
	  dropping the sheet anywhere in the workbook - reordering will still
	  be done.

2002-09-24  Morten Welinder  <terra@diku.dk>

	* src/parser.y (yylex): Handle error constants.  (And fix UTF-8
	strings.)

2002-09-24  Jody Goldberg <jody@gnome.org>

	* src/commands.c (cmd_area_set_text) : we can test for as_array here.
	  rather than in _redo.  Then make sure that array formulas are parsed
	  relative to the top left of the target region rather than the
	  edit_pos.

	* src/parser.y (build_range_ctor) : finish error message so that
	  things compile again.

2002-09-24  Jody Goldberg <jody@gnome.org>

	* src/parser.y : remove the rest of the CELLREF based productions.

	* src/parse-util.h : do a bit of tidying
	(col_parse) : make public.
	(row_parse) : make public.
	(cellpos_as_string) : rename from cell_pos_name.
	(cellpos_parse) : renamed from parse_cell_name
	(cellref_as_string) : rename from cellref_name
	(cellref_parse) : rename from cellref_get
	(parse_col_name) : delete duplicate
	(gnm_expr_char_start_p) : renamed from gnumeric_char_start_expr_p.

	* src/parse-util.c (rangeref_parse) : fix handling of non-3d
	  inter-sheet refs.
	(col_parse) : check for overflow.

	* src/parser.y : remove sheet_ref RANGEREF production. RANGEREF
	  already handles sheet references internally.

2002-09-23  Jody Goldberg <jody@gnome.org>

	* src/expr.c (gnm_expr_eval) : handle empties when implicit
	  intersection is valid but accesses an empty cell.

2002-09-23  Lutz Müller <lutz@users.sourceforge.net>

	* src/workbook-control-gui.c: Implement reordering of sheets via
	  drag & drop within workbooks.

2002-09-23  Jody Goldberg <jody@gnome.org>

	* src/sheet-view.c (sv_update) : see if there is a named expression that
	  matches the selection.
	* src/workbook-view.c (wb_view_selection_desc) : ditto.
	* src/expr-name.c (sheet_names_check) : new.

	* src/parse-util.c (cellref_a1_get) : add bound check for columns too.

	* src/func.c (function_call_with_list) : silence some pointless
	  warnings.
	* src/workbook-control-gui.c (workbook_menu_edit) : fix cut-n-paste-o.
	(cb_statusbox_focus) : Clear selection on focus out.  I'd like to
	  select everything on focus in, but gtkentry is not thrilled with
	  that.
	* src/workbook-control-gui.c (workbook_setup_edit_area) : connect
	  cb_status_box_focus.

2002-09-22  Jon K Hellan  <hellan@acm.org>

	* src/func.c (function_dump_defs): Re-enable function doc dumping.

2002-09-22  Jody Goldberg <jody@gnome.org>

	* src/parse-util.c (col_parse) : doh!

2002-09-20  Jody Goldberg <jody@gnome.org>

	* src/sheet-control-gui.c (context_menu_handler) : support clearing a
	  link and contect to the link editor dialog to add or edit one.

2002-09-20  Jody Goldberg <jody@gnome.org>

	* configure.in : extend the tests for graphing libraries.
	  Enable the corba plugin if the tools are in place.

2002-09-20  Jody Goldberg <jody@gnome.org>

	* src/GNOME_Gnumeric.xml : Use the stock jump-to icon
	* src/workbook-control-gui.c : ditto

2002-09-20  Jody Goldberg <jody@gnome.org>

	* src/plugin-util.c (gnumeric_mmap_error_info) : delete.

	* src/plugin-service.c (plugin_service_general_activate) : init error.
	(plugin_service_general_deactivate) : ditto.
	(gnum_plugin_file_opener_probe) : ditto.

2002-09-20  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c : Add entries for insert hyperlink to
	  toolbar and insert menu.
	* src/GNOME_Gnumeric.xml : ditto.
	* src/sheet-control-gui.c (scg_context_menu) : Use the new link icons.

2002-09-20  Jody Goldberg <jody@gnome.org>

	* src/print.c : revert to gnome-2-0 versions of gnome-print

	* src/application.c (gnumeric_application_setup_icons) : Add jimmac's
	  new hyperlink icons.
	* src/pixmaps/Makefile.am : ditto.

	* src/Makefile.am : remove the extra BONOBO libs that is now handled
	  correctly in configure.

	* configure.in : Prep for graphs
	    --with-graphs defaults to guppi, but can also be gtkextra-2
	    tidy up the compile/link line by being smarter, and merging in
	    the bonobo specific libs earlier
	    Enforce a gnome-2-0 limit on the printing libraries

2002-09-19  Morten Welinder  <terra@diku.dk>

	* src/dependent.c (micro_hash_remove): Plug leak.

2002-09-17  Zbigniew Chyla  <cyba@gnome.pl>

	* src/plugin-loader-module.c
	(gnumeric_plugin_loader_module_unload_service_function_group,
	gnumeric_plugin_loader_module_unload_service_ui): Removed.
	(gnumeric_plugin_loader_module_load_service_*):
	Set loader_data using g_object_set_data_full() so it gets destroyed
	together with service.

2002-09-17  Jody Goldberg <jody@gnome.org>

	* configure.in : remove idl dir as it starts to move to a plugin

	* src/application.c (application_workbook_list_remove) : fix typo.

2002-09-17  Jody Goldberg <jody@gnome.org>

	* src/application.c (gnumeric_application_class_init) : use
	  NONE__POINTER rather than NONE_OBJECT so that we can remove the
	  workbook during finalization.

2002-09-17  Jody Goldberg <jody@gnome.org>

	* configure.in : conditionally enable guppi

2002-09-17  Jody Goldberg <jody@gnome.org>

	* src/workbook.c (workbook_init) : no need to handle bonobo ness here.
	  we have signals now so things can be moved elsewhere.

	* src/gnm-marshalers.list : add NONE:OBJECT

	* src/bonobo-io.c : copy over remnants from workbook-private.
	* src/workbook-private.[ch] : delete

	* src/application.c (application_workbook_list_add) : emit signal.
	(application_workbook_list_remove) : emit signal.
	(application_workbook_list) : move workbook list into Application.
	(application_workbook_foreach) : ditto.
	(gnumeric_application_class_init) : add signals.

2002-09-17  Jody Goldberg <jody@gnome.org>

	* src/print.c (sheet_print) : tweak so that things compile again.

2002-09-16  Morten Welinder  <terra@diku.dk>

	* src/workbook.c (workbook_sheet_name_strip_number): Make UTF-8
	safe.

	* src/parse-util.c (check_quoted): Fix traversal right after
	backquote.
	(unquote): Make terminal \\ case match check_quoted.

2002-09-16  Morten Welinder  <terra@diku.dk>

	* src/parse-util.c (sheet_parse): Off by one bug.

2002-09-16  Morten Welinder  <terra@diku.dk>

	* src/bonobo-io.c (gnumeric_bonobo_read_from_stream): "Fix"
	warnings.

2002-09-16  Christian Neumair  <chris@gnome-de.org>

	* src/dialogs/*.glade: Made most dialogs HIG compliant.

2002-09-13  Jody Goldberg <jody@gnome.org>

	* src/workbook-view.c (wb_view_finalize) : detach the controls first.
	  before we start destruction.

	* src/sheet-control-gui.c (sheet_control_gui_new) : use connect_object
	  so that we only handle the destruction of the table while the
	  control exists.

	* src/workbook.c (workbook_detach_view) : remove the sheetviews
	  associated with this workbookview.

	* src/sheet-object.c (cb_sheet_object_remove) : don't unref,
	  cmd_object_delete handles that.

2002-09-13  Jody Goldberg <jody@gnome.org>

	* src/func.c (function_call_with_list) : support implicit iteration.

	* src/value-sheet.c (value_area_fetch_x_y) : catch value_empty too.

	* src/parse-util.c (col_parse) : don't change accept the column unless
	  at least 1 char was read.
	(row_parse) : ditto.
	(rangeref_parse) : off by 1 error when handling full ranges.

	* src/dependent.h (cell_eval) : make this a macro.

	* src/plugin-service.c (gnum_plugin_file_opener_probe) : silence a
	  warning.

	* src/expr.c (gnm_expr_eval) : rename from expr_eval_real and move the
	  empty handling into.
	(handle_empty) : here.
	(gnm_expr_array_intersection) : delete.

2002-09-11  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-graph.c (gnm_graph_new_view) : stub so that sheets with
	  graphs don't crash.
	(gnm_graph_update_bounds) : ditto.

2002-09-11  Jody Goldberg <jody@gnome.org>

	* src/expr.c (gnm_expr_eval) : move support for implicit intersection
	  here.

	* src/func.c (function_call_with_list) : merge the marshalling into
	  here in preparation for supporting implicit iteration.  Fix handling
	  of optional arguments.

2002-09-11  Jody Goldberg <jody@gnome.org>

	Patch from Jiri Jirat <Jiri.Jirat@systinet.com>
	* gnumeric.xsd  : fix schema errors

2002-09-11  Morten Welinder  <terra@diku.dk>

	* src/plugin-service.c (plugin_service_ui_activate): Plug leak.

	* src/workbook-control-gui.c (wbcg_finalize): Plug leak.

	* src/main-application.c (main): Shut down bonoboui for leak
	hunting.

2002-09-10  Jody Goldberg <jody@gnome.org>

	* src/parser.y (yylex) : parse full col/row references.
	  eg 2:2 or B:C

	* src/gui-clipboard.c (x_claim_clipboard) : offer content on both
	  primary and clipboard.

2002-09-10  Morten Welinder  <terra@diku.dk>

	* src/commands.c (cmd_set_text): Make UTF-8 safe.
	(cmd_area_set_text): Ditto.

2002-09-10  Morten Welinder  <terra@diku.dk>

	* src/sheet-object-image.c: Delete duplicate macros.

2002-09-10  Morten Welinder  <terra@diku.dk>

	* src/expr.c: Avoid trailing comma in enum.
	* src/gnumeric-canvas.h (gnm_canvas_handle_motion): Ditto.
	* src/item-cursor.c: Ditto.
	* src/item-edit.c: Ditto.
	* src/item-grid.c: Ditto.
	* src/preview-grid.c: Ditto.
	* src/print.c: Ditto.
	* src/sheet-object-graphic.c: Ditto.
	* src/sheet.h (enum SheetClearFlags): Ditto.

	* src/dialogs/dialog-search-replace.c (set_checked): Fix 92911.

2002-09-09  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-gconf.c : slim things down and cache the results
	  locally.

	* src/gutils.c (g_unichar_strchr) : new.
	(g_unichar_strstr_utf8) : new.
	(g_unichar_strlen) : new.
	(g_unichar_strncmp) : new.

2002-09-09  Morten Welinder  <terra@diku.dk>

	* src/item-edit.c (item_edit_destroy): Plug leak.

2002-09-06  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-component.c
	(workbook_control_component_init): wbcg no longer has editing,
	editing_sheet or editing_cell members, so don't initialize them.

2002-09-06  Jody Goldberg <jody@gnome.org>

	* src/style.c (style_font_new_simple) : provide smarter defaults in case
	  of a screw up.

	* src/gnumeric-gconf.c (gnm_gconf_get_zoom) : supply a smarter default
	  for out of range values.

2002-09-06  Jody Goldberg <jody@gnome.org>

	* src/sheet-control-gui.c (scg_colrow_select) : don't do a start and a
	  change.  Do a start or a change.  do not sheet_update for rangesel.

	* src/parser.y : some UTF-8 fixes for escaped characters

	* src/expr.c (do_expr_as_string) : rangeref_name -> rangeref_as_string
	* src/parse-util.c (rangeref_parse) : new.
	(parse_surrounding_ranges) : delete.

2002-09-06  Morten Welinder  <terra@diku.dk>

	* src/workbook-control-gui.c (setup_progress_bar): Use
	gnumeric_inject_widget_into_bonoboui, thus plugging leak.

	* src/gui-util.c (gnumeric_inject_widget_into_bonoboui): Plug
	leak.

2002-09-05  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (xml_write_style) : fix writing styles now that links
	  are always defined.

2002-09-05  Jody Goldberg <jody@gnome.org>

	* src/parser.y (yylex) : support 1/2 absolute row only refs.

2002-09-04  Jody Goldberg <jody@gnome.org>

	* src/item-edit.c (item_edit_draw) : fix leak.

2002-09-04  Jody Goldberg <jody@gnome.org>

	* schemas/Makefile.am : get the schemas translated

2002-09-04  Jody Goldberg <jody@gnome.org>

	* *.c : remove a pile of deprecated glib functions.

	* src/xml-io.c (xml_probe) : fix test for extension .xml.gz  We only
	  check the last extension.  So foo.xml.gz has extension .gz.
	  Don't rip out quite so much of the sax handler.

2002-09-04  Jody Goldberg <jody@gnome.org>

	* src/cell-draw.c (cell_draw) : fix handling of multiline text.
	* src/item-edit.c (item_edit_draw) : fix position of cursor line.

2002-09-03  Jody Goldberg <jody@gnome.org>

	* src/position.c (rangeref_name) : new.

	* src/expr.c (do_expr_as_string) : Use rangeref_name.

	* src/parser.y (sheetref) : support XL style 3d references
	(cellref) : accept XL style 3d references in addition to applix format.
	  Produce an error if an invalid combination is used.
	    eg sheet1:sheet2!a1:sheet3!a1
	  Prepare to support row only or col only references (A:C or 1:5)

2002-09-02  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (sheet_range_bounding_box) : doh!

	* src/mstyle.c (mstyle_new_default) : init the hyperlink to NULL.
	(mstyle_set_hlink) : relax restrictions.

	* src/sheet-control-gui.c (scg_context_menu) : implement the
	  conditions on the hyperlink context menu items.

	* src/sheet-style.c (sheet_style_region_contains_link) : new.
	(cb_find_link) : new.

2002-09-02  Jody Goldberg <jody@gnome.org>

	* src/gui-util.c (gnumeric_load_pixbuf) : new.

2002-09-01  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-graph.c :  disable enough stuff so that it builds
	  without bonobo.

2002-08-31  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (wbcg_add_custom_ui) : copy the domain.

2002-08-30  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-graph.c : fix some warnings.

2002-08-30  Morten Welinder  <terra@diku.dk>

	* src/collect.c (string_range_function): Don't copy string.

	* src/expr.c (expr_eval_real): Speed up concat operator a bit.

2002-08-29  Morten Welinder  <terra@diku.dk>

	* src/plugin-service.c (plugin_service_ui_activate): Plug leak.

2002-08-29  Morten Welinder  <terra@diku.dk>

	* src/gutils.c (gnm_mem_chunk_free): Plug a minor leak.

2002-08-29  Morten Welinder  <terra@diku.dk>

	* src/plugin.c (plugins_init): Plug leak.  Careful with
	g_slist_reverse.
	(plugins_shutdown): Ditto.

2002-08-29  Jody Goldberg <jody@gnome.org>

	* configure.in : bump gal version req
	* README : ditto.

2002-08-28  Jody Goldberg <jody@gnome.org>

	* src/print.c (print_range_down_then_right) : fix fence post error.
	  repeated cols/rows are part of the region if they start _on_ the
	  coordinate, not just before.

2002-08-28  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (xml_check_version) : fix failure test.
	(xml_probe) : ensure we are at the start of the stream.

2002-08-28  Jody Goldberg <jody@gnome.org>

	* src/func.c (function_marshal_arg) : begin work to support implicit
	  iteration.

2002-08-28  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-canvas.c : begin tighening the include requirements.
	* src/gui-file.c : ditto.
	* src/sheet-object-graphic.c : ditto.
	* src/sheet-object-widget.c : ditto.
	* src/xml-io.c : ditto.

	* src/gutils.c (gnm_extension_pointer) : move to libgsf.
	(gnm_iconv_close) : ditto.

2002-08-28  Jody Goldberg <jody@gnome.org>

	* configure.in : prep for inclusion of libegg code
	  bump libgsf version req.
	* src/Makefile.am : ditto.

	* README : update.

2002-08-25  Jody Goldberg <jody@gnome.org>

	* Release 1.1.8

2002-08-25  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c : tweak page setup label to match bonobo.

	* src/sheet-object-image.c (sheet_object_image_print) : slight tweak
	  to get thing spartially working.  placement is still off.

	* configure.in : bump the gal req to get the new cursor.

2002-08-23  Jon K Hellan  <hellan@acm.org>

	* src/bonobo-io.c: Include gsf-input-bonobo.h from gsf-gnome dir
	rather than gsf.

2002-08-21  Zbigniew Chyla  <cyba@gnome.pl>

	* module-plugin-defs.h:
	Define PLUGIN_CLASS only if PLUGIN_ID is defined

2002-08-20  Jody Goldberg <jody@gnome.org>

	* configure.in : add config message about python

2002-08-20  Zbigniew Chyla  <cyba@gnome.pl>

	* src/plugin-loader.[ch]: Inherit from GObject, not GtkObject.
	(gnumeric_plugin_loader_unload_service): Removed FIXME - unload plugin
	after unloading all services.

	* src/plugin-loader-module.h: Moved all typedefs with plugin
	structures...

	* src/module-plugin-defs.h: ... here, added some comments and
	  PLUGIN_CLASS macro

	* src/plugin-loader-module.c: Adjusted to plugin-loader.h

	* src/plugin.c:
	Inherit GnmPlugin from GModuleType, not GObject.
	(gnm_plugin_type_module_load, gnm_plugin_type_module_unload):
	New, GTypeModule methods.
	(gnm_plugin_deactivate): Destroy loader after deactivating plugin
	(GnmPlugin): Removed is_base_loaded,
	use gnumeric_plugin_loader_is_base_loaded to check this.
	(gnm_plugin_use_ref, gnm_plugin_use_unref):
	Added assertions (plugin must be active).

2002-08-19  Jon K Hellan  <hellan@acm.org>

	* src/stf.c (stf_read_default_probe): Use glib's seek enum instead
	of the enum which used to be in libgsf.

2002-08-19  Jody Goldberg <jody@gnome.org>

	* src/value.c (value_new_float) : return #NUM rather than #VALUE

2002-08-19  Jon K Hellan  <hellan@acm.org>

	* src/file-priv.h: include <bonobo/bonobo-storage.h>

2002-08-18  Jody Goldberg <jody@gnome.org>

	* A pile of header cleanups.

	* src/gui-clipboard.c (x_claim_clipboard) : fix warnings.

2002-08-18  Jon K Hellan  <hellan@acm.org>

	* src/print.c: Fix typo.

2002-08-18  Morten Welinder  <terra@diku.dk>

	* src/hlink.c (gnm_hlink_url_activate, ...): Use "lnk", not "link"
	as identifier.

2002-08-15  Zbigniew Chyla  <cyba@gnome.pl>

	* src/gnumeric-i18n.[ch]: New

	* src/Makefile.am: Added gnumeric-i18n.[ch]

	* src/gutils.[ch]
	(g_lang_score_in_lang_list, g_lang_score_is_better): Removed

	* src/format-template.h
	(FormatTemplateCategoryGroup, FormatTemplateCategory): Removed lang_score

	* src/xml-io-autoft.c (gnumeric_xml_read_format_template_category):
	Don't assign category->lang_score

	* src/file-autoft.c
	(category_compare_orig_name): Renamed to
	category_compare_orig_name_and_dir, compare by both name and directory
	(category_group_list_get): Don't use lang_score, get translation from
	the first category in a group. Sorting by name and directory guarantees
	deterministic results

	* plugins/applix/applix-read.c, plugins/derivatives/options.c,
	plugins/dif/dif.c, plugins/excel/boot.c, plugins/excel/ms-excel-read.c,
	plugins/excel/ms-excel-write.c, plugins/excel/ms-formula-read.c,
	plugins/excel/ms-formula-write.c, plugins/fn-complex/functions.c,
	plugins/fn-complex/gsl-complex.c, plugins/fn-database/functions.c,
	plugins/fn-date/functions.c, plugins/fn-eng/functions.c,
	plugins/fn-financial/functions.c, plugins/fn-info/functions.c,
	plugins/fn-logical/functions.c, plugins/fn-lookup/functions.c,
	plugins/fn-math/functions.c, plugins/fn-random/functions.c,
	plugins/fn-stat/functions.c, plugins/fn-string/functions.c
	plugins/gb/plugin.c, plugins/gda/plugin-gda.c, plugins/guile/plugin.c,
	plugins/guile/smob-value.c, plugins/html/html_read.c,
	plugins/html/roff.c, plugins/lotus-123/lotus.c, plugins/mps/mps.c,
	plugins/mps/parser.c, plugins/numtheory/numtheory.c,
	plugins/oleo/oleo.c, plugins/plan-perfect/pln.c,
	plugins/psiconv/psiconv-read.c, plugins/python/python.c,
	plugins/python-loader/py-gnumeric.c,
	plugins/python-loader/python-loader.c, plugins/qpro/qpro-read.c,
	plugins/sample_datasource/sample_datasource.c, plugins/sc/sc.c,
	plugins/sylk/sylk.c, plugins/uihello/uihello.c, plugins/xbase/boot.c,
	plugins/xml_sax/xml-sax-read.c, src/bonobo-io.c, src/clipboard.c,
	src/cmd-edit.c, src/command-context-stderr.c, src/command-context.c,
	src/commands.c, src/corba-args.c, src/dates.c,
	src/dialogs/dao-gui-utils.c, src/dialogs/dialog-about.c,
	src/dialogs/dialog-advanced-filter.c,
	src/dialogs/dialog-analysis-tools.c, src/dialogs/dialog-autocorrect.c,
	src/dialogs/dialog-autoformat.c, src/dialogs/dialog-autosave.c,
	src/dialogs/dialog-cell-comment.c, src/dialogs/dialog-cell-format.c,
	src/dialogs/dialog-cell-sort.c, src/dialogs/dialog-col-width.c,
	src/dialogs/dialog-consolidate.c, src/dialogs/dialog-define-names.c,
	src/dialogs/dialog-delete-cells.c, src/dialogs/dialog-formula-guru.c,
	src/dialogs/dialog-function-select.c, src/dialogs/dialog-goal-seek.c,
	src/dialogs/dialog-goto-cell.c, src/dialogs/dialog-graph-guru.c,
	src/dialogs/dialog-insert-cells.c, src/dialogs/dialog-merge.c,
	src/dialogs/dialog-paste-special.c, src/dialogs/dialog-plugin-manager.c,
	src/dialogs/dialog-preferences.c, src/dialogs/dialog-printer-setup.c,
	src/dialogs/dialog-random-generator.c, src/dialogs/dialog-row-height.c,
	src/dialogs/dialog-search-replace.c, src/dialogs/dialog-search.c,
	src/dialogs/dialog-sheet-order.c, src/dialogs/dialog-simulation.c,
	src/dialogs/dialog-solver.c, src/dialogs/dialog-stf-export-sheet-page.c,
	src/dialogs/dialog-stf-export.c, src/dialogs/dialog-stf-fixed-page.c,
	src/dialogs/dialog-stf-format-page.c,
	src/dialogs/dialog-stf-main-page.c, src/dialogs/dialog-stf-preview.c,
	src/dialogs/dialog-stf.c, src/dialogs/dialog-summary.c,
	src/dialogs/dialog-tabulate.c, src/dialogs/dialog-workbook-attr.c,
	src/dialogs/dialog-zoom.c, src/expr-name.c, src/expr.c,
	src/file.c, src/format-template.c, src/format.c, src/formats.c,
	src/func-builtin.c, src/func.c, src/gnumeric-canvas.c,
	src/gnumeric-graph.c, src/gui-clipboard.c, src/gui-file.c,
	src/gui-util.c, src/history.c, src/hlink.c, src/item-bar.c,
	src/item-cursor.c, src/item-edit.c, src/libgnumeric.c,
	src/main-application.c, src/number-match.c, src/parser.y,
	src/plugin-loader-module.c, src/plugin-loader.c, src/plugin-service.c,
	src/plugin-util.c, src/plugin.c, src/print-info.c, src/print.c,
	src/search.c, src/selection.c, src/sheet-autofill.c,
	src/sheet-control-gui.c, src/sheet-merge.c, src/sheet-object-bonobo.c,
	src/sheet-object-container.c, src/sheet-object-graphic.c,
	src/sheet-object-widget.c, src/sheet-object.c, src/sheet-view.c,
	src/sheet.c, src/stf-parse.c, src/stf-parse.h, src/stf.c, src/style.c,
	src/tools/analysis-tools.c, src/tools/auto-correct.c, src/tools/dao.c,
	src/tools/filter.c, src/tools/random-generator.c,
	src/tools/simulation.c, src/tools/solver/api.c,
	src/tools/solver/reports-write.c, src/tools/solver/reports.c,
	src/tools/solver/solver.c, src/validation.c, src/value-sheet.c,
	src/value.c, src/widgets/gnumeric-expr-entry.c,
	src/widgets/widget-font-selector.c, src/workbook-cmd-format.c,
	src/workbook-control-gui.c, src/workbook-control.c, src/workbook-edit.c,
	src/workbook-format-toolbar.c, src/workbook-object-toolbar.c,
	src/workbook-view.c, src/workbook.c, src/xml-io.c:
	Use <gnumeric-i18n.h> everywhere

2002-08-18  Jody Goldberg <jody@gnome.org>

	* src/item-grid.c (item_grid_draw) : hmm, we didn't notice the typo
	  because it did not matter.  Simplify the code.
	* src/print-cell.c (print_cell_range) : ditto.

2002-08-17  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-gui.c (custom_uic_destroy): #ifdef
	WITH_BONOBO.

	* src/item-grid.c (item_grid_draw): Fix typo.

	* src/print-cell.c (print_cell_range): Ditto.

2002-08-17  Jon K Hellan  <hellan@acm.org>

	* configure.in: Make bonobo version link with libgsf-gnome-1.

	* src/Makefile.am (gnumeric_LDADD): Ditto.

2002-08-17  Jon K Hellan  <hellan@acm.org>

	* configure.in: Reintroduce stuff accidentaly clobbered by my
	commit 2002-08-15.

2002-08-17  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/position.[ch]: Added cellref_set.

2002-08-17  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (xml_probe) : clear the sax routines so that it is
	  actually quiet.

2002-08-16  Jody Goldberg <jody@gnome.org>

	* src/gui-clipboard.c (x_clipboard_received) : tidy up a bit and
	  prepare to receive UTF-8.

2002-08-16  Jon K Hellan  <hellan@acm.org>

	* src/xml-io.h (gnumeric_xml_read_workbook): Declare.

	* src/mathfunc.c (random_gaussian_pdf): Make static.

	* src/hlink.h (gnm_hlink_get_type, gnm_hlink_cur_wb_get_type,
	gnm_hlink_url_get_type): s/foo bar ()/foo bar (void)/

	* src/file.c (gnum_file_saver_save_to_stream_real): ifdef out
	currently unused code.

2002-08-15  Jon K Hellan  <hellan@acm.org>

	* configure.in: Require libgsf 1.3.

	* src/xml-io.c (gnumeric_xml_read_workbook): Check for
	overflow from gsf_input_remaining.

	* src/stf.c (stf_open_and_read, stf_read_default_probe): Check for
	overflow from gsf_input_size.

2002-08-14  Jody Goldberg <jody@gnome.org>

	* gnumeric.keys.in (application) : convert to use gnumeric_icondir

	* src/workbook-control-gui.c (workbook_control_gui_ctor_class) : move
	  the default icon init here.
	* src/libgnumeric.c (gnm_common_init) : from here.  I'd like to make
	  this non-gui.  That will take a fair amount of cleanup, but it
	  should be doable.

2002-08-14  Jody Goldberg <jody@gnome.org>

	* src/gui-util.c (gnumeric_load_image) : Use gtk_image_new_from_file
	  directly.

	* src/xml-io.c (xml_read_cell) : make the warning more informative.

	* src/workbook-control-component.c (wbcc_set_sensitive) : fix warning.

	* src/rendered-value.c (rendered_value_calc_size_ext) : some UTF-8
	  cleanliness.  Should probably use pango layout directly ?

	* src/cell-draw.c (draw_overflow) : Use the cached measurement of '#'
	  and draw the entire string in 1 go.
	(draw_text) : use the cached layout.
	(cell_split_text) : same as rendered_value_calc_size_ext.

	* src/print-cell.c (print_overflow) : use the same method as
	  draw_overflow.

2002-08-14  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=87833
	Patch from dorami@bu.iij4u.or.jp to do an initial pass at supporting
	pango in cells.

	* src/cell-draw.c : first pass at using pango.
	* src/rendered-value.c : ditto.
	* src/style.c : ditto.
	* src/item-edit.c : ditto.

2002-08-14  Christian Meyer  <chrisime@gnome.org>

	* src/workgroup-control-component.c: Renamed to Page Setup accordingly.
	* src/workgroup-control-gui.c: ditto.
	* src/commands.c: ditto.
	* src/GNOME_Gnumeric.xml: Set mnemonic to Page Set_up (as proposed by
	HIG)
	* src/GNOME_Gnumeric.xml: ditto.
	* doc/C/menus.xml: Renamed Print Setup to Page Setup in the whole file.
	* doc/C/printing.xml: ditto.
	* doc/C/toolbars.xml: ditto.

2002-08-14  Christian Meyer  <chrisime@gnome.org>

	* src/GNOME_Gnumeric.xml: Renamed Print Setup to Page Setup.
	* src/GNOME_Gnumeric_Componente.xml: ditto.

2002-08-13  Zbigniew Chyla  <cyba@gnome.pl>

	* src/sheet.h (struct _Sheet): Added name_unquoted_collate_key.

	* src/sheet.c
	(sheet_rename, sheet_new): Generate collation key for unquoted name
	(sheet_destroy): g_free it here

	* src/search.c (cb_order_sheet_row_col, cb_order_sheet_col_row):
	Compare sheet names using strcmp() on collation keys

2002-08-13  Peteris Krisjanis <peteris.krisjanis@os.lv>

	* configure.in: (ALL_LINGUAS) Latvian (lv) language support.

2002-08-13  Morten Welinder  <terra@diku.dk>

	* src/regutf8.h (REG_EPAREN, REG_EBRACE, REG_EESCAPE, REG_OK):
	Move macros here.

2002-08-13  Jody Goldberg <jody@gnome.org>

	* src/regutf8.c : Add REG_OK

2002-08-12  Jody Goldberg <jody@gnome.org>

	* configure.in : post release version bump

2002-08-12  Jody Goldberg <jody@gnome.org>

	* Release 1.1.7

2002-08-12  Jody Goldberg <jody@gnome.org>

	* src/formats.c : remove the 8 bit characters until the gettext
	  infrasructure accepts them as UTF-8 without warning.

2002-08-12  Jody Goldberg <jody@gnome.org>

	* src/style-border.c (style_border_none_set_color) : Morten found the
	  colour leak.  While we're here lets fix the GC warnings.

	* src/sheet-style.c (sheet_style_update_grid_color) : fix the leak
	  here too.

	* src/sheet-object-graphic.c : Add a quicky line based polygon object.

2002-08-11  Jody Goldberg <jody@gnome.org>

	* src/workbook-view.c (wb_view_save_as) : Doh! order these correctly.

	* src/sheet-object-cell-comment.c (cell_set_comment) : fix ref leak
	  when adding a comment.

	* src/expr-name.c (expr_name_remove) : tidy old cruft.
	(expr_name_shutdown) : Use expr_name_list_destroy.
	(expr_name_list_destroy) : make checking more anal.

2002-08-11  Jody Goldberg <jody@gnome.org>

	* configure.in : Add the planperfect plugin

	* src/mstyle.c : Add shrink to fit.
	* src/xml-io.c (xml_write_style) : and here.
	(xml_read_style) : And here.

2002-08-09  Morten Welinder  <terra@diku.dk>

	* src/search.c (match_is_word): Make UTF-8 safe.
	(calculate_replacement): Ditto.
	(search_match_string): Ditto.
	(search_replace_string): Ditto.

2002-08-09  Zbigniew Chyla  <cyba@gnome.pl>

	* src/plugin-service.[ch]
	(PluginServiceClass::get_description): New method
	(PluginService): Added saved_description field
	(plugin_service_general_get_description,
	plugin_service_file_opener_get_description,
	plugin_service_file_saver_get_description,
	plugin_service_function_group_get_description,
	plugin_service_plugin_loader_get_description,
	plugin_service_ui_get_description):
	Implementations of the new method
	(plugin_service_get_description):
	New, store generated strings in service->saved_description

	* src/plugin.[ch]
	(gnm_plugin_get_extra_info_list): Removed
	(gnm_plugin_get_services): New

	* src/plugin-loader.[ch]
	(gnumeric_plugin_loader_get_extra_info_list,
	GnumericPluginLoaderClass::get_extra_info_list): Removed

	* src/plugin-loader-module.c
	(gnumeric_plugin_loader_module_info_get_extra_info_list): Removed

2002-08-09  Jody Goldberg <jody@gnome.org>

	* src/expr-name.c (expr_name_list_destroy) : fix.

2002-08-07  Zbigniew Chyla  <cyba@gnome.pl>

	* src/module-plugin-defs.h
	(PLUGIN): New convenience macro for accessing the plugin object.
	Define only if PLUGIN_ID is defined.
	(GNUMERIC_MODULE_PLUGIN_GET_INFO): Removed

2002-08-09  Jody Goldberg <jody@gnome.org>

	* configure.in (int) : enable plan perfect.

2002-08-09  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-component.c
	(workbook_control_component_ctor_class) : set_sensitive is now in
	command context.

2002-08-09  Jody Goldberg <jody@gnome.org>

	* src/dependent.c (sheet_deps_destroy) : clean names before deps
	  so that we don't end up with stale deps in a name dep list.
	(workbook_deps_destroy) : clear sheet names too.

	* src/expr-name.c (expr_name_shutdown) : deactivate the builtins
	  before freeing them.

2002-06-28  J.H.M. Dassen (Ray) <jdassen@debian.org>

	MIME consistency improvements
	* icons/gnome-application-vnd.lotus-1-2-3.png,
	  icons/gnome-application-x-applix-spreadsheet.png,
	  icons/gnome-application-x-generic-spreadsheet.png,
	  icons/gnome-application-x-generic-spreadsheet.png: New (from mc and
	  gnome-mime-data).
	* icons/Makefile.am: Updated for new icons.
	* gnumeric.keys.in: Added application/vnd.lotus-1-2-3,
	  application/x-applix-spreadsheet, application/x-oleo,
	  application/x-xbase
	* gnumeric.mime: Changed application/x-applix to
	  application/x-applix-spreadsheet to be consistent with the type
	  elsewhere; added application/vnd.lotus-1-2-3 with extensions as per
	  http://www.iana.org/assignments/media-types/application/vnd.lotus-1-2-3

2002-06-02  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* debian/*: updated.
	* src/cell.h: made declaration of cell_new a prototype.
	* src/plugin.h: declare printf format attribute for plugin_message.
	* src/print.c: removed duplicate declaration of print_debugging (which
	  is already declared via libgnumeric.h .

2002-08-08  Jody Goldberg <jody@gnome.org>

	* src/expr-name.c (expr_name_shutdown) : fix

2002-08-08  Jody Goldberg <jody@gnome.org>

	* src/workbook-view.c (wb_view_new_from_input) : its ok to have 0 sheets,
	  this is not the place to display the error messages.

	* src/expr-name.c (expr_name_init) : activate the builtins to help
	  catch someone trying to unref them.

	* gnumeric.desktop.in (Categories) : add encoding

	* src/value.c (value_get_as_string) : quote strings in arrays

2002-08-07  Jody Goldberg <jody@gnome.org>

	* src/command-context.c (cmd_context_set_sensitive) : move here from
	  workbook_control_set_sensitive.

	* src/workbook-view.c (wb_view_save_as) : use it here.

	* src/gui-file.c (gui_file_read) : rename it here.

	* src/command-context-stderr.c (ccs_get_password) : new.
	(ccs_set_sensitive) : new.
	(ccs_class_init) : register them.

2002-08-09  Hasbullah Bin Pit <sebol@ikhlas.com>

	* configure.in: (ALL_LINGUAS) Added Malay (ms).

2002-08-07  Zbigniew Chyla  <cyba@gnome.pl>

	* src/plugin-service.c
	s/g_strcasecmp/g_ascii_strcasecmp/

2002-08-04  Zbigniew Chyla  <cyba@gnome.pl>

	* src/func.[ch]
	(struct _FunctionDefinition): Added ref_notify
	(fn_def_new): Get extra (optional) argument and copy it to ref_notify
	(function_add_args, function_add_nodes, function_add_name_only):
	Get extra arg and pass it to fn_def_new.
	(func_ref): Call ->ref_notify on every change of refcount from 0 to 1
	(func_unref): ... and from 1 to 0

	* src/plugin-service.c:
	(plugin_service_function_group_func_ref_notify): New,
	call gnm_plugin_use_(un)ref when provided function is (de)referenced.
	(plugin_service_function_group_activate): Removed FIXME, pass
	extra argument to function_add_name_only.

	* func-builtin.c
	(func_builtin_init): Adjusted to function_add_* signature changes.

2002-08-05  Zbigniew Chyla  <cyba@gnome.pl>

	* configure.in (AC_OUTPUT): added plugins/uihello/Makefile

	* plugins/Makefile.am (SUBDIRS_EXAMPLES):
	moved $(GNOME_GLOSSARY_DIR) and $(PYFUNC_DIR) here, added uihello

2002-08-05  Zbigniew Chyla  <cyba@gnome.pl>

	* src/plugin-service.h
	(PluginServiceUICallbacks, GNM_PLUGIN_SERVICE_UI_TYPE,
	GNM_PLUGIN_SERVICE_UI, GNM_IS_PLUGIN_SERVICE_UI): New

	* src/plugin-service.c
	(PluginServiceUIClass, struct _PluginServiceUI, plugin_service_ui_init,
	plugin_service_ui_finalize, plugin_service_ui_read_xml, ui_verb_fn,
	plugin_service_ui_activate, plugin_service_ui_deactivate,
	plugin_service_ui_class_init): Implementation of the "ui" service.
	(service_types): Added "ui".

	* src/plugin-loader.h
	(struct _GnumericPluginLoaderClass):
	Added load_service_ui and load_service_ui methods.

	* src/plugin-loader.c
	(gnumeric_plugin_loader_unload_service_ui_real,
	gnumeric_plugin_loader_class_init,
	gnumeric_plugin_loader_load_service,
	gnumeric_plugin_loader_unload_service): Added support for ui service

	* plugin-loader-module.h
	(ModulePluginUIVerbInfo): New

	* src/plugin-loader-module.c
	gnumeric_plugin_loader_module_class_init
	ServiceLoaderDataUI
	gnumeric_plugin_loader_module_func_exec_verb
	gnumeric_plugin_loader_module_load_service_ui
	gnumeric_plugin_loader_module_unload_service_ui

	* src/workbook-control-gui-priv.h
	(struct _WorkbookControlGUI): Added custom_ui_components field

	* src/workbook-control-gui.h
	(register_xml_ui, unregister_xml_ui): New

	* src/workbook-control-gui.c
	(struct _CustomXmlUI, registered_xml_uis,
	wbcg_add_custom_ui, wbcg_remove_custom_ui,
	add_ui_to_workbook_controls, remove_ui_from_workbook_controls,
	register_xml_ui, unregister_xml_ui): New
	(workbook_control_gui_init): Initialize wbcg->custom_ui_components
	hash table, add all registered uis to the workbook control.
	(wbcg_finalize): Destroy wbcg->custom_ui_components

2002-08-06  Morten Welinder  <terra@diku.dk>

	* src/gutils.c (gnumeric_strcase_equal): Make UTF-8 safe.
	(gnumeric_strescape): Make UTF-8 safe.

2002-08-06  Jody Goldberg <jody@gnome.org>

	* src/GNOME_Gnumeric.xml (</) : make control-p the print accelerator.

	* src/item-edit.c (item_edit_destroy) : reset the cursor here.
	(item_edit_event) : set the cursor to something clearer on entry.

	* src/item-grid.c (item_grid_button_press) : Its crufty but given that
	  we do a grab on button down we need to recognize the double click
	  ourselves.
	(cb_cursor_come_to_rest) : remove some debugging cruft.

2002-08-06  Zbigniew Chyla  <cyba@gnome.pl>

	* src/plugin.h: Put information about PLUGIN_ALWAYS_LOAD in the comment.

	* src/plugin-service.c (plugin_service_activate):
	Load before activating if PLUGIN_ALWAYS_LOAD is defined.

	* src/plugin-loader.c
	(gnumeric_plugin_loader_load_base, gnumeric_plugin_loader_unload_base):
	Pass sensible level value to plugin_message().

	* src/plugin.c
	(plugin_info_read, plugins_init, plugins_shutdown): ditto

2002-08-05  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* samples/fn-random.gnumeric: A sample file containing 10,000
	random numbers of each distribution.

2002-08-04  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (workbook_setup_edit_area) : no need to
	  handle activate.  That is too late to do the cursor movement
	  correctly.

	* src/libgnumeric.c (gnm_shutdown) : don't leak the clipboard on exit.

	* src/cell.c (cb_cell_pool_leak) : new.
	(cell_shutdown) : use it.

	http://bugzilla.gnome.org/show_bug.cgi?id=88057
	* src/dependent.c (dependent_unlink) : unlink from the correct
	  position if we are unlinking a cell but the caller passed in a NULL
	  position.

2002-08-04  Jody Goldberg <jody@gnome.org>

	* src/expr-name.c (expr_name_new) : init as inactive.
	(expr_name_add) : activate when the name is added.
	(expr_name_create) : clarify the life cycle of the expression.
	(expr_name_unref) : it should not be possible to destroy a name that
	  is still in the lists.
	(expr_name_unlink) : delete and merge into expr_name_remove.
	(expr_name_list_destroy) : use remove.

	* src/dependent.c (sheet_deps_destroy) : remove the names in the sheet.
	(workbook_deps_destroy) : ditto.

2002-08-04  Jon K Hellan  <hellan@acm.org>

	* src/search.c: Include gutils.h.

2002-08-04  Zbigniew Chyla  <cyba@gnome.pl>

	* src/plugin.[ch]
	(plugin_db_activate_plugin_list, plugin_db_deactivate_plugin_list):
	Made public (for use by plugin manager).

2002-08-03  Zbigniew Chyla  <cyba@gnome.pl>

	* src/plugin.c
	(gnm_plugin_force_mark_inactive, ghf_plugin_mark_inactive): Removed
	(plugins_shutdown): Proper way of handling plugins marked for
	deactivation.

2002-07-31  Zbigniew Chyla  <cyba@gnome.pl>

	* src/gnumeric-gconf-priv.h: removed PLUGIN_GCONF_KNOWN

	* src/gnumeric-gconf.[ch]
	(gnm_gconf_get_known_plugins, gnm_gconf_set_known_plugins): removed

	* src/gutils.h
	(g_string_s]list_copy): added cast to GnmMapFunc
	(GNM_[S]LIST_APPEND): new
	(GNM_SIZEOF_ARRAY): cast to int, unsigned ints are evil

	* src/plugin-loader.c
	(gnumeric_plugin_loader_unload_service_general_real,
	gnumeric_plugin_loader_unload_service_file_opener_real,
	gnumeric_plugin_loader_unload_service_file_saver_real,
	gnumeric_plugin_loader_unload_service_function_group_real,
	gnumeric_plugin_loader_unload_service_plugin_loader_real):
	made static

	* src/plugin.[ch]
	(struct _GnmPlugin): added saved_textdomain
	(gnm_plugin_init): set saved_textdomain to NULL
	(gnm_plugin_finalize): g_free it here
	(gnm_plugin_get_config_prefix): removed
	(gnm_plugin_get_textdomain): new

2002-07-27  Zbigniew Chyla  <cyba@gnome.pl>

	* src/gutils.c:
	Converted g_string_[s]list_copy to more general functions,
	g_[s]list_map.

	* src/gutils.h:
	(g_[s]list_map): New
	(g_[s]tring_list_copy): Converted to macro (using g_[s]list_map)
	(g_list_to_vector, g_list_to_vector_custom, g_vector_free_custom,
	g_slist_to_vector):
	Removed
	(GNM_[S]LIST_SORT): New members of GNM_[S]LIST_* family.
	(GNM_SIZEOF_ARRAY): New macro

	* src/error-info.h:
	(GNM_INIT_RET_ERROR_INFO):
	New macro, I plan to add some extra code here.

	* src/plugin-service.[ch]
	PluginService and PluginService* are GObjects now
	(with three virtual methods: read_xml, activate, deactivate).
	All implementation details are hidden. Every PluginService* exposes
	only service-specific PluginService*Callbacks struct (returned by
	plugin_service_get_cbs function) for use by plugin loaders.
	Placed "id" attribute in PluginService struct instead of
	duplicating it in other structs.
	(plugin_service_{get,set,clear}_loader_data): Removed
	s/plugin_service_read/plugin_service_new/

	* src/plugin.c
	Adjusted to plugin-service.h changes
	(struct _GnmPlugin): Replace vectors with SLists.
	(plugins_shutdown): Destroy all plugins (g_object_unref).
	Use GNM_INIT_RET_ERROR_INFO everywhere.

	* src/plugin-loader.c
	(gnumeric_plugin_loader_unload_service_general_real,
	gnumeric_plugin_loader_unload_service_file_opener_real,
	gnumeric_plugin_loader_unload_service_file_saver_real,
	gnumeric_plugin_loader_unload_service_function_group_real,
	gnumeric_plugin_loader_unload_service_plugin_loader_real):
	Set callbacks using plugin_service_get_cbs and PluginService*Callbacks
	structs, instead of settings PluginService* fields directly (they are
	private now).
	(gnumeric_plugin_loader_load_service,
	gnumeric_plugin_loader_unload_service)
	Use RTTI to select (un)loading method.
	(gnumeric_plugin_loader_set_attributes,
	gnumeric_plugin_loader_load_base,
	gnumeric_plugin_loader_unload_base):
	Use GNM_INIT_RET_ERROR_INFO macro everywhere.

	* src/plugin-loader-module.c
	(gnumeric_plugin_loader_module_set_attributes,
	gnumeric_plugin_loader_module_load_base,
	gnumeric_plugin_loader_module_unload_base,
	gnumeric_plugin_loader_module_info_get_extra_info_list,
	gnumeric_plugin_loader_module_destroy,
	gnumeric_plugin_loader_module_func_init,
	gnumeric_plugin_loader_module_func_clean,
	gnumeric_plugin_loader_module_load_service_general,
	gnumeric_plugin_loader_module_func_file_probe,
	gnumeric_plugin_loader_module_func_file_open,
	gnumeric_plugin_loader_module_load_service_file_opener,
	gnumeric_plugin_loader_module_func_file_save,
	gnumeric_plugin_loader_module_load_service_file_saver,
	gnumeric_plugin_loader_module_func_get_full_function_info,
	gnumeric_plugin_loader_module_load_service_function_group,
	gnumeric_plugin_loader_module_unload_service_function_group,
	gnumeric_plugin_loader_module_func_get_loader_type,
	gnumeric_plugin_loader_module_load_service_plugin_loader):
	Use g_object data instead of plugin_service_[gs]et_loader_data.
	Set callbacks using plugin_service_get_cbs and PluginService*Callbacks
	structs, instead of settings PluginService* fields directly (they are
	private now).
	"has_probe" field has been removed, always get a pointer to
    *_file_probe pointer function if it's available.
	Less assertions, use GNM_INIT_RET_ERROR_INFO macro everywhere.

2002-07-22  Zbigniew Chyla  <cyba@gnome.pl>

	* src/gnumeric.h:
	Added typedefs: GnmPlugin, PluginService, GnumericPluginLoader.

	* src/gutils.h: New macros: GNM_LIST_FOREACH, GNM_LIST_PREPEND,
	GNM_LIST_REMOVE, GNM_LIST_CONCAT, GNM_LIST_REVERSE,
	GNM_SLIST_FOREACH, GNM_SLIST_PREPEND,
	GNM_SLIST_REMOVE, GNM_SLIST_CONCAT, GNM_SLIST_REVERSE.

	* src/gutils.c: Fixed typo in comment.

	* src/plugin-loader-module.h: s/PluginInfo/GnmPlugin/

	* src/plugin-loader-module.c:
	(ServiceLoaderDataGeneral): Removed module_func_can_deactivate.
	(gnumeric_plugin_loader_module_func_can_deactivate): Removed
	(gnumeric_plugin_loader_module_set_attributes):
	Adjusted to plugin-loader.c (read attributes from GHashTable).
	s/..._load/..._load_base/
	s/..._unload/..._unload_base/
	Use new macros from gutils.h.

	* src/plugin-loader.[ch]
	s/..._load/..._load_base/
	s/..._unload/..._unload_base/
	s/is_loaded/is_base_loaded/
	s/PluginInfo/GnmPlugin/
	(GnumericPluginLoaderClass::set_attributes,
	gnumeric_plugin_loader_set_attributes: Changed signature, read
	attributes from GHashTable, not from two lists.
	(gnumeric_plugin_loader_load_base): Ignore dependencies, now
	GnmPlugin object is responsible for this.
	(gnumeric_plugin_loader_unload_base): Ditto
	(gnumeric_plugin_loader_load_service): Don't load base part of the
	plugin, plugin takes care of this.

	* src/plugin-service.[ch]:
	s/PluginInfo/GnmPlugin/
	(PluginServiceGeneral::plugin_func_can_deactivate,
	plugin_service_can_deactivate,
	plugin_service_*_can_deactivate,
	plugin_services_data_new, plugin_services_data_free,
	PluginServicesData, plugin_service_can_deactivate): Removed.
	(plugin_service_plugin_loader_initialize): Use plugins_register_loader,
	passing loader id as "plugin-id:loader-service-id".
	(plugin_service_plugin_loader_cleanup): Ditto, plugins_unregister_loader.
	Use new macros from gutils.h.

	* src/plugin.[ch]
	Cut down the number of public functions by 20.
	Documented most public functions.
	Made PluginInfo a GObject, renamed to GnmPlugin.
	GnmPlugin sends signals on state change (active, loaded,
	can_deactivate).
	Removed _peek functions, no need for two types of getters.
	Remember "plugin file state" only for plugins from previous Gnumeric
	session (so that the list doesn't get bigger with every Gnumeric
	version installing .../gnumeric/version/plugins/... directories).
	Don't save known plugins separately, use the above list.
	Store available plugins in hash table for faster lookups by id.
	Ditto for loaders.
	Removed strange *_init, *_shutdown functions, now everything is in
	plugins_init and plugins_shutdown.
	Automatically add plugin containing loader to the list of plugin
	dependencies (it's easy because loader id is now:
	plugin_id + ":" + service_id).
	Detect cyclic dependencies during activation/deactivation.
	Very simple method for determining whether plugin can be deactivated
	- use "plugin usage counter" (increased by dependent plugins or plugin
	services if something keeps references to plugin structures).
	Validate plugin id, it may include only letters, digits and underscore.
	Removed ugly enums/structs (PluginDependencyType,
	PluginLoaderStaticInfo, PluginLoaderTypeInfo).
	Other simplifications.
	No new features.
	Use new macros from gutils.h (it looks so much better).

2002-08-04  Jody Goldberg <jody@gnome.org>

	* src/expr-name.c (expr_name_set_scope) : handle the wb -> sheet
	  transition too.
	(expr_name_set_expr) : tweak the expr ref counting semantics to be
	  more useful.  Just absorb it.

	* src/dependent.c (cb_name_invalidate) : don't NULL the name's
	  expression, rewrite it if necessary.

2002-08-03  Jody Goldberg <jody@gnome.org>

	* src/workbook-view.c (wb_view_auto_expr_recalc) : support NULL views.

	* src/sheet.c (sheet_get_view) : support NULL.

	* src/workbook-control-gui.c (wbcg_sheet_to_page_index) : allow
	  unfocused controls.

	* src/workbook.c (workbook_sheet_delete) : make sure nothing is
	  focused on the deleted sheet.

2002-08-03  Jon K Hellan  <hellan@acm.org>

	* src/GNOME_Gnumeric.xml: Add Edit/Fill/Merge.
	Change SheetReorder label to "Manage Sheets".

	* src/workbook-control-gui.c (verbs): s/ToolsMERGE/ToolsMerge/

2002-08-03  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-gui.c (verbs, wbcg_menu_state_update):
	Added Data/Filter/Show All.

	* src/GNOME_Gnumeric.xml: Added `Risk simulation' tool.
	Added Data/Filter/Show All.

2002-08-02  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* samples/simulation.gnumeric: Sample file of simulation.

	* src/workbook-control-gui.c: Added `Risk simulation' tool.

	* src/sheet.h: Added a round variable for risk simulation tool.

2002-08-02  Jody Goldberg <jody@gnome.org>

	* src/io-context.c (gnm_io_warning) : a simple placeholder.

	http://bugzilla.gnome.org/show_bug.cgi?id=88933
	* src/sheet-view.c (sv_attach_control) : no need to manually
	  initialize things.  Use sv_init_sc.

2002-08-01  Zbigniew Chyla  <cyba@gnome.pl>

	* src/stf.c
	(stf_open_and_read): Use g_try_malloc
	(stf_preparse, stf_read_workbook, stf_read_workbook_auto_csvtab):
	s/free/g_free/

2002-08-01  Jody Goldberg <jody@gnome.org>

	* src/sheet-style.c (sheet_style_foreach) : new.

	* src/mstyle.c (mstyle_equal_XL) : new.

	* src/item-grid.c (item_grid_draw) : partially fix drawing for merged
	  regions that have some cols/rows hidden.  It is impossible to do
	  that from the gnumeric ui, but it can happen with importers, and
	  will potentially happen with filters.

	* src/item-cursor.c (item_cursor_selection_event) : bring up context
	  menus on right button.

2002-07-30  Morten Welinder  <terra@diku.dk>

	* src/mathfunc.c (random_01): Fix path of random device!

2002-07-30  Morten Welinder  <terra@diku.dk>

	* src/mathfunc.c (ran_gamma_int): Fix incorrect underflow
	assumptions.

2002-07-28  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/func-buildin.c: Function description clean up.

2002-07-26  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/sheet.h, src/workbook-control-gui-priv.h,
	src/workbook-control-gui.c, src/tools/filter.c: Hide the
	sensitivity of `Show All' if there are no filtered rows.

	* src/workbook-control-gui.c: Added `Filter->Show All'.

2002-07-25  Morten Welinder  <terra@diku.dk>

	* src/mathfunc.c (dgeom, pgeom): Properly import using
	tools/import-R.

2002-07-22  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/mathfunc.[ch] (dgeom, pgeom): Added.

2002-07-21  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/mathfunc.[ch] (random_gaussian_tail): Added.

2002-07-21  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/mathfunc.[ch] (random_landau): Added.

2002-07-21  Jody Goldberg <jody@gnome.org>

	* Release 1.1.6

2002-07-21  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/mathfunc.[ch] (random_rayleigh_tail): Added.

2002-07-21  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/mathfunc.[ch] (random_exppow_pdf, random_exppow,
	random_gaussian, random_gaussian_pdf, random_laplace_pdf): Added.

2002-07-21  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_sheet_label_button_press) : be
	  consistent and select before bringing up the context menu given
	  that the menu is being applied to the tab.

2002-07-20  Jon K Hellan  <hellan@acm.org>

	* configure.in: Test for BROKEN_PY_INITIALIZE feature (before
	Python 2.0, Python would write to the environment, and we had to
	work around it.)

	* acconfig.h: Add BROKEN_PY_INITIALIZE

2002-07-20  Jody Goldberg <jody@gnome.org>

	* src/item-grid.c (item_grid_button_press) : tidy the interface
	  handle all types button presses, not just button1.
	  Button 3 is not consistent in selecting and bringing up context menu
	  rather than just the menu (Thanks to the OpenOffice folk for noticing)
	(item_grid_event) : move the press logic into item_grid_press_event.

2002-07-20  Jody Goldberg <jody@gnome.org>

	* src/item-grid.c (item_grid_init) : init the cursor timer.
	(item_grid_event) : handle hlink cursor transitions and tips.
	(ig_clear_hlink_tip) : new.
	(item_grid_destroy) : clear the cursor timer and any visible tips.
	(cb_cursor_come_to_rest) : new.
	(cb_cursor_motion) : new.

	* src/sheet-control-gui.c (scg_set_display_cursor) : in the non-object
	  case use the pane's current cursor.

2002-07-18  Jody Goldberg <jody@gnome.org>

	* src/expr.c (gnm_expr_extract_ref) : take some eval flags to see if
	  we can support implicit iteration.
	* src/func.c (function_call_with_list) : ditto.

2002-07-18  Jody Goldberg <jody@gnome.org>

	* src/hlink.c : write url and internal link support.

2002-07-16  Jody Goldberg <jody@gnome.org>

	* src/cellspan.c (cell_calc_span) : center across selection can force
	  a span for something that would wrap.

	* src/workbook-control-gui.c (wbcg_error_error_info) : add 150% as a
	  std zoom level.

2002-07-15  Jody Goldberg <jody@gnome.org>

	* src/func.h : add status info to the func def for easy update

2002-07-18  Morten Welinder  <terra@diku.dk>

	* src/search.c (calculate_replacement): Make UTF-8 safe at last.
	(inspect_case): New function split out from calculate_replacement.

	* src/gutils.c (gnumeric_utf8_strcapital): New function (that
	should really be in glib).

	* src/mathfunc.c (random_01): Use unsigned char array, not
	unsigned int.
	(random_cauchy, etc.): Make gnum_float safe.

2002-07-18  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/mathfunc.[ch]: Added random_levy, random_levy_skew,
	random_gumbel1 and random_gumbel2.

2002-07-18  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/mathfunc.[ch]: Added random_tdist.

2002-07-18  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/mathfunc.[ch]: Added random_beta, random_chisq, random_fdist,
	random_geometric, random_hypergeometric, random_logarithmic, and
	random_logistic.

2002-07-18  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/mathfunc.[ch]: Added random_gamma, random_pareto, random_laplace,
	and random_weibull.

2002-07-18  Jukka Pekka  <jiivonen@hutcs.cs.hut.fi>

	* src/mathfunc.[ch]: Added random_cauchy and random_lognormal.

2002-07-16  Yanko Kaneti <yaneti@declera.com>

	* configure.in: (ALL_LINGUAS) Added Bulgarian (bg).

2002-07-16  Morten Welinder  <terra@diku.dk>

	* configure.in (long double): Move to later when LIBS is in better
	shape.
	* src/gutils.c: Fix includes.

2002-07-13  Jody Goldberg <jody@gnome.org>

	* src/workbook.c (workbook_foreach_cell_in_range) : fix 3d handling,
	  and convert.

	* src/sheet.c (sheet_foreach_cell_in_range) : convert from boolean to
	  bit flags and support only_visible in addition to only existing.
	(sheet_col_size_fit_pixels) : Only fit visible cells.
	(sheet_row_size_fit_pixels) : ditto.

2002-07-12  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (cb_max_cell_width) : leave merged cells out of the
	  running.

	http://bugzilla.gnome.org/show_bug.cgi?id=87987
	(sheet_range_bounding_box) : nice catch, thankfully it is a new bug.

2002-07-12  Jody Goldberg <jody@gnome.org>

	* src/plugin-service.c (gnum_plugin_file_opener_probe) : remove
	  pretend feature that supported regexp.  Only shell paterns are
	  supported now.
	(plugin_service_file_opener_read) : ditto.

	* src/io-context.c (file_io_progress_set) : delete.
	(file_io_progress_update) : ditto.
	(memory_io_progress_set) : ditto.
	(memory_io_progress_update) : ditto.

	* src/gnumeric-gconf.c (gnm_gconf_get_horizontal_dpi) : dummy out for
	  now until we add a cache.
	(gnm_gconf_get_vertical_dpi) : ditto.

2002-07-10  Jody Goldberg <jody@gnome.org>

	* src/stf.c (stf_preparse) : stf_parse_convert_to_unix now returns the
	  length.
	* src/stf.c (stf_read_default_probe) : handle short files.

2002-07-10  Jody Goldberg <jody@gnome.org>

	* src/gui-clipboard.c (x_clipboard_to_cell_region) :
	  stf_parse_is_valid_data now takes a length.
	* src/stf.c (stf_read_default_probe) : ditto.
	(stf_preparse) : ditto.
	* src/stf-parse.c (stf_parse_is_valid_data) : Use the supplied buffer
	  length, not a 0 terminator.

2002-07-10  Jody Goldberg <jody@gnome.org>

	* configure.in : enable quatro pro plugin
	* plugins/Makefile.am : ditto

2002-07-11  Morten Welinder  <terra@diku.dk>

	* src/search.c (calculate_replacement): Initial work towards UTF-8
	safety.
	(search_replace_compile, search_replace_verify): Make UTF-8 safe,
	except for the fact that our regexp routines are not.

2002-07-10  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-component.c (cb_help_about): Remove
	debugging output.
	(workbook_control_component_activate): Plug leak.

2002-07-10  Morten Welinder  <terra@diku.dk>

	* src/search.c (search_replace_string): Use glib 2's
	g_string_append_len.
	(calculate_replacement): Ditto.
	(cb_order_sheet_col_row, cb_order_sheet_row_col): Make UTF-8 safe.

2002-07-09  Morten Welinder  <terra@diku.dk>

	* src/mathfunc.c (random_poisson): Fix loop (by switching method).

2002-07-09  Jody Goldberg <jody@gnome.org>

	* plugins/Makefile.am : excel is no longer conditional

2002-07-09  Jody Goldberg <jody@gnome.org>

	* README : add libgsf and remove libole
	* configure.in : remove libole

2002-07-08  Jon K Hellan  <hellan@acm.org>

	* src/gnumeric-graph.c: modernize a little bit more.

2002-07-08  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-graph.c : modernize.

2002-07-07  Jody Goldberg <jody@gnome.org>

	* src/gnumeric.h : Add GnmHLink.

	* src/item-grid.c : include hlink.h
	(item_grid_event) : a button release on an h-link activates it.

	* src/Makefile.am : Add hlink.[ch]

	* src/sheet.h : Lets take a break from architecture and add something
	  simple like hyper-links.

2002-07-07  Jon K Hellan  <hellan@acm.org>

	* src/datetime.c (date_init, datetime_g_to_serial,
	datetime_g_days_between, datetime_g_months_between,
	datetime_isoweeknum, datetime_weeknum,
	days_between_BASIS_MSRB_30_360, days_between_BASIS_30E_360,
	days_between_BASIS_30Ep_360, days_between_basis, coup_cd):
	Replaced deprecated g_date_xxx with g_data_get_xxx.

	* src/sheet-autofill.c (autofill_compute_delta): Ditto.

2002-07-01  Morten Welinder  <terra@diku.dk>

	* src/mathfunc.c (fact): Use table and avoid recursion.
	(permut): New function.
	(combin): Improve precision.

2002-06-27  Jody Goldberg <jody@gnome.org>

	* src/sheet-view.c : move frozen panes here.
	* src/sheet.c : from here.

	* src/sheet-control-gui.c (scg_resize) : freezing in view now.
	(scg_scrollbar_config) : ditto.
	(gnm_canvas_update_inital_top_left) : ditto.
	(scg_set_left_col) : ditto.
	(scg_set_top_row) : ditto.
	(scg_make_cell_visible) : ditto.
	(scg_set_panes) : ditto.
	* src/workbook-control-gui.c (wbcg_menu_state_update) : ditto.
	(cb_view_freeze_panes) : ditto.
	* src/xml-io.c (xml_read_sheet_layout) : ditto.
	(xml_write_sheet_layout) : ditto.

2002-06-27  Jody Goldberg <jody@gnome.org>

	* src/main-application.c : include gui-file.h

	* src/mathfunc.c : silence some warnings.

	* src/gui-util.c : add missing include.

2002-06-26  Jody Goldberg <jody@gnome.org>

	* configure.in : bump the gsf version req

2002-06-26  Jody Goldberg <jody@gnome.org>

	* src/expr.c (do_gnm_expr_unref) : add missing break.

2002-06-26  Jody Goldberg <jody@gnome.org>

	* src/gui-util.c (gui_file_open) : move the magic directory selector
	  for here.
	(gnumeric_dialog_file_selection) : to here, so that it works for other
	  situations too.

2002-06-26  Jon K Hellan  <hellan@acm.org>

	* GNOME_Gnumeric.server.in.in: Add mime types for lotus, applix,
	oleo & xbase.

2002-06-25  Jon K Hellan  <hellan@acm.org>

	* src/bonobo-io.c (get_raw_bytes_from_stream)
	(get_bytes_from_compressed_stream, get_bytes_from_stream)
	(cleanup_stream, check_gzip_header, init_for_inflate)
	(hack_xmlSAXParseFile, deserialize_wb_from_xml_stream)
	(read_from_stream): Remove.
	(gnumeric_bonobo_read_from_stream): GsfInput-ize. Probe for file
	type.

2002-06-24  Morten Welinder  <terra@diku.dk>

	* src/regression.c: Include Daniel Carrera's experimental
 	non-linear regression code (still unreachable).  Fix the most
 	obvious porting mistakes and leaks.

2002-06-24  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=86338
	* src/formats.c (cell_format_time) : reorder to keep hour major
	  formats before minute major.

	* src/number-match.c (MatchType) : add cummulative types.
	(compute_value) : support cummulative time.

2002-06-24  Jody Goldberg <jody@gnome.org>

	* src/func-builtin.c : finish cleaning out the 'selection' function
	and silence the warnings.

2002-06-23  Jody Goldberg <jody@gnome.org>

	* src/sheet-control-gui-priv.h (SCG_FOREACH_PANE) : respect the
	  GnumericPane::is_active flag to begin support for h/v only freezing.
	* src/sheet-control-gui.c (scg_redraw_headers) : ditto.
	(scg_make_cell_visible) : ditto.

	* src/sheet-view.c (sv_attach_control) : position the cursors for the
	  newly attached control.

	* src/func-builtin.c (func_builtin_init) : delete the 'selection'
	  function.  It is no longer possible with a sheetview.

	* src/workbook-control-gui.c (cb_select_auto_expr) : remove
	  'selection(0)' argument and just pass function name.  The conversion
	  to SheetView forces a different methodology.
	* src/workbook-view.c (workbook_view_new) : ditto.
	(wb_view_auto_expr_recalc) : Make the call manually.

2002-06-22  Jody Goldberg <jody@gnome.org>

	* src/expr.h : support constructed ranges.
	* src/parser.y (parser_sheet_by_name) : ditto.
	* src/expr-name.c (name_refer_circular) : ditto.

	* src/expr.c (do_gnm_expr_unref) : support range_ctor and reorder to
	  produce a better jump table.
	(gnm_expr_equal) : ditto.
	(do_expr_as_string) : ditto.
	(gnm_expr_rewrite) : ditto.
	(ets_hash) : ditto.
	(ets_equal) : ditto.
	(expr_tree_sharer_share) : ditto.
	(expr_eval_real) : ditto and use gnm_expr_extract_ref.
	(gnm_expr_extract_ref) : new.

2002-06-21  Jody Goldberg <jody@gnome.org>

	* src/workbook-view.c (workbook_view_new) : add views of all existing
	  sheets.

	* src/workbook-control-component.c (wbcc_sheet_focus) : move to new
	signature.

	* src/application.c (gnumeric_application_finalize) : do not free the
	  clipboard here.  It is too late.

2002-06-21  Jody Goldberg <jody@gnome.org>

	* src/parse-util.c (parse_cell_name) : take a cellpos *

	* src/func-builtin.c (gnumeric_selection) : dummy out for now until a
	  different approach is available.

	* src/commands.c : convert to sheetview.
	  s/parent/cmd/ to make things more readable
	(cmd_selection_clear) : rename from cmd_clear_selection so that we can
	  start to group the operations that currently operate on selections.
	(cmd_selection_format) : rename from cmd_format.
	(cmd_selection_colrow_hide) : rename from cmd_colrow_hide_selection.
	(cmd_selection_outline_change) : rename from cmd_colrow_outline_change.
	(cmd_selection_group) : rename from cmd_group.
	(cmd_selection_autoformat) : rename from cmd_autoformat.
	(cmd_colrow_hide_correct_selection) : take a control.

	* src/colrow.c (cb_colrow_visibility) : selections are now part of
	  sheetview.
	(colrow_get_visibility_toggle) : ditto.

	* src/cmd-edit.c (cmd_select_cur_row) : convert to sheetview.
	(cmd_select_cur_col) : ditto.
	(cmd_select_cur_array) : ditto.
	(cmd_select_cur_depends) : ditto.
	(cmd_select_cur_inputs) : ditto.
	(cmd_paste_to_selection) : ditto.

	* src/bonobo-io.c (deserialize_wb_from_xml_stream) : pass the wbv into
	  the context directly.
	(gnumeric_bonobo_write_workbook) : ditto.
	(gnumeric_bonobo_read_workbook) : ditto.

	* src/consolidate.c (redraw_respan_and_select) : set selection only
	  for the calling view.
	(row_consolidate) : pass in the view.
	(col_consolidate) : ditto.
	(colrow_consolidate) : ditto.
	(consolidate_apply) : Take a control so that we can extract the view.

	* src/commands.c (cmd_consolidate_redo) : Pass the control.

2002-06-20  Jody Goldberg <jody@gnome.org>

	* src/sheet-view.c (sheet_view_init) : init the selection.

	* src/workbook-view.c (workbook_view_new) : init current_sheet_view.
	(wb_view_format_feedback) : operate on the sheetview.
	(wb_view_selection_desc) : ditto.
	(wb_view_edit_line_set) : ditto.

2002-06-20  Jody Goldberg <jody@gnome.org>

	* src/workbook-view.c (wb_view_sheet_add) : Use sheet_get_view.
	(wb_view_sheet_focus) : ditto.
	* src/xml-io.c (xml_write_selection_info) : ditto.
	(xml_read_selection_info): ditto.
	(xml_workbook_write) : now that the view is in the context don't
	  bother passing it.
	(xml_write_wbv_attributes) : ditto.
	(xml_read_wbv_attributes) : ditto.

2002-06-21  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/application.h (gnumeric_application_get_app) : new
	* src/application.c (gnumeric_application_get_app) : new
	(application_clipboard_clear) : emit "clipboard_modified" rather than
	  calling wb_control_menu_state_update on each control
	(application_clipboard_cut_copy) : ditto
	* src/libgnumeric.c (gnm_common_init) : remove debug spew, no need
	  to keep an app pointer
	(gnm_shutdown) : use gnumeric_application_get_app rather than a static
	  app pointer
	* src/workbook-control-priv.h : new clipboard_changed_signal field in
	  WorkbookControl
	* src/workbook-control.c (cb_wbc_clipboard_modified) : new
	(wbc_finalize) : disconnect signal handler
	(workbook_control_init) : new

2002-06-21  Morten Welinder  <terra@diku.dk>

	* configure.in: When checking for 2.96, use $CC.

2002-06-20  Jon K Hellan  <hellan@acm.org>

	* configure.in (have_pygtk): Add test for Pygtk.

	* acconfig.h: Add WITH_PYGTK

2002-06-19  Jody Goldberg <jody@gnome.org>

	* src/application.c (application_clipboard_cut_copy) : Use sv_weak_ref.
	(application_clipboard_clear) : Use sv_weak_unref.

	* src/workbook-view.c (wb_view_sheet_add) : create the view before
	  potentially looking for it.

	* src/workbook-edit.c (wbcg_edit_finish) : Accept text with only a
	  leading expr char as strings, we know they cannot be expressions.

	* src/parse-util.c (gnumeric_char_start_expr_p) : be more lenient
	  about accepting leading '+' as the start of an expression.

	* src/application.c (application_set_selected_sheet) : merge into.
	(application_clipboard_cut_copy) : here.

2002-06-19  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/application.h : gobjectify
	* src/application.c : gobjectify; replace app. with app-> throughout
	(application_init) : deleted
	(gnumeric_application_init) : new
	(gnumeric_application_class_init) : new
	(application_display_dpi_set) : deleted
	(application_use_auto_complete) : use gconf
	(application_live_scrolling) : ditto
	(application_auto_expr_recalc_lag) : ditto
	(gnumeric_application_setup_icons) : new
	(gnumeric_application_finalize) : finalize
	* src/libgnumeric.c (gnm_common_init) : use new application object
	(gnm_shutdown) : ditto
	* src/commands.c (cmd_cell_range_is_locked_effective) : use range type
	(cmd_dao_is_locked_effective) : new
	(cmd_sort_redo) : check for locks

2002-06-19  Morten Welinder  <terra@diku.dk>

	* src/mathfunc.c: Update to R 1.5.1.
	(pexp, pweibull): Use R's version.  All callers
	changed to match new prototype.

2002-06-19  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (sheet_destroy) : no need to unant, that is a view
	  responsibility.

	* src/sheet-view.c (sv_weakref_notify) : new.
	(sv_weak_ref) : new.
	(sv_weak_unref) : new.
	(sv_unant) : move here from sheet.
	(sv_ant) : move here from sheet.
	(sv_selection_copy): from selection.c
	(sv_selection_cut) : from selection.c

	* src/sheet-control.c (sc_view) : new.

	* src/sheet-control-gui.c (scg_ant) : the animated cursors are now
	  stored in the view not the sheet.
	(context_menu_handler) : sync with the workbook control criteria for
	  enabling paste special.

	* src/selection.c (sheet_selection_copy) : start the process of
	  migrating to SheetView and move this there.
	(sheet_selection_cut) : ditto.

	* src/item-cursor.c (item_cursor_do_action) : pass a SheetView.

	* src/gnumeric-canvas.c (gnm_canvas_key_mode_sheet) : pass a
	  SheetView.

	* src/corba-sheet.c : untested patch to handle views.

	* src/commands.c (cmd_ins_del_colrow_undo) : use the sheetview.
	(cmd_ins_del_colrow_redo) : ditto.
	(cmd_ins_del_colrow_finalize) : remove weakref on the view.
	(cmd_ins_del_colrow) : add a weak ref to the view.

	* src/application.c (application_init) : we store a view now, not just
	  a sheet.
	(application_clipboard_clear) : update all workbooks, not just this
	  one, and store the view.
	(application_clipboard_unant) : use the view.
	(application_set_selected_sheet) : the selection is now view based.
	(application_clipboard_cut_copy) : take a view and remove the crufy
	  enable_paste_special flag.  That is handled locally.
	(application_clipboard_is_empty) : handle SheetView.
	(application_clipboard_is_cut) : ditto.
	(application_clipboard_sheet_get) : ditto.
	(application_clipboard_sheet_view_get) : ditto.

	* src/workbook-control-gui.c (wbcg_menu_state_update) : Use the
	  current sheet not some magic sheet.

	* src/sheet.c (sheet_new) : delete enable_paste_special.

	* src/workbook-control-gui.c (wbcg_menu_state_update) : paste special
	  is for local copies, use the application data rather than a sheet
	  local flag.

2002-06-19  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (sheet_attach_view) : renamed from sheet_attach_control.
	(sheet_detach_view) : renamed from sheet_detach_control.

	* src/sheet-view.c : new.

	* src/sheet-control.c (sc_sheet_set) : delete bogus.
	(sc_view) : new.

	* src/sheet-control-gui.c (sheet_control_gui_new) : A control now takes a
	  view in place of a model.

	* src/selection.c (sheet_selection_redraw) : adjustment to
	  SHEET_FOREACH_CONTROL.

	* src/gnumeric.h : Add SheetView
	* src/Makefile.am : Add sheet-view.[ch]

2002-06-18  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_insert_current_date) : check for
	  failure to start editing.
	(cb_insert_current_time) : ditto.

2002-06-18  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-graph.c (gnm_graph_vector_seq_scalar) : forward port a
	  patch for keelyn.

	* src/file.c (gnum_file_saver_save_to_stream_real) : forward port a
	  warning suppression.

	* src/clipboard.c (clipboard_paste_region) : restore the expr_relocate
	  code in preparation for supporting the XL style heuristic.

	* src/GNOME_Gnumeric.xml : forward port some fixes.
	* src/sheet-object-widget.c (cb_scrollbar_value_changed) : ditto.
	(sheet_widget_scrollbar_set_sheet) : ditto.

2002-06-17  Jody Goldberg <jody@gnome.org>

	* src/dependent.c (cb_name_invalidate) : renamed from
	  cb_name_invalidate_sheet.  Just set the expression to NULL.
	  no need to be polite.  It just confuses things during workbook
	  destruction when the name references another sheet which has already
	  been destroyed.

2002-06-17  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (cmd_cell_range_is_locked_effective) : use
	  gnumeric_error_invalid rather than gnumeric_notice,
	  change arguments to cmd_cell_range_is_locked_effective
	  throughout.
	(cmd_selection_is_locked_effective) : change arguments
	(cmd_clear_redo) : check for locked cells
	(cmd_format_redo) : check for locked cells

2002-06-17  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (cmd_selection_is_locked_effective) : new
	(cmd_area_set_text_redo) : check for locked cells
	(cmd_ins_del_colrow_redo) : check for locked cells and split arrays

2002-06-15  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/application.c : add pixmaps
	* src/commands.c (cmd_reorganize_sheets_undo) : change call to
	  cmd_reorganize_sheets
	(cmd_reorganize_sheets_redo) : ditto
	(cmd_reorganize_sheets_finalize) : handle lock lists
	(cmd_reorganize_sheets) : handle lock lists
	* src/commands.h (cmd_reorganize_sheets) : change arguments
	* src/workbook-control-gui.c : change calls to cmd_reorganize_sheets
	* src/workbook.c (workbook_sheet_reorganize) : handle changed locks
	* src/workbook.h (workbook_sheet_reorganize) : add arguments
	* src/pixmaps/Makefile.am : add padlock_no.xpm and padlock.xpm
	* src/pixmaps/padlock_no.xpm : new
	* src/pixmaps/padlock.xpm : new

2002-06-14  Jody Goldberg <jody@gnome.org>

	* src/workbook.c (workbook_sheet_detach) : add comment that we should
	  not do the check if it is during destruction.
	(workbook_finalize) : Its too late to destroy the 3d depends here.
	* src/dependent.c (workbook_deps_destroy) : do it here.

	* src/parser.y (parser_sheet_by_name) : new utility function to
	  support applix style absolute sheet references.
	(sheetref) : parser_sheet_by_name.

2002-06-13  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (cmd_cell_range_is_locked_effective) : new
	(cmd_analysis_tool_redo) : check whether output region is locked.

2002-06-13  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/workbook-control-gui.c (workbook_close_if_user_permits) :
	show "All" buttons only if multiple workbooks are open.

2002-06-13  Jody Goldberg <jody@gnome.org>

 	http://bugzilla.gnome.org/show_bug.cgi?id=85181
	* src/workbook-edit.c (wbcg_edit_start) : protect against recursion
	  before testing for protection, we may already have a dialog up.

2002-06-12  Rodrigo Moya <rodrigo@gnome-db.org>

	* src/file.c:
	* src/plugin-service.c: s/IS_GSF/GSF_IS

2002-06-11  Jon K Hellan  <hellan@acm.org>

	* src/file.c: Include unistd.h to declare unlink, close and read.

	* src/main-application.c: Inlude bonobo-main.h to declare
	bonobo_activate.

2002-06-10  Jon K Hellan  <hellan@acm.org>

	* src/file.c: Fix up includes to make the bonobo version build.

	* src/plugin-service.c: Ditto.

	* src/gui-file.c (ask_for_file_saver, gui_file_save_to_stream):
	Disable for now to make the bonobo version build.

	* src/workbook-control-gui.c (cb_file_send): Ditto.

2002-06-07  Jody Goldberg <jody@gnome.org>

	* src/workbook-view.c (wb_view_open) : convert to libgsf.

	* src/stf.c (stf_open_and_read) : convert to libgsf.
	(stf_preparse) : ditto.
	(stf_read_workbook) : ditto.
	(stf_read_workbook_auto_csvtab) : ditto.
	(stf_read_default_probe) : ditto.

	* src/stf-parse.c (stf_parse_is_valid_data) : actually disable the
	  wide char support if it is not available.

	* src/gutils.c (gnm_extension_pointer) : copied from libgnome to
	  decrease our dependence on it.

	* src/gui-util.c (gnumeric_editable_enters) : modernize a bit.

	* src/gnumeric-simple-canvas.c (gnm_simple_canvas_grab) : suppress
	  warning.

	* src/file.c (gnum_file_opener_probe_real) : Use libgsf.
	(gnum_file_opener_open_real) : ditto.
	(gnum_file_opener_probe) : ditto.
	(gnum_file_opener_open) : ditto.
	(gnum_file_saver_save_to_stream_real) : disable, we can move this out
	  of here when GsfOutput comes online.

	* src/collect.c (string_range_function) : suppress warning.

	* src/cell.c (cell_set_array_formula) : Adjust to the signature change
	  for gnm_expr_new_array.
	* src/sheet-autofill.c (autofill_cell) : ditto.

2002-06-07  Jody Goldberg <jody@gnome.org>

	* configure.in : require libgsf.

	* src/xml-io.c (xml_check_version) : move the sanity checking here.
	(gnumeric_xml_read_workbook) : rather than here.  Support GsfInput.
	(xml_probe) : and here.
	(gnumeric_xml_write_workbook_to_stream) : delete.

2002-05-31  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-simple-canvas.c (gnm_simple_canvas_grab) : actually
	  return the result.

2002-06-01  Jody Goldberg <jody@gnome.org>

 	http://bugzilla.gnome.org/show_bug.cgi?id=83794
	* src/stf.c (stf_read_workbook_auto_csvtab) : simple autodetection of
	  tab delimited vs csv

	http://bugzilla.gnome.org/show_bug.cgi?id=82847
	* src/value.c (parse_criteria_range) : Check for null in both cases.
	  Clean up a touch while we are in here.

2002-05-29  Jody Goldberg <jody@gnome.org>

	* src/Makefile.am (EXTRA_DIST) : include main-component.c

2002-05-29  Jody Goldberg <jody@gnome.org>

	* configure.in : post release version bump

2002-05-29  Jody Goldberg <jody@gnome.org>

	* Release 1.1.4

2002-05-29  Jody Goldberg <jody@gnome.org>

	* src/Makefile.am : tweak to make automake happy

2002-05-27  Jody Goldberg <jody@gnome.org>

	* configure.in : up the gnome-print req.

2002-05-29  Jody Goldberg <jody@gnome.org>

	* src/parse-util.h : Add PERR_SINGLE_RANGE.

2002-05-29  Jon Kåre Hellan  <hellan@acm.org>

	* configure.in (try_python): Fix typo

2002-05-22  Jody Goldberg <jody@gnome.org>

	* src/clipboard.c (clipboard_paste_region) : remove
	  PASTE_EXPR_RELOCATE.  It was added so that sorting cells with
	  relative references would change, but it was not well considered and
	  causes breakage.

2002-05-21  Morten Welinder  <terra@diku.dk>

	* src/func-builtin.c (func_builtin_init, shutdown_cat): Use plain
	function_get_category.

	* src/func.c (function_get_category): Don't use NULL as translated
	name -- translate!
	(function_add_placeholder): Use plain function_get_category.

2002-05-21  Morten Welinder  <terra@diku.dk>

	* src/func.c (function_def_get_arg_name): Fix char/string type
	mismatch.  Bad Andreas!
	(functions_shutdown): Remove stubs for unknown functions.
	(function_add_placeholder): Keep track of unknown functions.

	* configure.in: Refuse to compile with gcc 2.96.

2002-05-20  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-dialogs.schemas : add 2 printer schemas
	* src/gnumeric-gconf-priv.h : add printer keys
	* src/gnumeric-gconf.c : add printer get/set methods
	* src/gnumeric-gconf.h : ditto
	* src/print.c (print_job_info_set_one_time_defaults) : add 2 settings
	(print_job_info_save_one_time_defaults) : ditto

2002-05-19  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (cmd_print_setup_redo) : dirty all sheets if
	  parent.sheet == NULL

2002-05-16  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-component.c (wbcc_set_sensitive): New
	(wbcc_menu_state_sensitivity): Remove
	(workbook_control_component_ctor_class): Register
	wbcc_set_sensitive and remove wbcc_menu_state_sensitivity.

2002-05-16  Jody Goldberg <jody@gnome.org>

	* src/workbook-view.c (wb_view_open) : Use wb_control_set_sensitive.

	* src/workbook-control-priv.h :
	  remove menu.set_sensitivity
	  add set_sensitive
	* src/workbook-control.[ch] : ditto.

	* src/workbook-control-gui.c (cb_thaw_ui_toolbar) : call
	  wbcg_menu_state_sensitivity directly.
	(wbcg_edit_set_sensitive) : ditto.
	(wbcg_set_sensitive) : new.
	(workbook_control_gui_ctor_class) : register wbcg_set_sensitive and
	  remove wbcg_menu_state_sensitivity.

2002-05-15  Andreas J. Guelzow <aguelzow@taliesin.ca>
	* src/print-info.c (print_info_set_margin_right) : remove some
	  debugging code

2002-05-15  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* configure.in : bump lignomeprintui req to 0.115.0
	* src/print-info.c (print_info_new) : margins are now in print_config
	(print_info_save) : ditto
	(print_info_dup) : ditto
	(print_info_get_margins) : new
	(print_info_set_margin_header) : new
	(print_info_set_margin_footer) : new
	(print_info_set_margin_left) : new
	(print_info_set_margin_right) : new
	(print_info_set_margins) : new
	* src/print-info.h (print_info_get_margins) : new
	(print_info_set_margin_header) : new
	(print_info_set_margin_footer) : new
	(print_info_set_margin_left) : new
	(print_info_set_margin_right) : new
	(print_info_set_margins) : new
	* src/print.c (print_hf_element) : margins are now in print_config
	(print_headers) : ditto
	(print_footers) : ditto
	(print_page) : ditto
	(print_job_info_get) : ditto
	* src/xml-io.c (xml_node_set_print_margins) : new
	(xml_node_get_print_margin) : new
	(xml_write_print_info) : margins are now in print_config
	(xml_print_info_fix_margins) : ditto
	(xml_read_print_margins) : ditto

2002-05-15  Morten Welinder  <terra@diku.dk>

	* src/main-application.c (warn_about_ancient_gnumerics): Don't
	complain unless the file name has a slash in it.

2002-05-14  Jon K Hellan  <hellan@acm.org>

	* src/main-component.c (control_activated_cb): Don't call
	bonobo_ui_component_rm. We got a warning from bonobo when the
	containing shell was deleted.

2002-05-14  Jon K Hellan  <hellan@acm.org>

	* src/GNOME_Gnumeric_Component.xml: Add File/Print setup,
	File/Print, File/Print preview.

	* src/workbook-control-component.c (cb_file_print_setup)
	(cb_file_print, cb_file_print_preview): New functions. Invoke
	File/Print setup, File/Print, File/Print preview.
	(verbs): Add File/Print setup, File/Print, File/Print preview.

	* src/main-component.c (gnumeric_component_factory): Initialize
	plugins. Yet another bpb.

2002-05-14  Morten Welinder  <terra@diku.dk>

	* configure.in (GNUMERIC_LOCALE_DIR): Deduce.
	* src/libgnumeric.c (init_init): Use GNUMERIC_LOCALE_DIR.

2002-05-14  Jon K Hellan  <hellan@acm.org>

	* src/bonobo-io.c (read_from_stream): Brown paper bag.

2002-05-14  Jon K Hellan  <hellan@acm.org>

	* src/bonobo-io.c (init_for_inflate): Use size of buffer, not size
	of pointer to buffer.

2002-05-13  Jon K Hellan  <hellan@acm.org>

	* src/cmd-edit.[ch] (cmd_paste): Remove 'time' parameter.

	* src/cmd-edit.c (cmd_paste): Call wb_control_paste_from_selection
	without 'time' parameter.
	(cmd_paste_to_selection): Call cmd_paste without 'time' parameter.

	* src/item-cursor.c (item_cursor_do_action): Remove 'time'
	parameter. Call cmd_paste without 'time' argument.
	(context_menu_hander, item_cursor_do_drop): Call
	item_cursor_do_action without 'time' argument.

	* src/gui-clipboard.[ch]: Switched to GtkClipboard API.
	(x_request_clipboard): Remove 'time' parameter.
	(x_clipboard_bind_workbook): Remove.
	(x_claim_clipboard): New function. Claims ownership of primary and
	clipboard.

	* src/gui-clipboard.c
	(x_clipboard_to_cell_region): Renamed from
	x_selection_to_cell_region.
	(x_clipboard_received): Renamed from
	x_selection_received. 'widget' parameter replaced with
	'clipboard', and 'time' parameter dropped. Call
	gtk_clipboard_request_contents instead of gtk_selection_convert.
	(x_clipboard_get_cb): Renamed from x_selection_handler. 'widget'
	parameter replaced with 'clipboard', and 'time' parameter dropped.
	Don't trust 'info' parameter. Gtk bug?
	(x_clipboard_clear_cb): New function. Replaces x_selection_clear,
	but even simpler.
	(x_request_clipboard): Call gtk_clipboard_request_contents instead
	of gtk_selection_convert.

	* src/workbook-control.[ch], src/workbook-control-priv.h: Remove
	'time' parameter from paste_from_selection method.

	* src/workbook-control-component.c (wbcc_claim_selection): Remove.
	(workbook_control_component_ctor_class): Inherit claim_selection
	from superclass.

	* src/workbook-control-gui.c (wbcg_paste_from_selection): Remove
	'time' parameter and call x_request_clipboard without 'time'
	parameter.
	(wbcg_claim_selection): Replace old implementation with call to
	new function x_claim_clipboard.
	(workbook_control_gui_init): Remove call to
	x_clipboard_bind_workbook.

2002-05-13  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/plugin.c (gnumeric_extra_plugin_dirs) : don't memorize the
	  answer
	(plugin_db_rescan) : new
	* src/plugin.h (plugin_db_rescan) : new

2002-05-12  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/workbook-control-gui.c (workbook_close_if_user_permits) : add
	  arguments and add discard-all and save-all buttons when exiting.
	(cb_file_quit) : handle discard-all and save-all

2002-05-11  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-component.c (wbcc_set_transient_for):
	Enable bonobo_control_set_transient_for. It's fixed in libbonoboui
	now.

2002-05-11  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gnumeric-gconf.c (gnm_gconf_rm_notification_autocorrect) :
	  renamed to gnm_gconf_rm_notification
	(nm_gconf_add_notification_plugin_directories) : new
	* src/gnumeric-gconf.h : ditto
	* src/gui-util.c (fsel_dir_handle_ok) : new
	(gnumeric_dialog_dir_selection) : new
	* src/gui-util.h (gnumeric_dialog_dir_selection) : new

2002-05-10  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-gui.c (cb_file_preferences): Add wbcg
	argument to dialog_preferences.
	(cb_format_preferences): Ditto.

2002-05-10  Morten Welinder  <terra@diku.dk>

	* src/value.c (value_new_string_nocopy): New function.
	(value_new_string): Simplify.

2002-05-10  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-gui.c (workbook_setup_sheets): Really
	revert kluge.

2002-05-10  Jon K Hellan  <hellan@acm.org>

	* src/gnumeric-canvas.c: oops. Committed this file by mistake, and
	have to revert.

2002-05-10  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-gui.c (workbook_setup_sheets): Remove
	resize kluge. It broke things on Solaris.

2002-05-09  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-general.schemas : add 3 printer schemax
	* src/gnumeric-gconf-priv.h : add printer keys
	* src/gnumeric-gconf.c : add printer get/set methods
	* src/gnumeric-gconf.h : ditto
	* src/print.c (print_job_info_set_one_time_defaults) : new
	(print_job_info_save_one_time_defaults) : new
	(print_job_info_get) : call print_job_info_set_one_time_defaults
	(sheet_print) : call print_job_info_save_one_time_defaults

2002-05-08  Jon K Hellan  <hellan@acm.org>

	* src/gui-util.c (gnumeric_dialog_run): Silence warnings.

2002-05-08  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-gui.c, src/workbook-control-gui-priv.h
	(wbcg_scroll_wheel_support_cb): Rename from
	cb_scroll_wheel_support and export protected.

	* src/workbook-control-component.c: Add more missing includes:
	commands.h, selection.h, sheet-control-gui.h, workbook-edit.h.
	(wbcc_validation_msg): Return a dummy 0 to satisfy prototype.
	(workbook_control_component_init): Remve unused drag_types
	variable. Add signal handler for mouse wheel scrolling.

2002-05-08  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-component.c: Include "dialogs.h" to get
	prototype for dialog_search.

	* src/bonobo-io.c (cleanup_stream): Return status.

2002-05-08  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control.[ch], src/workbook-control-priv.h
	(wb_control_edit_set_sensitive): New virtual, replacing
	workbook_edit_set_sensitive in workbook-edit. Made parameter names
	descriptive because it's now used far away from where it is
	defined.

	* src/workbook-control-component.c (wbcc_edit_set_sensitive): Null
	implementation of new virtual.
	(workbook_control_component_init): Construct, but don't show, the
	edit area, to avoid warnings when range selecting.
	(workbook_control_component_ctor_class): Register
	edit_set_sensitive implementation.

	* src/workbook-control-gui.[ch] (wbcg_toolbar_timer_clear): Moved
	from workbook-edit, renamed and exported.

	* src/workbook-control-gui.h (cb_thaw_ui_toolbar): Moved from
	workbook-edit.
	(wbcg_edit_set_sensitive): Implementation of new virtual
	wb_control_edit_set_sensitive, moved from workbook-edit and
	renamed from workbook_edit_set_sensitive.
	(workbook_control_gui_ctor_class): Register edit_set_sensitive
	implementation.

	* src/workbook-edit.c (toolbar_timer_clear, cb_thaw_ui_toolbar,
	workbook_edit_set_sensitive): Move to workbook-control-gui.
	(wbcg_edit_finish, (wbcg_edit_start, wbcg_edit_attach_guru,
	wbcg_edit_detach_guru):
	s/workbook_edit_set_sensitive/wb_control_edit_set_sensitive/

2002-05-08  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/workbook-edit.c : include gnumeric-gconf.h
	* src/workbook-edit.h : declare wbcg_edit_attach_guru_with_unfocused_rs

2002-05-08  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-general.schemas : add unfocused-rs schema
	* src/gnumeric-gconf-priv.h : add unfocused-rs key and fix
	  print-setup-all-sheets key
	* src/gnumeric-gconf.c : add unfocused-rs get/set methods
	* src/gnumeric-gconf.h : ditto
	* src/workbook-edit.c (wbcg_edit_attach_guru_main) : new
	(wbcg_edit_attach_guru) : split off wbcg_edit_attach_guru_main
	(wbcg_edit_attach_guru_with_unfocused_rs) : new

2002-05-06  Jon K Hellan  <hellan@acm.org>

	* src/bonobo-io.c (deserialize_wb_from_xml_stream)
	(gnumeric_bonobo_read_from_stream): Display message on error.

	* src/workbook-control-component.c
	(workbook_control_component_ctor_class): Inherit io context
	methods from wbcg.
	(wbcc_error_system, wbcc_error_read, wbcc_error_read)
	(wbcc_error_read, wbcc_error_save, wbcc_error_invalid)
	(wbcc_error_error_info): Remove.

	* src/gui-util.c (gnumeric_dialog_run): Use wbcg_set_transient
	instead of gtk_window_set_transient_for.

2002-05-06  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/print.c (print_job_info_get) : duplicate print_info
	(print_job_info_destroy) : destroy print_info
	(sheet_print) : use range info from print dialog

2002-05-06  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-general.schemas : add print-setup-all-sheets schema
	* src/gnumeric-gconf-priv.h : add print-setup-all-sheets key
	* src/gnumeric-gconf.c : add print-setup-all-sheets get/set methods
	* src/gnumeric-gconf.h : ditto
	* src/commands.c (cmd_print_set_up) : allow sheet == NULL (ie. all sheets)
	(cmd_print_set_up_redo) : handle sheet == NULL
	(cmd_print_set_up_undo) : handle sheet == NULL

2002-05-05  Jon K Hellan  <hellan@acm.org>

	* GNOME_Gnumeric.server.in.in: Add Bonobo Zoomable interface.

	* src/main-component.c (control_activated_cb): Don't set
	wbcc->bcontrol here.
	(zoom_level_from_index, zoomable_set_zoom_level_cb,
	zoomable_zoom_in_cb, zoomable_zoom_out_cb,
	zoomable_zoom_to_fit_cb, zoomable_zoom_to_default_cb): New
	functions to support zoomable interface.
	(add_interfaces): Add zoomable interface.
	(gnumeric_component_factory): Call wbcc_set_bcontrol.

	* src/workbook-control-component.[ch]
	wbcc_get_zoom_factor): New function. Return zoom factor of current
	sheet.
	(wbcc_set_zoom_factor): New function. Set zoom factor for current
	sheet.
	(wbcc_sheet_focus): Report zoom level.
	(wbcc_set_bcontrol): New function. Setter for private 'bcontrol'
	attribute.
	(wbcc_set_zoomable): New function. Setter for private 'zoomable'
	attribute.
	(workbook_control_component_activate): Remove 'control' from
	signature. Use wbcc->bcontrol instead.

	* src/workbook-control-component.c (wbcc_zoom_feedback): Implement
	method.

	* src/workbook-control-component-priv.h (struct
	_WorkbookControlComponent): Add 'zoomable' attribute.

2002-05-05  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-general.schemas : add zoom-factor schema
	* src/gnumeric-gconf-priv.h : add zoom-factor key
	* src/gnumeric-gconf.c : add zoom-factor get/set methods
	* src/gnumeric-gconf.h : ditto
	* configure.in : update libgnomeprint/libgnomeprintui req.
	* src/sheet.c (sheet_new) : use zoom factor from preferences

2002-05-05  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c : add cmd_print_set_up and friends
	* src/commands.h : add cmd_print_set_up
	* src/print-info.c (save_margin) : constify second argument
	(save_range) : ditto
	(print_info_margin_copy) : constify first argument and fix
	  silly typo
	(print_info_dup) : fix leak

2002-05-05  Jon K Hellan  <hellan@acm.org>

	* src/Makefile.am: Fix typo in GNOME_Gnumeric_Component.xml

2002-05-05  Pablo Saratxaga  <pablo@mandrakesoft.com>

	* configure.in: Added Vietnamese (vi) to ALL_LINGUAS

2002-05-05  Jon K Hellan  <hellan@acm.org>

	* src/GNOME_Gnumeric_Component.xml: Add UI for the viewer component.

	* src/Makefile.am: Add UI file for the viewer component.

	* src/gui-util.c (gnumeric_keyed_dialog): Use
	wbcg_set_transient instead of gnumeric_set_transient.

	* src/main-component.c (control_activated_cb): New signal handler
	to handle component activation/deactivation.
	(gnumeric_component_factory): Register activation/deactivation
	signal handler

	* src/workbook-control-component.[ch]
	(workbook_control_component_activate): New function. Merge in our
	UI.

	* src/workbook-control-component-priv.h
	(struct	_WorkbookControlComponent): Add bcontrol member for the
	BonoboControl.

	* src/workbook-control-component.c (wbcc_set_transient_for): New
	function. Set a dialog transient for the bonobo shell which
	contains us.
	(bcontrol_get_wbcg): New function. Get the WorkbookControl from
	the BonoboControl. This is implemented by means of object data on
	the BonoboControl.
	(cb_file_summary): New function. Pop up the Properties dialog.
	(cb_edit_copy): New function. Copy the selection.
	(cb_edit_search): New function. Pop up the search dialog.
	(cb_help_about): New function. Pop up the "About Gnumeric" dialog.
	(verbs): Add them.
	(workbook_control_component_init): Zero the bcontrol field.
	(workbook_control_component_ctor_class): Override the wbcg
	set_transient method.

	* src/workbook-control-gui.[ch] (wbcg_set_transient): New virtual
	method to set a dialog transient for the toplevel.

	* src/workbook-control-gui-priv.h (WorkbookControlGUIClass): Add
	set_transient virtual method.

	* src/workbook-control-gui.c (WBCG_CLASS, WBCG_VIRTUAL_FULL,
	WBGC_VIRTUAL): Define macros, analogous to macros in
	workbook-control.c.
	(wbcg_set_transient_for): New function. set_transient
	implementation for wbcg.
	(workbook_setup_sheets): Resize notebook from an idle handler to
	work around a display problem in the component. Explain why we had
	to do this.
	(workbook_control_gui_ctor_class): Add set_transient virtual method.

2002-05-04  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (sheet_colrow_get_default) : new.
	* src/commands.c (cmd_ins_del_colrow_redo) : Use it.

2002-05-04  Jukka-Pekka Iivonen  <jiivonen@cs144028.pp.htv.fi>

	* configure.in : Removed src/functions/Makefile.

2002-05-03  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/func-builtin.c : mark argument names for translation and adjust
	  them for use by the formula guru.
	* src/func.c (function_def_get_arg_name) : translate argument name

2002-05-03  Morten Welinder  <terra@diku.dk>

	* src/workbook-control-gui.c (cb_select_auto_expr): Filter out
	expressions that don't parse.  (Probably because some plugin
	wasn't loaded.)

2002-05-03  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-general.schemas : add max-initial-clauses schema
	* src/gnumeric-gconf-priv.h : add max-initial-clauses key
	* src/gnumeric-gconf.c : add max-initial-clauses get/set methods
	* src/gnumeric-gconf.h : ditto

2002-05-03  Morten Welinder  <terra@diku.dk>

	* src/rangefunc.c (range_count): New function.
	* src/func-util.h: Remove.

2002-05-02  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/print-info.c (print_info_free) : add print-config
	(print_info_new) : ditto
	(print_info_save) : ditto
	(print_info_dup) : ditto
	* src/print-info.h : add print-config to PrintInformation
	* src/print.c (print_job_info_get) : use
	  gnome_print_master_get_page_size_from_config
	(sheet_print) : use print_config included in PrintInformation
	* src/xml-io.c (xml_write_print_info) : use print_config included
	  in PrintInformation
	(xml_read_print_info) : ditto

2002-05-02  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-canvas.c (gnm_canvas_key_mode_sheet) : shift has noting
	  to do with this any more.

2002-05-02  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=79925
	* src/sheet-control-gui.c (scg_colrow_select) : flag failures to
	  initiate a selection
	* src/item-bar.c (item_bar_event) : only grab if the selection is
	  successful.

2002-05-02  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/print.c (sheet_print) : pass updated print-config to print-dialog

2002-05-01  Christophe Merlet  <christophe@merlet.net>

	* schemas/gnumeric-dialogs.schemas : Replaced // with /.
	* src/Makefile.am : Added main-application.c to $EXTRA_DIST.

2002-04-30  Jody Goldberg <jody@gnome.org>

	* src/dependent.c (cb_range_contained_collect) : begin support for
	  GnmRenderedRegion by adding support for non relocatable dependents.
	(cb_single_contained_collect) : ditto.

2002-04-29  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-pane.c (gnumeric_pane_header_init) : set a
	  non-constraining scrollregion here in case something scrolls before we
	  are realized and a real region is assigned.

	* src/sheet-object.c (sheet_object_clone_sheet) : range == NULL is legal

	* src/sheet.c (sheet_clone_colrow_info_item) : Use colrow_copy.
	  While we're here use sheet_colrow_fetch too.
	(sheet_dup) : rename from sheet_duplicate to be consistent.

2002-04-29  Jody Goldberg <jody@gnome.org>

	* configure.in : post release version bump

2002-04-29  Jody Goldberg <jody@gnome.org>

	* Release 1.1.3

2002-04-28  Jody Goldberg <jody@gnome.org>

	* src/item-cursor.c : no need to do the gdk_flushes here.
	  the grab/ungrab wrappers handle it.

2002-04-29  Jon K Hellan  <hellan@acm.org>

	* src/bonobo-io.c (deserialize_wb_from_xml_stream): New
	function. Factored out of gnumeric_bonobo_read_from_stream.
	Deserializes a Workbook from an XML stream.
	(read_from_stream): New function. Factored out of
	gnumeric_bonobo_read_from_stream. Handles bonobo stream oriented
	aspect of stream deserialization task.
	(gnumeric_bonobo_read_from_stream): Refactor so that only Workbook
	/ WorkbookView / WorkbookControl aspects of deserialization are
	handled here. The stream and XML concerns are factored out into
	separate functions. Also, fix reload bugs by making code more
	similar to wb_view_open. Still not perfect, but better.

2002-04-28  Jody Goldberg <jody@gnome.org>

	* src/sheet-control-gui.c : no longer needs item-debug support.

	* src/sheet-object.c (sheet_object_view_key) : ARRGGGHHHH.
	  cut-n-paste error.

	* src/gnumeric-simple-canvas.c (gnm_simple_canvas_ungrab) : be anal
	  and gdk_flush.
	(gnm_simple_canvas_grab) : ditto.  We periodically do some processing
	  after an ungrab which might delay flushing the event queue.  Which
	  could result in the grab remaining for the duration of the event.

2002-04-28  Jon K Hellan  <hellan@acm.org>

	* src/bonobo-io.c (gnumeric_bonobo_read_from_stream): Initialize
	wb, drop dirty test. This fixes component display bug.

2002-04-28  Jon K Hellan  <hellan@acm.org>

	* src/bonobo-io.c (gnumeric_bonobo_read_from_stream): Drop
	workbook_is_pristine test. In the viewer, we know we shouldn't
	save, but the test gives suprising results.

2002-04-27  Jody Goldberg <jody@gnome.org>

	* src/item-acetate.c (item_acetate_point) : remember that the far
	  point is not included.

	* src/bonobo-io.c (gnumeric_bonobo_read_from_stream) : similar to
	  wb_view_open we need to recalc as necessary and do a sheet_update.

	* src/workbook-control-gui.c (cb_insert_image) : no need to recalc or
	  update.

2002-04-27  Jon K Hellan  <hellan@acm.org>

	* configure.in: Check for bonobo libraries when --with-bonobo is
	selected.

2002-04-27  Jody Goldberg <jody@gnome.org>

	* src/sheet-control-gui.c (scg_finalize) : destroy the views
	  before we destroy the control.

	* src/sheet-object.c (cb_sheet_object_view_finalized) : renamed from
	  sheet_object_view_destroyed and simplified to use weakrefs.  At this
	  point all we can do is remove the view from the list.
	(sheet_object_new_view) : using weakrefs we are more constrained.
	  object data is already done so there is no need to add refs to the
	  control.

2002-04-26  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (wbcg_sheet_add) : Use
	  sc_object_create_view.

	* src/sheet-control-gui-priv.h (SCG_FOREACH_PANE) : new.
	* src/sheet-control-gui.c (scg_redraw_all) : use SCG_FOREACH_PANE.
	(scg_redraw_region) : ditto.
	(scg_resize) : ditto.
	(scg_set_zoom_factor) : ditto.
	(cb_table_destroy) : ditto.
	(sheet_control_gui_new) : ditto.
	(scg_unant) : ditto.
	(scg_ant) : ditto.
	(scg_adjust_preferences) : ditto.
	(scg_cursor_visible) : ditto.
	(scg_compute_visible_region) : ditto.
	(scg_edit_start) : ditto.
	(scg_edit_stop) : ditto.
	(scg_rangesel_changed) : ditto.
	(scg_rangesel_start) : ditto.
	(scg_rangesel_stop) : ditto.
	(scg_set_display_cursor) : ditto.
	(scg_colrow_resize_stop) : ditto.
	(scg_colrow_resize_start) : ditto.
	(scg_colrow_resize_move) : ditto.
	(scg_special_cursor_start) : ditto.
	(scg_special_cursor_stop) : ditto.
	(scg_special_cursor_bound_set) : ditto.
	(scg_object_stop_editing) : clear the control points in the panes.
	(scg_mode_edit_object) : ditto.
	(scg_object_update_bbox) : ditto.

	* src/gnumeric-pane.c (gnm_pane_init) : init anted_cursors and the
	  control points.  Optionally create views of all the objects if we
	  already have a sheet.
	(gnm_pane_object_stop_editing) : transfered from scg.
	(gnm_pane_object_move) : ditto.
	(cb_slide_handler) : ditto.
	(display_object_menu) : ditto.
	(cb_control_point_event) : ditto.
	(new_control_point) : ditto.
	(set_item_x_y) : ditto.
	(set_acetate_coords) : ditto.
	(gnm_pane_object_set_bounds) : ditto.
	(cb_sheet_object_canvas_event) : ditto.
	(cb_sheet_object_view_destroy) : ditto.
	(cb_sheet_object_widget_canvas_event) : ditto.
	(gnm_pane_object_register) : ditto.
	(gnm_pane_widget_register) : ditto.

	* src/sheet-control-gui.c (scg_object_destroy_view) : new.
	(scg_object_create_view) : new.
	(scg_class_init) : register the new functions.

	* src/sheet-object*.c
	(*update_bounds) : update signature.
	(*new_view) : update signature.

2002-04-26  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/print.c (compute_sheet_pages) : don't overwrite number of
	  pages from previous sheets.

2002-04-26  Jon K Hellan  <hellan@acm.org>

	* src/bonobo-io.c (get_bytes_from_compressed_stream): Fix typo

2002-04-26  Jon K Hellan  <hellan@acm.org>

	* src/bonobo-io.c (struct StreamIOCtxt): Context data structure
	for reading a PersistStream.
	(get_raw_bytes_from_stream): New function. Read raw bytes from the
	stream.
	(get_bytes_from_compressed_stream): New function. Uncompress bytes
	from the stream and copy wanted number of bytes into buffer.
	(get_bytes_from_stream): New function. Read bytes from the stream,
	having uncompressed them if necessary.
	(cleanup_stream): New function. Clean up zlib when closing stream.
	(check_gzip_header): New function. Check if stream is gzipped.
	(init_for_inflate): New function. Initialize data structures for
	uncompressing.
	(hack_xmlSAXParseFile): Drop the non HAVE_LIBXML_2 branch. Rename
	context variables: We now have both an xml context and a stream
	context.
	(gnumeric_bonobo_read_from_stream): Set up handling of compressed
	streams. Propagate CORBA exceptions where allowed by the
	PersistStream interface.

2002-04-25  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-general.schemas : add sort schemas
	* src/gnumeric-gconf-priv.h : add sort related keys
	* src/gnumeric-gconf.[ch] : add sort-related get/set methods
	* src/sort.[ch] : use preferences, add preserve formats flags
	* src/workbook-control-gui.c (sort_by_rows) : use preferences

2002-04-25  Jody Goldberg <jody@gnome.org>

	* src/sheet-control-gui.c (set_acetate_coords) : work around some
	  strange code in the canvas-shape that was blowing out the borders.

2002-04-25  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gnumeric-canvas.[ch] : add sheet_object_group
	* src/commands.c : add selector to cmd_object_raise
	* src/commands.h : ditto
	* src/sheet-object-container.c : use sheet_object_group
	* src/sheet-object-graphic.c : ditto
	* src/sheet-object-image.c : ditto
	* src/sheet-object-item.c : ditto
	* src/sheet-object.c (cb_sheet_object_raise_to_top) : new
	(cb_sheet_object_lower_to_bottom) : new
	(sheet_object_populate_menu) : add raise to top/lower to bottom
	  menu items

2002-04-24  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/item-grid.c (ig_obj_create_finish) : don't unref the sheet
	  object, the ref has already been absorbed elsewhere.
	  http://bugzilla.gnome.org/show_bug.cgi?id=79809

2002-04-24  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.[ch] (cmd_object_raise) : new command
	* src/sheet-object.h (sheet_object_raise) : new
	* src/sheet-object.c (sheet_object_raise) : new
	(cb_sheet_object_raise) : new
	(cb_sheet_object_lower) : new
	(sheet_object_populate_menu) : add raise/lower menu items

2002-04-24  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/print.c (setup_rotation) : deleted
	(print_page) : remove call to setup_rotation
	(sheet_print) : no need to hide landscape printing

2002-04-24  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/print.c (sheet_print) : work around some gnome-print bug and hide
	  landscape printing temporarily.

2002-04-24  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/application.c (application_clipboard_clear) : also clear CLIPBOARD
	* src/gui-clipboard.c (x_selection_clear) : clear selection only if PRIMARY
	  is asserted elsewhere
	(x_clipboard_bind_workbook) : set CLIPBOARD targets
	* src/workbook-control-gui.c (wbcg_claim_selection) : claim PRIMARY and
	  CLIPBOARD

2002-04-23  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (cmd_analysis_tool_undo) : reset column widths and
	  row heights
	(cmd_analysis_tool_redo) : save column widths and row heights
	(cmd_analysis_tool) : initialize column widths and row heights save lists
	(cmd_analysis_tool_finalize) : delete column widths and row heights save lists

2002-04-21  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* idl/Makefile.am: introduce EVOLUTION_IDL_DIR to support building
	with Evolution-Composer.idl in a non-standard location.

2001-11-04  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* configure.in: added gdk_pixbuf to the libs considered for
	GNUMERIC_CFLAGS and GNUMERIC_LIBS.

2001-10-27  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* configure.in : Support --with-python=prog consistently: never call
	`python', always call $python_prog.

2001-10-21  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* idl/Makefile.am : Introduced EVOLUTION_IDL_DIR to make it possible
	  to use Evolution-Composer.idl from a non-standard location.

2001-11-04  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* configure.in: added gdk_pixbuf to the libs considered for
	GNUMERIC_CFLAGS and GNUMERIC_LIBS.

2002-04-22  Morten Welinder  <terra@diku.dk>

	* src/value.c (criteria_test_equal, criteria_test_unequal,
	criteria_test_less, criteria_test_less_or_equal,
	criteria_test_greater, criteria_test_greater_or_equal,
	parse_criteria, parse_criteria_range, free_criterias,
	find_rows_that_match, parse_database_criteria,
	find_column_of_field): Move from fn-database.

2002-04-22  Morten Welinder  <terra@diku.dk>

	* src/expr-name.c (expr_name_shutdown): New function.

	* src/libgnumeric.c (gnm_common_init, gnm_shutdown): Fix
	prototype.
	(gnm_shutdown): Shut down expr_name.

2002-04-19  Morten Welinder  <terra@diku.dk>

	* src/expr.c (gnm_expr_new_error): Remove.

	* src/func-builtin.c (gnumeric_selection, gnumeric_version): Moved
	from fn-sheet.

2002-04-19  Jon K Hellan  <hellan@acm.org>

	* src/bonobo-io.[ch] (gnumeric_bonobo_read_from_stream): New
	function. Reads a workbook from a Bonobo PersistStream.

	* src/bonobo-io.c (hack_xmlSAXParseFile): Re-enable

	* src/main-component.c: No longer a dummy. Remove DUMMY compile
	flag.
	(load_workbook_from_stream): Remove.
	(dummy_add_interfaces): Rename to add_interfaces. Pass control to
	bonobo_persist_stream_new.
	(gnumeric_component_factory): Make a real gnumeric component.

	* src/sheet-control-gui.c (scg_take_focus): Test if wbcg_toplevel
	!= NULL.

	* src/workbook-control.[ch] (wb_control_menu_state_sheet_count):
	New virtual.

	* src/workbook-control-priv.h: Virtualize menu_state.sheet_count.

	* src/workbook-control-component.c (wbcc_get_password,
	wbcc_progress_set, wbcc_progress_message_set, wbcc_init_state,
	wbcc_title_set, wbcc_format_feedback, wbcc_zoom_feedback,
	wbcc_edit_line_set, wbcc_edit_selection_descr_set,
	wbcc_auto_expr_value, wbcc_undo_redo_clear,
	wbcc_undo_redo_truncate, wbcc_undo_redo_pop, wbcc_undo_redo_push,
	wbcc_undo_redo_labels, wbcc_menu_state_update,
	wbcc_menu_state_sheet_prefs, wbcc_menu_state_sheet_count,
	wbcc_menu_state_sensitivity, wbcc_validation_msg): New no-op
	methods.
	(wbcc_error_system, wbcc_error_plugin, wbcc_error_read,
	wbcc_error_save, wbcc_error_invalid, wbcc_error_error_info,
	wbcc_control_new, wbcc_sheet_focus, wbcc_claim_selection): New
	methods.
	(workbook_control_component_init): New function.
	(workbook_control_component_ctor_class): Flesh out.
	(workbook_control_component_new): New function.

	* src/workbook-control-gui.[ch] (wbcg_sheet_to_page_index): Rename
	from sheet_to_page_index and make public.

	* src/workbook-control-gui.c (wbcg_cur_scg, wbcg_sheet_remove,
	wbcg_sheet_rename, wbcg_sheet_focus, wbcg_sheet_move, cb_edit_cut,
	cb_sheet_remove): Use new name of from sheet_to_page_index and
	make public.
	(wbcg_sheet_add): Use virtualized menu_sheet_count.
	(workbook_control_gui_ctor_class): Virtualize menu_sheet_count.

2002-04-18  Morten Welinder  <terra@diku.dk>

	* src/expr-name.c (expr_name_add): Plug leaks.

	* src/gnumeric-graph.c: Resurrect enough so that the excel plugin
	will load.  This doesn't mean things will work!

	* src/func-builtin.c (func_builtin_init): New file.  Some stuff
	from src/functions/fn-math.c imported.

	* src/libgnumeric.c (gnm_shutdown): Shutdown functions also.

	* src/func.c (functions_init): Init builtins.
	(functions_shutdown): New function.

2002-04-18  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui-util.c (gnumeric_error_info_dialog_show) : hide cursor

2002-04-17  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui-file.c : replace gnome-config with get/set methods from
	  src/gnumeric-gconf.h
	* schemas/gnumeric-general.schemas : new schemas
	* src/gnumeric-gconf-priv.h : new keys
	* src/gnumeric-gconf.[ch] : new get/set methods

2002-04-17  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui-util.[ch] (gnumeric_dialog_show) : deleted
	* src/gui-file.c (ask_for_file_saver) : change GnomeDialog to GtkDialog
	  NOTE: untested change!
	* src/sheet-object-container.c (sheet_object_container_new_file) :
	  change GnomeDialog to GtkDialog.  NOTE: untested change!

2002-04-17  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui-util.c (gnumeric_error_info_dialog_show_full) : renamed to
	  gnumeric_error_info_dialog_show and rewritten
	(gnumeric_error_info_dialog_show) : deleted
	(ctree_insert_error_info) : deleted
	(insert_error_info) : new

2002-04-17  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui-util.c (gnumeric_error_info_dialog_show_full) : converted from
	  GnomeDialog to GtkDialog

2002-04-17  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-general.schemas : add xml-compression schema
	* src/gnumeric-gconf-priv.h : new xml-compression-level key
	* src/gnumeric-gconf.[ch] : new xml-compression-level get/set functions
	* src/xml-io.c : use get/set methods from src/gnumeric-gconf.h rather
	  than gnome-config directly

2002-04-16  Jody Goldberg <jody@gnome.org>

	* src/workbook-view.c (wb_view_open) : merge with wb_view_open_custom
	  and remove the useless view argument.

	* src/libgnumeric.c : move the application specific code from here.
	* src/main-application.c : to here.

	* configure.in : Add gobject & gmodule

2002-04-15  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-general.schemas : add window size schemas
	* src/gnumeric-gconf-priv.h : add window size keys
	* src/gnumeric-gconf.[ch] : add window size set/get methods
	* src/workbook-control-gui.c : use gconf for all preferences

2002-04-15  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-dialogs.schemas : add more schemas
	* src/commands.c : use get/set methods from src/gnumeric-gconf.h
	* src/file-autoft.[ch] : switch from gnome-config to gconf
	* src/gnumeric-gconf-priv.h : more keys
	* src/gnumeric-gconf.[ch] : more get/set methods
	* src/gutils.[ch] (gnumeric_config_get_string_list) : deleted

2002-04-15  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-dialogs.schemas : new plugin schemas
	* src/Makefile.am : add src/gnumeric-gconf.c and src/gnumeric-gconf-priv.h
	* src/application.c : use get/set methods from src/gnumeric-gconf.h
	* src/commands.c : change include
	* src/error-info.c : switch to GSLists from GLists
	* src/error-info.h : switch to GSLists from GLists
	* src/gnumeric-gconf.h : new get/set methods
	* src/gnumeric-gconf.c : new
	* src/gnumeric-gconf-priv.h : formerly src/gnumeric-gconf.h
	* src/gui-util.c : switch to GSLists from GLists
	* src/gutils.h : some new g_slist functions
	* src/gutils.c : some new g_slist functions
	* src/libgnumeric.c : use get/set methods from src/gnumeric-gconf.h
	* src/plugin-loader-module.c : switch to GSLists from GLists
	* src/plugin-loader.c : switch to GSLists from GLists
	* src/plugin-loader.h : switch to GSLists from GLists
	* src/plugin-service.c : switch to GSLists from GLists
	* src/plugin.c : switch to GSLists from GLists and use gconf
	* src/plugin.h : switch to GSLists from GLists
	* src/workbook-control-gui.c : use get/set methods from src/gnumeric-gconf.h

2002-04-15  Jon K Hellan  <hellan@acm.org>

	* src/.cvsignore: Ignore gnumeric-component

2002-04-15  Jon K Hellan  <hellan@acm.org>

	* src/main-component.c (gnumeric_component_factory): And another one.

2002-04-15  Jon K Hellan  <hellan@acm.org>

	* src/main-component.c (gnumeric_component_factory): Silence
	warning.

2002-04-15  Jon K Hellan  <hellan@acm.org>

	* src/main.[ch]: Remove from CVS.

	* src/libgnumeric.c: Really don't include main.h

2002-04-15  Jody Goldberg <jody@gnome.org>

	* src/libgnumeric.c : delete some stale code that is no longer needed
	  in gtk2.

2002-04-15  Jon K Hellan  <hellan@acm.org>

	* src/libgnumeric.h: Rename header guards after file rename.

	* src/main.[ch]: Add notes that the files are obsolete

2002-04-15  Jon K Hellan  <hellan@acm.org>

	* src/libgnumeric.c: Copied from src/main.c. Don't include main.h

	* src/libgnumeric.h: Copied from src/main.h

	* src/corba-args.c: s/main.h/libgnumeric.h/

	* src/main-application.c: s/main.h/libgnumeric.h/

	* src/main-component.c: s/main.h/libgnumeric.h/

	* src/normal-args.c: s/main.h/libgnumeric.h/

	* src/print.c: s/main.h/libgnumeric.h/

	* src/workbook.c: s/main.h/libgnumeric.h/

	* src/workbook-control-gui.c: s/main.h/libgnumeric.h/

2002-04-15  Jon K Hellan  <hellan@acm.org>

	* src/main.[ch]: Restructure.

	* src/gui-gnumeric.h: Declare WorkbookControlComponent and
	WorkbookControlStandalone.

	* GNOME_Gnumeric.server.in.in: Add gnumeric-component /
	OAFIID:GNOME_Gnumeric_Factory

	* src/Makefile.am: Add gnumeric-component to build, and new files.

	* src/workbook-control-gui.h (WORKBOOK_CONTROL_GUI_CLASS): Fix typo.

	* src/workbook-control-standalone.h: New file. wbcg class for
	standalone app - public header file. Dummy for now.

	* src/workbook-control-standalone.c: New file. wbcg class for
	standalone app - source file. Dummy for now.

	* src/workbook-control-standalone-priv.h: New file. wbcg class for
	standalone app - private header file. Dummy for now.

	* src/workbook-control-component.h: New file. Bonobo component
	class - public header file. Dummy for now.

	* src/workbook-control-component.c: New file. Bonobo component
	class - source file. Dummy for now.

	* src/workbook-control-component-priv.h: New file. Bonobo
	component class - private header file. Dummy for now.

	* src/main-component.c: New file. Main entry point for Bonobo
	component.

	* src/main-application.c: New file: Main entry point for
	standalone application.

2002-04-15  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-dialogs.schemas : add more preferences
	* src/application.c : move autocorrect_init into src/main.c
	* src/gnumeric-gconf.h : added defines and comments
	* src/main.c : add autocorrect_init and autocorrect_shutdown

2002-04-15  Morten Welinder  <terra@diku.dk>

	* src/sheet.c (sheet_cell_add_to_hash): Plug leak.

2002-04-15  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-general.schemas : add various new preferences
	* schemas/gnumeric-dialogs.schemas : fix capitalization
	* src/application.c : switch gnome_config to gconf
	* src/gnumeric-gconf.h : new preferences

2002-04-14  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/rangefunc-strings.c : fix warning
	* src/history.c : fis argument type in non-bonobo build

2002-04-14  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-general.schemas : add max number of undo items pref
	* src/commands.c (truncate_undo_info) : also truncate if max number
	  of items is exceeded.
	* src/gnumeric-gconf.h : add max number of undo items pref

2002-04-14  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/GNOME_Gnumeric.xml : Change menu text for Sheet Reorder/Manage
	* src/workbook-control-gui.c : Change tooltip for Sheet Manage

2002-04-14  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-general.schemas : add history and n of sheets
	  preferences
	* src/Makefile.am : add src/rangefunc-strings.[ch]
	* src/application.c : change file history handling to gconf,
	  change app.history_list to GSList from GList
	* src/application.h : change app.history_list to GSList from GList
	* src/collect.c : add string functions
	* src/collect.h :add string functions
	* src/gnumeric-gconf.h : add history and n of sheets preferences
	* src/history.c : change history_list to GSList from GList
	* src/history.h : change history_list to GSList from GList
	* src/main.c : add user-specified number of sheets to first workbook
	* src/workbook-control-gui.c : add user-specified number of sheets
	  to new workbooks
	* src/workbook.c : change history_list to GSList from GList
	* src/rangefunc-strings.h : new
	* src/rangefunc-strings.c : new

2002-04-14  Jon K Hellan  <hellan@acm.org>

	* src/main.h (has_gnumeric_been_compiled_with_guile_support):
	This function disappeared long ago. Remove.

2002-04-13  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/collect.c (callback_function_collect) : keep missing data info
	(collect_floats) : afdd missing data info handling
	(collect_floats_value_with_info) : new
	(cb_insert_diff_elements) : new
	(cb_int_descending) : new
	(union_of_int_sets) : new
	(cb_remove_missing_el) : new
	(strip_missing) : new
	(float_range_function2) : use flags
	* src/collect.h (CollectFlags) : 2 new flags
	* src/commands.c (max_descriptor_width) : fix sense of test.

2002-04-13  Jody Goldberg <jody@gnome.org>

	* src/commands.c (max_descriptor_width) : add some protection.

2002-04-13  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (xml_cellregion_write) : Patch massive leak introduced
	  in the transition to libxml2.  Thanks Andreas.

2002-04-13  Morten Welinder  <terra@diku.dk>

	* */*: Make fn-financial a plugin.

	* src/commands.c (cmd_range_list_to_string_utility): Try not to
	allocate gigabytes of memory for no reason.

2002-04-13  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (cmd_range_to_str_utility) : new
	* src/commands.h (cmd_range_to_str_utility) : new

2002-04-13  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/value.c (value_get_as_string) : handle VALUE_ARRAY more reasonably
	(value_peek_string) : initialize all fields of cache

2002-04-13  Jon K Hellan  <hellan@acm.org>

	* src/gui-file.c: s/ENABLE_BONOBO/WITH_BONOBO/

	* src/gui-util.c: Ditto.

	* src/history.c: Ditto.

	* src/main.c: Ditto.

	* src/sheet.c: Ditto.

	* src/sheet-object.c: Ditto.

	* src/workbook-control-gui.c: Ditto.

	* src/workbook-format-toolbar.c: Ditto.

	* src/workbook-object-toolbar.c:

	* src/workbook.c: Ditto.

	* src/workbook-private.c: Ditto.

	* src/xml-io.c: Ditto.

2002-04-13  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-general.schemas : add 2 undo preference settings
	* src/commands.c : add sheet name to descriptors depending on
	  preference setting
	* src/commands.h : add cmd_range_list_to_string_utility and
	  cmd_cell_pos_name_utility
	* src/gnumeric-gconf.h : new file, gather gconf paths in a single
	  includable place

2002-04-12  Jody Goldberg <jody@gnome.org>

	* src/workbook-private.c :  move the really broken bonobo stuff here.

	* src/sheet-control-gui.c (scg_object_update_bbox) : Use fabs to
	  handle inversion.
	(scg_mode_edit_object) : Be a touch more anal.

	* src/style.c (get_substitute_font) : add more font mappings.

	* src/item-grid.c (ig_obj_create_finish) : no need to moneky with the
	  internals of scg.  Setting the mode clears the new object.  Setting
	  the sheet adds a ref, so there are no worries that it will go away.

	* src/gnumeric-canvas.c : rip out the drag and drop support.
	* src/workbook-control-gui.c : move it here.
	(cb_insert_image) : silence a warning.
	(cb_edit_cut) : at least make the object deletetion undoable.
	(workbook_close_if_user_permits) : reorder to conform to HIG.

2002-04-08  Jody Goldberg <jody@gnome.org>

	* src/sheet-control-gui.c (scg_object_stop_editing) : unref the
	  current object.
	(scg_mode_edit_object) : ref the current object.

	* src/item-grid.c (ig_obj_create_finish) : Use
	  scg_mode_edit_object.
	* src/gnumeric-canvas.c (gnm_canvas_key_mode_object) : Use
	  sc_mode_edit to handle objects that are still being created.

2002-04-06  Jody Goldberg <jody@gnome.org>

	* src/sheet-control-gui.c (scg_object_update_bbox) : abs the dif when
	  checking for middle ctrl points.

2002-04-01  Jody Goldberg <jody@gnome.org>

	* src/gui-util.c (gnumeric_toolbar_new) : minor clean up.
	  one init is sufficient.

2002-04-12  Jon K Hellan  <hellan@acm.org>

	* src/GNOME_Gnumeric.xml (FilePrintSetup): Add back "print" stock icon.
	(FilePreferences): Add as menu item.
	(InsertGraph, InsertComponent, InsertShapedComponent): Comment out
	both from menu and toolbar.
	(InsertImage, InsertFormula): Add to "Insert" menu.
	(List, Combo): Re-enable in object toolbar.

2002-04-12  Morten Welinder  <terra@diku.dk>

	* src/auto-format.c (auto_format_init): Install a key destroyer.
	(auto_format_shutdown): Simplify.
	(auto_format_function_result_by_name): New function.
	(auto_format_function_result): Use
	auto_format_function_result_by_name.
	(auto_format_function_result_remove): New function.

2002-04-12  Jon K Hellan  <hellan@acm.org>

	* src/workbook-format-toolbar.c: Replace Gnome stock pixmap names
	with gtk synonym.

	* src/item-cursor.c (item_cursor_popup_menu): Replace Gnome stock
	copy pixmap name with gtk synonym.

2002-04-12  Jon K Hellan  <hellan@acm.org>

	* src/GNOME_Gnumeric.xml: Update to current pixmap names. Add
	'preferences' command.

2002-04-12  Jon K Hellan  <hellan@acm.org>

	* plugins/Makefile.am (SUBDIRS_FILE_FORMATS): Plan Perfect plugin
	  got installed, but not built. Don't do either.

2002-04-12  Jon K Hellan  <hellan@acm.org>

	* configure.in (bonobo_msg): (re)introduce ENABLE_BONOBO variable
	and bonobo_suffix.

	* src/Makefile.am (uidir): Update to gnome-2 conventions.

	* idl/GNOME_Gnumeric.idl
	(GNOME::Gnumeric::Application.new_workbook): Fix syntax error.

	* src/bonobo-io.c: #ifdef out the lot for now.

	* src/gnumeric-graph.c: ditto.

	* src/sheet-object-bonobo.c: ditto.

	* src/sheet-object-container.c: ditto.

	* src/sheet-object-item.c: ditto.

	* src/main.c (main): #ifdef out gnumeric_bonobo_io_init for now.
	(main): #ifdef out EmbeddableGridFactory_init.

	* src/print.c: Remove bonobo-print-client.h include.

	* src/sheet-object.c (sheet_object_register): #ifdef out bonobo
	object registration.

	* src/workbook.c (workbook_is_pristine, workbook_init,
	workbook_new): #ifdef bonobo case to be the same as non bonobo for
	now.
	(workbook_persist_file_load, workbook_persist_file_save,
	workbook_bonobo_setup): #ifdef out for now.

	* src/workbook-control-gui.c (cb_launch_graph_guru,
	insert_bonobo_object, cb_insert_component,
	cb_insert_shaped_component): #ifdef out for now.
	(verbs): #ifdef out GraphGuru, InsertComponent and
	InsertShapedComponent for now.

	* src/workbook-private.[ch]: #ifdef bonobo case to be the same as non
	bonobo for now.

2002-04-11  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/dependent.c (dependent_set_expr) : fix leak
	(invalidate_refs) : fix leak
	(cb_name_invalidate_sheet) : fix leak
	* src/expr-name.c (expr_name_create) : fix leak

2002-04-11  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/sheet-object-graphic.c (cb_dialog_graphic_config_apply_clicked) :
	  removed
	(cb_dialog_graphic_config_ok_clicked) : don't call
	  cb_dialog_graphic_config_apply_clicked
	(cb_adjustment_value_changed) : also change real sheet object
	(cb_color_changed) : ditto
	(cb_dialog_filled_config_apply_clicked) : removed
	(cb_dialog_filled_adjustment_value_changed) : new
	(cb_dialog_filled_color_changed) : new
	(cb_dialog_filled_config_ok_clicked) : don't call
	  cb_dialog_filled_config_apply_clicked
	(sheet_object_filled_user_config) : hook-up cb_dialog_filled_*_changed
	* src/sheet-object-widget.c (cb_scrollbar_config_ok_clicked) : save
	  all data
	(cb_checkbox_config_destroy) : delete old_label
	(cb_checkbox_config_cancel_clicked) : reset all data
	(sheet_widget_checkbox_user_config) : save old label

2002-04-11  Morten Welinder  <terra@diku.dk>

	* */*: Make new plugins fn-eng from src/functions/fn-eng.c

	* src/parser.y (gnumeric_parse_error): Plug leak.

	* src/item-edit.c (item_edit_destroy): Fix memory corruption on
	double destroys.

2002-04-10  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/sheet-object-graphic.c (sheet_object_filled_user_config) : don't
	  use GnomeDialog. Use Glade.
	(cb_dialog_filled_config_destroy) : replaces cb_dialog_filled_close
	(cb_dialog_filled_config_apply_clicked) : replaces cb_dialog_filled_clicked
	(cb_dialog_filled_config_ok_clicked) : new
	(cb_dialog_filled_config_cancel_clicked) : new

2002-04-10  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/sheet-object-graphic.c (sheet_object_graphic_user_config) : add line
	  preview

2002-04-10  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/sheet-object-graphic.c (sheet_object_graphic_user_config) : don't
	  use GnomeDialog. Use Glade.
	(cb_dialog_graphic_config_destroy) : replaces cb_dialog_graphic_close
	(cb_dialog_graphic_config_apply_clicked) : replaces cb_dialog_graphic_clicked
	(cb_dialog_graphic_config_ok_clicked) : new
	(cb_dialog_graphic_config_cancel_clicked) : new
	(cb_adjustment_value_changed) : use changed DialogGraphicData

2002-04-10  Morten Welinder  <terra@diku.dk>

	* src/clipboard.c (paste_cell_with_operation): Plug leak.
	(paste_link): Ditto.

2002-04-10  Morten Welinder  <terra@diku.dk>

	* src/parse-util.c (cellref_a1_get): Fix toupper usage.  Make this
 	work for non-English.  Check for overflow in row number.

2002-04-10  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* sheet-object-widget.c (cb_checkbox_config_ok_clicked) : plug
 	expr leak
	(cb_scrollbar_config_ok_clicked) : plug expr leak

2002-04-10  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* sheet-object-widget.c (cb_checkbox_config_cancel_clicked) : new
	(cb_checkbox_config_ok_clicked) replaces cb_scrollbar_config_clicked
	(sheet_widget_checkbox_user_config) : don't use GnomeDialog

2002-04-09  Morten Welinder  <terra@diku.dk>

	* src/rendered-value.c (rendered_value_new,
 	rendered_value_destroy, rendered_value_init,
 	rendered_value_shutdown): Yet another pool allocator.

2002-04-09  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* gnumeric-canvas.c (gnm_canvas_key_mode_object) : Sheet objects
	  are GObjects
	* src/item-grid.c (ig_obj_create_finish) : unref the object since
	  scg_mode_edit_object might not pick up the reference
	* src/sheet-control-gui.c (scg_object_stop_editing) : unref the
	  sheet object
	(scg_mode_edit_object) : ref the object if we store a reference
	* src/workbook-control-gui.c (cb_edit_cut) :  Sheet objects
	  are GObjects

2002-04-09  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* sheet-object-widget.c (cb_scrollbar_config_cancel_clicked) : new
	(cb_scrollbar_config_ok_clicked) replaces cb_scrollbar_config_clicked
	(sheet_widget_scrollbar_user_config) : don't use GnomeDialog

2002-04-09  Morten Welinder  <terra@diku.dk>

	* configure.in (bind_textdomain_codeset): Add -lintl when needed.

	* src/workbook-control-gui.c: s/E_qual/_Equal/.

2002-04-08  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/workbook-control-gui.c (hide_show_detail_real) : new
	(group_ungroup_colrow_real) : new
	(hide_show_detail) : use dialog_col_row
	(group_ungroup_colrow) : use dialog_col_row

2002-04-08  Morten Welinder  <terra@diku.dk>

	* src/expr.c (cb_expression_pool_leak): New function.
	(expr_shutdown): Show leaking expressions.

	* src/validation.c (validation_eval): Plug leaks.

2002-04-08  Jon K Hellan  <hellan@acm.org>

	* configure.in: Test for <wctype.h>

	* src/stf-parse.c: Include <wctype.h> only if present.

2002-04-08  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/colrow.c (colrow_set_sizes) : set to default if size is 0
	* src/commands.c (cmd_resize_colrow) : size == 0 means default size
	* src/summary.c : avoid warnings
	* src/workbook-cmd-format.c (sheet_dialog_set_column_width) : just
	  call dialog_col_width
	(workbook_cmd_format_column_std_width) : ditto
	(sheet_dialog_set_row_height) : just call dialog_row_height
	(workbook_cmd_format_row_std_height) : ditto

2002-04-07  Jon K Hellan  <hellan@acm.org>

	* configure.in: Test for isfinite as a macro.
	* acconfig.h: Ditto.

2002-04-05  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/item-edit.c : link to the expr-entry changed signal rather than its
	  gtkentry changed signal.

2002-04-05  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/item-edit.c (point_is_inside_range) : rather than parsing
	  using parse_surrounding_ranges, ask the expression entry
	  widget for the already parsed info.
	* src/parse-util.c (parse_surrounding_ranges) : fix formatting and
	  add some debug switches

2002-04-05  Morten Welinder  <terra@diku.dk>

	* src/gutils.c (gnm_mem_chunk_foreach_leak): New function.

	* src/str.c (string_get, string_get_nocopy, string_unref):
	Optionally use string pool.
	(string_shutdown): New function.
	* src/main.c (main): Call string_shutdown.

2002-04-05  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_insert_image) : add insert image.

	* src/sheet-object.c (sheet_object_default_size) : add a default_size
	  handler that can generate default sizes per instance rather than
	  class.

	* src/sheet-object-image.c (sheet_object_image_default_size) :
	  implement.
	(sheet_object_image_class_init) : register the deafult size handler.
	* src/application.c  : add insert image.
	* src/pixmaps/Makefile.am : add insert image.

2002-04-04  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gnumeric-pane.c (gnm_pane_reposition_cursors) : also
	  reposition item-edit cursor
	  http://bugzilla.gnome.org/show_bug.cgi?id=77321

2002-04-04  Morten Welinder  <terra@diku.dk>

	* src/main.c (main): Initialize and shutdown expr class.

	* src/expr.c (gnm_expr_new_constant, gnm_expr_new_funcall)
	(gnm_expr_new_unary, gnm_expr_new_binary, gnm_expr_new_name)
	(gnm_expr_new_cellref, gnm_expr_new_array, gnm_expr_new_set)
	(do_gnm_expr_unref): Conditionally use expression pool.
	(expr_init, expr_shutdown): Setup new expression pool.

2002-04-04  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/item-edit.h (point_is_inside_range) : don't call
	  gnumeric_char_start_expr_p since it changes the cursor position
	(entry_cursor_event) : new
	(item_edit_set_arg) : use notify::cursor-position rather than
	  button-press-event

2002-04-04  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/parse-util.c (parse_surrounding_ranges) : new, code extracted
	  from src/widgets/gnumeric-expr-entry.c
	* src/parse-util.h (parse_surrounding_ranges) : new
	* src/item-edit.c (scan_at) : deleted
	(point_is_inside_range) : use arse_surrounding_ranges
	* src/position.c (value_to_rangeref) : new
	(rangeref_normalize) : new
	* src/position.h (value_to_rangeref, rangeref_normalize) : new
	* src/ranges.c (setup_range_from_value) : use setup_range_from_range_ref
	(setup_range_from_range_ref) : new
	* src/ranges.h (setup_range_from_range_ref) : new
	* src/value-sheet.c (value_cellrange_normalize) : use rangeref_normalize

2002-04-03  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/ranges.h (setup_range_from_value) : new
	(value_to_global_range) : new
	* src/ranges.c : ditto
	* src/consolidate.c : use setup_range_from_value
	* src/corba-sheet.c : ditto
	* src/item-edit.c : ditto
	* src/value.c : ditto

2002-04-03  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-general.schemas : Fix long description formatting.

2002-04-02  Jon K Hellan  <hellan@acm.org>

	* src/func.c (function_def_get_arg_name): Don't crash if arguments
	aren't named.

2002-04-01  Morten Welinder  <terra@diku.dk>

	* src/value.c (USE_VALUE_POOLS): Make pools conditional.

	* src/parser.y (line, opt_exp): Plug gigantic leak.  Now why does
	the expression widget call the parser thousands of times?

	* src/expr.c (expr_eval_real): Simplify.

2002-04-01  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/item-cursor.c (item_cursor_target_region_ok) : fix message dialog

2002-04-01  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/mstyle.c (mstyle_new_default) : protect against faulty
	  schema installation
	* src/style.c (font_init) : protect against faulty
	  schema installation and also configure bold and italic default fonts.

2002-04-01  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-general.schemas : add default font schemas
	* src/application.[ch] : add central preferences dialog
	* src/main.c : dispose of preference dialog on exit
	* src/mstyle.c : use gconf data to initialize default style
	* src/style.[ch] : use gconf data to initialize default style
	* src/workbook-control-gui.c : add preference menu items

2002-04-01  Morten Welinder  <terra@diku.dk>

	* src/expr.c (expr_eval_real): Fix overflow for EXP case.  (Twice.)

	* src/mathfunc.c (gnumeric_fake_trunc): Fix for negative valus.

2002-03-31  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c : use workbook signals
	* src/commands.h : include tools/tools.h rather than dialogs/tools.h
	* src/summary.c (summary_info_add) : return boolean
	* src/summary.h (summary_info_add) : return boolean
	* src/workbook.c : new workbook signals
	(workbook_add_summary_info) : new, emit signal
	(workbook_set_filename) : emit signal
	* src/workbook.h : new workbook signals

2002-03-31  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (cmd_analysis_tools_undo) : clear region
	  before pasting (to avoid leaving cell comments behind)

2002-03-31  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c : cmd_analysis_tools allow the engines
	  to carry info from TOOL_ENGINE_LAST_VALIDITY_CHECK to
	  TOOL_ENGINE_PERFORM_CALC
	* src/commands.h : include dialogs/tools.h rather than
	  tools/analysis-tools.h

2002-03-31  Jody Goldberg <jody@gnome.org>

	* src/gui-util.c (gnumeric_toolbar_new) : respect ui preferences.

2002-03-30  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (cmd_analysis_tool_redo) : TOOL_ENGINE_PERFORM_CALC
	  should never return TRUE since we already cleared the target.

2002-03-29  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-general.schemas : new schema file
	* schemas/Makefile.am : added gnumeric-general.schemas
	* src/application.h (application_release_gconf_client) : new
	(application_get_gconf_client) : new
	* src/application.c (application_release_gconf_client) : new
	(application_get_gconf_client) : new
	(app_init) : initialize new app.gconf_client
	* src/commands.c (truncate_undo_info) : read size_left from gconf
	* src/main.c : destroy app.gconf_client on exit

2002-03-29  Jukka-Pekka Iivonen  <jiivonen@hutcs.cs.hut.fi>

	* src/sheet.c (sheet_delete_rows, sheet_delete_cols) : Fixed the
	adjustments for Solver's parameters.

	* src/sheet.c (sheet_insert_rows, sheet_insert_cols) : Fixed the
	adjustments for Solver's parameters.

2002-03-29  Morten Welinder  <terra@diku.dk>

	* src/value.c (value_new_cellrange_unsafe, value_new_cellrange,
	value_new_cellrange_r, value_new_array_non_init, value_release):
	Use chunk allocator for ranges and arrays.
	(value_init): Initialise range and array pools.
	(value_shutdown): Free range and array pools.

2002-03-29  Morten Welinder  <terra@diku.dk>

	* src/gutils.c (gnm_mem_chunk_new, gnm_mem_chunk_destroy,
	gnm_mem_chunk_alloc, gnm_mem_chunk_free): Keep per-block
	freelists.
	(gnm_mem_chunk_free): g_free chunks that are completely empty.

	* src/value.c (value_get_as_float): Improve precision.
	(value_get_as_int): Take sign into account when (fake-)truncating
	floating point numbers.
	(value_new_error, value_new_error_str, value_new_string,
	value_new_string_str, value_release): Use chunk allocator for
	strings and errors.
	(value_init): Initialise error and string pools.
	(value_shutdown): Free error and string pools.

2002-03-29  Jukka-Pekka Iivonen  <jiivonen@hutcs.cs.hut.fi>

	* samples/solver/regression-test-suite.gnumeric: Solver's
	regression test suite added.

2002-03-28  Jody Goldberg <jody@gnome.org>

	* src/sheet-object.c (sheet_object_set_sheet) : ref the object when we
	  add it to the sheet.
	(sheet_object_clear_sheet) : unref here.
	(sheet_object_set_sheet) : move the content of new_view here.

	* src/print-cell.c (print_cell) : seems like the sign of the descenty
	  is reversed.
	* src/print.c (print_footers) : ditto.

	* src/sheet.c (sheet_move_range) : long list onto short list not
	  vice versa.
	(sheet_delete_cols) : ditto.
	(sheet_delete_rows) : ditto.
	* src/dependent.c (micro_hash_resize) : ditto.

	* src/style.c (style_font_new_simple) : init the print_font.
	(style_font_unref) : unref the print_font.

	* src/print-cell.c (print_cell) : use the print_font.

	* src/print.c (print_job_info_destroy) : GnomeFont is a GObject.

2002-03-27  Jody Goldberg <jody@gnome.org>

	* gnumeric.desktop.in (Exec) : Add %F

2002-03-28  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (cmd_analysis_tool_redo) : add dao_autofit_columns

2002-03-28  Morten Welinder  <terra@diku.dk>

	* */*.c: Fix g_warning calls to not have terminating n.

2002-03-28  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/print.c (sheet_print) : gpm is not a GtkObject

2002-03-27  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/print.c : port to gnome2

2002-03-27  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui-util.c (gnumeric_destroy_dialog) : replaced by call to
	  gtk_widget_destroyed

2002-03-27  Jody Goldberg <jody@gnome.org>

	* configure.in : Include the necessary gconf setup to install schemas.

2002-03-27  Jody Goldberg <jody@gnome.org>

	* src/io-context.c (gnm_io_get_password) : new.
	* src/command-context.c (cmd_context_get_password) : new.
	* src/workbook-control-gui.c (wbcg_get_password) : new.

2002-03-26  Jody Goldberg <jody@gnome.org>

	* src/parser.y (yylex) : make UTF-8 clean.
	(find_char) : ditto.
	(find_matching_close) : ditto.

2002-03-26  Jody Goldberg <jody@gnome.org>

	* configure.in : add schemas dir.

	* src/gnumeric-canvas.c (gnumeric_canvas_new) : disable auto-center.

2002-03-27  Jukka-Pekka Iivonen  <jiivonen@hutcs.cs.hut.fi>

	* src/xml-io.c: Added saving and loading of Solver's options.

2002-03-25  Jody Goldberg <jody@gnome.org>

	* Release 1.1.2

2002-03-26  Morten Welinder  <terra@diku.dk>

	* src/rendered-value.c (rendered_value_new): Just peek directly
	into the approx_width structure -- everyone else does that.  Take
	worst case of "e", signs, and decimal points into account.

	* src/style.h (StyleFont): Change floats to doubles.  Add more
	approx_width fields.

	* src/style.c (style_font_get_width_pts): Remove.

2002-03-26  Morten Welinder  <terra@diku.dk>

	* src/style.c (style_font_new_simple): Translate pixels to points
	properly.

	* src/style.c (style_font_new_simple): Fix misplaced #endif.

	* src/format.c (format_value): Fix general display of floats.
	Oops.

	* src/value.c (value_release): Use the fact that VALUE_TERMINATE
	is an error value.

2002-03-26  Morten Welinder  <terra@diku.dk>

	* src/value.c (value_new_bool, value_new_int, value_release): Use
	int/bool pool.
	(value_init): Initialise int/bool pool.
	(value_shutdown): Free int/bool pool.

	* src/gutils.c (gnm_mem_chunk_new): Use smaller alignment when
	known to be possible.

2002-03-26  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/workbook-control-gui.c : added insert-function menu item

2002-03-26  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/ : new directory for schema files
	* schemas/gnumeric-dialogs.schemas : file for gconf configuration
	  variables used by the gnumeric dialogs

2002-03-25  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* gui-util.[ch] (focus_on_entry) : new
	* src/workbook-control-gui.c (cb_file_summary) : delete unused
	  variable

2002-03-25  Morten Welinder  <terra@diku.dk>

	* src/format.c (format_value): Strip signs when conditional
	formats are in use.

2002-03-25  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.[hc] : implement cmd_change_summary
	* src/summary.[hc] : constify arguments
	(summary_item_free) : make public, handle NULL argument
	(summary_item_copy) : new
	(summary_item_by_name) : new
	(summary_item_as_text_by_name) : new
	* src/workbook-control-gui.c (cb_file_summary) : delete unused
	  variable, add argument to dialog_summary_update
	* src/workbook.c (workbook_set_filename) : update summary dialog

2002-03-25  Morten Welinder  <terra@diku.dk>

	* src/format.c (StyleFormatEntry): Make the value field a
	gnum_float at intended.

	* src/main.c (main): Call g_set_prgname.
	(main): Call value_init and value_shutdown appropriately.

	* src/value.c (value_terminate_err): New value.
	(value_terminate): Replace this function by the value
	VALUE_TERMINATE.  All callers changed.
	(value_hash): Be smarter about arrays.
	(value_new_float): Use chunk allocator.
	(value_release): Release floats properly.
	(value_init, value_shutdown): New functions.

	* src/gutils.c (gnm_mem_chunk_destroy): Add new argument for leak
	tracking.

2002-03-25  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* workbook-control-gui.c : change arguments in call of
	  dialog_summary_update

2002-03-24  Morten Welinder  <terra@diku.dk>

	* src/gutils.c (gnm_mem_chunk_new, gnm_mem_chunk_destroy,
 	gnm_mem_chunk_alloc, gnm_mem_chunk_alloc0, gnm_mem_chunk_free):
 	New functions implementing a sane and fast chunk allocated.
  	(Maybe use Evolution's later.)

	* src/dependent.h (struct _GnmDepContainer): add members
 	range_pool and single_pool for allocation.

	* src/dependent.c (link_single_dep): Allocate from pool.
	(unlink_single_dep): Free using pool.
	(link_range_dep): Allocate from pool.
	(unlink_range_dep): Free using pool.
	(do_deps_destroy): Destroy pools.
	(gnm_dep_container_new): Allocate pools.
	(cb_dep_hash_invalidate): Don't free at all -- we're about to dump
 	both pools anyway.

	* src/cell.c (cell_new): New function.  (About time.)
	(cell_copy): Use cell_new.
	(cell_destroy): Free from pool if we allocated that way.
	(cell_init, cell_shutdown): New functions.

	* src/xml-io.c (cell_copy_new): Use cell_new.
	* src/sheet.c (sheet_cell_new): Use cell_new.
	* src/main.c (main): Initialise and shutdown cells.

2002-03-22  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (sheet_cell_insert) : delete.
	(cb_sheet_cell_copy) : use sheet_cell_new instead of
	  cell_copy + sheet_cell_insert.

	* src/gnumeric.h (CellList) : delete.

2002-03-22  Almer S. Tigelaar  <almer@gnome.org>

	* src/format-template.h: Extend FormatTemplate struct with
	edge related flags.

	* src/format-template.c (formate_template_new): Initialize
	new edge related members.
	(format_template_clone): Clone new edge related members and
	constify.
	(format_template_transform_edges): Transforms the templates
	by removing edges if so desired.
	(format_template_calculate): Use format_template_transform_edges.

2002-03-21  Jody Goldberg <jody@gnome.org>

	* Massive rename
	ExprTree -> GnmExpr
	eval.[ch] -> dependent.[ch]
	DependentContainer -> GnmDepContainer

	* src/print-info.c (load_formats) : suppress some warnings.

	* src/func.c (function_def_call_with_values) : use g_alloca.

2002-03-21  Jukka-Pekka Iivonen  <jiivonen@hutcs.cs.hut.fi>

	* AUTHORS: Added the authors of the LP Solve algorithm.

2002-03-20  Jody Goldberg <jody@gnome.org>

	* src/sheet-style.c (cell_tile_apply_pos) : a simple optimization.
	  Don't split a tile to apply the existing style.

	* src/cellspan.c (cell_calc_span) : Fix span calc when spanning
	  through hidden columns with content there was a typo, and a logic
	  error.  No need to change the margin for an invisible column.

2002-03-19  Jody Goldberg <jody@gnome.org>

	* src/eval.c (cell_eval_content) : move here from cell.c and
	  privatize.
	(dependent_changed) : remove useless argument.

2002-03-19  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/func.[ch] (function_def_get_arg_type_string) : new
	(function_def_get_arg_name) : new
	* src/gui-util.[ch] (gnumeric_dialog_raise_if_exists) :
	  change return type from gboolean to gpointer
	* src/workbook-control-gui.c : add argument to call to
	  dialog_formula_guru

2002-03-19  Morten Welinder  <terra@diku.dk>

	* src/position.c (cellref_equal): Change the order of comparisons
	a bit.  This works around a purify problem.  (I.e., a problem with
	purify, not with the gnumeric code.)

	* src/style.c (style_font_new_simple): Work harder at getting widest character.

	* src/format.c (format_number): Fix format breakage.  (Extra "E".)

	* src/parser.y (parse_string_as_value): Clean up.

2002-03-19  Juan Pablo Mendoza <jpablo@gnome.org>

	* src/Makefile.am: Changue subdirs order to build pixmaps before
	  dialogs. This fix the cvs build.

2002-03-18  Morten Welinder  <terra@diku.dk>

	* src/rangefunc.c (float_hash): Fix for long double case (which
	has six padding bytes on gcc/ix86).  Also be smarter.

	* src/value.c (value_hash): Scale by a power of two for speed.

2002-03-18  Morten Welinder  <terra@diku.dk>

	* src/workbook-control-gui.c (cb_workbook_debug_info): Add code to
	share cells in workbook.

	* src/main.c: Add --debug_share=1 option.

	* src/expr.c (expr_list_eq): New function.
	(expr_tree_sharer_new, expr_tree_sharer_destroy)
	(expr_tree_sharer_share): New functions.

	* src/position.c (cellref_hash): New function.

	* src/value.c (value_hash): New function.

2002-03-18  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (cmd_analysis_tool) : set me->parent.size

2002-03-18  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c : typo. (Thanks frob)

2002-03-18  Jody Goldberg <jody@gnome.org>

	* configure.in : bump canvas req to pull in the canvas fixes
	changes.

	* src/xml-io.c (xml_sheet_read) : look for sheet names in the right
	  place.

2002-03-17  Jody Goldberg <jody@gnome.org>

	* src/style.c (style_font_get_height) : add some additional
	  protection.
	(style_font_new_simple) : be really really anal.

2002-03-17  Jon K Hellan  <hellan@acm.org>

	* src/workbook-format-toolbar.c (cb_fore_color_changed): Handle
	autocolors.
	(cb_border_changed): Ditto.
	(workbook_create_format_toolbar): Ditto.

2002-03-16  Jody Goldberg <jody@gnome.org>

	* src/workbook.c (workbook_foreach_cell_in_range) : support 3d
	  references.
	(workbook_finalize) : free the 3d dep list if necessary.
	(workbook_init) : initialize the list.
	(cb_dep_unlink) : new.
	(pre_sheet_index_change) : new.
	(cb_dep_link) : new.
	(post_sheet_index_change) : new.
	(workbook_sheet_index_update) : privatize.
	(workbook_sheet_attach) : add pre/post handling for 3d references.
	(workbook_sheet_detach) : ditto.

	* src/eval.c (link_cellrange_dep) : add support for 3d deps.
	(unlink_cellrange_dep) : add support for 3d deps.
	(workbook_link_3d_dep) : new.
	(workbook_unlink_3d_dep) : new.
	(dependent_link) : called here.
	(dependent_unlink) : and here.

	* configure.in : bump libcanvas req to getthe no auto-center patch.

2002-03-16  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (sheet_{insert,delete}_{cols,rows}) : don't recalc the
	  entire sheet.  We'll queue what we need when relocating.

	* src/cell.c (cell_set_expr_unsafe) : don't relink.

	* src/eval.c (micro_hash_resize) : minor optimization.
	(dependents_unrelocate_free) : moved here and renamed from
	(workbook_unrelocate_free) : moved here and renamed from
	  workbook_expr_unrelocate_free.
	(workbook_unrelocate) : moved here and renamed from
	  workbook_expr_unrelocate.
	(cb_range_contained_collect) : new.
	(cb_single_contained_collect) : new.
	(dependents_relocate) : moved here and renamed from
	  workbook_expr_relocate.  Then changed to operate on the actual
	  depenents of the region rather than everything, clarified the
	  handling of linking/unlinking.
	(dependents_unrelocate) : relink deps and queue them for recalc.

	* src/cell.c (cell_relocate) : clean out a bit now that we are not
	  using it without reloc info.

	* src/expr.c (cellref_relocate) : don't use the ultra safe reference
	  checks here, we WANT to know if things are out of bounds.
	(cellref_shift) : ditto.

2002-03-15  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/sheet-control-gui-priv.h : added label field
	* src/workbook-control-gui.c (cb_sheet_name) : call
	  editable_label_start_editing rather than dialog_sheet_name
	(sheet_action_rename_sheet) : ditto
	(wbcg_sheet_add) : store editable label ref for future ref

2002-03-15  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c : support tab color changes in cmd_reorganize_sheets
	* src/commands.h (cmd_reorganize_sheets) : add arguments
	* src/sheet.c (sheet_set_tab_color) : add third argument
	(sheet_new) : initialize tab_text_color
	(sheet_destroy) : free tab_text_color
	* src/sheet.h : add tab_text_color to _Sheet
	(sheet_set_tab_color) : add third argument
	* src/workbook-control-gui.c (wbcg_sheet_add) : also set tab_text_color
	(wbcg_sheet_rename) : add arguments to call of cmd_reorganize_sheets
	(cb_insert_sheet) : ditto
	* src/workbook.c (workbook_sheet_reorganize) : support changing of tab
	  colors
	* src/workbook.h (workbook_sheet_reorganize) : add arguments
	* src/xml-io.c : read and write TabTextColor

2002-03-14  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (cmd_merge_data_redo) : use cell_assign_value rather
	  than copy/paste to preserve merged target fields.
	* src/commands.c (cmd_merge_data_redo) : don't create unnecessary cells
	* src/sheet-object.[ch] (sheet_object_clone_sheet) : delete
	* src/sheet-object.[ch] (sheet_object_clone_sheet_in_range) : rename
	  sheet_object_clone_sheet
	* src/sheet.c : change sheet_object_clone_sheet calls

2002-03-14  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c : use cell_assign_value rather than copy/paste to
	  preserve merged target fields.

2002-03-14  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/sheet-object-widget.[ch] (sheet_widget_checkbox_switch_link_sheet) :
	  delete again (unnecessary after Jody's fix of the root problem)
	* src/colrow.c (colrow_set_states) : preserve the
	  ColRowStateList, it possibly should also be applied to other sheets
	(colrow_restore_state_group) : ditto.
	* src/sheet.c : delete the ColRowStateList after colrow_set_states
	* src/commands.c : delete the ColRowStateList after colrow_set_states
	(cmd_merge_data_redo) : preserve column and row widths, etc.

2002-03-13  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-canvas.c (gnm_canvas_key_press) : disable object
	  movement while guru is up.

	* src/sheet-object-widget.c (sheet_widget_scrollbar_get_ref) : Add a
	  force_sheet parameter.
	(sheet_widget_checkbox_get_ref) : ditto.
	(sheet_widget_scrollbar_clone) : do not force a fully qualified ref here.
	  It would incorrectly cause the new object to link to the old sheet.
	(sheet_widget_checkbox_clone) : ditto.

	* src/parser.y : support the applix #AND# #OR# #NOT# operators.

2002-03-13  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (cmd_merge_data_redo) : handle sheet objects
	  and change ref in checkboxes
	* src/sheet-object-widget.c (sheet_widget_checkbox_switch_link_sheet) :
	  new
	* src/sheet-object-widget.h (sheet_widget_checkbox_switch_link_sheet) :
	  new
	* src/sheet-object.c (sheet_object_clone_sheet_in_range) : new
	* src/sheet-object.h (sheet_object_clone_sheet_in_range) : new
	* src/workbook-control-gui.c (cb_tools_merge) : remove unused var

2002-03-12  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_sheet_label_edit_finished) : renamed
	  from cb_sheet_label_changed and handle NULL text as cancel.
	(cb_sheet_label_edit_stopped) : deleted.

	* configure.in : Generate GNOME_Gnumeric.server.in
	* Generate GNOME_Gnumeric.server : start to think about this.

	* src/expr-name.c (expr_name_unlink_deps) : handle delayed hash
	  creation.
	(expr_name_new) : dont init the hash table.
	(expr_name_add_dep) : until here.

	* src/sheet.c (sheet_destroy_contents) : free the primary array too.

	* src/xml-io.c (cell_copy_new) : set comment to NULL.
	* src/gui-clipboard.c (x_selection_to_cell_region) : ditto.
	* src/stf-parse.c (stf_parse_region) : ditto.

2002-03-12  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* workbook-control-gui.c : add Merge to the Edit/Fill menu
	(cb_tools_merge) : new
	* commands.h (cmd_merge_data) : new
	* commands.c : implement the cmd_merge_data command
	(cmd_set_comment_finalize) : simplify

2002-03-12  Morten Welinder  <terra@diku.dk>

	* src/sheet.c (sheet_destroy_contents): Plug leak.
	* src/workbook.c (workbook_finalize): Free the sheets member.
	* src/sheet-control-gui.c (scg_finalize): Plug leak.

2002-03-11  Jody Goldberg <jody@gnome.org>

	* src/expr-name.c (expr_name_new) : make public.

2002-03-11  Jon K Hellan  <hellan@acm.org>

	* src/format.c: silence	warning.

2002-03-11  Morten Welinder  <terra@diku.dk>

	* configure.in (ynl, erfl, erfcl): Check that these actually work.
	(glibc defines these, they just don't work.)

2002-03-11  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (delete_pristine_sheets) : rename to
	  cmd_reorganize_sheets_delete_sheets and use command_undo_sheet_delete
	  rather than workbook_sheet_delete.
	(cmd_analysis_tool_finalize) : shorten code.

2002-03-11  Jody Goldberg <jody@gnome.org>

	* src/gui-util.c (color_combo_get_style_color) : changes to color combo.
	* src/sheet-object-graphic.c (cb_fill_color_changed) : ditto.
	* src/workbook-format-toolbar.c (cb_fore_color_changed) : ditto.
	(cb_back_color_changed) : ditto.
	(workbook_create_format_toolbar) : ditto.

2002-03-10  Jody Goldberg <jody@gnome.org>

	* configure.in : bump gal req to pull in the colour combo changes.

2002-03-10  Jody Goldberg <jody@gnome.org>

	* configure.in : post release bump

2002-03-10  Jody Goldberg <jody@gnome.org>

	* Release 1.1.1

2002-03-10  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (command_undo_sheet_delete) new utility function (for
	  CMD_ANALYSIS_TOOL_TYPE and CMD_SHEET_REORGANIZE_TYPE)
	(CMD_ANALYSIS_TOOL) : undo/redo command for data analysis tools.
	* src/commands.h (cmd_analysis_tool) : new

2002-03-10  Jody Goldberg <jody@gnome.org>

	* src/tools/solver/reports.c : warning suppression
	* src/tools/solver/solver.c (lp_solver_init) : ditto.

	* configure.in : bump gal version req.

2002-03-09  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gnm-marshalers.list : add NONE:STRING

2002-03-10  Jon K Hellan  <hellan@acm.org>

	* src/func.c (copy_hash_table_to_ptr_array): Check if function is
	FUNCTION_NAMEONLY here.
	(function_dump_defs): So that we can use the earlier version of this.

2002-03-09  Jon K Hellan  <hellan@acm.org>

	Dump function definitions from plugins, this time the easy way
	which even works.

	* src/func.c (copy_hash_table_to_ptr_array): Copy also when fd->help
	is NULL.
	(function_dump_defs): Load function definition before dumping name
	only function.

	* src/main.c (main): Drop force load argument to plugins_init.

	* src/plugin.[ch] (activate_plugin, plugin_db_activate_plugin_list,
	plugin_db_activate_saved_active_plugins, plugins_init): Revert to
	pre 2002-03-08 version. We apologize for the inconvenience.
	However, error reporting by means of gnumeric_error_error_info
	remains.

	* src/plugin-service.[ch]
	(plugin_service_function_group_initialize): Revert to pre
	2002-03-08 version.
	(plugin_service_activate): Ditto. Except that we don't reinstate
	#ifdef PLUGIN_ALWAYS_LOAD. That branch is hopelessly bitrotted.

	* src/plugin.h: Drop #undef PLUGIN_ALWAYS_LOAD.

2002-03-09  Jody Goldberg <jody@gnome.org>

	* src/func.c (func_def_load) : rename from function_def_get_full_info_if_needed
	  and remove the condition.

	* src/eval.c (link_expr_dep) : Call func_def_load if necessary to
	  check for a link function.

2002-03-09  Jukka-Pekka Iivonen  <jiivonen@hutcs.cs.hut.fi>

	* samples/solver/blend.mps: Added another Netlib demo.  The
	results seem to be correct now, so we are finally getting close..

2002-03-09  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_editline_focus_in) : if editing fails
	restore focus to the sheet.

	* src/workbook-edit.c (wbcg_edit_start) : fix typo and swapping of the
	  warnings.

2002-03-09  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* workbook-control-gui.c : change menu items "Re-order sheets"
	  to "Manage Sheets" and enable these items even for single sheet
	  workbooks.
	* commands.h : add deleted_sheets argument to cmd_reorganize_sheets
	* commands.c : ditto

2002-03-08  Jody Goldberg <jody@gnome.org>

	* src/GNOME_Gnumeric.xml : switch Format->Workbook with
	  Format->AutoFormat
	* src/workbook-control-gui.c (workbook_menu_format) : ditto.

	* src/workbook-view.c (wb_view_is_protected) : new.

	* src/workbook-edit.c (wbcg_edit_start) : load style directly
	  don't use cell_get_style.  This enables support for protection of
	  blank cells.  Use wb_view_is_protected, and command_context_invalid.

2002-03-08  C. Scott Ananian <cananian@lesser-magoo.lcs.mit.edu>

	* src/gnumeric-canvas.c (gnm_canvas_key_mode_sheet): don't put us in
	  edit mode if wbcg_edit_start indicates the cell is locked.
	* src/workbook-control-gui.c (cb_autosum, cb_autofunction): handle
	  case where wbcg_edit_start returns FALSE indicating that cell is
	  locked.
	* src/workbook-edit.c (wbcg_edit_start): this function now returns a
	   boolean which indicates whether the 'edit_start' attempt succeeded.
	   Check cell properties to return FALSE if the cell is locked.
	* src/workbook-edit.h (wbcg_edit_start): modify the prototype as per above.
	* src/workbook-view.c (wb_view_set_attribute, workbook_view_init):
	  Remove ARG_VIEW_* enumeration, which isn't used after Gnome2 port.
	  Add WorkbookView::is_protected attribute, and initialize it to
	  FALSE.  The update to wb_view_set_attribute is enough to get
	  xml_sax import working properly (yay, modular code!).
	* src/workbook-view.h: add 'is_protected' field to WorkbookView struct.
	  This is TRUE iff the workbook is locked.
	* src/xml-io.c (xml_write_wbv_attributes):
	  Write the new 'protected' workbook view attribute.  Two lines are
	  enough to get read/write from xml_io working.  Score one for
	  xml_sax: zero should have been sufficient.
	* src/dialogs/cell-format.glade: The 'worksheet protected' checkbox
	  shouldn't be greyed-out anymore.
	* src/dialogs/dialog-cell-format.c (cb_protection_sheet_protected_toggle,
	fmt_dialog_init_protection_page, cb_fmt_dialog_dialog_buttons):
	  connect up the 'worksheet protected' button in the
	  Format->Cells->Protection dialog.  Update worksheet object when
	  toggled and mark that the dialog's changed.
	* src/dialogs/dialog-workbook-attr.c src/dialogs/workbook-attr.glade:
	  Add Format->Worksheet->Protection dialog.

2002-03-08  Jon K Hellan  <hellan@acm.org>

	* src/command-context-stderr.c (ccs_class_init): Make gmorten happy.

	* src/command-context.h (COMMAND_CONTEXT): Fix typo.

	* src/command-context-stderr.c
	(command_context_stderr_get_status): Fix typo.

	* src/command-context-stderr.[ch]: Add.

	* src/Makefile.am: Add command-context-stderr.[ch]

	* src/main.c (main): Force load plugins before dumping function
	definitions.

	* src/plugin.[ch] (activate_plugin, plugin_db_activate_plugin_list,
	plugin_db_activate_saved_active_plugins, plugins_init): Add
	force_load parameter.
	(plugins_init): Use virtual function gnumeric_error_error_info to
	report error.

	* src/plugin-service.[ch]
	(plugin_service_function_group_initialize): Add force_load
	parameter. Get function info if force loaded.
	(plugin_service_activate): Propagate force_load parameter.

	* src/gnumeric.h: Declare CommandContextStderr.

	* src/func.[ch] (function_def_get_full_info_if_needed): Make
	public so that it's available when force-loading plugins.

	* src/error-info.c (error_info_print_with_offset): Print to stderr
	instead of stdout.

2002-03-08  Morten Welinder  <terra@diku.dk>

	* src/validation.c (validation_eval): Minor cleanup.
	* src/value.c (value_peek_string): Be smarter about errors.

2002-03-08  Jakub Steiner <jimmac@ximian.com>

	* src/pixmaps/Makefile.am:
	* src/pixmaps/format_money_24.png:
	* src/pixmaps/format_percent_24.png:
	* src/pixmaps/object_list_24.png:
	* src/pixmaps/object_combo_24.png: fix the filenames

2002-03-08  Jakub Steiner <jimmac@ximian.com>

	* icons/down-right.png, icons/right-down.png: pretty gnome2 icons
	* src/pixmaps/percent.png:
	* src/pixmaps/money.png:
	* src/pixmaps/list.png:
	* src/pixmaps/combo.png, src/pixmaps/Makefile.am: replace xpm
	  with a PNG (removed combo.xpm)

2002-03-08  Jody Goldberg <jody@gnome.org>

	* configure.in : add sample_datasource

	* src/validation.c (validation_eval) : cleanup handling of 'int'
	and fix handling of between.

2002-03-08  Jody Goldberg <jody@gnome.org>

	* src/eval.h : Add DEPENDENT_ALWAYS_UNLINK.
	  and the as yet unused DEPENDENT_HAS_3D.

	* src/io-context.c (gnm_io_warning) : new stub.
	(gnm_io_warning_unknown_font) : ditto.
	(gnm_io_warning_unknown_function) : ditto.
	(gnm_io_warning_unsupported_feature) : ditto.

	* src/func.c (function_def_get_full_info_if_needed) :  add
	  link/unlink.

	* src/plugin-service.c
	(plugin_service_function_group_get_full_info_callback) : add
	  link/unlink.  This is a terrible interface.  Why not just make the
	  thing into the FunctionDescriptor.
	* src/plugin-loader-module.c
	(gnumeric_plugin_loader_module_func_get_full_function_info) : ditto.

2002-03-08  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (xml_write_print_info) : handle missing paper so that
	  we can save again.

	* templates/autoformat/autoformat.3D.button.xml : fix.

	* plugins/Makefile.am (SUBDIRS) : add sample_datasource.

2002-03-07  Jody Goldberg <jody@gnome.org>

	* src/plugin-loader-module.h (ModulePluginFunctionInfo) : add
	  'link' and 'unlink'.

2002-03-07  Jody Goldberg <jody@gnome.org>

	* src/position.c (eval_pos_init*) : handle the optional dependent.

	* src/eval.c (link_expr_dep) : support the adjustment to EvalPos.
	(unlink_expr_dep) : support the adjustment to EvalPos.

	* *.c : directly include gnome-i18n.h, value.h and expr.h
	  where necessary now that they are no longer included.
	* src/func.h : here.

	* src/position.h (EvalPos) : Pass in an optional Dependent.

	* src/expr.h (FunctionEvalInfo) : remove the func_def.  Send in the
	  ExprFunc wrapper instead.  That contains the func-def if desired.

	* src/func.c (function_set_link_handlers) : differentiate signatures
	  for link & unlink.

2002-03-07  Jukka-Pekka Iivonen  <jiivonen@hutcs.cs.hut.fi>

	* src/analysis-tools.[ch]: Moved into src/tools.
	src/auto-correct.[ch]: Ditto.
	src/goal-seek.[ch]: Ditto.

	* src/solver.h (SolverResults): Added a few more fields to improve
	reporting.

2002-03-07  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* workbook.c (workbook_sheet_reorganize) : implement adding of
	  multiple sheets

2002-03-06  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/sheet.c (sheet_new) : initialize sheet->index_in_wb
	* src/sheet.h : new field sheet::index_in_wb
	* src/workbook-control-gui.c (wbcg_sheet_add) : replace
	  workbook_sheet_index_get with sheet->index_in_wb
	* src/workbook-view.c (wb_view_sheet_focus) : ditto
	* src/workbook.c (workbook_sheet_index_get) : deleted
	(workbook_sheet_index_update) : new
	(workbook_sheet_attach) : replace workbook_sheet_index_get
	  with sheet->index_in_wb, call workbook_sheet_index_update
	(workbook_sheet_detach) : ditto
	(workbook_sheet_move) : ditto
	(workbook_sheet_reorganize) : ditto

2002-03-06  Jukka-Pekka Iivonen  <jiivonen@hutcs.cs.hut.fi>

	* src/tools: New directory created for tools.

	* src/tools/solver: Moved src/solver-lp.c into here and split it
	into two files: src/tools/solver/solver.c and
	src/tools/solver/reports.c.  A _major_ rewrite.

	* src/tools/solver/lp_solve: Integrated key parts of an LGPLed
	linear programming toolkit called LP Solve 3.2.  (The whole
	package can be found from ftp://ftp.ics.ele.tue.nl/pub/lp_solve).
	Major clean up for making it to look like GNOME code.  LP Solve is
	written by Michel Berkelaar and others.  Thanks for the great
	work!

	* configure.in: Added src/tools/Makefile, src/tools/solver/Makefile,
	and src/tools/solver/lp_solve/Makefile.

	* src/Makefile.am: Added tools subdirectory.

	* src/mathfunc.[ch]: Removed all solver related functions.

	* src/solver.h, src/sheet.c: solver_lp_new renamed as
	solver_param_new.  solver_lp_destroy renamed as
	solver_param_destroy.

	* src/xml-io.c: Solver related changes.

	* samples/solver/production-plan.gnumeric: A Solver sample file.

2002-03-06  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui-util.c (gnumeric_error_info_dialog_show) : remove
	  forced placement by mouse
	(gnumeric_set_transient) : remove unused code, set dialog
	  placement to GTK_WIN_POS_CENTER_ON_PARENT

2002-03-06  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/eval.c (link_expr_dep) : fix typo

2002-03-06  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (delete_pristine_sheets) : new
	(cmd_reorganize_sheets_undo) : delete new sheets, change calling
	  sequence of workbook_sheet_reorganize
	(cmd_reorganize_sheets_redo) : change calling
	  sequence of workbook_sheet_reorganize
	(cmd_reorganize_sheets_finalize) : clear new_sheets
	(cmd_reorganize_sheets) : handle adding of sheets, streamline
	  selection of cmd descriptor
	* src/workbook-control-gui.c (cb_insert_sheet) : use
	  cmd_reorganize_sheets
	* src/workbook.c (workbook_sheet_reorganize) : handle adding of sheets
	* src/workbook.h (workbook_sheet_reorganize) : add argument

2002-03-05  Jody Goldberg <jody@gnome.org>

	* src/eval.c (link_single_dep) : flag inter-{sheet,book} references.
	(link_cellrange_dep) : ditto.
	(link_expr_dep) : collect the flags.
	(dependent_link) : and assign them here.
	(dependent_unlink_sheet) : delete and merge into.
	(do_deps_destroy) : here.  And use the new inter-{sheet,book} flags to
	  avoid removing internal links.

	* src/sheet.c (sheet_destroy_contents) : depends are now handled
	  outside this routine add a precondition.

	* src/main.c : delete style_debugging.

	* src/clipboard.c (clipboard_copy_range) : suppress warning.

2002-03-05  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/workbook-control-gui.c (workbook_close_if_user_permits) :
	  use gtk_message_dialog_new/gnumeric_dialog_run

2002-03-05  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/sheet-control-gui.c (scg_comment_display) : put
	  a frame around the pop-up

2002-03-05  Morten Welinder  <terra@diku.dk>

	* src/expr.c (expr_eval_real): Improve precision of %.

2002-03-05  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/sheet-control-gui.c (scg_comment_display) : use
	  textview widget

2002-03-05  Morten Welinder  <terra@diku.dk>

	* src/workbook-edit.c (auto_complete_matches): Plug leak.

	* src/gutils.c (erfgnum, erfcgnum, yngnum): Ground work for later.

	* src/mathfunc.c (gpow10): Fix precision for large negative
	exponents.
	(gpow2): Fix for negative exponents.

2002-03-05  Jody Goldberg <jody@gnome.org>

	* src/eval.c : split add/drop into distinct functions and use
	  link/unlink consistently.

2002-03-05  Morten Welinder  <terra@diku.dk>

	* src/validation.c (validation_eval): Make int-check saner.
	Fix translated string.

	* src/analysis-tools.c (fourier_fft_inv, fourier_fft): Improve
	precision.

	* src/mathfunc.h (M_LN2gnum, M_LN10gnum, M_PIgnum, M_PI_2gnum,
	M_LN2gnum, M_LN10gnum, M_SQRT2gnum): Provide high-precision
	constants.

2002-03-05  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/clipboard.c (clipboard_paste_region) : preserve comments
	  when pasting content
	* src/clipboard.h : exclude comments from PASTE_DEFAULT
	* src/sheet-control-gui.c : Add `Add/modify comments' item to
	  cell context menu
	* src/sheet.h : CLEAR_COMMENTS and CLEAR_MERGES should be distinct.
	* src/workbook-control-gui.c : correct spelling

2002-03-05  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (sheet_cell_remove_from_hash) : only unlink if it is
	  linked.
	(sheet_cell_destroy) : simplify slightly.
	(cb_remove_allcells) : just destroy them, no need to remove from hash.
	(sheet_destroy_contents) : ditto.

	* src/eval.c (UNLINK_DEP) : delete.
	(dependent_unlink) : simplify.
	(dependent_unlink_sheet) : clean up and don't bother to unlink from
	  deps list.

	* src/cell.c : s/CELL_BEING_ITERATED/DEPENDENT_BEING_ITERATED/

2002-03-04  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/clipboard.c (clipboard_copy_range, clipboard_prepend_cell
	  clipboard_prepend_comment) : check existing cells and all
	  comments.
	* sheet-object-cell-comment.c (cell_comment_event) : handle
	  double click by opening dialog (slightly modified patch by
	  Wayne Schuster)

2002-03-04  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/clipboard.h : PASTE_ALL_TYPES should include comments

2002-03-04  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/clipboard.c (paste_cell) : paste comment
	(clipboard_prepend_cell) : store comment info
	(clipboard_copy_range) : check all cells
	* src/clipboard.h : add comment field to CellCopy
	* src/commands.c (cmd_clear_undo) : handle comments
	(cmd_clear_selection) : ditto

2002-03-04  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* commands.h (cmd_set_comment) : new
	* commands.c (cmd_set_comment_apply, set_comment_undo,
	  cmd_set_comment_redo, cmd_set_comment_finalize, cmd_set_comment) :
	  new

2002-03-04  Morten Welinder  <terra@diku.dk>

	* src/mathfunc.c (dexp): Add give_log arg and use R's version.
	All callers changed.

	* src/analysis-tools.c (destroy_data_set_list): Plug leak.

2002-03-04  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (sheet_cell_insert) : make it clear that this routine
	  does not link the expression or register the dependencies.
	(sheet_cell_remove_from_hash) : document state changes and use
	  dependend_unlink.
	(cb_remove_allcells) : cell_destroy will unlink.
	(cb_collect_cell) : be clear that the results are unlinked.
	(colrow_move) : some docs.
	(sheet_move_range) : simplify now that the collected cells are
	  unlinked rather than just having their depends dropped.

	* src/eval.c (cell_add_dependencies) : delete.
	(cell_drop_dependencies) : delete.

	* src/style.c (style_font_new_simple) : If we can't find a font check
	  a map to see if we know of something similar.
	(get_substitute_font) : moved here from the XL importer.

2002-03-03  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (cmd_rename_sheet,...) : now a wrapper around
	  cmd_reorganize_sheets.
	(cmd_reorganize_sheets_apply) : moved into workbook.c as
	  workbook_sheet_reorganize
	(cmd_reorganize_sheets,...) : implement sheet renaming
	* src/commands.h : add an argument to cmd_rename_sheet
	* src/workbook-control-gui.c (cb_sheet_label_changed) :
	  change invocation of cmd_rename_sheet
	* src/workbook.c (workbook_sheet_rename) replaced by
	  workbook_sheet_reorganize
	* src/workbook.h: ditto

2002-03-02  Jody Goldberg <jody@gnome.org>

	* src/eval.c (handle_tree_deps) : Use hooks for per dependent
	  link/unlink for each function.

2002-03-02  Jody Goldberg <jody@gnome.org>

	* src/global-gnome-font.c : Use string chunk.

	* src/sheet-object-cell-comment.c :  This is a GObject now.
	(comment_get_points) : fix x offset.

2002-03-01  Morten Welinder  <terra@diku.dk>

	* src/workbook-control-gui.c: Add dots to "Sort" entry.

	* src/complex.h (complex_scale_real): New function.

	* src/analysis-tools.c (fourier_fft, fourier_fft_inv): Clean using
	existing complex math routines.

2002-03-01  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/commands.c (cmd_reorganize_sheets_finalize) : fix typo

2002-03-01  Morten Welinder  <terra@diku.dk>

	* src/commands.c (cmd_reorganize_free_names): Remove.
	(cmd_reorganize_sheets_finalize): Simplify.

	* src/analysis-tools.c (regression_tool): Fix P values.

	* src/regression.c (general_linear_regression): Fix ->var in the
	trivial n==xdim case.

2002-02-29  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* commands.h (cmd_reorganize_sheets) : new
	* commands.c : implement cmd_reorganize_sheets

2002-02-28  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/workbook-control-gui.c (wbcg_validation_msg) : delete
	  dialog and fix sense of test

2002-02-28  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui-util.[hc] (entry_to_float_with_format_default) : new

2002-02-28  Morten Welinder  <terra@diku.dk>

	* src/regression.c (linear_solve): Move rescaling from here...
	(LUPDecomp): ...to here so we save a copy.
	(general_linear_regression): Allocate the permutation matrix with
	the proper size.  (The old size was too big, so no-one really got
	hurt.)

	* src/rangefunc.c (range_minabs, range_maxabs): New functions.

	* src/regression.c (rescale): Don't include "b" in determining the
	scale.  Use range_maxabs.

2002-02-28  Morten Welinder  <terra@diku.dk>

	* src/regression.c (general_linear_regression): If the inverse has
	negative elements in the diagonal, assume near singularity.
	(linear_solve): Rescale matrix and target.  Rip out the error
	correction attempt.
	(rescale): New function.
	(LUPDecomp, backsolve): Remove col/row confusion.

2002-02-28  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (workbook_control_gui_init) : fix
	  reordering of ins col/row in non-bonobo case.

2002-02-28  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/workbook-control-gui.c (delete_sheet_if_possible) :
	  use gnumeric_dialog_question_yes_no

2002-02-28  Jody Goldberg <jody@gnome.org>

	* src/expr-name.c (expr_name_set_expr) : always relink.

	* src/eval.c (handle_tree_deps) : ignore inactive names.

2002-02-27  Jody Goldberg <jody@gnome.org>

	* src/global-gnome-font.c (global_gnome_font_init) : fix leak.

	* src/style.c (style_font_new_simple) : fix leak.

2002-02-27  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui-util.h (entry_to_float_with_format) : new
	* src/gui-util.c (entry_to_float_with_format) : add format to
	  entry_to_float
	(entry_to_float) : wrapper around entry_to_float_with_format

2002-02-27  Morten Welinder  <terra@diku.dk>

	* src/analysis-tools.c: Use new lower-tail flag for R's q*
 	routines.
	(new_data_set): Plug leak.

2002-02-27  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/value.c (value_get_as_string) : case VALUE_CELLRANGE can be
	  for absolute and A1-rel references. Use global_range_name.

2002-02-27  Morten Welinder  <terra@diku.dk>

	* src/analysis-tools.c (ztest_tool): Fix problem from R upgrade.
	(regression_tool): Simplify.

	* src/regression.c (linear_solve): Attempt error correction in the
 	near-singular case.
	(linear_regression, exponential_regression): Change return type to
 	an enum.  All callers changed.
	(LUPDecomp): Attempt to detect near-singularity.

2002-02-26  Morten Welinder  <terra@diku.dk>

	* src/regression.c (linear_regression, exponential_regression):
	Add safety check.

	* plugins/*/*.xml.in: just use the .la file for module_file.

	* plugins/*/Makefile.am: don't hack the .xml file any more.

	* src/mathfunc.c: Make various helper functions static.

	* src/format-template.h: prototype the template member functions.

2002-02-26  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (xml_read_cell) : xmlNodeGetContent always returns a
	  value now.  That simplifies comments and complicates content.
	(xml_cellregion_read) : ditto.

2002-02-25  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (wbcg_progress_message_set) : port to
	  gnome2.

	* src/print-cell.c (print_show_iso8859_1) : delete.

	* src/gui-file.c (gui_file_open) : someportability tweaks.

	* icons/Makefile.am : move the icons here.

	* src/history.c (history_menu_item_create) : constness.
	* src/formats.c (currency_date_format_init) : constness.
	* src/solver.h : some constness.
	* src/workbook-control-gui.c (cb_select_auto_expr) : constness.
	(workbook_control_gui_init) : some fixes for the bonobo build.

2002-02-25  Morten Welinder  <terra@diku.dk>

	* src/format-template.h: prototype the template member functions.

	* src/mathfunc.c: Switch to R-1.4.0 sources.  Deal with signature
	changes everywhere.

2002-02-25  Morten Welinder  <terra@diku.dk>

	* configure.in: Test if we must prototype strtold.  Test for
	log1pl.

2002-02-25  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/sheet-object-widget.c (cb_scrollbar_set_focus) : remove code
	  now held in wbcg_edit_attach_guru
	(cb_checkbox_set_focus) : ditto
	(sheet_widget_scrollbar_user_config) : rearrange signal callbacks
	(sheet_widget_checkbox_user_config) : ditto

2002-02-25  Morten Welinder  <terra@diku.dk>

	* src/xml-io.c (xml_cellregion_write) : specify the encoding, and
	  enable formatting.
	(gnumeric_xml_write_workbook) : ditto.

2002-02-25  Morten Welinder  <terra@diku.dk>

	* src/mathfunc.c (random_01): Reduce the number of system calls
	and get more precision for the general gnum_float case.

	* src/mathfunc.c (random_*): use gnum_float, not double.  (Since
	many underlying functions are still double-based, not all these
	will have precision beyond double.)

	* src/solver-lp.c: Constify.  Plug a few leaks.

	* src/sheet.h (struct _Sheet): Make solver_parameters a pointer.
	Deal with this everywhere.

2002-02-25  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/analysis-tools.h : delete tool_set_focus
	* src/workbook-edit.c (guru_set_focus) : new, formerly tool_set_focus
	  in src/dialogs/dialog-analysis-tools.c
	(wbcg_edit_attach_guru) : attach guru_set_focus to set_focus widget

2002-02-25  Morten Welinder  <terra@diku.dk>

	* configure.in (atan2l, sinhl, coshl, tanhl, asinhl, acoshl,
	atanhl, erfl, erfcl, ynl, isnanl, finitel, hypotl): Add checks for these.
	* src/numbers.h: supply right version of above.  Use everywhere.

2002-02-25  Jon K Hellan  <hellan@acm.org>

	* src/sheet-object-image.h: Declare typedef ObjectImage.

	* src/sheet-object-image.c (struct _SheetObjectImage): Add
	cropping parameters.
	(sheet_object_image_new): Initialize cropping parameters.
	(sheet_object_image_set_crop): New function. Set cropping
	parameters.
	(soi_get_cropped_pixbuf): New function. Get the cropped image from
	pixbuf.
	(soi_get_pixbuf): Do cropping by calling soi_get_cropped_pixbuf.
	(sheet_object_image_init): Initialize cropping parameters.

2002-02-24  Almer S. Tigelaar  <almer@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=72416
	http://bugzilla.gnome.org/show_bug.cgi?id=71783
	* src/stf-export.c (stf_export_cell):
	Honor the 'never' quote setting and fix a subtle
	bug that caused the quoting character always be	"

2002-02-22  Morten Welinder  <terra@diku.dk>

	* src/numbers.h (floorgnum, ceilgnum, powgnum, expgnum, loggnum,
	log10gnum, singnum, cosgnum, tangnum, asingnum, acosgnum,
	atangnum): Supply these.  Use everywhere.

	* configure.in: Check for the above.

2002-02-22  Morten Welinder  <terra@diku.dk>

	* configure.in: Check for ldexpl and frexpl.

	* src/mathfunc.c (gpow2): New function.
	(gnumeric_add_epsilon, gnumeric_sub_epsilon, gnumeric_fake_floor,
	gnumeric_fake_ceil, gnumeric_fake_round, gnumeric_fake_trunc):
	Make these gnum_float typed.

	* src/numbers.h (frexpgnum, ldexpgnum): New stuff.

2002-02-21  Morten Welinder  <terra@diku.dk>

	* src/numbers.h: Define prototypes for strtognum, modfgnum, and
	gnumabs here when needed.

	* src/workbook-control-gui.c (wbcg_validation_msg): Constify.

	* src/cell.c (cell_is_zero): Use gnum_float.

	* src/regression.c (LUPDecomp): Use gnumabs.
	* src/solver-lp.c (solver_answer_report): Ditto.
	* src/value.c (value_diff): Ditto.
	* src/goal-seek.c: Ditto.
	* src/rangefunc.c (range_avedev): Ditto.

	* src/validation.c (validation_eval): Use gnum_float, modfgnum,
	and gnumabs.

	* src/numbers.h (GNUM_MANT_DIG, GNUM_MAX_EXP, gnumabs): New stuff.

2002-02-21  Morten Welinder <terra@diku.dk>

	* src/solver-lp.c (callback): Fix formats.

	* src/plugin-loader-module.h (ModulePluginFunctionInfo): Constify.
	* src/plugin-loader-module.c (gnumeric_plugin_loader_module_func_get_full_function_info): Constify.
	* src/func.c (function_def_get_full_info_if_needed): Constify.

2002-02-20  Jody Goldberg <jody@gnome.org>

	* src/workbook.h : some house cleaning.

	* src/workbook.c (workbook_is_pristine) : remove stuf for
	  external_dependents.  No use having fogotten stubs hanging around.

	* src/workbook-control-gui.c (cb_insert_component) : look for
	  ControlFactories.
	(cb_insert_shaped_component) : look for CanvasComponentFactories.

	* src/commands.h : remove include for gtkobject.

	* idl/GNOME_Gnumeric_Graph.idl : We a ControlFactory now, not an
	  Embeddable.

2002-02-20  Morten Welinder  <terra@diku.dk>

	* src/mathfunc.c (display): Fix format.
	* src/analysis-tools.c (confidence_level): Ditto.
	(regression_tool): Ditto.
	* src/format.c (fmt_general_int): Ditto.

	* configure.in (set_mode_warnings): Add -Wformat also.

2002-02-20  Morten Welinder  <terra@diku.dk>

	* src/func.c (fn_def_new, function_add_args, function_add_nodes):
 	Constify.

2002-02-20  Morten Welinder  <terra@diku.dk>

	* src/parser.y (yyerror): Constify.

	* src/xml-io.c (xml_node_set_print_unit): Constify.
	(xml_read_print_repeat_range): Constify.

	* src/summary.c (summary_item_name): Constify.

	* src/print-info.c (predefined_formats, render_ops): Constify.

2002-02-20  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/expr-name.c (builtins): Constify.

	* src/complex.c (complex_to_string): Constify.

	* src/commands.c (cmd_set_text): Constify.
	(cmd_area_set_text): Constify.

	* src/mstyle.c (mstyle_to_string): Missing g_strdup added for
 	sanity check, just in case.
	* src/summary.c (summary_item_as_text): Ditto.
	* src/value.c (value_get_as_string): Ditto.

	* configure.in (CFLAGS): Add -Wwrite-strings, if possible.

	* src/gui-util.c (gnumeric_dialog_raise_if_exists): Constify.

2002-02-20  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/analysis-tools.c (regression_tool) : use only values
	  from extra_stat (renamed to regression_stat)
	* src/regression.c (general_linear_regression) : calculate more
	  regression_stat
	(regression_stat_new) : new
	(regression_stat_destroy) : new
	* src/regression.h : add fields to regression_stat_t and add
	  declarations of regression_stat_new and regression_stat_destroy

2002-02-20  Morten Welinder  <terra@diku.dk>

	* src/format.c (format_value): Missing g_strdup added for sanity
 	check, just in case.

	* src/datetime.c (coup_cd): Cleanup using
 	g_date_get_days_in_month.

2002-02-19  Morten Welinder  <terra@diku.dk>

	* src/numbers.h (modfgnum, strtgnum, GNUM_FORMAT_[eEfg],
 	GNUM_DIG): New stuff.

  	* .../*.[cy]: All relevant strtod changed to strtognum; modf to
 	modfgnum; DBL_DIG to GNUM_DIG; formats changed to use
 	GNUM_FORMAT_...

	* src/gutils.c (strtognum): If needed, define a version here.

	* src/complex.c (complex_to_string): Use right format for
 	imaginary part.

	* configure.in: Add support for --with-long-double.

	* acconfig.h: Add WITH_LONG_DOUBLE.

2002-02-19  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=69362
	* src/auto-correct.c (autocorrect_tool) : only upper case things if
	  they are at the start of a word.

2002-02-19  Morten Welinder  <terra@diku.dk>

	* src/format.c: Use gnum_float instead of double.

	* src/mathfunc.c (random_01): Use /dev/urandom when available.

	* src/sheet-autofill.c (autofill_cell): Use gnum_float instead of
	double.
	* src/expr.c (expr_eval_real): Ditto.
	* src/datetime.c (datetime_timet_to_serial_raw): Ditto.

	* src/format.c (format_compile): Fix isdigit usage.

	* src/value.c (value_diff): Return a gnum_float, not a double.

2002-02-19  Jody Goldberg <jody@gnome.org>

	* src/global-gnome-font.c (global_gnome_font_init) : get font list
	  from pango.
	(global_gnome_font_shutdown) : and free it here.

2002-02-18  Jody Goldberg <jody@gnome.org>

	* configure.in  : post release bump.

2002-02-18  Jody Goldberg <jody@gnome.org>

	* Release 1.1.0

2002-02-18  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_scroll_wheel_support) : fix
	  scrollwheel support.
	(workbook_control_gui_init) : use the new 'scroll-event' handler.

2002-02-17  Jody Goldberg <jody@gnome.org>

	* plugins/excel/ms-escher.c (ms_escher_read_OPT) : add support for
	  blip cropping.

2002-02-16  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-image.c (soi_get_pixbuf) : move things here.
	(sheet_object_image_new_view) : and use it here.
	(sheet_object_image_print) : and here.

2002-02-15  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-image.{ch} : new.

	* src/sheet-object.c (sheet_object_new_view) : use a weak_ref.

	* src/sheet-control-gui.c (scg_object_register) : more safety
	  and use a weak_ref.

	* src/sheet-object-graphic.c : More GObject-ification.

2002-02-15  Morten Welinder  <terra@diku.dk>

	* src/regression.c (LUPDecomp): Use fabs, not abs.
	* src/validation.c (validation_eval): Ditto.

2002-02-15  Morten Welinder  <terra@diku.dk>

	* src/regression.c (general_linear_regression): Cleanup using
	range functions.

2002-02-15  Jody Goldberg <jody@gnome.org>

	* src/widgets/gnumeric-combo-text.c (gnm_combo_text_destroy) : more
	  g_signal-ification.  g_signal_handlers_disconnect_by_func just hides
	  the problem.  The real issue is that we are disconnecting twice.

	* src/workbook.c (workbook_set_saveinfo) : use a weak_ref.

2002-02-15  Jody Goldberg <jody@gnome.org>

	* src/item-cursor.c (item_cursor_tip_setlabel) : enable now that the
	  canvas bug is fixed.

	* src/sheet-control-gui.c (cb_hscrollbar_adjust_bounds) : new.
	(cb_vscrollbar_adjust_bounds) : new.

	* src/gui-util.c (gtk_button_stock_alignment_set) : new.
	(gnumeric_init_help_button) : new.

	* src/gnumeric-canvas.h : Move declaration of
	  GnumericCanvasSlideHandler here.

	* src/gnumeric-canvas.c (gnm_canvas_guru_key) : forward to the entry,
	  not the GnumericExprEntry wrapper.
	(gnm_canvas_key_mode_sheet) : ditto.

	* src/formats.c (cell_format_classify) : handle general.

	* src/file-priv.h : Inherit from GObject.

	* src/complete-sheet.c (complete_sheet_finalize) : call class_peek
	  here to avoid potential reference problems.

	* src/commands.c (cmd_set_text) : doh!  fix multi-line text.
	(cmd_autoformat) : const.

	* src/cell.c (cell_relocate) : const.
	* src/clipboard.c (paste_cell_with_operation) : const.
	(paste_cell) : ditto.

	* src/application.c (application_init) : add jimmac's expr-entry icon.

	* src/Makefile.am : distribute the marshaller.list

	s/GtkType/GType/
	s/GtkSignalFunc/GCallback/
	s/gtk_signal_connect/g_signal_connect/  + reformatting.
	s/GTK_CHECK_CAST/G_TYPE_CHECK_INSTANCE_CAST/
	s/GTK_CHECK_TYPE/G_TYPE_CHECK_CLASS_CAST/
	s/GTK_CHECK_CLASS_CAST/G_TYPE_CHECK_INSTANCE_TYPE/
	s/GTK_CHECK_CLASS_TYPE/G_TYPE_CHECK_CLASS_TYPE/

2002-02-11  Jody Goldberg <jody@gnome.org>

	* src/stf.c (stf_init) : Make the names of the text import/export
	  clearer.

2002-02-12  Morten Welinder  <terra@diku.dk>

	* src/io-context.c (value_io_progress_update): Correct assertion.

	* src/io-context.c (file_io_progress_update,
	memory_io_progress_update, value_io_progress_update,
	count_io_progress_update, workbook_io_progress_update): Use test,
	not assignment.

	* src/stf-parse.c (trim_spaces_inplace): Fix isspace usage.
	(stf_parse_is_valid_data): Ditto.
	* src/sheet.c (sheet_name_quote): Ditto.

2002-02-11  Jon K Hellan  <hellan@acm.org>

	Support per-sheet grid color. Needed for correct XL import.

	* src/style-color.[ch] (color_equal): Rename to style_color_equal
	and export.

	* src/style-border.[ch] (style_border_none_set_color): New
	function. Update the grid color (color of style border none) to
	the given color.

	* src/sheet-style.[ch] (sheet_style_update_grid_color): New
	function. Update the grid color to fit the given sheet.

	* src/item-grid.c (item_grid_draw): Call
	sheet_style_update_grid_color before rendering.

	* src/print-cell.c (print_cell_range): Ditto

	* src/preview-grid.c (preview_grid_draw): Call
	style_border_none_update_color before rendering.

2002-02-11  Jody Goldberg <jody@gnome.org>

	* src/item-bar.c (item_bar_realize) : Use the standard cursor.

2002-02-08  Jody Goldberg <jody@gnome.org>

	* src/workbook-edit.c (wbcg_get_entry) : Use
	  gnumeric_expr_entry_get_entry.
	(wbcg_edit_attach_guru) : wbcg_get_entry.
	(wbcg_edit_detach_guru) : ditto.

	* src/workbook-control-gui.c : include datetime.h
	(workbook_setup_edit_area) : pack the ecpr-entry, not the contained
	entry.
	(wbcg_validation_msg) : warning suppression.

	* src/validation.c (validation_eval) : suppress warning.

	* src/sheet-autofill.c (str_contains) : delete.

	* src/number-match.c (format_match) : remove unused variable.

	* src/item-edit.c (item_edit_set_arg) : wbcg_get_entry signature change.

	* src/format-template.c (format_template_member_set_row_info) : delete.
	(format_template_member_set_col_info) : ditto.

	* src/commands.c (cmd_autoformat) : revert previous attempt at
	  constness.  It seems the templates are also used as acumulators
	  during application.  I don't think it is a great design choice,
	  but we'll live with it.

	* src/application.c (application_init) : add Jacub's expr entry.

2002-02-10  Chema Celorio  <chema@celorio.com>

	* configure.in: remove GNOME_COMMON_INIT
	[http://developer.gnome.org/dotplan/porting/ar01s05.html]

2002-02-08  Jon K Hellan  <hellan@acm.org>

	* src/mstyle.c (link_border_colors): Return from the right place.

	* src/style-color.c (style_color_new_uninterned): Create with
	refcount 1.
	(style_color_new): Only increment refcount if using cached color.

	* src/sheet.c (sheet_duplicate): Clone auto pattern color

	* src/sheet-style.c (sheet_style_init): Move auto_pattern_color
	initialization forward. sheet_style_get_auto_pattern_color is
	called from sheet_style_find below.
	(sheet_style_set_auto_pattern_color): Tag it as an auto
	color. Unref the input color.

	* src/sheet-style.[ch]: (sheet_style_get_auto_pattern_color): constify.

	* src/mstyle.c (link_pattern_color): New function.  Replace auto
	pattern color in style with sheet's auto pattern color.
	(link_border_colors): New function. Replace auto border colors in
	style with sheet's auto pattern color.
	(mstyle_link_sheet): Use target sheet's auto pattern color by
	calling link_xxxx_color functions.
	(mstyle_set_border): Fix typo.

2002-02-07  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/analysis-tools.c (anova_single_factor_tool) : be more
	  careful with precision.

2002-02-07  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/rangefunc.c (range_sum) : improve precision through 2 pass
	  algorithm
	(range_sumsq) : ditto

2002-02-06  Jody Goldberg <jody@gnome.org>

	* src/auto-format.c (auto_style_format_suggest) : it is now the
	  primitive.

2002-02-06  Michael Meeks  <michael@ximian.com>

	* src/workbook.c (workbook_bonobo_setup): don't
	setup the item container.

	* src/gnumeric-graph.c: porting action.
	(bonobo_activation_exception_id): kill.

	* src/corba-args.c (gnumeric_arg_parse): upd.

	* src/bonobo-io.c: porting action.

	* src/sheet-object-bonobo.c: porting action.

2002-02-06  Jody Goldberg <jody@gnome.org>

	* src/sheet-autofill.c (autofill_create_fill_items) : changes to the
	classification interface.  It will continue to evolve.

	* src/formats.c (cell_format_classify) : change the signature.  In the
	  future this should really be split.  This routine is
	  1) stupid
	  2) wrong
	  It is really only useful in the context of the format dialog.
	  however, our desire to call it elsewhere indicates what the new
	  format engine should make easiliy accessible.

	* src/expr.c (expr_eval_real) : quick and easy support for autoformat
	  style formatting for percent operator.  Just a quick test to see how
	  hard it would be, and it wasn't.

	* src/auto-format.c : Convert to StyleFormat.  Nothing actually uses
	  this anymore but I have not merged its logic into the eval structure
	  yet.

	* src/format-template.c (format_template_check_valid) : warning
	  suppression.

	* src/format.c (style_format_general) : new.
	(style_format_default_date) : new.
	(style_format_default_time) : new.
	(style_format_default_percentage) : new.
	(style_format_default_money) : new.

	* src/cell.c (cell_get_format) : finish the conversion.

2002-02-05  Jon K Hellan  <hellan@acm.org>

	* src/style-color.c (style_color_new_uninterned): New
	function. Factored out of style_color_new. Creates color
	unconditionally, without using the hash table.
	(style_color_new): Factor out style_color_new_uninterned.
	(style_color_new_i8): New function. Create a style color from 8
	bit rgb values by cloning to 16 bits.
	(style_color_auto_font): New function. Returns an uninterned black
	to represent Excel auto font color.
	(style_color_auto_back): New function. Returns an uninterned white
	to represent Excel auto background color.
	(style_color_auto_pattern): New function. Returns an uninterned black
	to represent Excel auto pattern color.
	(color_equal): Include is_auto flag in comparison.
	(color_hash): Include is_auto flag in hash function.

	* src/style-color.h (style_color_new_i8, style_color_auto_font,
	style_color_auto_back, style_color_auto_pattern): Declare

	* src/sheet-style.c (struct _SheetStyleData): Add
	auto_pattern_color.
	(sheet_style_init): Initialize auto_pattern_color.
	(sheet_style_shutdown): Unref auto_pattern_color.
	(sheet_style_set_auto_pattern_color): New function. Set the auto
	pattern color for this sheet.
	(sheet_style_get_auto_pattern_color): New function. Get the auto
	pattern color for this sheet.

	* src/sheet-style.h (sheet_style_set_auto_pattern_color,
	sheet_style_get_auto_pattern_color): Declare.

2002-02-03  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_insert_current_date) : don't actually
	  store the value, just start editing with it.
	(cb_insert_current_time) : ditto.

2002-02-03  Jody Goldberg <jody@gnome.org>

	* src/value.c (value_new_*) : init Value*::fmt
	(value_duplicate) : ref the fmt too.
	(value_set_fmt) : new.

	* src/cell.c (cell_cleanout) : no more format.
	(cell_copy) : ditto.
	(cell_set_text) : ditto.
	(cell_set_expr_internal) : ditto.
	(cell_set_expr_unsafe) : ditto.
	(cell_get_format) : ditto.

	Change all callers.
	* src/sheet.c (sheet_cell_set_value) : remove format assingment.
	* src/cell.c (cell_set_expr_and_value) : remove format assignment.
	(cell_assign_value) : ditto.
	(cell_set_value) : ditto.
	(cell_set_expr) : ditto.
	* src/parser.y (expr_parse_str) : remove arg to return the suggested
	  format.  That will be handled at run time.
	* src/number-match.c (format_match) : remove arg to return the parse
	  formula.  Store it in the value instead.

2002-02-02  Jody Goldberg <jody@gnome.org>

	* src/main.c (main) : disable the removal of Shift as an accelerator
	  fixes the double movement in treeviews strangeness.

	* src/workbook-control-gui.c : reorganize the insert menu.
	* src/GNOME_Gnumeric.xml : ditto.

2002-02-01  Jody Goldberg <jody@gnome.org>

	* src/xml-io-autoft.c : port to libxml2 and begin merging into
	* src/format-template.c : here.

2002-01-31  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui-util.c (gnumeric_dialog_question_yes_no) : port to gnome2

2002-02-01  Jody Goldberg <jody@gnome.org>

	* configure.in : cleanup the includes a bit and make the libole2
	  requirement specific to the XL plugin.  Tidy up the gda, and gb
	  tests to be consistent and more informative.

	* src/main.c : remove ole debug flag.

	* src/gnumeric-graph.c (gnm_graph_new) : return a GObject
	  makes it easier to handle NULL.

2002-01-31  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/analysis-tools.h : add `warning' to GENERIC_TOOL_STATE
	  and some clean-up

2002-01-31  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (wbcg_focus_cur_scg) : warning
	  suppression.
	(sheet_control_gui_new) : enable partial scrollbar support.

	* src/workbook-control.c (wb_control_parse_and_jump) : make defined
	  names absolute.

2002-01-30  Jody Goldberg <jody@gnome.org>

	* src/dialogs/dialog-autoformat.c (templates_load) : changes to
	  category_group_get_templates_list.

	* src/xml-io-autoft.c (gnumeric_xml_write_format_template) : take a
	  context not a control to clarify things.
	(gnumeric_xml_read_format_template) : ditto.

	* src/workbook.c (workbook_persist_file_save) : changes to
	  wb_view_save_as.

	* src/io-context.c (io_context_destroy) : impl is a command context now.
	(gnumeric_io_context_new) : weaken requirements so that all we need is
	  a command context.  Not strictly necessary, but makes it less likely
	  that people will get confused.

	* src/workbook-view.c (wb_view_save_as) : Take a command context not a
	  workbook control to avoid confusing what we are saving.
	(wb_view_save) : ditto.
	(wb_view_selection_desc) : Implement using an explicit control.
	(wb_view_open_custom) : add a missing precondition.
	* src/gui-file.c (do_save_as) : changes to wb_view_save_as.
	(gui_file_save_to_stream) :  changes to gnumeric_io_context_new.

	* src/file-autoft.c (category_get_templates_list) : take a command
	context, not a workbookcontrol.
	(category_group_get_templates_list) : ditto.
	* src/format-template.c (format_template_new) : ditto.
	(format_template_new_from_file) : ditto.

2002-01-31  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/analysis-tools.h : include type definitions and function
	  prototypes previously in src/dialogs/dialog-analysis-tools.c
	* src/analysis-tools.c (autofit_columns) : make non-static
	* src/func-util.h (parse_database_criteria) : new

2002-01-30  Jody Goldberg <jody@gnome.org>

	* src/application.c : merge in the new object icons from jimmac.
	* src/pixmaps/Makefile.am : ditto.
	* src/workbook-control-gui.c : ditto.
	* src/GNOME_Gnumeric.xml : ditto.
	s/^/Object/
	s/Rect/Rectangle/
	s/Oval/Ellipse/
	s/Checkbutton/Checkbox/

	* src/gui-util.c (gnumeric_error_info_dialog_show) : center error
	  dialog on the mouse.

2002-01-29  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (cb_notebook_switch_page) : fix changing
	  sheets.

2002-01-29  Jody Goldberg <jody@gnome.org>

	* src/workbook-format-toolbar.c (workbook_create_format_toolbar) :
	  hard code relief.
	* src/workbook-control-gui.c (workbook_create_standard_toolbar) :
	  ditto.

2002-01-29  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/workbook-control-gui.c (sheet_action_rename_sheet) : move most
	  code into dialog_sheet_name and friends
	(cb_sheet_change_name) : ditto, also rename to cb_sheet_name

2002-01-28 Joshua R. Odom <jrodom@stic.net>

	* src/application.c : clean up the file names to match the code.
	* src/pixmaps/Makefile.am : ditto.

2002-01-28  Jody Goldberg <jody@gnome.org>

	* src/workbook.c (workbook_sheet_move) : flag if the move did
	  anything.

	* src/workbook-object-toolbar.c :  adjust to the new creation format.

	* src/workbook-edit.c (wbcg_edit_has_guru) : return the actual guru.

	* src/workbook-control-gui.c : Explicitly use the STOCK items rather
	  than just the stock icon names.  This enables the accelerators too.

	* src/sheet-object-widget.c : cleanup.
	  Use _init functions, no need to create a silly _new wrapper that calls
	  construct.  Remove unused Sheet arguments.

	* src/gnumeric-canvas.c (gnm_canvas_guru_key) : new.
	(gnm_canvas_key_mode_sheet) : be more careful about what how to handle
	  keys when there is a guru up.

	* src/sheet-object-widget.c (sheet_widget_checkbox_user_config) :
	  create the table.

2002-01-27  Jody Goldberg <jody@gnome.org>

	* src/Makefile.am : cleanup the generated files.

2002-01-28  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/consolidate.c (consolidate_set_destination) : accept
	  value instead of range
	(consolidate_add_source) : ditto
	* src/consolidate.h (consolidate_set_destination) : change
	  parameters
	(consolidate_add_source) : ditto

2002-01-27  Seth Nickell  <snickell@stanford.edu>

	* Makefile.am:

	Install .desktop file into prefix/share/applications,
	the new location for .desktop files in GNOME 2.

	* gnumeric.desktop.in:

	Add appropriate categories fields.

	Add a functional description to match the GNOME 2
	HIG.

2002-01-27  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui_util.c (gnumeric_destroy_dialog) : new callback
	(gnumeric_notice_nonmodal) : save dialog ptr in reference
	* src/gui_util.h (gnumeric_notice_nonmodal) : change
	  parameters and return value

2002-01-27  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c :
	  remove Menu_ prefix from pixmap names.

2002-01-26  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui-util.c (gnumeric_notice_nonmodal) : non-modal version of
	  gnumeric_notice
	(gnumeric_dialog_run) : remove warning
	* src/gui-util.h (gnumeric_notice_nonmodal) : new

2002-01-26  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui-util.c (entry_to_float) :
	  moved here from dialogs/dialog-analysis-tools.c
	(entry_to_int) : ditto
	(float_to_entry) : ditto
	(int_to_entry) : ditto

	* src/gui-util.h (entry_to_float) new function (used to be static)
	(entry_to_int) : ditto
	(float_to_entry) : ditto
	(int_to_entry) : ditto

2002-01-25  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* item-grid.c (item_grid_event) : don't scroll at end of formula
	  range selection (http://bugzilla.gnome.org/show_bug.cgi?id=63485)

2002-01-25  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui-util.c (gnumeric_dialog_run) : use GTK functions
	(gnumeric_notice) : create GTK_Message_Dialog
	* src/gui-util.h (gnumeric_notice) : change type of second argument
	* src/gui-file.c : fix all calls to gnumeric_notice
	* src/print.c : ditto
	* src/style.c : ditto
	* src/workbook-cmd-format.c : ditto
	* src/workbook-control-gui.c : ditto

2002-01-25  Jody Goldberg <jody@gnome.org>

	* src/sheet-control-gui.c (scg_context_menu) : fix the icon names.

	* src/gui-util.c (gnumeric_popup_menu) : sink the menus.

	* src/main.c (main) : lock the encoding to be UTF-8.

	* src/eval.c : enable the micro hash by default.

	* src/expr.c (cellref_relocate) : simplify and remove the force
	  arguments.  Flag invalidations from inside vs to inside. From takes
	  precendence.
	(cellref_shift) : new.
	(cellrange_relocate) : simplfy and try a different tack on how to
	  handle corners with different sets of relocation needs.

	* src/commands.c (cmd_paste_cut_undo) : pass NULL for the
	  reloc_storage to disable invalidation.

	* src/sheet.c (sheet_move_range) : document.
	  Make the reloc_storage optional.  If it is not specified do NOT
	  invalidate references to the dst region that are being
	  invalidated.  Since this routine is only used for cut redo/undo
	  and undo really should not be invalidating we use that as a flag.

2002-01-25  Jody Goldberg <jody@gnome.org>

	* src/Makefile.am : register the marshaller as BUILT sources.

2002-01-24  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/cell.h (cell_get_render_color) : new
	* src/rendered-value.c (cell_get_render_color) : new

2002-01-24  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/ranges.h (global_range_name) : new
	* src/ranges.c (global_range_name) : new

2002-01-24  Jody Goldberg <jody@gnome.org>

	* configure.in : explicitly disable guile, psiconv, and bonobo for now.
	Add a warning.

	* src/Makefile.am : Apparently the sources list is order dependent.
	  Put the built sources at the top.

2002-01-24  Rodrigo Moya <rodrigo@gnome-db.org>

	* configure.in: fixed libgda detection for GNOME 2.

2002-01-23  Jody Goldberg <jody@gnome.org>

	* src/gui-util.c (gnumeric_textview_get_text) : new utility.
	(gnumeric_textview_set_text) : ditto.

	* src/history.c : tidy up a mite.

	* src/gui-util.c : Some initial conversions to gnome2.  Needs work.

	* src/gui-file.c (can_try_save_to) : Use the new glib2 file utilities.

	* src/gnumeric.h : remove the gnome-1.4 compatibility shims.

	* src/gnumeric-pane.c (gnumeric_pane_realized) : renamed to be
	  consistent.

	* src/gnumeric-graph.c (bonobo_activation_exception_id) : renamed from
	  oaf_exception_id.
	(gnm_graph_setup) : begin conversion to bonobo-activation.

	* src/gnumeric-canvas.c : disable the IM support for now.

	* src/formats.c (currency_symbols) : pound, yen, euro -> UTF-8.

	* src/format.c : no need for portability.h
	* src/func.c : ditto.

	* src/file.c (gnum_file_saver_setup) : disable mime for now.

	* src/command-context.c : Inherit directly from GObject.
	* src/commands.c : ditto.
	* src/complete-sheet.c : ditto.
	* src/complete.c : ditto.

	* src/application.c : convert to new stock icon management.

	* src/Makefile.am : remove portability.h.
	  Add pixmaps subdir.
	  Build marshallers.

	* Makefile.am : Convert to intltool.
	* acconfig.h : Convert to gnome2 gettext format.
	* .cvsignore : Convert to intltool, and remove the Conf file.
	* src/.cvsignore : Update.
	* autogen.sh : Convert to gnome2.
	* configure.in : Rough conversion to gnome2.  We'll need to re-enable
	  the plugins.

	* idl/GNOME_Gnumeric.idl : Delete an unused interface.
	* idl/Makefile.am (dist) : update.

	* plugins/Makefile.am :  Use WITH_GUILE rather than just GUILE to be
	  consistent.
	* plugins/*/Makefile.am : Convert to intltool.

2002-01-22  Jody Goldberg <jody@gnome.org>

	* src/sheet-autofill.c (autofill_create_fill_items) : Use
	  list_prepend, and reverse in palce of append.

2001-01-22  Kevin Breit <mrproper@ximian.com>

	* Makefile.am: Added omf-install/
	* omf-install: Added directory for OMF stuff
	* omf-install/Makefile.am: Copied that in

2002-01-22  Rodrigo Moya <rodrigo@gnome-db.org>

	* README:
	* configure.in: increased minimum libgda versions
