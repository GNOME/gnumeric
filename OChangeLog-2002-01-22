2001-10-29  Jody Goldberg <jgoldberg@home.com>

	* Release 0.73

2001-10-29  Jody Goldberg <jgoldberg@home.com>

	* src/parser.y : add support for referencing names in other workbooks.

	* src/expr.c (expr_tree_new_name) : take an optional sheet and
	  workbook as scoping info.
	(expr_eval_real) : handle inactive names.
	(do_expr_tree_to_string) : improve scoping.
	(expr_rewrite) : handle inactives and scope changes.

	* src/expr-name.c (expr_name_lookup) : add the notion of active and a
	  ref count so that we can do a delayed destruction and invalidation.
	(expr_name_add) : make it clearer that the return is not meant
	  to be freed.
	(expr_name_create) : don't free the result of expr_name_lookup.
	(expr_name_ref) : generalize.
	(expr_name_unref) : ditto.
	(expr_name_remove) : deactivate the name.

2001-10-27  Almer S. Tigelaar  <almer@gnome.org>

	* src/GNOME_Gnumeric.xml: Tidy view menu.

	* src/workbook-control-gui.c: Idem.

2001-10-27  Almer S. Tigelaar  <almer@gnome.org>

	* src/GNOME_Gnumeric.xml: Enable validate menu item.

	* src/validation.[ch]: New, defines a container for
	validation settings.
	
	* src/Makefile.am: Add new validation.[ch]

	* src/gnumeric.h: Add validation declaration.

	* src/gui-validation.[ch] (validation_mstyle_get_title): Burn.
	(validation_generate_msg): Rework slightly to accept a stylecondition
	instead of an mstyle.
	(validation_mstyle_get_msg): Burn.
	(validation_mstyle_get_msg_subst): Burn.
	(validation_mstyle_set_title_msg): Burn.
	(validation_get_accept): Request a validation instead of
	an mstyle. Actually free the automatically generated message.

	* src/mstyle.[ch]: Adjust mstyle_names to include hidden/locked.
	(mstyle_hash): Remove validation style hashing.
	(mstyle_element_dump): Don't dump validation message, dump validation
	refcount instead.
	(mstyle_element_equal): Remove comparing of style and message.
	(mstyle_elements_equal): Don't give a mismatched types warning if
	one of the elements is not set.
	(mstyle_element_ref): Ref validation, remove reffing of msg.
	(mstyle_element_unref): Idem for unref.
	(mstyle_new_default): Don't initialize any validation related
	element.
	(mstyle_set_validation): Set a Validation instead of a StyleCondition.
	(mstyle_get_validation): Idem for get.
	(mstyle_set_validation_style): Burn.
	(mstyle_get_validation_style): Burn.
	(mstyle_set_validation_msg): Burn.
	(mstyle_get_validation_msg): Burn.

	* src/style-condition.c (style_condition_new_constraint): Initialize
	from passed parameter!

	* src/style-condition.h: Remove validation enum.

	* src/workbook-control-gui.c (cb_data_validate): Enable.
	(workbook_control_gui_init): Change index of consolidate
	menu item.

	* src/workbook-edit.c (wbcg_edit_validate) : Get the StyleCondition
	from the validation. The validation element must be set on the mstyle.
	Pass validation, not mstyle, to validation_get_accept.
	(wbcg_edit_finish): Only call wbcg_edit_validate if the validation
	element is set on the mstyle.

	* src/xml-io.c (xml_write_style_condition_chain): Generates a
	StyleConditionChain in XML format.
	(xml_read_style_condition_chain): Turns an XML description of a
	StyleConditionChain into a real StyleConditionChain.
	(xml_write_style): Add validation support.
	(xml_read_style): Idem.
	
2001-10-27  Jody Goldberg <jgoldberg@home.com>

	* src/expr.c (cellref_relocate) : Only make the sheet local if the
	  input ref did not qualify the sheet.

	* src/parse-util.c (parse_text_value_or_expr) : be more careful.

2001-10-27  Jody Goldberg <jgoldberg@home.com>

	* configure.in : Support --with-python=prog

2001-10-27  Jody Goldberg <jgoldberg@home.com>

	* src/sheet.c (sheet_{insert,delete}_{cols,rows}) : don't have
	  sheet_relocate_objects update the bounds.  Save it for sheet_update.
	  This allows us to use reposition_objects which does double duty to
	  help with resizing frozen panes too.

	* src/sheet-object.c (sheet_relocate_objects) : only update if requested.

2001-10-27  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-control-gui.c (scg_colrow_select) : be smarter about
	  edit_pos placement when there are frozen panes.

2001-10-27  Jody Goldberg <jgoldberg@home.com>

	* src/item-grid.c (item_grid_event) : move the cursor setting out of
	  event::ENTER and into scg_set_display_cursor.

	* src/sheet-control-gui.c (scg_set_display_cursor) : new routine.
	(scg_mode_edit) : reset the display cursors.
	(scg_mode_edit_object) : ditto.
	(scg_mode_create_object) : ditto.

	* src/gnumeric-canvas.c (gnm_canvas_key_press) : if the key is
	  unhandled forward it to the canvas items.

	* src/item-cursor.c (item_cursor_autofill_event) : ctrl-autofill
	  defaults to increment.

2001-10-26  Jody Goldberg <jgoldberg@home.com>

	* src/workbook-edit.c (wbcg_edit_finish) : remove the loops, and
	  recursions.  match against formatted values before expressions, then
	  fall back to strings.

	* src/parse-util.c (parse_text_value_or_expr) : match against
	  formatted values before expressions, then fall back to strings.

	* src/cell.c (cell_set_text) : parse_text_value_or_expr takes a ParsePos.
	* src/sheet.c (sheet_cell_set_text) : ditto.
	* src/widgets/gnumeric-expr-entry.c
	  (gnumeric_expr_entry_key_press_event) : ditto.
	* src/commands.c (cmd_area_set_text_redo) : ditto.
	(cmd_area_set_text) : ditto.
	(cmd_search_replace_do_cell) : create a tmp EvalPos to avoid changing
	  the search data structures.

	* src/expr.c (expr_tree_get_range) : renamed from range_from_expr_tree.
	  add support for singletons.

	* src/ranges.c (global_range_parse) : tweak slightly.

2001-10-26  Jody Goldberg <jgoldberg@home.com>

	* src/number-match.c (format_match_init) : don't include text in the
	  stock set of formats they should only match numbers.

2001-10-25  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-autofill.c (autofill_compute_delta) : try to clarify
	  things by removing the unused parameter.
	(autofill_cell) : Restore and correct the old code.

2001-10-25  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/analysis-tools.c : various routines added to keep track of missing 
	  observations as well as various routines removed that are no longer
	  required. Renamed data_set_t to old_data_set_t, and introduced a new
          data_set_t
	(correlation_tool) : now handles missing observations and permits disconnected
          rectangular data regions
	(covariance_tool) : ditto
	(descriptive_stat_tool) : now permits disconnected rectangular data regions 
	(sampling_tool) : now permits samples of multiple datasets as well as multiple 
	  samples.
	* src/analysis-tools.h : new group_by_t type
	* src/ranges.c (global_range_parse) : fix bug (relative references were 
	  evaluated with respect to B2 rather than A1)

2001-10-25  Morten Welinder  <terra@diku.dk>

	* src/number-match.c (format_create_regexp): Sign after "E" is
 	optional.
	(char_to_re): New function.
	(format_create_regexp): Use char_to_re to quote thousand and
 	decimal separators.
	(compute_value): Fix sign handling.

2001-10-25  Jody Goldberg <jgoldberg@home.com>

	* src/number-match.c (compute_value) : fix leaks.

	* src/sheet-autofill.c (autofill_cell) : fix leak.

	* gnumeric.xsd : add the scaling information.

	* src/xml-io.c (xml_write_print_info) : why weren't we saving scaling
	  info ?
	(xml_read_print_info) : or reading back.

2001-10-25  Jody Goldberg <jgoldberg@home.com>

	* src/ranges.c (global_range_list_parse) : put things in the right
	  order.
	(global_range_list_foreach) : new routine designed to replace old
	  range_list_foreach_full.

	* src/number-match.c (compute_value) : fix old typo, make dates
	  integers when possible.

2001-10-25  Jody Goldberg <jgoldberg@home.com>

	* src/number-match.c (compute_value) : fix return values and test that
	  year is within bounds.

	* src/ranges.c (range_trim) : decrease lobotomization factor.

2001-10-23  Jody Goldberg <jgoldberg@home.com>

	* src/expr-name.c (named_expr_new) : renamed from add_real, simplified
	  interface.
	(expr_name_add) : take and store a parse position.
	(expr_name_create) : ditto.
	(expr_name_destroy) : adjust to stored parsepos.
	(expr_name_unlink) : ditto.
	(expr_name_sheet2wb) : ditto.
	(expr_name_init) : ditto.
	(expr_name_as_string) : renamed from expr_name_value.
	(expr_name_eval) : renamed from eval_expr_name.

	s/eval_expr/expr_eval/

	* src/expr.c (do_expr_tree_to_string) : Use value_as_string in most
	  places.
	* src/value-sheet.c (value_cellrange_get_as_string) : delete bogus
	  useless arg.
	(encode_cellref) : delete redundant.

	* src/parse-util.c (cellref_name) : ICK!  XL wraps relative references
	  that are out of bounds.

2001-10-23  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/ranges.c/h (global_range_parse) : remove `strict' argument
	(range_list_foreach_full) : change third argument from boolean to
	  enumerate to allow third variant, namely call backup even for NULL 
	  cells without creating them.
        * src/ranges.c (global_range_parse) : change to a wrapper
	  around expr_parse_string.
	(global_range_list_parse) : new routine, analogue 
	  to range_list_parse but calling global_range_parse rather than 
	  range_parse (for analysis tools)

2001-10-23  Almer S. Tigelaar  <almer@gnome.org>

	* src/mstyle.c (mstyle_get_validation_msg): Fix this for
	cases where the msg is NULL.

	* src/workbook-edit.c (wbcg_edit_validate): Call upon
	validation_get_accept in gui-validation.c to pop-up
	a dialog if needed.

	* src/gui-validation.[ch]: New, gui parts of validation.
	Used by wbcg_edit_validate and also in dialog-cell-format.c

	* src/style-condition.c (style_condition_flags_eval): Remove
	debug message.
	
2001-10-22  Almer S. Tigelaar  <almer@gnome.org>

	* src/style-condition.h :
	Re-Order validation Enum and define new StyleCondition
	types.

	* src/style-condition.c (style_condition_expr_dep_eval) :
	Renamed from style_condition_dep_eval.
	(style_condition_expr_set_expr) :
	Renamed from style_condition_set_expr.
	(style_condition_expr_dep_debug_name) :
	Renamed from style_condition_dep_debug_name.
	(style_condition_new_expr): Renamed from
	style_condition_new.
	(style_condition_new_constraint): New, creates a
	stylecondition of type constraint.
	(style_condition_new_flags): New, creates a stylecondition
	of type flags.
	(style_condition_unref): Deal with changes in stylecondition
	structure.
	(style_condition_chain): Add operator parameter.
	(style_condition_expr_eval): Split out from style_condition_eval.
	(style_condition_constraint_eval): Idem.
	(style_condition_flags_eval): New, handles allow blank.
	(style_condition_dump): New, dumps a style condition chain to the
	screen. For debugging purposes.
	(style_condition_eval): Handle the new chain operators and use
	the *_eval functions.

2001-10-22  Jody Goldberg <jgoldberg@home.com>

	* src/expr-name.c (name_refer_circular) : fix.

	* src/print.c (print_sheet_objects) : filter hidden objects.

	* src/commands.c (cmd_unmerge_cells_undo) : queue the original region
	  for a redraw before remerging in case of spans.

	* src/parser.y (gnumeric_parse_error) : Use workbook_sheet_by_name.

	* src/sheet.c (sheet_lookup_by_name) : delete bogus routine.

2001-10-21  Jody Goldberg <jgoldberg@home.com>

	* src/cellspan.c (cell_calc_span) : min_col is exclusive.

	* src/sheet-object-container.c (sheet_object_container_update_bounds) :
	  handle visibility.
	* src/sheet-object-cell-comment.c (cell_comment_update_bounds) : ditto.
	* src/sheet-object-graphic.c (sheet_object_graphic_update_bounds) : ditto.
	(sheet_object_filled_update_bounds) : ditto.
	* src/sheet-object-widget.c (sheet_object_widget_update_bounds) : ditto.

	* src/sheet-object.c (sheet_object_init) : init is_visible.
	  Not really needed, but lets be careful.
	(sheet_object_update_bounds) : check to visibility.

2001-10-20  jody goldberg <jgoldberg@home.com>

	* src/sheet.c (cb_max_cell_width) : factor in indents too.

2001-10-20  Jody Goldberg <jgoldberg@home.com>

	* src/sheet.c (sheet_find_boundary_{horizontal,vertical}) : handle
	  jumping to end of non-blank region where the end is hidden.

2001-10-19  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-graph.c (gnm_graph_setup) : it is 'oaf-run-query'
	  Spew the informative message for all oaf exceptions.

2001-10-19  Morten Welinder  <terra@diku.dk>

	* src/number-match.c (compute_value): Fix parsing of decimal
 	fractions and exponents.

2001-10-19  Morten Welinder  <terra@diku.dk>

	* src/goal-seek.c (goal_seek_newton): Deliberately overshoot in
 	each iteration.  This makes it more likely that we get to hit both
 	sides of the root.
	(goal_seek_bisection): Introduce Newton steps when we're close to
 	a root.  Pick best of xmid, xneg, and xpos when we decide we have
 	the required precision.

2001-10-19  Jody Goldberg <jgoldberg@home.com>

	* configure.in : Until the gb plugin works with newer gb make
	the test == 0.17

2001-10-19  Morten Welinder  <terra@diku.dk>

	* src/goal-seek.c (goal_seek_bisection): Use mid-point bisection
 	more often.  Increase maximum number of iterations (just in case).

	* src/commands.c (cmd_ins_del_colrow_redo): Initialise cri, just
 	in case.

2001-10-18  Andreas J. Guelzow <aguelzow@taliesin.ca>

        * src/ranges.c/h (global_range_parse) : new function

2001-10-18  Jody Goldberg <jgoldberg@home.com>

	* configure.in : post release bump.

2001-10-18  Jody Goldberg <jgoldberg@home.com>

	* Release 0.72

2001-10-18  Jody Goldberg <jgoldberg@home.com>

	* src/xml-io.c (xml_node_get_int) : use strtol
	(xml_node_get_double) : strtod.

	* src/number-match.c (format_match_number) : new.

	* src/expr.c (eval_expr_real) : format_match can match non-numbers now.

2001-10-18  Morten Welinder  <terra@diku.dk>

	* src/pixmaps/16_search.xpm: new file (derived from from Evolution).
	* src/application.c (application_init): Add search pixmap.
	* src/workbook-control-gui.c (workbook_menu_edit): Ditto.
	* src/GNOME_Gnumeric.xml: Ditto.

2001-10-17  Jody Goldberg <jgoldberg@home.com>

	* src/item-bar.c (ib_draw_cell) : add some protection in case of bad
	  fonts.

2001-10-17  Jody Goldberg <jgoldberg@home.com>

	* src/gui-util.c (gnumeric_create_popup_menu_list) : tweak this to
	  take a list.
	(gnumeric_create_popup_menu) : and make this a wrapper.

	* src/gnumeric-graph.c (gnm_graph_user_config) : connect to the graph
	  guru formatGuru.

2001-10-17  Jon K Hellan  <hellan@acm.org>

	* src/gnumeric-graph.h: Declare GNM_VECTOR_DATE to fix build.

2001-10-16  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-object.c (sheet_object_clear_sheet) : fix leak.

	* src/gnumeric-graph.c (gnm_graph_import_specification) : fix leak.

2001-10-16  Jody Goldberg <jgoldberg@home.com>

	* rc/gnumeric-graph.c (gnm_graph_vector_eval) : patch leak.
	(gnm_graph_series_get_dimension) : s/element/dim_name/
	(gnm_graph_series_add_dimension) : ditto.

2001-10-16  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-graph.c (gnm_graph_type_selector) : delete.
	(gnm_graph_get_config_control) : ORBit returns garbage if the remote
	  call fails.
	(gnm_graph_subscribe_vector) : ditto.

2001-10-16  Andreas J. Guelzow <aguelzow@taliesin.ca>

       * src/analysis-tools.c (sampling_tool) : Fixed small bug.

2001-10-16  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-graph.c (gnm_graph_get_spec) : Buffer changed name.
	  leak fix.
	(gnm_graph_import_specification) : ditto.

	* idl/GNOME_Gnumeric_Graph.idl  : Add some derived controls to act as
	  gurus.

2001-10-15  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-graph.c (gnm_graph_series_get_dimension) : fix leak.
	(gnm_graph_import_specification) : fix leak.
	(gnm_graph_arrange_vectors) : ditto.

2001-10-14  Almer S. Tigelaar  <almer@gnome.org>
 
 	* src/workbook-control-gui.c (cb_data_validate):
 	Pop-up validation page of format dialog. Disabled
	for now.
 
 	* src/GNOME_Gnumeric.xml: Add validate menu
 	item. Commented out for now.

2001-10-13  Morten Welinder  <terra@diku.dk>

	* src/search.c (search_match_string): Fix last change.

2001-10-13  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-canvas.c (gnm_canvas_key_mode_sheet) : don't move past
	  the unhidden region.
	* src/sheet.c (sheet_find_boundary_horizontal) : ditto.
	(sheet_find_boundary_vertical) :ditto.

	* src/colrow.c (colrow_set_visibility) : keep track of the bound of
	  the unhidden region of the sheet.

2001-10-12  Jody Goldberg <jgoldberg@home.com>

	http://bugzilla.gnome.org/show_bug.cgi?id=62167
	* src/parser.y (yylex) : If an integer is out of range fall back to
	  float.  Reorganize slightly to make this more readable.

2001-10-12  Morten Welinder  <terra@diku.dk>

	* src/search.c (search_collect_cells_free): New convenience
 	function.
	(search_match_string): Fix word search.

	* src/commands.c (cmd_search_replace_do): Use
 	search_collect_cells_free.

2001-10-12  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-graph.c (gnm_graph_vector_destroy) : release the cached
	  value if it exists.
	(gnm_graph_arrange_vectors) : don't allocate anything if the manager
	  is missing.

2001-10-12  Morten Welinder  <terra@diku.dk>

	* src/workbook-view.c (wb_view_open_custom): Plug leak.

2001-10-12  Jody Goldberg <jgoldberg@home.com>

	* idl/GNOME_Gnumeric_Graph.idl :  simplify my life
	  make the manager inherit from Embeddable directly.

2001-10-11  Jody Goldberg <jgoldberg@home.com>

	* src/mathfunc.c (minverse) : fix.

2001-10-11  Jody Goldberg <jgoldberg@home.com>

	* src/eval.c (dependent_set_sheet) : new utility.

2001-10-12  Morten Welinder  <terra@diku.dk>

	* configure.in (gal): Require 0.14 because the new search code
 	uses E-table.

	* src/workbook-control-gui.c: Add the F7 accelerator for
 	non-Bonobo also.

2001-10-12  John Gotts <jgotts@linuxsavvy.com>

	* gnumeric.spec.in: If you don't want bonobo, change %define WithBonobo
	1 to %define WithBonobo 0.

2001-10-11  Jody Goldberg <jgoldberg@home.com>

	* src/item-grid.c (ig_obj_create_motion) : renamed and restructured
	  from cb_obj_create_motion.
	(ig_obj_create_finish) : ditto from cb_obj_create_button_release.
	(ig_obj_create_begin) : ditto from sheet_object_begin_creation.
	  Grab to pointer and use the grid's event handler rather than
	  attempting to apply local handlers for the canvas.
	(cb_extend_object_creation) : new.
	(item_grid_event) : use the new obj_create routines.
	(item_grid_init) : init the obj_create data.

2001-10-11  Morten Welinder  <terra@diku.dk>

	* src/search.c (search_filter_matching,
 	search_filter_matching_free): New functions.

	* src/workbook-control-gui.c (workbook_control_gui_init): Plug leak.
	(cb_edit_search): Delete.
	(cb_edit_search): Use new dialog.

2001-10-11  Jody Goldberg <jgoldberg@home.com>

	* src/workbook-control-gui.c (cb_file_quit) :
	(workbook_close_if_user_permits) : optionally avoid closing pristine
	  books.  Return more state info to handle cancel vs closed vs can
	  close.
	(wbcg_close_control) : keep it simple.

2001-10-10  Jody Goldberg <jgoldberg@home.com>

	* src/colrow.c (colrow_visibility) : we stop wither at the edge, or 1
	  past the last match.

2001-10-10  Jody Goldberg <jgoldberg@home.com>

	* src/mstyle.c (mstyle_merge) : delete.

2001-10-10  Jody Goldberg <jgoldberg@home.com>

	* src/plugin-util.c (gnumeric_fopen) : be smarter about what type of
	  error to report.

	* src/xml-io.c (gnumeric_xml_write_workbook) : switch to manually
	  opening the file then dumping to prepare for xml2.  Apparently it
	  attempts to escape file names.
	* src/xml-io-autoft.c (gnumeric_xml_write_format_template) : ditto.

2001-10-10  Jody Goldberg <jgoldberg@home.com>

	* src/xml-io.c (gnumeric_xml_set_compression) : new utility.
	(gnumeric_xml_write_selection_clipboard) : Used here.
	(gnumeric_xml_write_workbook) : and here.

2001-10-10  Almer S. Tigelaar  <almer@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=62006
	* src/stf-parse.c (stf_parse_csv_is_separator): Tidy.
	(stf_parse_csv_cell): Fix handling of multiple separators.
	(stf_parse_get_colcount): Idem.
	(stf_parse_get_colwidth): Idem.

2001-10-10  Jody Goldberg <jgoldberg@home.com>

	http://bugzilla.gnome.org/show_bug.cgi?id=62031
	* src/sheet-control-gui.c (scg_cursor_extend) : Make this smarter.
	  only make the dimension that changed visible, there is no need to
	  jump to the corner.

	* src/gui-util.h (color_combo_get_style_color) : add missing decl.

2001-10-08    J.H.M. Dassen (Ray) <jdassen@debian.org>

	* src/workbook-control-gui.c (cb_edit_fill_autofill) : 
	  Don't use C++/C99 `//' comment.

2001-10-10  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-graph.c (gnm_graph_vector_seq_scalar) : Fix row vectors.
	(gnm_graph_vector_seq_date) : ditto.
	(gnm_graph_vector_seq_string) : ditto.

2001-10-10  Jody Goldberg <jgoldberg@home.com>

	http://bugzilla.gnome.org/show_bug.cgi?id=62030
	* src/gui-util.c (color_combo_get_style_color) : new utility.
	* src/sheet-object-graphic.c (cb_dialog_graphic_clicked) : Use it here.
	(cb_dialog_filled_clicked) and here.

2001-10-09  John Gotts <jgotts@linuxsavvy.com>

	* gnumeric.spec.in: Added gnome-core and bonobo as requirements.

2001-10-09  Jody Goldberg <jgoldberg@home.com>

	* README : bump bonobo req to fix some crashes in printing.
	and fix some stale docs.
	* configure.in : ditto.

2001-10-09  Jody Goldberg <jgoldberg@home.com>

	* GNOME_Gnumeric.oaf.in : Disable embeddable grid, it is broken.

2001-10-09  Jody Goldberg <jgoldberg@home.com>

	* src/eval.c (dependent_set_expr) : Make a default handler to merge
	  all the different states that have croppedup into one place.
	* src/gnumeric-graph.c (gnm_graph_vector_set_expr) : Use the default.
	* src/sheet-object-widget.c (checkbox_set_expr) : ditto.
	* src/style-condition.c (style_condition_dep_set_expr) : The default
	  handles most of the work.

	* src/style-condition.c : Use DEPENDENT_MAKE_TYPE.

2001-10-09  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-graph.c (gnm_graph_add_vector) : Allow empties to
	  remaing empty.
	(gnm_graph_vector_eval) : ditto.
	(gnm_graph_vector_seq_string) : handle singleton empties.

2001-10-08  Almer S. Tigelaar  <almer@gnome.org>

	* src/style-condition.[ch] (style_condition_eval):
	Add StyleFormat parameter and support for new non-value
	conditions.
	(style_condition_new): Don't demand expression for
	non-value restrictions.
	(style_condition_chain): Fix typo preventing chaining.

	* src/workbook-edit.c (wbcg_edit_validate): Pass
	StyleFormat parameter to style_condition_eval if
	the cell has one.

2001-10-08  Jody Goldberg <jgoldberg@home.com>

	* configure.in : post release bump

2001-10-07  Jody Goldberg <jgoldberg@home.com>

	* Release 0.71

2001-10-07  Jody Goldberg <jgoldberg@home.com>

	* configure.in (EXTRA_GNOME_{CFLAGS,LIBS}) : rename to something
	  clearer like GNUMERIC_{CFLAGS,LIBS})
	* **/Makefile.am : Use them in place of EXTRA_* and GNOME_INCLUDEDIR.

2001-10-06  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-graph.c (gnm_graph_get_spec) : Add a force_update.
	(gnm_graph_series_delete) : new
	(gnm_graph_series_set_dimension) : new
	(gnm_graph_exception) : new.
	(gnm_graph_vector_from_string) : delete.

2001-10-06  Jody Goldberg <jgoldberg@home.com>

	* src/dialogs/dialog-stf-preview.c (stf_preview_new) : Use
	  gdk_fontset_load to be more friendly in multi-byte environments.
	* src/style.c (style_font_new_simple) : ditto.

2001-10-06  Morten Welinder  <terra@diku.dk>

	* src/workbook-control-gui.c (cb_edit_search_action): Handle
 	comments.

	* src/search.c (search_replace_cell, search_replace_comment): New
 	functions, extracted from commands.c.

	* src/commands.c (cmd_search_replace_do_cell): Use search_replace
 	and search_replace_comment.

2001-10-06  Morten Welinder  <terra@diku.dk>

	* src/workbook-control-gui.c (cb_edit_search): Implement search.

	* src/search.c (search_collect_cells): New function, extracted
 	from commands.c.
	(search_match_string): New function to check for match only.

	* src/gui-util.c (gnumeric_keyed_dialog): Constify.

2001-10-05  Jody Goldberg <jgoldberg@home.com>

	* src/number-match.c (format_match) : compute_value returns a Value
	  now.
	(compute_value) : return a Value.

2001-10-05  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-graph.c (gnm_graph_series_set_dimension) : new.
	(gnm_graph_series_delete) : new.

	* idl/GNOME_Gnumeric_Graph.idl : Add seriesSetDimension, and
	  seriesDelete.  Bump the idl version.

2001-10-05  Morten Welinder  <terra@diku.dk>

	* src/commands.c (cmd_search_replace_do): Leg work for search.
	* src/search.h: Ditto.

2001-10-05  Jody Goldberg <jgoldberg@home.com>

	* src/application.c (application_init) : Add a matching save icon for
	  the toolbar.

	* src/workbook-control-gui.c (workbook_standard_toolbar) : Use it.
	* src/GNOME_Gnumeric.xml : and here.

2001-10-04  Jody Goldberg <jgoldberg@home.com>

	* src/analysis-tools.c (get_data) : teeny tiny fixups.  use
	  prepend/reverse rather than append.  Add an ignore_blanks
	  flag.

2001-10-04  Jody Goldberg <jgoldberg@home.com>

	* src/analysis-tools.c (set_cell) : Use value_new_empty in place of an
	  empty string.
	(set_cell_value) : don't clip singletons.

2001-10-04  Jody Goldberg <jgoldberg@home.com>

	* src/number-match.c (format_create_regexp) : handle embedded strings
	  properly.

2001-10-04  Jody Goldberg <jgoldberg@home.com>

	* src/workbook-control-gui.c (zoom_changed) : Start searching for the
	  assigned text at the current list item.
	(cb_change_zoom) : adjust to new signal from the gnm_combo_text.
	  Make more error resistant.  Don't reset the content twice.
	(workbook_create_standard_toolbar) : adjsut to new signals from the
	  gnm_combo_text and use the simplified interface.

	* src/clipboard.c (paste_link) : adjust this to link a region not just
	  a single cell so that we can link all the cells, even the blanks.
	(clipboard_paste_region) : simplify and change link handling to ignore
	  the content.

2001-10-03  Jody Goldberg <jgoldberg@home.com>

	* src/application.c (application_clipboard_cut_copy) : merge
	  application_clipboard_cut and application_clipboard_copy.
	  Make the animated cursor optional.

	* src/selection.c (sheet_selection_cut) : interface change.
	(sheet_selection_copy) : ditto.
	* src/commands.c (cmd_ins_del_colrow_undo) : ditto.
	(cmd_ins_del_colrow_redo) : ditto.

2001-10-03  Jody Goldberg <jgoldberg@home.com>

	* src/number-match.c (format_match_create) : ensure we don't compile
	  General.
	  (format_match_init) : no need to filter General here.
	* src/format.c (style_format_new_XL) : do it here.

2001-10-03  Jukka-Pekka Iivonen  <jiivonen@hutcs.cs.hut.fi>

	* src/functions/fn-financial.c (coupnum): Fixed frequency 2 and 4.
	Now it can pass quite extensive test suite.

2001-10-03  Jody Goldberg <jgoldberg@home.com>

	* src/item-cursor.c (item_cursor_point) : disable events that could
	  cause cursor changes or allow dragging while a guru is up.

2001-10-03  Jakub Steiner <jimmac@ximian.com>

	* gnome-gnumeric.png: now it scales down better AND looks nice ;)

2001-10-03  Morten Welinder  <terra@diku.dk>

	* src/workbook.c (workbook_sheet_get_free_name): Get rid of eye
 	sore constant 1000.

2001-10-03  Andreas J. Guelzow <aguelzow@taliesin.ca>

        * src/analysis-tools.c (get_data) : Use sheet_cell_get_value rather
	  than sheet_cell_get
	  (covariance_tool) : These are covariances rather than correlations.

2001-10-03  Jody Goldberg <jgoldberg@home.com>

	* configure.in :  Improve the oaf test.

2001-10-02  Jody Goldberg <jgoldberg@home.com>

	* idl/Makefile.am : Don't make the stampel files unless the idl
	  compile was successful.

2001-10-02  Jody Goldberg <jgoldberg@home.com>

	* src/workbook-control-gui.c (workbook_create_standard_toolbar) : Use
	  the gnm_combo_text until we merge it back into gal.

2001-10-02  Morten Welinder  <terra@diku.dk>

	* src/commands.c (cmd_search_replace_do_cell): Implement querying
 	for cell comments.

	* src/search.h (SearchReplaceQuery): Add SRQ_querycommment.

	* src/workbook-control-gui.c (cb_edit_search_replace_query):
 	implement SRQ_querycommment.

2001-10-02  Jakub Steiner <jimmac@ximian.com>

	* gnome-gnumeric.png: less detail so it looks better scaled down

2001-10-01  Jody Goldberg <jgoldberg@home.com>

	* src/Makefile.am : don't use _SOURCES for things that are not
	  directly related to automake.  1.5 complains.

	* idl/Makefile.am (CLEANFILES) : New automake warnings.

2001-10-01  Morten Welinder  <terra@diku.dk>

	* src/search.h (SearchReplaceQuery): Add SRQ_query.

	* src/commands.c (cmd_search_replace_do_cell): Implement querying.

	* src/workbook-control-gui.c (cb_edit_search_replace_query):
 	implement SRQ_query.

	* src/xml-io.c (xml_probe): Please gcc.

2001-09-30  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-object-widget.c (sheet_widget_checkbox_user_config) : Use
	  gnumeric_expr_entry_set_rangesel_from_dep.

2001-10-01  Zbigniew Chyla  <cyba@gnome.pl>

	* src/xml-io.c (xml_probe): Accept .gnumeric, .xml, .xml.gz not
	"everything but .xml".

2001-09-30  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-graph.c (gnm_graph_vector_as_string) : screw it.
	  Simplify my life by treating constants as expressions.
	(gnm_graph_series_get_dimension) : new utility.
	(gnm_graph_series_add_dimension) : new utility.

2001-09-28  Morten Welinder  <terra@diku.dk>

	* src/regression.c (LUPDecomp): Revert last change.  This seems to
 	fix regression, but there is something really bogus going on here.

2001-09-28  Jody Goldberg <jgoldberg@home.com>

	* src/item-cursor.c (item_cursor_set_bounds_visibly) : Actually use
	  the visible_{col,row} args,  Rename them to something more obvious
	  to avoid future stupidity.

2001-09-27  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-object.c (cell_offset_calc_pixel) : round to nearest
	  pixel, rather than truncating.

2001-09-27  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-control-gui.c (set_acetate_coords) : make the control pts
	  prettier.
	(set_item_x_y) : ditto.

2001-09-27  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-object-graphic.c (sheet_object_filled_print) : fix the
	  color mapping.  This should really be a convenience routine.
	* src/sheet-object-graphic.c (sheet_object_graphic_print) : ditto.

2001-09-27  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-object-graphic.c (sheet_object_graphic_fill_color_set) :
	  Use StyleColors and make public.
	(sheet_object_graphic_destroy) : unref the fill colour.
	(sheet_object_graphic_new_view) : translate from stylecolor to gdk.
	(sheet_object_graphic_read_xml) : use style colors.
	(sheet_object_graphic_write_xml) : use style colors.
	(sheet_object_graphic_clone) : reference the fill colour.
	(sheet_object_graphic_print) : use style colour.
	(cb_dialog_graphic_clicked) : ditto.
	(cb_dialog_filled_clicked) : ditto.
	(sheet_object_graphic_user_config) : ditto.
	(sheet_object_filled_user_config) : ditto.

	* src/style-color.c (style_color_ref) : NULL is ok.
	(style_color_unref) : ditto.

	* src/xml-io.c (xml_node_get_color) : rename and tidy up.
	(xml_node_get_gdkcolor) : delete.
	(xml_node_set_gdkcolor) : delete.
	(xml_read_style_border) : changes to get_color.
	(xml_read_style) : ditto.

2001-09-26  Jody Goldberg <jgoldberg@home.com>

	* src/item-grid.c (cb_obj_create_motion) : use down&right vs down&left.
	* src/sheet-control-gui.c (scg_object_view_position) : ditto.
	* src/sheet-object.c (sheet_object_direction_set) : ditto.

2001-09-26  Jody Goldberg <jgoldberg@home.com>

	* gnumeric.xsd : The style flags are not required, it will eventually
	  be possible to define styles that only change some of the
	  attributes.  Add locked & hidden.

	* src/xml-io.c (xml_write_style) : write locked & hidden.
	(xml_read_style) : read them too.

	* src/mstyle.c (mstyle_element_equal) : support locked and hidden.
	(mstyle_{get,set}_content_{locked,hidden}) : We have not implemented
	  it yet, but storing the info is easy enough.
	(mstyle_new_default) : Add locked & hidden.

2001-09-25  Jody Goldberg <jgoldberg@home.com>

	* src/expr.c (eval_expr_real) : shrink the stack a bit.

2001-09-25  Jon K Hellan  <hellan@acm.org>

	* idl/.cvsignore: Adapt to present reality.

2001-09-25  Jody Goldberg <jgoldberg@home.com>

	* src/workbook-view.c (wb_view_selection_desc) : fix old typo.

2001-09-24  Jody Goldberg <jgoldberg@home.com>

	* src/formats.c (cell_format_classify) : parse first, search list later.
	  This ensures that we find the right precision and such.

	* src/number-match.c (format_create_regexp) : fix matching for
	  non-separated numbers.  This still needs work.  The regexp is
	  not handling the precision.
	(compute_value) : improve debug output.
	(format_match) : ditto.

2001-09-21  Jody Goldberg <jgoldberg@home.com>

	* src/clipboard.c (cellregion_to_string) : don't append tabs or
	  newlines for singletons.

	* src/item-bar.c (item_bar_event) : fix silliness that was breaking
	  autoscroll.

2001-09-20  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-object-graphic.c (sheet_object_graphic_init) : Init the
	  fill colour for lines and arrows to black.
	(sheet_object_filled_init) : Use a name rather than assuming 0 = black
	  for outline colour, and convert the fill colour to white.

2001-09-19  Jody Goldberg <jgoldberg@home.com>

	* src/eval.c (workbook_recalc) : only redraw if something recalced.
	(dependent_eval) : return flag if something recalced.

2001-09-19  Jody Goldberg <jgoldberg@home.com>

	* src/cell-draw.c (cell_draw) : off by 1.
	* src/print-cell.c (print_cell) : off by 1.

	* src/sheet.c (sheet_cell_calc_span) : support SPANCALC_NO_DRAW
	  and don't bother rendering calculated cells.
	(cb_max_cell_width) : render if necessary.

2001-09-18  Jody Goldberg <jgoldberg@home.com>

	* src/style.c (style_font_get_width_pts) : renamed from
	  style_font_get_width and set to return pts.

2001-09-18  Jody Goldberg <jgoldberg@home.com>

	* src/cell-draw.c (cell_draw) : implemenent a bit of just in time
	  rendering.
	* src/print-cell.c (print_cell) : ditto.
	* src/cell.c (cell_eval_content) : ditto.

2001-09-18  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-control-gui.c (scg_scrollbar_config) : Fix old off by 1
	  error.  Number of visible = last - first PLUS 1.

2001-09-18  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-control-gui.c (scg_redraw_all) : make headers optional.
	* src/sheet-control.c (sc_redraw_all) : make headers optional.
	* src/sheet.c (sheet_redraw_all) : make headers optional.

	* src/colrow.c (colrow_set_visibility_list) : redraw_all does headers.

	* src/cell.c (cell_eval_content) : don't redraw here, and only render
	  if we were already rendered.  This will avoid rendering sheets no
	  one is looking at.

	* src/eval.c (workbook_recalc) : after a recalc redraw all, but not
	  headers.

2001-09-17  Jody Goldberg <jgoldberg@home.com>

	* src/workbook-control.c (wb_control_menu_state_sensitivity) : new
	  virtual.

	* src/workbook-control-gui.c (wbcg_menu_state_sensitivity) : renamed
	  and moved from.
	* src/workbook-edit.c (workbook_edit_toolbars_set_sensitive). here.

	* src/workbook-view.c (wb_view_open_custom) : Use
	  wb_control_menu_state_sensitivity to enable/disable
	  the menus and toolbars of the manging contol.

2001-09-17  Jody Goldberg <jgoldberg@home.com>

	* src/sheet.c (sheet_cell_new) : add some protection.

2001-09-16  Jody Goldberg <jgoldberg@home.com>

	* src/func.c (function_dump_defs) : dump the functions in alphabetical
	  order.  FIXME : when we have translated names we should use them.

2001-09-14  Jody Goldberg <jgoldberg@home.com>

	* gnumeric.xsd : reference v8, and make Max{Col,Row} optional.

	* src/xml-io.c : bump the name space version to reflect the schema
	  and move the location of the dtd and schema to somewhere we control.
	(xml_workbook_write) : reference the schema.
	(xml_sheet_write) : The name space is always available already.

2001-09-14  Jody Goldberg <jgoldberg@home.com>

	* src/workbook-control-gui.c (workbook_create_standard_toolbar) : Use
	  gnome_preferences_get_toolbar_detachable rather than
	  gnome_preferences_get_menubar_detachable.
	* src/workbook-format-toolbar.c (workbook_create_format_toolbar) :ditto.
	* src/workbook-object-toolbar.c (workbook_create_object_toolbar) :ditto.

2001-09-14  Jody Goldberg <jgoldberg@home.com>

	* src/style-color.c (style_color_new_name) : new utility.

	* src/gnumeric-graph.c : cleanup the debug info.
	(gnm_graph_get_spec) : make public and add some protection.

	* src/number-match.c : remove format_parse_t and merge it with
	  StyleFormat.
	(format_match_release) : new routine split from format_match_finish.
	(format_match_finish) : just unref the StyleFont.
	(format_match_create) : tweaking the calling convention and rename
	  format_match_define.
	(format_match_init) : manage the format_match_list here.
	(format_match) : Match against the currently assigned format first

	* src/format.c : clean the includes.
	Make _StyleFormat public for sharing with number-match.c
	(format_compile) : call format_match_create.
	(format_destroy) : call format_match_release.
	(format_color_init) : use style_color_new_name.
	(style_format_new_XL) : init the new regexp elements to NULL.

	* src/bonobo-io.c (gnumeric_bonobo_io_init) : name this better.

	* src/sheet-control-gui.c (scg_object_update_bbox) : add some
	  protection.

2001-09-12  John Gotts <jgotts@linuxsavvy.com>

	* gnumeric.spec.in: Keep better track of the /usr/share/gnumeric
	  directory structure, following problem reports on the GNOME mailing
	  lists.

2001-09-12  Jody Goldberg <jgoldberg@home.com>

	* idl/GNOME_Gnumeric_Graph.idl : move the type enums here.
	  merge the addVector routines.
	  change immportSpec into an attribute.

	* src/gnumeric-graph.c (gnm_graph_write_xml) : new routine.
	(gnm_graph_read_xml) : new routine.
	(gnm_graph_class_init) : assign them here.
	(gnm_graph_new) : split this into a wrapper for
	(gnm_graph_setup) : this new routine.
	(gnm_graph_vector_seq_scalar) : handle blank cells.
	(gnm_graph_vector_seq_date) : handle blank cells.
	(gnm_graph_vector_seq_string) : handle blank cells.
	(gnm_graph_vector_corba_destroy) : release the subscriber.
	(gnm_graph_subscribe_vector) : adjust to idl changes.
	(gnm_graph_get_spec) : new routine.

	* src/position.c (parse_pos_init_dep) : new utility.

2001-09-11  Jody Goldberg <jgoldberg@home.com>

	* src/style.c (style_font_new_simple) : store the width in pixels as
	  well as pts.

	* src/print-cell.c (print_cell) : sync with the drawing code.

2001-09-10  Morten Welinder  <terra@diku.dk>

	* src/xml-io.c (xml_probe): Don't be picky about file name case.

	* src/GNOME_Gnumeric.xml: Add menu item for toolbars.

2001-09-10  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/analysis-tools.c (confidence_level) : Fix confidence interval
	  calculation (bug 57320). Change code to calculate mean only twice
	  rather than four times per variable.
	(summary_statistics) : Change code to calculate mean only twice
	  rather than four times per variable.
	(descriptive_stat_tool) : ditto

2001-09-10  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-graph.c (gnm_graph_range_to_vectors) : move this here
	  from the guru.
	(gnm_graph_arrange_vectors) : implement.
	(gnm_graph_add_vector : init the extra members for arrangement.

2001-09-04  Christopher Fairbairn  <ckf13@student.canterbury.ac.nz>

	* src/GNOME_Gnumeric.xml: added new menu item
	* src/ranges.c: (range_trim): added function to trim blank cells
	  at bottom/right edge of a range
	* src/ranges.h: ditto
	* src/workbook-control-gui.c: (cb_edit_fill_autofill): added
	  keyboard and menu support for the autofill feature

2001-09-07  Morten Welinder  <terra@diku.dk>

	* src/xml-io.c (gnumeric_xml_read_selection_clipboard): Properly
 	initialise context.
	(gnumeric_xml_write_selection_clipboard): Ditto.
	(StyleSideNames): Constify.
	(xml_arg_set): Constify.
	(xml_write_print_repeat_range): Constify.
	(xml_parse_ctx_new_full): Initialise new shared_exprs member for
 	reading.
	(xml_parse_ctx_destroy): Destroy shared_exprs.
	(xml_read_cell): Use shared_exprs over expr_map.

2001-09-03  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/dialogs/descriptive-stats.glade : New file. Template for
	  descriptive stats analysis tool dialog.
	* src/analysis-tools.h : Separate descriptive_stat_tool_t type into
	  descriptive_stat_tool_t (used by descriptive stats tool) and
	  stat_tool_t (used by other tools).
	* src/dialogs/dialog-analysis-tools.c : Rewrote code related to
	  descriptive stats tool to use glade template and gnumeric-expr-entry
	  widget.
	(summary_stat_signal_fun) : deleted
	(confidence_signal_fun) : deleted
	(kth_largest_signal_fun) : deleted
	(kth_smallest_signal_fun) : deleted
	(first_col_label_signal_fun) : deleted
	(add_groupped_by) : deleted
	(desc_stat_tool_destroy) : new procedure
	(desc_stat_tool_set_focus) : new procedure
	(cb_desc_stat_tool_ok_clicked) : new procedure
	(cb_desc_stat_tool_cancel_clicked) : new procedure
	(desc_stat_tool_update_sensitivity) : new procedure
	(desc_stat_tool_update_sensitivity_cb) : new procedure
	(dialog_desc_stat_tool_init) : new procedure
	(dialog_descriptive_stat_tool) : setup guru rather than modal dialog.

2001-09-06  Jody Goldberg <jgoldberg@home.com>

	* src/xml-io.c (xml_parse_ctx_new) : Use GNUM_XML_LATEST.
	* src/bonobo-io.c (gnumeric_bonobo_write_workbook) : ditto.

2001-09-06  Morten Welinder  <terra@diku.dk>

	* src/*.c: Fix MIX/MAX usage to always have identical argument
 	types.

	* src/xml-io.c (xml_parse_ctx_new): Fix version.

2001-09-06  Morten Welinder  <terra@diku.dk>

	* src/eval.c (dependent_changed): Remove "pos" argument which is
 	always NULL.  All callers changed.

	* src/main.c (main): Delete.
	(main): Renamed from gnumeric_main.  Return type changed to int.

2001-09-05  Jody Goldberg <jgoldberg@home.com>

	* src/commands.c (cmd_ins_del_colrow) : don't store the clipboard if
	  it on another sheet.

	* src/GNOME_Gnumeric.xml : The magic incantation  that allows us to
	  desensitize toolbars by setting a property on a command of the same
	  namedoesnot work with a menubar, but supplying an 'id' property to
	  the menu appears to do the trick.

	* src/workbook-edit.c (workbook_edit_toolbars_set_sensitive) : set the
	  menubar also.
	(workbook_edit_toolbars_set_sensitive) : add a kludge for bonobo
	  to disable its tendancy to resensitize the undo/redo widgets.
	(workbook_edit_set_sensitive) : decrease the timer so that we don't feel
	  so sluggish.

2001-09-04  Jody Goldberg <jgoldberg@home.com>

	* src/xml-io.c (xml_probe) : accept .xml & .xml.gz

	* src/sheet-object.c (sheet_object_anchor_init) : Actually store the
	  the direction.

	* src/gnumeric-graph.c (gnm_graph_add_vector) : improve handling of
	  failures.

2001-09-03  Jody Goldberg <jgoldberg@home.com>

	* src/value-sheet.c (value_area_get_width) : fix old silliness.
	(value_area_get_height) : ditto.  Handle inverted  mixed mode
	  references.

2001-09-02  Jody Goldberg <jgoldberg@home.com>

	* src/style-condition.h : Qualify the namespace better.

2001-09-02  Jody Goldberg <jgoldberg@home.com>
	For Wayne Schuller <k_wayne@linuxpower.org>

	* src/pattern.c (gnumeric_background_set_pc) : Support gray scale
	  patterns when printing.

2001-09-02  Jody Goldberg <jgoldberg@home.com>

	* src/style-condition.c (style_condition_eval) : Use dependent_eval
	  and add an invariant that ensures that val is only NULL if we have
	  been queued for recalc.

	* src/eval.c (dependent_eval) : split from workbook_recalc.
	(cell_eval) : change return type.  no one was using it.
	(dependent_needs_recalc) : new macro.

2001-08-31  Jody Goldberg <jgoldberg@home.com>

	* src/format.c (format_number) : add a way to force 12 hour mode
	  without showing am/pm

2001-09-02  Almer S. Tigelaar  <almer@gnome.org>

	* src/style-condition.[ch]: Implementation of conditionals.

	* src/gnumeric.h: Add StyleCondition here.

	* src/mstyle.c (mstyle_hash): Hash validation style.
	(mstyle_element_dump): Dump validation message.
	(mstyle_element_equal): Add support for validation elements.
	(mstyle_element_ref): Ref validation message and style condition.
	(mstyle_element_unref): Idem.
	(mstyle_new_default): Initialize validation elements.
	(mstyle_set_validation): Sets validation style condition.
	(mstyle_get_validation): Gets ....
	(mstyle_set_validation_style): Sets validation style.
	(mstyle_get_validation_style): Gets ....
	(mstyle_set_validation_msg): Sets validation message.
	(mstyle_get_validation_msg): Gets ....

	* src/mstyle.h: Add the new elements.

	* src/workbook-edit.c (wbcg_edit_validate): Do the validation
	and handle the consequences if it fails.
	(wbcg_edit_finish): Use wbcg_edit_validate and discard the input
	if needed.

2001-08-31  Morten Welinder  <terra@diku.dk>

	* src/xml-io.c (xml_workbook_read): Avoid geek speak.  Most users
 	should not know, not care, that the underlying format is XML.
	(gnumeric_xml_read_workbook): Ditto.

2001-08-31  Abel Cheung  <maddog@linux.org.hk>

	* configure.in (ALL_LINGUAS): zh_TW.Big5 -> zh_TW

2001-08-30  Jody Goldberg <jgoldberg@home.com>

	* src/sheet.c (sheet_cell_destroy) : fix.  We need to check
	  for recalc before we unlink, and possibly queue the dependents
	  of cells which had constant values.

	* src/eval.c : rearrange
	DependentSingle &
	DependentRange to keep the dep_list at the top
	Then define DependentAny for generic operations.
	(depsingle_dtor) : delete.
	(deprange_dtor) : delete.
	(dependent_queue_recalc_list) : remove unnecessary parameter.
	(sheet_region_queue_recalc) : walk the hash in both cases.
	(dependent_unlink) : only unlink if there is a dep list.
	(cb_search_rangedeps) : renamed from search_cell_deps.
	(cb_single_recalc_all_depends) : delete.
	(cb_range_recalc_all_depends) : delete.
	(cb_recalc_all_depends) : new.
	(cb_dep_hash_invalidate) : merge cb_single_hash_invalidate,
	  cb_range_hash_invalidate.
	(do_deps_destroy) : use the merged invalidation routines.
	(add_range_dep) : loop through the range buckets.
	(drop_range_dep) : loop through the range buckets.
	(dependent_unlink_sheet) : use SHEET_FOREACH_DEPENDENT.
	(cell_foreach_range_dep) : only check useful buckets.
	(dependency_data_new) : create the buckets.
	(sheet_dump_dependencies) : handle ranges.

2001-08-30  Morten Welinder  <terra@diku.dk>

	* src/workbook.h (WORKBOOK_FOREACH_SHEET): New macro.
	(WORKBOOK_FOREACH_DEPENDENT): Re-factor.
	(Workbook): Move dependents to DependencyContainer, see below.
	Introduce new external_dependents, not yet used.

	* src/sheet.h (SHEET_FOREACH_DEPENDENT): New macro.

	* src/eval.h: (DependencyContainer): type moved from eval.c and
 	renamed from DependencyData.  Add dependent_list member which used
 	to be in Workbook.
	(DEPENDENT_IS_CELL): New macro.  Put into used lots of places.
	(DEPENDENT_CONTAINER_FOREACH_DEPENDENT): New macro.

	* src/eval.c (cb_dependent_queue_recalc): Allocate single list
 	element on stack, not heap.
	(dependent_queue_recalc_list): Don't essentailly copy all lists.
	(UNLINK_DEP): Take only dep arguement and find the container from
 	that.

2001-08-29  Morten Welinder  <terra@diku.dk>

	* src/eval.c (workbook_queue_all_recalc): Avoid listifying.
	(cb_dependent_queue_recalc, cell_queue_recalc): Recast in terms of
 	dependent_queue_recalc_list.
	(dependent_queue_recalc_list): Eliminate recursion which used to
 	be unbounded deep.

	* src/eval.h (struct _Dependent): Name next to next_dep and prev
 	to prev_dep.  (Because we might need a similar list for evaluation
 	at some point.)

	(DEPENDENT_TYPE): New macro type hide most uses of the ugly
 	DEPENDENT_TYPE_MASK.  All such uses fixed.

2001-08-29  Jody Goldberg <jgoldberg@home.com>

	* src/eval.c (dependent_queue_recalc_list) : fix my breakage and don't
	  bother recursing for already queued cells.
	(workbook_queue_all_recalc) : remove sillyness.
	(dependent_unqueue) : delete unused routine.

	* src/cell.c (cell_cleanout) : remove useless 'in_recalc_queue' flag.
	(cell_copy) : ditto.

	* src/sheet.c (sheet_cell_destroy) : no need to unqueue, unlink
	  handles it.
	(sheet_move_range) : ditto.

2001-08-29  Jody Goldberg <jgoldberg@home.com>

	* src/eval.c (dependent_queue_recalc) : make this a macro.
	(cb_dependent_queue_recalc) : simplify to just mark the requirement
	  now that there is no distinct reval queue.
	(dependent_unqueue) : this is now trivial.
	(dep_slist_filter_sheet) : delete.
	(dependent_unqueue_sheet) : delete.
	(dependent_unlink) : clear the recalc flag directly.
	(cell_foreach_single_dep) : remove broken debugging.
	(workbook_recalc) : just walk the dependent list.  We can optimize
	  this later if need be.
	(sheet_dump_dependencies) : remove unnecessary debug info.

	* src/sheet.c (sheet_destroy_contents) : no need to unqueue_sheet.
	  unlink handles it.

	* src/workbook.c (workbook_destroy) : no more eval_queue.

2001-08-28  Jody Goldberg <jgoldberg@home.com>

	* src/eval.c (dependent_unlink_sheet) : Clear the sheet in case the
	  dependent tries to clear itself later.

	* src/xml-io.c (xml_write_attributes) : fix.

2001-08-28  Jody Goldberg <jgoldberg@home.com>

	* src/xml-io.c (xml_sheet_read) : no need to load the max col/row.
	  That is really only useful for external parsers.  We handle it
	  internally.

2001-08-28  Morten Welinder  <terra@diku.dk>

	* src/workbook.h (struct _Workbook): point to first dependent
 	directly, not via an slist.

	* src/eval.h (struct _Dependent): Add prev and next fields.

	* src/eval.c (dependent_unlink, dependent_unlink_sheet): Fix-up
 	unlinking.
	(dependent_link): Link using new double-linked structure.
	(sheet_region_queue_recalc): Use new dependent linking structure.
	(workbook_queue_all_recalc): Make an slist of dependents here.

	* src/workbook-control-gui.c (TOGGLE_HANDLER/display_formulas):
 	Adapt to new dependent linking structure.

	* src/workbook.c (workbook_expr_relocate): Adapt to new dependent
 	linking structure.

2001-08-28  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-control-gui.c (scg_mode_edit) : fix a warning on exit
	  when closing 1 of many open sheets.

	* src/gnumeric-graph.c : make the debug spew conditional.
	(CMANAGER1) : new macro.
	(gnm_graph_new) : add more safety checks.
	(gnm_graph_arrange_vectors) : use the versioning macros.
	(gnm_graph_import_specification) : new routine.

	* idl/gnumeric-graphs.idl (importSpecification) : new routine.

	* src/xml-io.c : clean up.
	s/xml_get_value_int/xml_node_get_int/
	s/xml_set_value_int/xml_node_set_int/
	s/xml_get_value_double/xml_node_get_double/
	s/xml_set_value_double/xml_node_set_double/
	s/xml_set_value_points/xml_node_set_points/
	s/xml_set_value_cstr/xml_node_set_cstr/
	s/xml_set_prop_cellpos/xml_node_set_cellpos/
	s/xml_get_prop_cellpos/xml_node_get_cellpos/
	s/xml_read_range/xml_node_get_range/
	s/xml_get_print_hf/xml_node_get_print_hf/
	s/xml_set_print_hf/xml_node_set_print_hf/
	s/xml_set_color_value/xml_node_set_color/
	s/xml_get_color_value/xml_node_get_color/
	s/xml_set_value_color/xml_node_set_gdkcolor/
	s/xml_get_value_color/xml_node_get_gdkcolor/

	Remove the pointless searching of children for content.
	We never relied on those semantics, nor do we want them.

	(xml_sheet_create) : Use xmlGetProp directly.
	(xml_sheet_read) : ditto.
	(xml_read_solver) : ditto.
	(xml_write_solver) : use xml_node_set_cstr.
	(xml_write_print_info) : Use xmlNewChild.
	(xml_value_get) : delete and use xmlGetProp directly.

2001-08-27  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-graph.c (gnm_graph_vector_set_expr) : remove debuggin
	  cruft.

2001-08-26  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-object-graphic.c (sheet_object_graphic_init) : default
	  fill colour to white.  It makes for bett looking paceholders.

2001-08-26  Jukka-Pekka Iivonen  <jiivonen@hutcs.cs.hut.fi>

	* plugins/mps/mps.c, plugins/mps/plugin.xml,
	plugins/mps/Makefile.am: Introduced.

	* configure.in, plugins/Makefile.am: Added the compilation of the
	MPS plugin.

	* samples/solver/afiro.mps: Added a sample file for the MPS plugin.
	It is from the Netlib collection which is in public domain.

2001-08-26  Zbigniew Chyla  <cyba@gnome.pl>

	* src/file-priv.h (struct _GnumFileSaver):
	Added "overwrite_files" field.

	* src/file.h (gnum_file_saver_set_overwrite_files): New function.

	* src/file.c
	(gnum_file_saver_init): Initialize overwrite_files (set to TRUE).
	(gnum_file_saver_save): Report an error and abort saving if file with
	given name already exists and overwrite_files == FALSE.

	* src/plugin-service.h (struct _PluginServiceFileSaver):
	Added "overwrite_files" field.

	* src/plugin-service.c (plugin_service_file_saver_read,
	gnum_plugin_file_saver_new): Handle overwrite_files flag.

	* src/xml-io.c (gnumeric_xml_read_workbook):
	Use fstat to get file size. Corrected error message.

2001-08-26  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-graph.c (gnm_graph_add_vector) : merge with
	  gnum_graph_vector_new and add intelligence to merge multiple
	  requests for the same vector into a single vector.

2001-08-26  Jody Goldberg <jgoldberg@home.com>

	* src/position.c (cellref_get_abs_pos) : rename and adjust signature.

	* src/expr.c (expr_tree_equal) : new function.

2001-08-24  Jody Goldberg <jgoldberg@home.com>

	* configure.in : bump bonobo req for real and remove unused
	  @gnumeric_executable@

	* idl/Makefile.am : fix.

	* src/gnumeric-canvas.c : add gnome-i18n.
	* src/gnumeric-util.c : add gnome-{i18n,util}
	* src/gui-file.c : add gnome-{i18n,config,util}
	* src/history.c : add gnome-i18n.
	* src/main.c : add gnome-config.
	* src/sheet-control-gui.c : add gnome-i18n.
	* src/workbook.c : Add gnome-i18n, loosen sheet-control-gui req to
	  just sheet-control.
	* src/workbook-edit.c : add gnome-i18n.
	* src/workbook-view.c : add gnome-i18n and gnome-config, remove widget.
	* src/workbook-control-gui.c : Add gnome-i18n and gnome-config.
	* src/xml-io-autoft.c : add unistd.h

2001-08-24  Zbigniew Chyla  <cyba@gnome.pl>

	* src/analysis-tools.c, src/application.c, src/bonobo-io.c,
	src/clipboard.c, src/cmd-edit.c, src/command-context.c,
	src/commands.c, src/corba-args.c, src/corba-workbook-factory.c,
	src/dates.c, src/dialogs/dialog-about.c,
	src/dialogs/dialog-advanced-filter.c,
	src/dialogs/dialog-analysis-tools.c, src/dialogs/dialog-autocorrect.c,
	src/dialogs/dialog-autoformat.c, src/dialogs/dialog-autosave.c,
	src/dialogs/dialog-cell-comment.c, src/dialogs/dialog-cell-format.c,
	src/dialogs/dialog-cell-sort.c, src/dialogs/dialog-consolidate.c,
	src/dialogs/dialog-define-names.c, src/dialogs/dialog-delete-cells.c,
	src/dialogs/dialog-function-wizard.c, src/dialogs/dialog-goal-seek.c,
	src/dialogs/dialog-goto-cell.c, src/dialogs/dialog-graph-guru.c,
	src/dialogs/dialog-insert-cells.c, src/dialogs/dialog-paste-special.c,
	src/dialogs/dialog-plugin-manager.c,
	src/dialogs/dialog-printer-setup.c,
	src/dialogs/dialog-search-replace.c, src/dialogs/dialog-sheet-order.c,
	src/dialogs/dialog-simple-input.c, src/dialogs/dialog-solver.c,
	src/dialogs/dialog-stf-export-private.h,
	src/dialogs/dialog-stf-export-sheet-page.c,
	src/dialogs/dialog-stf-export.c, src/dialogs/dialog-stf-preview.h,
	src/dialogs/dialog-stf.c, src/dialogs/dialog-stf.h,
	src/dialogs/dialog-summary.c, src/dialogs/dialog-validate.c,
	src/dialogs/dialog-workbook-attr.c, src/dialogs/dialog-zoom.c,
	src/dialogs/utils-dialog.c, src/expr-name.c, src/expr.c,
	src/file-autoft.c, src/format-template.c, src/format.c, src/formats.c,
	src/func.c, src/global-gnome-font.c, src/gnumeric-util.h,
	src/gui-clipboard.c, src/gui-file.c, src/gui-gnumeric.h, src/gutils.c,
	src/history.c, src/item-bar.c, src/item-cursor.c, src/item-debug.c,
	src/main.c, src/normal-args.c, src/number-match-test.c,
	src/number-match.c, src/parse-util.c, src/parser.y, src/pattern.h,
	src/preview-grid.c, src/print-cell.c, src/print-info.c, src/print.c,
	src/search.c, src/selection.c, src/sheet-autofill.c,
	src/sheet-merge.c, src/sheet-object-bonobo.c,
	src/sheet-object-container.c, src/sheet-object-graphic.c,
	src/sheet-object-item.c, src/sheet-object-widget.c,
	src/sheet-object.c, src/sheet.c, src/stf-parse.h, src/stf.c,
	src/style-color.c, src/style.c, src/test-format.c, src/value-sheet.c,
	src/value.c, src/widgets/gnumeric-dashed-canvas-line.h,
	src/widgets/gnumeric-hscrollbar.c, src/widgets/gnumeric-toolbar.c,
	src/widgets/gnumeric-vscrollbar.c,
	src/widgets/widget-editable-label.c,
	src/widgets/widget-font-selector.c, src/workbook-cmd-format.c,
	src/workbook-control.c, src/workbook-format-toolbar.c,
	src/workbook-object-toolbar.c, src/workbook-private.h,
	src/xml-io-autoft.c, src/xml-io.c:
	Replace mega-include <gnome.h> with something smaller.

2001-08-24  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-control-gui.c (scg_context_menu) : use the new artwork.

	* configure.in : bump version req for gnome-print to ensure that
	  we only see fontmap2.
	* README : ditto.
	* gnumeric.spec.in : ditto.

	* src/style.c (font_init) : Mention only the file fontmap2.

	* src/item-bar.c (item_bar_realize) : Don't attempt to use a gc from
	  an unrealized button.  Do it manually instead.

	* src/sheet-object.c (sheet_object_populate_menu) : Put Properties
	  above delete.

2001-08-23  Jody Goldberg <jgoldberg@home.com>

	* src/item-bar.c (item_bar_destroy) : remove debug msg.
	(item_bar_realize) : We need to use an existing widget to get style
	  information, use the select all button because it was the first
	  thing I thought of.

2001-08-23  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-graph.c (gnm_graph_clear_vectors_internal) : once we
	  clear the vectors be sure to also zero out the array.
	(gnm_graph_arrange_vectors) : CORBA does not like NULL.  Giveit some
	  zero length sequences.

	* src/commands.c (cmd_object_move) : init first_time.
	(cmd_object_move_destroy) : fix cut-n-paste-o.
	(cmd_object_move_redo) : do even less work.

2001-08-23  Jody Goldberg <jgoldberg@home.com>

	* idl/gnumeric-graphs.idl : reorganize to improve naming.
	  remove notion of header that was not working well.
	  remove freeze.
	  add arrangeVector.
	  add notion of selection for future uese.

	* src/gnumeric-graph.c (gnm_graph_vector_type_name) : add these.
	(MANAGER) : bump the idl version.
	(GnmGraphVector) : remove header, add id, adjust to new idl and use
	  vectors directly, rather than notifies.
	(gnm_graph_add_vector) : adjust to idl renaming.
	(gnm_graph_new) : improve error message.
	(gnm_graph_freeze) : delete.
	(gnm_graph_arrange_vectors) : new function.
	(gnm_graph_vector_seq_{scalar,date,string}) : headers are handled at a
	  higher level.
	(gnm_graph_vector_eval) : idl renaming.
	(impl_vector_selection_selected) : new.
	(gnm_graph_vector_corba_init) : split from gnm_graph_vector_new to
	  simpify cut-n-paste sharing with guppi.
	(gnm_graph_vector_corba_destroy) : Fix and split out to simplify
	  sharing.
	(gnm_graph_vector_destroy) : simplify and handle the case of a vector
	  being destroyed indepenently of the graph.
	(gnm_graph_vector_new) : handle headers at a higher level.
	(gnm_graph_vector_corba_class_init) : renamed from
	  corba_implementation_classes_init.

	* src/sheet-object-container.c (sheet_object_container_new_view) : Use
	  bonobo_client_site_new_view_full to disable the irrtiating frame
	  that causes the content to change size when the frme is activated
	  and deactivated.

2001-08-22  Zbigniew Chyla  <cyba@gnome.pl>

	Fixes #59334

	* src/workbook-view.c (wb_view_open_custom):
	Try opening only regular files.

2001-08-22  Almer S. Tigelaar  <almer@gnome.org>

	* src/workbook-control-gui.c (wbcg_edit_error_dialog) :
 	Dialog for displaying errors and giving the user a choice as
 	to what action to take.
 	(wbcg_edit_finish): Call wbcg_edit_error_dialog and take appropriate
 	action depending on the users choice.

2001-08-21  Morten Welinder  <terra@diku.dk>

	* src/style.c (style_font_unref) [AGGRESSIVE_CACHING]: Leave font
 	in cache.
	(style_font_new_simple): Rearrange ref-counting slightly for
 	clarity.

2001-08-21  Morten Welinder  <terra@diku.dk>

	* src/style.c (style_font_new_simple): Don't measure the font size
 	unless we just created the font.

2001-08-21  Zbigniew Chyla  <cyba@gnome.pl>

	* src/plugin-service.c
	(plugin_service_file_opener_read, plugin_service_file_saver_read):
	Get opener/saver description from translated content of <description>
	node inside <information> not from <information>'s attributes.
	(plugin_service_function_group_read):
	Get category name (both translated and untranslated) from <category>'s
	content, not from "name" attribute.

	* src/plugin.c
	(plugin_info_read):
	Get plugin name and description from translated content of <name> and
	<description> nodes inside <information>, not from <information>'s
	attributes.
	(plugin_loader_get_type_by_id, plugin_loader_is_available_by_id,
	plugin_db_activate_plugin_list, plugin_db_deactivate_plugin_list,
	plugin_db_get_plugin_info_by_plugin_id,
	plugin_db_update_saved_active_plugin_id_list):
	Removed unnecessary casts.

	* src/plugin-loader-module.c (gnumeric_plugin_loader_module_load,
	gnumeric_plugin_loader_module_unload): Put (possibly long) g_module
	error string in ErrorInfo details instead of appending it to our
	error message.

2001-08-20  Jody Goldberg <jgoldberg@home.com>

	* configure.in : post release bump

2001-08-20  Jody Goldberg <jgoldberg@home.com>

	* Release 0.70

2001-08-20  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-control-gui.c (scg_set_panes) : I do need to set the top &
	  left of the new panes when freezing.

2001-08-20  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-object.c (sheet_object_remove_cb) : All we need is a wbc.
	(sheet_object_anchor_set) : new routine to replace range_set.
	(sheet_object_anchor_get) : new.
	(sheet_object_anchor_cpy) : new.
	(sheet_object_anchor_init) : new routine to bundle up object
	  positioning more neatly.

	* src/sheet-object-cell-comment.c (cell_set_comment) : Only use anchor
	  types that are implemented.  Use the new SheetObjectAnchor scheme.

	* src/sheet-control-gui.c (scg_object_move) : track whether the ctrl
	  point causes a move or a resize.
	(cb_control_point_event) : store the initial anchor rather than the
	  control specific position,  and assume that the changes are simple
	  movements until a resize occurs.
	(scg_object_calc_position) : adjust to using SheetObjectAnchor.
	(scg_colrow_distance_get_virtual) : new routine.
	(scg_class_init) : register it here.

	* src/sheet-control.c (sc_colrow_distance_get) : a new new virtual.

	* src/gnumeric-canvas.c (gnm_canvas_key_mode_object) : delete newly
	  created objects too.
	(gnm_canvas_filenames_dropped) : signature change
	  for sheet_object_container_new_file.

	* src/gnumeric.h : add GnmGraph.

	* src/Makefile.am : rename graph-vector -> gnumeric-graph

	* idl/gnumeric-graphs.idl : Add some versioning.
	  Move the header arg out of the value callback.
	  Replace VectorNotify::remove with Manger::clearVectors.
	  Merge freeze & thaw.
	  Renamed 'nameChange' to 'headerChanged'
	  Add an 'id' arg when registering vectors.

2001-08-19  Jody Goldberg <jgoldberg@home.com>

	* src/commands.c
	    s/insert_object/object_insert/
	    s/move_object/object_move/
	    s/delete_object/object/delete/
	(cmd_object_insert_redo) : The object knows its position based on its
	  anchor. No need to set the control specific coordinates for an
	  arbitrary control.  No need to tweak the reference count either.
	(cmd_object_insert) :  ditto.
	(cmd_object_insert_undo) : no need to tweak the ref count.
	(cmd_object_delete_redo) : keep it simple, just set the sheet.
	(cmd_object_delete_undo) : just clear the sheet.
	(cmd_object_delete_destroy) : very simple.
	(cmd_object_move_redo) : store the anchor, not the position for a
	  specific control.  Be careful not to move the object the firs time
	  through.  We've already done that.
	(cmd_move_object_undo) : just call redo.
	(cmd_object_move) : store the old anchor and take a flag indicating
	  move vs resize.

	* src/workbook-control-gui.c (wb_control_gui_toplevel) : Add some
	  protection.

	* src/sheet-object.c (sheet_object_update_bounds) : rename from
	  sheet_object_position to have a clearer name.

	* src/embeddable-grid.c (embeddable_grid_init_anon) : init the sheet.
	(grid_view_new) : use scg_toplevel.

	* src/sheet-control-gui.c (scg_toplevel) : new function.

2001-08-18  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-graph.c : Major reorg to fix life cycle issues.
	(gnm_graph_new) : don't dangle the reference returned by oaf.
	(gnm_graph_destroy) : deactivate & _fini the corba obj.
	(gnm_graph_vector_destroy) : ditto.

	* src/expr.c (expr_to_graph_vector) : delete this function.
	  we have no need to disassemble the expression in graphs.

	* src/item-grid.c : revert switch from destroy -> finalize.
	* src/item-bar.c : ditto.

	* src/sheet-object-container.c : no need to include gnorba.
	  no need to include sheet-control-gui-priv anymore.
	(sheet_object_container_destroy) : delete unused.
	(sheet_object_container_new) : weaken requirements to take a workbook,
	  rather than a sheet as the container.
	(sheet_object_container_new_object) : ditto.
	(sheet_object_container_new_file) : ditto.

	* src/workbook-private.c : delete some unnecessary code.

	* src/workbook.c : include sheet-control vs sheet-control-gui.
	(workbook_expr_unrelocate) : it is ok to attempt to relocate to a
	  non-existent cell.

	* src/commands.c (cmd_paste_cut_undo) : restore the original content
	  AFTER unrelocating the expressions.

	* src/workbook-control-gui.c (workbook_control_gui_init) : Add the
	  magic to enable the bonobo toolbar config utility.
	(workbook_menu_edit) : Fix the accelerators and sync the text with the
	  bonobo version.
	(wbcg_menu_state_update) : Fix the capitalization for freeze/unfreeze.
	(change_menu_label) : Fix accelerator display, we still don't set
	  them, but at least we display them correctly.
	(insert_bonobo_object) : signature change to
	  sheet_object_container_new_object.

2001-08-17  Jody Goldberg <jgoldberg@home.com>

	* src/sheet.c (sheet_freeze_panes) : set the initial top_left position
	  based on the frozen pane when unfreezing.

	* src/sheet-control-gui.c (scg_set_panes) : prepare for h/v only splits.
	  Reformat.  Remove code to set the topleft after the panes are
	  created or removed.  That is handled by sheet.

	* src/GNOME_Gnumeric.xml : enable the font accelerators in the bonobo
	  build by making them standalone rather than associating them with
	  toolbuttons.  It appears as if bonobo does not support accelerators
	  for toolbuttons as yet.

2001-08-16  Zbigniew Chyla  <cyba@gnome.pl>

	* src/func.h (struct TokenizedHelp): Added help_is_localized field.

	* src/func.c (tokenized_help_new): Initialize it here.

	* src/dialogs/dialog-function-wizard.c (formula_guru_init_args):
	Use the default argument separator (comma) if the function's help is
	not localized.

2001-08-15  Jody Goldberg <jgoldberg@home.com>

	* src/GNOME_Gnumeric.xml : Use the new artwork from gtkhtml for
		- undo/redo
		- cut/copy/paste
	* src/workbook-control-gui.c : ditto.
	* src/application.c : ditto.

2001-08-15  Jody Goldberg <jgoldberg@home.com>

	* src/dialogs/dialog-about.c (dialog_about) : update.
	* AUTHORS : update.

2001-08-13    J.H.M. Dassen (Ray) <jdassen@debian.org>

	* configure.ac: Test whether _USE_BSD is needed for M_PI and caddr_t.
	Made --without-evolution work as intended by fixing two tests.

2001-08-14  Ariel Rios  <ariel@linuxppc.org>

	* src/main.c (main): Remove guile stuff. We no longer need
	to take over main and all guile init functions are now handle
	by the guile plugin itself.

2001-08-14  Lutz Mller <urc8@rz.uni-karlsruhe.de>

	* src/sheet-object-graphic.c (sheet_object_filled_user_config): Set
	the dialogs parent so that the dialog will get placed correctly. I did
	it already in sheet_object_graphic_user_config but forgot to add
	it here, too.

2001-08-14  Lutz Mller <urc8@rz.uni-karlsruhe.de>

	* src/print-cell.[c,h] (print_cell_range): Use a Range as parameter
	instead of four ints
	* src/print.c (print_titles), (print_sheet_objects), (print_page_cells),
	(print_page): Same here. In addition, adjust calls to these functions
	all over the place.

2001-08-14  Jody Goldberg <jgoldberg@home.com>

	* idl/Makefile.am : Use stamp files to make parallel compiles work.

2001-08-14  Lutz Mller <urc8@rz.uni-karlsruhe.de>

	* src/sheet-object-graphic.c: Let the user configure arrow shapes only
	if the object is an arrow. Update the color of the arrow in the preview.

2001-08-14  Lutz Mller <urc8@rz.uni-karlsruhe.de>

	* src/print.c (print_sheet_objects): gnome_print_gsave before we
	clip the SheetObjects' region.

2001-08-14  Lutz Mller <urc8@rz.uni-karlsruhe.de>

	* src/print.c: Remove all bonobo-related stuff.
	(print_sheet_objects): New. Prints all objects that overlap a given
	range and clips to that range.
	(print_page_cells): Call print_sheet_objects from here.
	(print_page_object): Removed.
	(print_page): Check for sheet objects if no printable cells can be
	found.
	(render_sheet_objects): Removed.
	* src/sheet-object-bonobo.c (sheet_object_bonobo_print): Move the
	bonobo printing stuff in here.
	* src/sheet-object-impl.h: The virtual method print now has only
	three arguments: The PrintContext and the base (x & y) where to
	start printing.
	* src/sheet-object.[c,h]: Adjusted to new syntax.
	* src/sheet-object-cell-commend.c (cell_comment_print): Same here.
	* src/sheet-object-graphic.c (sheet_object_graphic_print): And here.
	Fixed some broken logic. Printing of arrows implemented.
	(sheet_object_filled_print): Fixed.
	* src/sheet.c (sheet_col_get_distance_pts): Make sign double like in
	sheet_row_get_distance_pts. This didn't fix my problem but it is
	nicer this way (problem got fixed by Jody's fix below).

2001-08-14  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-object.c (cell_offset_calc_pt) : Fixcut-n-paste-o to fix
	  printing placement.

2001-08-14  Lutz Mller <urc8@rz.uni-karlsruhe.de>

	* src/sheet-object-cell-comment.c (cell_comment_print): Add a note that
	this function is left empty intentionally
	* src/sheet-object-graphic.c: Let the user configure the arrow shape

2001-08-14  Jody Goldberg <jgoldberg@home.com>

	* src/format-template.c (format_template_range_check) : fix typo.

	* src/xml-io.c (xml_sheet_read) : Add some sanity checking for bogus
	  inputs.

	* src/expr.c (expr_to_graph_vector) : new routine.

2001-08-14  Jody Goldberg <jgoldberg@home.com>

	* src/item-edit.c (item_edit_draw_text) : ignore leading newlines.
	(recalc_spans) : handle embedded newlines.

	* src/workbook-control-gui.c (wb_edit_key_pressed) : delete, and
	  move this logic from here.
	(workbook_setup_edit_area) : don't hook up wb_edit_key_pressed.
	  Use a GnumericExprEntry instead.

	* src/widgets/gnumeric-expr-entry.c (gnumeric_expr_entry_key_press_event) :
	  Move the magic embedded newline and Abs/Rel handling here.
	(gnumeric_expr_entry_new) : Take a wbcg.

2001-08-13  Morten Welinder  <terra@diku.dk>

	* src/mathfunc.c (gnumeric_sub_epsilon): New function.  Dual of
 	gnumeric_add_epsilon.
	(gnumeric_fake_ceil): Use gnumeric_sub_epsilon, not
 	gnumeric_add_epsilon.

2001-08-13  Lutz Mller <urc8@rz.uni-karlsruhe.de>

	* src/sheet.c (sheet_get_extent): Don't ignore the SheetObjects! They
	want to get printed even if all cells are empty.

2001-08-12  Jody Goldberg <jgoldberg@home.com>

	* src/formats.c (currency_symbols) : fix brazil and argentina.

2001-08-12  Jody Goldberg <jgoldberg@home.com>

	* configure.in : bump version.

2001-08-11  Jody Goldberg <jgoldberg@home.com>

	* Release 0.69

2001-08-11  Ariel Rios <ariel@linuxppc.org>

	* configure.in: Configure is now able to detect
        whether a recent version of guile is available
        to be able to build the guile plugin.

2001-08-11  Lutz Mller <urc8@rz.uni-karlsruhe.de>

	* src/sheet-object.c: Revert below removal of "Old crufty IO". In
	addition, fix a warning that I introduced yesterday (missing cast).

2001-08-11  Lutz Mller <urc8@rz.uni-karlsruhe.de>

	* src/sheet-object-graphic.c: Use GdkColors instead of strings.
	Implemented printing. Objects aren't in the right place though. Still
	needs some tuning. Configuration implemented (border width, outline
	color, fill color).
	* src/sheet-object-graphic.h: Be consistent, rename
	IS_SHEET_GRAPHIC_OBJECT -> IS_SHEET_OBJECT_GRAPHIC and
	IS_SHEET_FILLED_OBJECT -> IS_SHEET_OBJECT_FILLED
	* sheet-object.c: (sheet_object_read_xml): Remove "Old crufty IO"
	(quoted from code). Get and set the direction here instead of in
	sheet-object-graphic.
	* src/xml-io.[c,h]: Make xml_[get,set]_value_double and
	xml_[get,set]_value_color public.

2001-08-09  Jody Goldberg <jgoldberg@home.com>

	* src/format.c (format_get_decimal) : Fix a problem in locale's with
	  different numeric conventions for standard and monetary use (eg ru_RU)
	  we must use the same thing as strtod.

2001-08-08  Zbigniew Chyla  <cyba@gnome.pl>

	* src/commands.c (cmd_move_object):
	Use "Resize object" instead of "Move object" as command's description
	if the size of the object has changed.

2001-08-07  Zbigniew Chyla  <cyba@gnome.pl>

	Fixes #58648
	Added support for default importers (with specified priority)

	* file.[ch]
	(register_file_opener_as_importer_as_default,
	get_default_file_importer): New functions, added support for default
	importers (with specified priority).

	* gui-file.c (gui_file_import): Open the dialog with default importer
	selected.

	* plugin-service.h (struct _PluginServiceFileOpener):
	Added default_importer_priority field.

	* plugin-service.c (plugin_service_file_opener_read): If importer is
	enabled, read default_importer_priority attribute.
	(plugin_service_file_opener_initialize): Register as default importer if
	default_importer_priority is specified.

	* src/stf.c (stf_init): Register "Gnumeric_stf:stf_druid" as default
	file importer with priority 50.

2001-08-07  Jody Goldberg <jgoldberg@home.com>

	* src/item-cursor.c (item_cursor_draw) : When centering the cursor
	  with an even width tweak it to make things symetric.
	Some cosmetic formating and naming issues too.

2001-08-07  Lutz Mller <urc8@rz.uni-karlsruhe.de>

	* src/commands.c: (cmd_insert_object_redo): Do proper ref counting.
	* src/item-grid.c: (cb_obj_create_button_release): Hook up
	cmd_insert_object.
	* src/sheet-object.c: (sheet_object_remove_cb): Unref the sheet
	object.
	(sheet_object_set_sheet): Just return TRUE if (so->sheet == sheet)
	instead of printing a warning. This is because when command_push_undo
	is called, the redo function will be called although there is nothing
	to redo at this moment. We detect this through this function here.

2001-08-07  Lutz Mller <urc8@rz.uni-karlsruhe.de>

	* src/commands.[c,h]: (cmd_insert_object), (cmd_delete_object): New.
	cmd_insert_object is not hooked up yet.
	* src/sheet-control-gui.c: (cb_control_point_event): Pass the sheet
	object to cmd_move_object, that makes more sense than the so_view.
	* src/sheet-object.c: (sheet_object_remove_cb): Call cmd_delete_object
	instead of just gtk_object_destroy which can't be undone.
	(sheet_object_clear_sheet): If so->sheet == NULL, just return instead
	of printing a warning.

2001-08-07  Lutz Mller <urc8@rz.uni-karlsruhe.de>

	* src/commands.[c,h]: (cmd_move_object): New. Will also handle
	resizing of objects
	* src/sheet-control-gui-priv.h: Remember the initial_coords before
	moving or resizing an object
	* src/sheet-control-gui.c: (cb_control_point_event): When done with
	moving/resizing, call cmd_move_object so that we can undo this action
	later.

2001-08-06  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-autofill.c (autofill_compute_delta) : Make month/years
	  count forward and add some smarts to handle nice steps when days are
	  visible too.
	(autofill_cell) : ditto.

2001-08-06  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-canvas.c (gnumeric_canvas_new) : don't use different
	  canvas groups for objects and animated cursors.  That was confusing
	  things.

2001-08-04  Jody Goldberg <jgoldberg@home.com>

	* src/sheet.c (sheet_set_zoom_factor) : changing the zoom forces a
	  visibility computation.

2001-08-06  Jody Goldberg <jgoldberg@home.com>

	* src/item-cursor.c (item_cursor_point) : Disable selection if we are
	  invisible.

2001-08-06  Morten Welinder  <terra@diku.dk>

	* configure.in (psion): Improve psiconv test.

2001-08-06  Jody Goldberg <jgoldberg@home.com>

	* src/selection.c (walk_boundaries) : Check for merged regions while
	  walking, not just at the onset.

2001-08-03  Jody Goldberg <jgoldberg@home.com>

	* src/colrow.c (colrow_restore_sizes) : Use sheet_flag_recompute_spans.
	  to simplfy debugging.
	* src/sheet.c (sheet_set_zoom_factor) : ditto
	(sheet_{insert,delete}_{cols,rows}) : ditto.
	(sheet_move_range) : ditto.
	sheet_{col,row}_set_size_{pts,pixels} : ditto.

2001-07-19  Tim Mooney <mooney@dogbert.cc.ndsu.NoDak.edu>

	* configure.in: fix the GNUMERIC_HAVE_ALLOCA_H test to handle the
	new cache value used by autoconf 2.50+.

2001-08-02  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* configure.in: Use the new improved (functional) guile tests.

2001-08-02  Jody Goldberg <jgoldberg@home.com>

	* src/application.c (application_init) : Add search&replace icon from
	  evo.
	* src/workbook-control-gui.c (workbook_standard_toolbar_orient) : Use
	  it.

2001-08-01  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-autofill.c (autofill_compute_delta) : default to copy not
	  increment.

2001-07-31  Jody Goldberg <jgoldberg@home.com>

	* src/application.c (application_init) : add new icons from evolution.
	* src/workbook-control-gui.c (workbook_standard_toolbar_orient) : Use
	  them.

2001-07-30  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-pane.c (gnm_pane_rangesel_bound_set) : typo.

2001-07-30  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-canvas.c (gnm_canvas_key_mode_sheet) : Use the properly
	  localized formats.

2001-07-30  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-canvas.c (gnm_canvas_key_mode_sheet) : Use
	  workbook_cmd_mutate_borders.
	* src/workbook-cmd-format.c (workbook_cmd_mutate_borders) : moved
	  from gnumeric_canvas.

2001-07-30  Jody Goldberg <jgoldberg@home.com>

	* src/item-bar.c (item_bar_resize_stop) : renamed from
	  item_bar_end_resize to be consistent.

	* src/Makefile.am : rename gnumeric-sheet -> gnumeric-canvas

2001-07-30  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-control.c (sc_wbc) : new.
	(sc_sheet) : const.
	(sc_update_cursor_pos) : delete.

	* src/gnumeric-pane.c (gnm_pane_special_cursor_bound_set) : new.
	(gnm_pane_special_cursor_start) : ditto.
	(gnm_pane_special_cursor_start) : ditto.

	* src/sheet-control-gui.c (scg_update_cursor_pos)  : fold into
	  scg_resize.
	(scg_resize) : reposition all of the cursors.
	(scg_edit_start) renamed from scg_create_editor.
	(scg_edit_stop) : renamed from scg_stop_editing.
	(scg_special_cursor_start) : new.
	(scg_special_cursor_stop) : new.
	(scg_special_cursor_bound_set) : new.

	* src/item-cursor.c (item_cursor_selection_event) : Use
	  scg_special_cursor_start, and scg_special_cursor_bound_set.
	(item_cursor_do_action) : use scg_special_cursor_stop.
	(item_cursor_do_drop) : ditto.
	(item_cursor_autofill_event) : ditto.
	(item_cursor_set_bounds_visibly) : Doh! fix my stupidity.
	  We need to change the visibility here because we explicitly disable
	  doing it in the scroll handlers.  We are constraining the scroll
	  so we need to do it manually.

2001-07-30  Jody Goldberg <jgoldberg@home.com>

	s/GnumericSheet/GnumericCanvas/
	s/gsheet/gcanvas/
	s/gnumeric_sheet_*/gnm_canvas_/
	s/gnumeric_pane_*/gnm_pane_/
	Move the std and rangesel cursors from GnumericSheet -> GnumericPane
	Move the grid and editor from GnumericSheet -> GnumericPane

2001-07-28  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-sheet.c (gnumeric_sheet_handle_motion) : fix autoscroll
	  from bottom/right panes into adjcant regions that do not scroll as
	  reported by almer.

2001-07-28  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-sheet.c (gnumeric_sheet_handle_motion) : work towards
	  support h only or v only freezes by using the geometry of pane 1 or 3
	  in place of pane 2 which only exists in the h&v case.
	(gsheet_sliding_callback) : ditto.
	(gnumeric_sheet_slide_init: ditto.

2001-07-28  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-pane.c (gnumeric_pane_colrow_resize_start) :
	  Switch GnumericSheet to using CellPos for consisency.
	* src/gnumeric-sheet.c (gnumeric_sheet_key_mode_sheet) : ditto.
	(gnumeric_sheet_button_release) : ditto.
	(gnumeric_sheet_init) : ditto.
	(gnumeric_sheet_find_col) : ditto.
	(gnumeric_sheet_find_row) : ditto.
	(gnumeric_sheet_create_editor) : ditto.
	(gsheet_compute_visible_region) : ditto.
	(gnumeric_sheet_redraw_region) : ditto.
	(gsheet_sliding_callback): ditto.
	(gnumeric_sheet_handle_motion) : ditto.
	(gnumeric_sheet_slide_init) : ditto.
	* src/item-bar.c (item_bar_draw) : ditto.
	(item_bar_event) : ditto.
	* src/item-cursor.c (item_cursor_update) : ditto.
	(item_cursor_draw) : ditto.
	* src/item-edit.c (recalc_spans) : ditto.
	(item_edit_set_arg) : ditto.
	* src/sheet-control-gui.c (scg_redraw_headers) : ditto.
	(scg_resize) : ditto.
	(scg_scrollbar_config) : ditto.
	(scg_colrow_select) : ditto.
	(gnumeric_sheet_update_inital_top_left) : ditto.
	(bar_set_left_col) : ditto.
	(bar_set_top_row) : ditto.
	(gnumeric_sheet_set_left_col) : ditto.
	(gnumeric_sheet_set_top_row) : ditto.
	(gnumeric_sheet_set_top_left) : ditto.
	(gnumeric_sheet_make_cell_visible) : ditto.
	(scg_set_panes) : ditto.
	(cb_slide_handler) : ditto.
	* src/workbook-control-gui.c (cb_view_freeze_panes) : ditto.

2001-07-24  Jody Goldberg <jgoldberg@home.com>

	* plugins/Makefile.am (SUBDIRS) : Add psion plugin from
	Frodo Looijaard <frodol@dds.nl>

2001-07-27  Morten Welinder  <terra@diku.dk>

	* src/rangefunc.c (range_min_k, range_min_k_nonconst): New
 	function.

	* src/analysis-tools.c (kth_largest, kth_smallest): Use
 	range_min_k_nonconst.

	* src/analysis-tools.c (summary_statistics): Constify data.

	* src/rangefunc.c (range_median_inter): Respect const.
	(range_median_inter_nonconst): New version.

	* src/rangefunc.c, src/rangefunc.h: new files, contents taken from
 	mathfunc.c among other places.

2001-07-27   Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/analysis-tools.c (correlation_tool) Rewrite to use standard
	  range_* functions.
	(covariance_tool) ditto
	(descriptive_stat_tool) Extract code into multi-use support functions.
	(summary_statistics) ditto
	(confidence_level) ditto
	(kth_largest) : ditto
	(kth_smallest) : ditto
	(sampling_tool) : Create real random samples.
	and various support functions.

	* src/dialog/dialog-analysis-tools.c (dialog_correlation_tool) Display
	error dialog.
	(dialog_covariance_tool) ditto
	(dialog_descriptive_stat_tool) Use dao->labels_flag instead of labels_flag.

	* src/dialogs/tools.h (descriptive_stat_tool) Remove labels_flag.

2001-07-27  Almer S. Tigelaar  <almer@gnome.org>

	* src/workbook-control-gui.c (hide_show_detail): helper which
	implements the actual meat of the show/hide operations.
	(cb_data_hide_detail): Implement using hide_show_detail.
	(cb_data_show_detail): Idem.

2001-07-26  Jody Goldberg <jgoldberg@home.com>

	* src/sheet.c (sheet_init_sc) : Don't allow positioning during the
	  initialization sequence of a control to overwrite requested top_left.

	* src/sheet-control-gui.c (gnumeric_sheet_update_inital_top_left) :
	  new function.
	(gnumeric_sheet_set_left_col) : used here.
	(gnumeric_sheet_set_top_row) : used here.
	(gnumeric_sheet_set_top_left) : used here.

2001-07-26  Almer S. Tigelaar  <almer@gnome.org>

	* src/stf.c (stf_read_workbook): Set the format on all lines.

	* src/sheet-control-gui.c (scg_colrow_select): Avoid loss of
	an invalid expression.

	* src/workbook-control-gui.c (wbcg_close_control): Avoid loss of
	any entered text.

2001-07-26  Almer S. Tigelaar  <almer@gnome.org>

	* src/workbook-control-gui.c (cb_notebook_switch_page):
	Accept input and flip page in one step (don't require two clicks).

2001-07-25  Morten Welinder  <terra@diku.dk>

	* src/analysis-tools.c (summary_statistics): Cleanup a bit.  Fix
 	the min, max, and range items.  Avoid most casts.

2001-07-25  Almer S. Tigelaar  <almer@gnome.org>

 	* src/gnumeric-sheet.c (gnumeric_sheet_key_mode_sheet): Add
 	C-Insert, S-Insert and S-Delete shortcuts for cutting, pasting
 	and copying.

2001-07-25  Almer S. Tigelaar  <almer@gnome.org>

 	* src/workbook-control-gui.c (cb_notebook_switch_page): If we are
 	still editing and the expression is invalid, don't switch pages, but
 	insist the user correct it first.

2001-07-18   Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/analysis-tools.c (set_cell) : Catch NULL string pointer.
	(get_data_grouped_by_cols) : new routine to read data from cell range.
	(get_data_grouped_by_rows) : ditto
	(get_text_col) : ditto
	(get_text_row) : ditto
	(kurt) : removed, use range_kurtosis_m3_est instead.
	(skew) : removed, use range_skew_est instead.
	(summary_statistics) : rewritten to use range_*, to use correct data
	  labels and to check for errors.
	(confidence_level) : ditto
	(kth_largest) : ditto
	(kth_smallest) : ditto
	(range_min_k) : new function to find kth smallest number (rather than
	  the code twice)
	(descriptive_stat_tool) : rewritten to use correct data labels and to
	  use above modified functions.

	* src/analysis-tools.h (range_min_k) : new prototype

	* src/dialogs/dialog-analysis-tools.c : include selection.h
	(dialog_descriptive_stat_tool) :  preload descriptive statistics input
	  range and add checkbox to specify row labels

	* src/dialogs/tools.h (descriptive_stat_tool) : add labels_flag

2001-07-18  Jody Goldberg <jgoldberg@home.com>

	* configure.in : AC_DEFINE ENABLE_EVOLUTION if it is available.

2001-07-20  Lutz Mller  <urc8@rz.uni-karlsruhe.de>

	* src/sheet-object-impl.h: Add the view as parameter to the virtual
	method set_active.
	* src/sheet-object-container.c:
	(sheet_object_container_set_active): New. Overrides above virtual and
	handles (de)activation of view frames.
	* src/sheet-control-gui-priv.h: Do not let the SheetControlGUI know
	about an active_object_frame - remove this variable.
	* src/sheet-control-gui.[c,h]:
	(scg_activate_view_frame),
	(scg_deactivate_view_frame): Removed. Now handled by the objects
	themselves through set_active virtual method.
	(scg_object_stop_editing),
	(scg_mode_edit_object): Adjust parameters for virtual method set_active.

2001-07-18  Zbigniew Chyla  <cyba@gnome.pl>

	* src/dialogs/dialog-function-wizard.c (formula_guru_init_args): Use
	locale dependent argument separator.

	* src/func.h (function_get_category,
	function_get_category_with_translation): Renamed args.

	* src/func.c
	(function_category_compare): Don't use g_strcasecmp, it's broken.
	(function_get_category): Use function_get_category_with_translation.
	(function_get_category_with_translation): Some code moved from
	function_get_category, keep categories sorted by display_name, store
	internal_name in "normalized" form (converted to lowercase).

2001-07-18  Jody Goldberg <jgoldberg@home.com>

	* configure.in : post release version bump.

	* src/xml-io-autoft.c (xml_write_format_template_members) : remove
	  warnings.

2001-07-17  Jody Goldberg <jgoldberg@home.com>

	* Release 0.68

2001-07-17  Jody Goldberg <jgoldberg@home.com>

	* configure.in : Only enable evo support if someone explicitly
	  requests it.

	* src/gui-clipboard.c (x_selection_handler) : Make things friendlier
	  with Klipper.

	* src/workbook-control-gui.c (wbcg_sheet_move) : Fix.
	  SheetControl no longer inherits from Table it now contains it.

	* src/sheet-control-gui.c (cb_sheet_object_view_destroy) : rename from
	  cb_sheet_object_destroy.

	* src/sheet-object.c (cb_sheet_object_configure) : Use
	  sheet_object_view_obj and sheet_object_view_control.
	(sheet_object_view_destroyed) : remove the sheetcontrol key from the
	  view when it is destroyed.  And remove our reference to the control.
	(sheet_object_new_view) : give the view a ref of the control.

	* src/item-grid.c (item_grid_draw) : only draw bound lines at pane
	  bounds.

	* src/item-bar.c (item_bar_event) : dont draw the resize bar past the
	  minimum size.

2001-07-15  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/analysis-tools.c (descriptive_stat_tool) : adjust
	  scrollbars after outputting data.
	(sampling_tool) : ditto
	(ztest_tool) : ditto
	(random_tool) : ditto
	(regression_tool) : ditto
	(average_tool) : ditto
	(ranking_tool) : ditto
	(anova_single_factor_tool) : ditto
	(anova_two_factor_without_r_tool) : ditto
	(anova_two_factor_with_r_tool) : ditto
	(histogram_tool) : ditto

2001-07-16  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-object-graphic.c (sheet_object_graphic_write_xml) : use cstr.
	(sheet_object_filled_write_xml) : ditto.

	* src/xml-io-autoft.c (xml_write_format_template_members) : remove
	  extra copying to and fro.

	* src/xml-io.c (xml_set_value_string) : delete this bogosity.
	(xml_write_solver) : Use xmlSetProp in its place.
	(xml_set_value_double) : remove the searchiing silliness.
	(xml_read_sheet_layout) : new function.
	(xml_sheet_read) : called from here.
	(xml_write_sheet_layout) : new function.
	(xml_sheet_write) : called from here.

2001-07-16  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-sheet.c (gsheet_compute_visible_region) : add a
	  comment.
	(gnumeric_sheet_button_release) : Fix scroll wheel handling.
	  And make the scroll by 1/4 of a page rather than a full page.

	* src/workbook-control-gui.c (cb_sheet_label_button_press) : while
	  selecting a range all buttons switch pages.
	(cb_view_freeze_panes) : Improve handling of border cases.

	* src/sheet-control-gui.c (scg_set_top_left) : new function.
	(scg_class_init) : tied in here.
	(scg_scrollbar_config) : Some usability tuning.

	* src/sheet.c (sheet_new) : init 'initial_top_left'
	(sheet_set_initial_top_left) : new function.
	(sheet_init_sc) : Set the initial top left.
	(sheet_update_cursor_pos) : delete unnecessary.
	(sheet_update_only_grid) : It is only called from here.  And even this
	  seems questionable.
	(sheet_find_boundary_{vertical,horizontal}) : adds more comments.

	* src/sheet-control.c (sc_set_top_left) : new function.

2001-07-17  Zbigniew Chyla  <cyba@gnome.pl>

	* src/commands.c (cmd_format): Marked string for translation.

2001-07-16  Morten Welinder  <terra@diku.dk>

	* src/stf-parse.c (stf_parse_csv_line): Don't reverse the fields
 	in case there are too many.
	(stf_parse_fixed_line): Ditto.
	(stf_parse_general): Plug leak.

2001-07-16  Zbigniew Chyla  <cyba@gnome.pl>

	* src/file.c (gnum_file_saver_save_to_stream_real):
	Don't mmap the file, use read() instead.

2001-07-16  Almer S. Tigelaar  <almer@gnome.org>

	* src/stf-parse.c (stf_parse_csv_line): Use g_list_append and
	g_list_reverse.
	(stf_parse_fixed_line): Idem.
	(stf_parse_general): Idem.

 	* src/item-cursor.c (item_cursor_selection_event): Fix horizontal
	double-click filling and add extra bound check for vertical
	double-click filling.

2001-07-16  Zbigniew Chyla  <cyba@gnome.pl>

	* src/file-priv.h
	(struct _GnumFileSaver): Removed save_to_stream_func member.
	(gnum_file_saver_setup): Removed save_to_stream_func argument.

	* src/file.h
	(gnum_file_saver_new): Removed save_to_stream_func argument.
	(gnum_file_saver_supports_save_to_stream): Removed.

	* src/file.c
	(gnum_file_saver_save_to_stream_real):
	New implementation, uses temporary file and gnum_file_saver_save.
	(gnum_file_saver_setup): Removed save_to_stream_func argument.
	(gnum_file_saver_new): Removed save_to_stream_func argument.
	(gnum_file_saver_supports_save_to_stream): Removed.

	* src/gui-file.c
	(ask_for_file_saver): Show all file savers in format chooser.

	* src/bonobo-io.c (gnumeric_bonobo_io_init),
	src/plugin-service.c (gnum_plugin_file_saver_new),
	src/stf.c (stf_init):
	Adjusted to file.h change (removed save_to_stream_func argument).

	* src/xml-io.c
	(gnumeric_xml_write_workbook_to_stream): Removed.
	(xml_init): Adjusted to file.h change.

2001-07-16  Almer S. Tigelaar  <almer@gnome.org>

	* stf-parse.c (stf_parse_general): Fix leakage.

2001-07-15  Zbigniew Chyla  <cyba@gnome.pl>

	* src/gnumeric-util.c (gnumeric_create_popup_menu): Fixed problem with
	keyboard navigation in popup menus ("empty" items not skipped). Now
	such items are insensitive.

2001-07-15  Zbigniew Chyla  <cyba@gnome.pl>

	* src/workbook-control-gui.c: Added comment above send_menu_item and
	send_menu_item_i18n strings about keeping them in sync.

2001-07-15  Kjartan Maraas  <kmaraas@gnome.org>

	* configure.in: Added "nn" to ALL_LINGUAS.

2001-07-15  Almer S. Tigelaar  <almer@gnome.org>

	* stf.c (stf_read_workbook): Honor lines to parse.

	* gui-clipboard.c (x_selection_to_cell_region): Idem.

	* stf-parse.c (stf_parse_options_set_lines_to_parse): Don't
	convert to index it's not an index.

2001-07-15  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	* src/analysis-tools.c (anova_two_factor_with_r_tool): Finish
 	implementation.

2001-07-15  Zbigniew Chyla  <cyba@gnome.pl>

	* src/workbook-control-gui.c:
	(send_menu_item): Defined static string instead of SEND_MENU_ITEM macro
	to avoid backslashes, added _tip property.
	(send_menu_item_i18n): Array of strings from send_menu_item intended for
	localization (i18n tools can't extract strings from XML inside .c file).
	(workbook_control_gui_init): Adjusted.

2001-07-15  Jody Goldberg <jgoldberg@home.com>

	* src/sheet.c (sheet_freeze_panes) : Avoid double calling set_panes.

2001-07-15  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-control-gui.c (scg_resize) : Adust to change in semantics
	  and name from sheet::frozen::bottom_right ->
	                sheet::unfrozen_top_left.
	(scg_scrollbar_config) : ditto.
	(scg_set_left_col) : ditto.
	(scg_set_top_row) : ditto.
	(scg_make_cell_visible) : ditto.
	(scg_set_panes) : ditto.
	* src/sheet.c (sheet_new) : ditto.
	(sheet_update_only_grid) : ditto.
	(sheet_freeze_panes) : ditto.
	(sheet_is_frozen) : ditto.

	* src/sheet-merge.c (sheet_merge_add) : don't regen the spans until
	  after the merge is listed.

2001-07-14  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-sheet.c (gnumeric_sheet_handle_motion) : support
	  reverse scroll for things that started the drag adjacent.  That is
	  about as clear as mud, see the deleted BUG entry.
	(gsheet_sliding_callback) : ditto.

2001-07-14  Zbigniew Chyla  <cyba@gnome.pl>

	* src/error-info.[ch]
	(error_info_new_vprintf): New.
	(error_info_new_printf): Use error_info_new_vprintf.
	(error_info_peek_message): Constified.

	* src/command-context-priv.h (struct CommandContextClass): Added
	error.error_info virtual.

	* src/command-context.[ch] (gnumeric_error_error_info): New.

	* src/io-context.[ch]
	(gnumeric_io_error_system, gnumeric_io_error_read,
	gnumeric_io_error_save): Use gnumeric_io_error_string.
	(gnumeric_io_error_string): New.
	(gnumeric_io_error_display): Renamed from
	gnumeric_io_error_info_display. Use CommandContext's virtual -
	gnumeric_error_error_info.
	(gnumeric_io_error_info_clear, gnumeric_io_has_error_info): Removed.
	s/gnumeric_io_clear_error/gnumeric_io_error_clear
	s/gnumeric_io_error_info_push/gnumeric_io_error_push/
	s/gnumeric_io_error_info_pop/gnumeric_io_error_pop/

	* src/gnumeric-util.c
	(ctree_insert_error_info): Automatically expand most nodes (don't expand
	nodes with siblings).
	(gnumeric_error_info_dialog_show_full): Renamed from
	gnumeric_error_info_dialog_show. Display only a tree with error
	details. Don't hardcode ctree column width, make ctree look nicer (no
	lines, triangles as icons).
	(gnumeric_error_info_dialog_show): New function, displays only main part
	of the error and (optionally) "Show details" button. Use standard
	gnome_message_box.

	* src/plugin-util.c (gnumeric_fopen_error_info,
	gnumeric_mmap_error_info): Use error_info_new_from_errno.
	(gnumeric_open_error_info): Use error_info_new_from_errno,
	added missing *ret_error.

	* src/workbook-control-gui.c (wbcg_error_error_info): New
	(implementation of CommandContext's virtual).
	(workbook_control_gui_ctor_class): Use it here.

	* src/workbook-view.c (wb_view_save_as, wb_view_save,
	wb_view_open_custom): Don't use removed gnumeric_io_has_error_info.

2001-07-14  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-sheet.c (gnumeric_sheet_handle_motion) : adjust
	  signature to take an enum instead of 4 booleans.  Add a flag to
	  allow the caller to handle motion within the visible pane.
	(gsheet_sliding_callback) : more tuning for reverse motion in unfrozen
	  panes.

	* src/item-bar.c (item_bar_event) : convert to new
	  gnumeric_sheet_handle_motion signature.
	* src/item-grid.c (item_grid_event) : ditto.
	* src/item-cursor.c (item_cursor_handle_motion) : ditto.
	* src/sheet-control-gui.c (cb_control_point_event) : ditto.
	  Handle object motion within visible region locally.

2001-07-14  Jody Goldberg <jgoldberg@home.com>

	* src/sheet.c (sheet_init_sc) : set the panes.

	* src/sheet-control.c (sc_init_state) : delete unused.

	* src/sheet-control-gui.c (scg_make_cell_visible) : when landing in a
	  partially frozen pane (1 or 3) if the panes are coupled move the
	  other pane too.
	(scg_set_panes) : Only use herioc measures if panes are changing, not
	  when initializing.
	(sheet_control_gui_new) : construct before attaching.
	(horizontal_scroll_offset_changed) : don't clear wbcg msg text if we
	  are't connected yet.
	(vertical_scroll_offset_changed) : ditto.
	(scg_scrollbar_config) :  no need to clear here.  We are already doing
	  it in the adjustment handlers.

	* src/gnumeric-sheet.c (gsheet_sliding_callback) : simplify and
	  improve feel at bounds when scrolling in reverse.  Also remove debug
	  spewage.

2001-07-13  Jody Goldberg <jgoldberg@home.com>

	* src/item-cursor.c (item_cursor_set_bounds_visibly) : no need to make
	  anything visible here.  We already did that in the autoscroller.

	* src/gnumeric-sheet.c (gnumeric_sheet_key_mode_sheet) : no need to
	  force a scroll.

2001-07-13  Jody Goldberg <jgoldberg@home.com>

	* src/item-cursor.c (item_cursor_in_drag_handle) : bounding coords
	  mark the outside of the drag box, center things before checking.
	(item_cursor_selection_event) : be smarter about handling double
	  clicks.  This could still be improved see comment.

	* src/sheet.c (sheet_cell_calc_span) : clear existing span before
	  recalculating it.
	(sheet_cell_set_text) : clear existing spans for expressions.
	(sheet_cell_set_expr): ditto.

	* src/cellspan.c (cellspan_is_empty) : rename from cell_is_empty
	  and change order of args to make it clear that the Cell in the cell
	  in that arg list is _not_ the one being tested for emptiness.  Do
	  the empty chacek manually because expressions with initial value
	  'empty' are allowing other cells to continue spanning into them.
	  However, since the expressions don't calc spans yet, the cell
	  content is never made visibible.

	* src/sheet-control-gui.c (scg_resize) : increase the size of the
	  header canvases by 1.  I don't especially like the like, but I have
	  no time to track down why the canvas scrolls by 1 pixel if I don't
	  do this.
	(cb_control_point_event) : partially fix sheet object movement.

	* src/gnumeric-sheet.c (gnumeric_sheet_slide_stop) : renamed from
	  gnumeric_sheet_stop_sliding.
	(col_scroll_step) : new function.
	(row_scroll_step) : new function.
	(gsheet_sliding_callback) : rewrite again to manage scrolling for
	  panes more smoothly.  Still needs work.
	(gnumeric_sheet_handle_motion) : handle motin into adjacent panes
	  here.
	(gnumeric_sheet_slide_init) : new routine to set adjacency earlier in
	  process.

	* src/item-bar.c (item_bar_event) : call gnumeric_sheet_slide_init.
	* src/item-cursor.c (item_cursor_selection_event) : ditto.
	(item_cursor_drag_event) : ditto.
	* src/item-grid.c (item_grid_button_1) : ditto.

2001-07-12  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-pane.c (gnumeric_pane_header_init) : no need to
	  calc_size here.  That will be done when the item is realized.

	* src/sheet-control-gui.c (scg_set_left_col) : And bounds checks and
	  safety.
	(scg_set_top_row) : ditto.

	* src/item-cursor.c (item_cursor_draw) : Add a simple test for pane
	  support when placing the drag handle.

2001-07-13  Morten Welinder  <terra@diku.dk>

	* src/eval.c (dependent_unqueue_sheet): Unconstify since it
 	changes things.
	(dependent_unlink_sheet): Ditto.
	(dep_slist_filter_sheet): Return the right list.

2001-07-13  Lutz Mller <urc8@rz.uni-karlsruhe.de>

        * src/sheet-control-gui.[c,h]: Clean up the handling of bonobo objects
        by introducing
	(scg_activate_view_frame) and
        (scg_deactivate_view_frame).
	* src/sheet-object-bonobo.[c,h]: Check for existence of interfaces
	before querying it. Fix ref-counting. Make functions
	(sheet_object_bonobo_load_persist_file),
	(sheet_object_bonobo_load_persist_stream), and
	(sheet_object_bonobo_load_stream) consistent.
	* src/sheet-object-container.c: Parent class is and has ever been
	SheetObjectBonobo. This file should be called
	sheet-object-bonobo-container... Fix ref-counting.
	(cb_user_activation_request): Activate the view frame and set edit mode
	(cb_view_activated): Removed
	(sheet_object_container_new_view): Let the canvas item remember the
	view frame (through gtk_object_set_data)
	* src/sheet-object-container.h: Rename IS_SHEET_CONTAINER_OBJECT to
	IS_SHEET_OBJECT_CONTAINER to be consistent. Remove view_frame
	variable - this object can produce many view frames.

2001-07-13  Morten Welinder  <terra@diku.dk>

	* src/analysis-tools.c (ttest_eq_var_tool): Fixed for pooled
 	variance from Prof. Dr. Andreas J. Guelzow.

2001-07-12  Morten Welinder  <terra@diku.dk>

	* src/mathfunc.c (range_multinomial): New function.

	* configure.in (evolution): Fix check, but see BUGS.

2001-07-12  Almer S. Tigelaar  <almer@gnome.org>

	* src/gnumeric-pane.c (gnumeric_pane_set_bounds): Kill warning.

2001-07-11  Jody Goldberg <jgoldberg@home.com>

	* src/item-grid.c (item_grid_draw) : Draw bound lines for panes.

	* src/gnumeric-pane.c (gnumeric_pane_set_bounds) : new function.

2001-07-10  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-control-gui.c (scg_resize) : Federico wins a dinner for
	  pointing out the source of the bug with frozen panes starting
	  somewhere other than 0,0.  It seems that scroll_regions are more
	  powerful than I thought.
	(scg_init) : the slider handling is elsewhere.
	(bar_set_top_row) : remove debug spewage.
	(scg_stop_sliding) : move to gnumeric_sheet.
	(scg_sliding_callback) : ditto.
	(scg_start_sliding) : ditto.
	(cb_slide_handler) : signature change for slide callbacks.
	(cb_control_point_event) : changes for panes.

	* src/item-grid.c (cb_extend_cell_range) : signature change for slide
	  callbacks.
	(cb_extend_expr_range) : ditto.
	(item_grid_event) : use gnumeric_sheet_handle_motion.
	(item_grid_finalize) : switch over from destroy.
	(item_grid_class_init) : add bound args.
	(item_grid_set_arg) : ditto.
	(item_grid_draw) : begin using the bound arg.
	(item_grid_init) : init the bound arg to fullsheet.
	(item_grid_realize) : Add an extra GC for drawing the bounding lines.
	(item_grid_unrealize) : release the new GC.

	* src/item-cursor.c (cb_move_cursor) : signature change for slide
	  callbacks.
	(cb_autofill_scroll) : ditto.
	(item_cursor_handle_motion) : use gnumeric_sheet_handle_motion.

	* src/item-bar.c (item_bar_draw) : remove debug spewage.
	(cb_extend_selection) : signature change for slide callbacks.
	(item_bar_event) : use gnumeric_sheet_handle_motion and simplify the
	  code alot.

	* src/gnumeric-sheet.c (gnumeric_sheet_init) : init the sliding members.
	  The sliding used to be managed by the scg, but it is now handled
	  with the gsheet (could just as easily be gpane) becuase scrolling
	  panes needs to know _which_ pane is scrolling.
	(gsheet_compute_visible_region) : remove the debug spewage.
	(gnumeric_sheet_stop_sliding) : moved from scg_stop_sliding.
	(gsheet_sliding_callback) : moved from scg_sliding_callback and
	  revamped to support frozen panes.
	(gnumeric_sheet_handle_motion) : new routine to merge in the old
	  scg_start_sliding and add a pile of replicated code from all the
	  different users of the sliding mechanism.
	(gnumeric_sheet_new) : take max col/row as arg.

	* src/gnumeric-pane.c (canvas_bar_adjustment_changed) : delete debug routine.
	(gnumeric_pane_header_init) : no need for adjust_size handler.

2001-07-10  Jody Goldberg <jgoldberg@home.com>

	* idl/Makefile.am : improve evo handling.

	* configure.in : Fix definition of ENABLE_EVOLUTION in makefiles.

2001-07-09  Jody Goldberg <jgoldberg@home.com>

	* src/item-bar.c (item_bar_event) : clip the minimum col/row size at
	  the margins.

	* src/sheet.c (colrow_compute_pts_from_pixels) : add some sanity
	  checking.

	* src/gnumeric-sheet.c (gnumeric_sheet_handle_motion) : new function.
	  begin the process of getting enough information to scroll
	  effectively with frozen panes.  Also merge alot of similar code.

	* src/item-bar.c (item_bar_event) : Use gnumeric_sheet_handle_motion.
	* src/item-cursor.c (item_cursor_handle_motion) : ditto.
	* src/sheet-control-gui.c (cb_slide_handler) : ditto.

2001-07-11  Zbigniew Chyla  <cyba@gnome.pl>

	* src/workbook-control-gui.c (wbcg_menu_state_update): Fixed path for
	"_Freeze Panes" menu item.

2001-07-11  Almer S. Tigelaar  <almer@gnome.org>

	* src/parser.y : Add error ID's.
	(gnumeric_parse_error): Accept ID and set ID on error struct.

	* src/parse-util.[ch]
	(parse_error_init): Initialize the error id.

	* src/workbook-edit.c (wbcg_edit_finish): When there's a missing
	closing paren, try appending one and see if it helps.

	* src/stf.c (stf_preparse): New, default preparsing of a file.
	(stf_read_workbook): Use stf_preparse.
	(stf_read_default_probe): Prober for reading.
	(stf_read_workbook_csv_default): New, read a csv file in default formatting.
	(stf_init): Register stf_read_workbook_csv_default.

2001-07-10  Lutz Mller <urc8@rz.uni-karlsruhe.de>

	* src/workbook-control-gui.c: Add a menu item "Send" to the file menu.
	If this one is clicked, pop up an Evolution-Composer with current
	workbook attached.
	* src/file-priv.h: New virtual function for GnumFileSaver:
	save_to_stream.
	Introduce GnumFileSaverSaveToStreamFunc. Keep a mime type.
	* src/file.[c,h]: Implement save_to_stream and mime_type detection.
	* src/gui-file.[c,h]: Reduce copy & paste by introducing
	(make_format_chooser) and (check_multiple_sheet_support_if_needed).
	New function: (gui_file_save_to_stream) which asks for the desired
	mime type.
	* src/bonobo-io.c: This file saver doesn't support save_to_stream.
	* src/stf.c: This one either.
	* src/xml-io.[c,h]: Implement save_to_stream.
	* src/plugin-service.c: Pass NULL for save_to_stream.

2001-07-09  Lutz Mller <urc8@rz.uni-karlsruhe.de>

	* acconfig.h: #undef ENABLE_EVOLUTION
	* configure.in: Checks for Evolution-Composer.idl. Can be overwritten
	with --without-evolution.
	* idl/Makefile.am: Let orbit process the Evolution-Composer.idl.
	* idl/.cvsignore: Ignore the generated Evolution* files.

2001-07-09  Almer S. Tigelaar  <almer@gnome.org>

	* stf-parse.c (stf_parse_convert_to_unix): Make this work as it
	is supposed to.
	(stf_parse_csv_line): Remove deprecated comment.

2001-07-09  Jody Goldberg <jgoldberg@home.com>

	* src/gnumeric-pane.c (canvas_bar_realized) : moved from scg.
	(canvas_bar_adjustment_changed) : ditto.
	(gnumeric_pane_header_init) : ditto.
	(gnumeric_pane_init) : ditto.
	(gnumeric_pane_release) : ditto.
	(gnumeric_pane_colrow_resize_end) : new function.
	(gnumeric_pane_colrow_resize_start) : ditto.
	(gnumeric_pane_colrow_resize_move) : ditto.

	* src/colrow.c (colrow_set_visibility) : toggling visibility moves
	  objects and panes.
	(colrow_save_sizes) : Use sheet_colrow_get_info.

	* src/item-bar.c : s/destroy/finalize/
	s/item_bar/ib/ for internal routines and vars.
	Some renaming to clean things up
	Move the struct decl into .c nothing should be looking at the
	  implementation.
	(item_bar_init) : remove unused 'FirstElement' arg.
	(item_bar_set_arg) : remove unused arg and fix typo.
	(item_bar_event) : use resize guide support routines in scg
	  instead of handling it ourselves.
	(resize_bar_init) : delete, and move concept to gnumeric-pane.
	(item_bar_start_resize) : move content to gnumeric-pane.
	(item_bar_end_resize) : move content to gnumeric-pane.

	* src/sheet-control-gui.c (scg_set_top_row) : pane support.
	(scg_set_left_col) : ditto.
	(scg_colrow_resize_end) : new function.
	(scg_colrow_resize_start) : ditto.
	(scg_colrow_resize_move) : ditto.

2001-07-08  Lutz Mller <urc8@rz.uni-karlsruhe.de>

	* src/GNOME_Gnumeric.xml: Wrap file related menus into a placeholder
	named FileOperations. Wrap print related menus into a a placeholder
	named PrintOperations. This will help components like EOG to put
	menu entries into the right place when activated.

2001-07-06  Jody Goldberg <jgoldberg@home.com>

	* src/item-cursor.c (item_cursor_update) : go one past the last
	  visible in case the last visible == the last full.

	* src/item-bar.c (item_bar_end_resize) : fix typo.

	* src/sheet.c (sheet_update_only_grid) : force a resize after col/row
	  resizes with frozen panes.

2001-07-07  Almer S. Tigelaar  <almer@gnome.org>

	* src/preview-grid.[ch] (marshal_POINTER__INT_INT): New, custom marshaller.
	(pg_get_row_height): Get default row height by emitting signal.
	(pg_get_col_width): Idem for column width.
	(pg_get_style): Idem for style.
	(pg_construct_cell): Idem for value.
	(preview_grid_init): Provide sensible defaults.
	(preview_grid_set_arg): Remove callback related arguments.
	(preview_grid_class_init): Idem and create all newly added signals.

2001-07-06  Yukihiro Nakai  <nakai@gnome.gr.jp>

	* src/gnumeric-sheet.c (gnumeric_sheet_realize) : Over-the-Spot
	  style support for XIM.

2001-07-05  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-control-gui.c (scg_make_cell_visible) : simplify.  There
	  is no need to scroll all panes if the target is already visible in
	  one of them.  Just keep things in sync.  This does suggest a ui
	  enhancement thou.  Jump to boundaries (ctrl-arrow) should be smart
	  about panes.
	(scg_set_panes) : pre-scroll things to their minimum.

2001-07-05  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-control.c (sc_resize) : add a force_scroll argument.

	* src/sheet-control-gui.c (scg_scrollbar_config) : handle panes.
	(scg_resize) : Add a force_scroll argument.
	  reset all of the offsets.
	  Keep the col/row heades for pane[0] and toss those on pane[1,3]
	(scg_set_zoom_factor) : support panes without headers.
	(scg_scrollbar_config) : pane support.
	(scg_set_left_col) : quicky stub.
	(scg_set_top_row) : quicky stub.
	(gnumeric_pane_init) : rename from gnumeric_pane_new for consistency.
	  either add both or neither header.
	(gnumeric_pane_free) : rename from gnumeric_pane_delete.
	(scg_set_panes) : only panes 0 and 2 need headers no need to attach
	 the headers for panes 1 & 3.
	 force a full scroll when setting up the panes.
	(scg_adjust_preferences) : no need to worry about panes.

2001-07-05  Rodrigo Moya <rodrigo@gnome-db.org>

	* configure.in: use libgda >= 0.2.11 for the GDA plugin

	* README: added comments about libgda version requirements

2001-07-05  Morten Welinder  <terra@diku.dk>

	* configure.in (finite): Also check in -lm.

2001-07-05  Almer S. Tigelaar  <almer@gnome.org>

	* gnumeric-sheet.c (gnumeric_sheet_key_mode_sheet): Fix backspace.

2001-07-04  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-merge.c (sheet_merge_add) : Use sheet_redraw_range.

	* src/sheet-control.c (sc_set_panes) : new virtual.
	(sc_set_sheet) : renamed from sc_invalidate_sheet.

	* src/sheet-control-gui.c (scg_primary_pane) : new function. Be very
	  careful when using this.  It should not be necessary in most cases.
	(scg_get_wbcg) : convenience routine.
	(scg_redraw_all) : frozen panes.
	(scg_redraw_region) : renamed from scg_redraw_cell_region, and frozen
	  pane support.
	(scg_redraw_headers) : merge in the code from gnumeric-sheet.
	(scg_update_cursor_pos) : pane support.
	(scg_resize) : ditto.
	(scg_set_zoom_factor) : ditto.  Broken. needs to resize the panes.
	(scg_scrollbar_config) : adjust to panes.
	(scg_make_edit_pos_visible) : use scg_make_cell_visible.
	(scg_colrow_select) : reorg a bit.
	(vertical_scroll_offset_changed) : adjust to panes.
	(horizontal_scroll_offset_changed) : ditto.
	(cb_table_destroy) : ditto.
	(scg_init) : init the top here.
	(bar_set_left_col) : from gnumeric-sheet. Still needs work for panes.
	(bar_set_top_row) : ditto.
	(gnumeric_sheet_set_left_col) : ditto.
	(gnumeric_sheet_set_top_row) : ditto.
	(scg_set_left_col) : TODO.
	(scg_set_top_row) : ditto.
	(gnumeric_sheet_set_top_left) : new function split from.
	(gnumeric_sheet_make_cell_visible) : here.
	(scg_make_cell_visible) : adjsut to panes and do the real work here.
	(scg_make_cell_visible_virt : wrapper for use as virtual.
	(gnumeric_pane_new) : new function.
	(gnumeric_pane_delete) : ditto.
	(scg_set_panes) : ditto.
	(scg_construct) : move the table attachments around and move the
	  canvas groups into the panes.
	(sheet_control_gui_new) : beef this up.
	(scg_unant) : adjust to panes.
	(scg_ant) : ditto.
	(scg_cursor_visible) : ditto.
	(scg_cursor_bound) : ditto.
	(scg_adjust_preferences) : ditto.
	(scg_compute_visible_region) : ditto.
	(scg_create_editor) : ditto.
	(scg_stop_editing) : ditto.
	(scg_take_focus) : ditto.
	(scg_sliding_callback) : adjust top panes, but is still much too
	  stupid.
	(scg_start_sliding) : ditto.
	(cb_slide_handler) : ditto.
	(cb_control_point_event) : ditto.
	(new_control_point) : ditto.
	(set_item_x_y) : ditto.
	(set_acetate_coords) : ditto.
	(scg_object_calc_position) : ditto.
	(scg_object_view_position) : ditto.
	(scg_rangesel_changed) : ditto.
	(scg_rangesel_start) : ditto.
	(scg_rangesel_stop) : ditto.
	(scg_rangesel_move) : ditto.
	(scg_rangesel_extend) : ditto.

	* src/item-grid.c (sheet_object_begin_creation) : Use the group
	  associated with the gsheet, not the scg, and use GNUMERIC_IS_SHEET
	  in preference to != NULL.

	* src/item-bar.c : Store the gnumeric-sheet rather than the scg so
	  that we can get to the Pane.

	* src/embeddable-grid.c (grid_view_activate) : Use scg_take_focus.
	(grid_view_new) : Use sheet_control_gui_new in place of sheet_new_scg.

	* convert to E_MAKE_TYPE
	* Use IS_SHEET in preference to sheet != NULL
	* sheet_range_calc_spans signature change

	* src/clipboard.c (clipboard_paste_region) : special handling when
	  pasting into a selection that consists of a single merged cell.

	* src/application.c (application_set_selected_sheet) : Use IS_SHEET.
	(application_clipboard_copy) : ditto.
	(application_clipboard_cut) : ditto.

	* src/Makefile.am :
	    command-context-corba -> workbook-control-corba

	* src/sheet.c : convert to using IS_SHEET in place of sheet != NULL in
	  several places.
	(sheet_is_frozen) : new function.
	(sheet_freeze_panes) : implement.
	(sheet_new) : init frozen pane data.
	(sheet_range_calc_spans) : pass a pointer rather than copy of the range.
	  and use sheet_redraw_range.
	(sheet_apply_style) : use sheet_redraw_range.
	(cb_sheet_get_extent) : premature optimization is evil.
	(sheet_redraw_region) : rename from sheet_redraw_cell_region.
	(sheet_set_edit_pos) : use sheet_redraw_range.
	(sheet_move_range) : ditto.
	(sheet_init_sc) : new routine.
	(sheet_attach_control) : rename and task from sheet_new_scg.
	(sheet_redraw_region) : renamed from sheet_redraw_cell_region.

	* src/item-cursor.c (item_cursor_update) : increase the spacing for
	  the autohandle.

	* src/GNOME_Gnumeric.xml :
	  - Use Control*colon and Control*semicolon
	  - desensitize the graph guru for now.
	  - Add freeze/thaw

	* src/item-bar.c (item_bar_unrealize) : no need to double unref the
	  fonts.

	* src/print-cell.c (print_merged_range) : This is not being drawn on
	  the screen, no need for all the fancy calcs to only draw the visible
	  bits.  We will just clip it.
	* src/print-cell.c (print_cell) : Use the calulated width, not the col
	  width for splitting.

	* src/gnumeric-sheet.c (gnumeric_sheet_key_mode_sheet) : Use the scg_
	  versions of things in preference to the gnumeric_sheet_ versions.
	(gnumeric_sheet_new) : Store the Pane that this is associated with.
	(gnumeric_sheet_bar_set_top_row) : moved to sheet-control-gui.c
	(gnumeric_sheet_set_top_row) : ditto.
	(gnumeric_sheet_bar_set_left_col) : ditto.
	(gnumeric_sheet_set_left_col) : ditto.
	(gnumeric_sheet_make_cell_visible) : ditto.
	(gsheet_compute_visible_region) : handle panes.

2001-06-28  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-object-container.c : include sheet.h

2001-06-29  Jody Goldberg <jgoldberg@home.com>

	* src/sheet-control-gui.c (cb_table_destroy) : unref the control so
	  that it is removed from the sheets lists and cleaned up.

	* gnumeric.desktop.in : restore missing content.

2001-06-28  Jody Goldberg <jgoldberg@home.com>

	* Makefile.am : Add missing old changelog (doh!)

	* configure.in : post release version bump.

2001-06-28  Jody Goldberg <jgoldberg@home>

	* Release 0.67

2001-06-28  Jody Goldberg <jgoldberg@home.com>

	* Makefile.am  : Install .desktop file not .in

	* src/formats.c : Add comments re: order assumptions.

	* src/workbook-control-gui.c (workbook_standard_toolbar_orient) :
	  disable initial frozen pane support for release.

	* src/workbook-control-gui.c (sort_by_rows) : fix old bug with sort
	  tool buttons.

	* src/stf-export.c (stf_export_sheet) : ignore spans and merges.

	* src/ranges.c (range_clip_to_finite) : add comment re: expense.

	* src/print.c (print_sheet) : Include spans and merges when printing.
	(compute_sheet_pages) : ditto.

	* src/gnumeric-sheet.c (gnumeric_sheet_key_mode_sheet) : spans are not
	  relevant here.

2001-06-28  Jody Goldberg <jgoldberg@home.com>

	* configure.in : bump libxml1 req to 1.8.14 to fix i18n xml import
	  broken with the switch to the progress monitor.
	* gnumeric.spec.in : ditto.

	* src/Makefile.am : Restore files that were not distributed due the
	  differences in bonobo build.

2001-06-27  John Gotts <jgotts@linuxsavvy.com>

	* gnumeric.spec.in : resynch with 0.66.

2001-06-27  John Gotts <jgotts@linuxsavvy.com>

	* gnumeric.spec.in : minor updates.

2001-06-27  Jody Goldberg <jgoldberg@home.com>

	* configure.in : bump version to 0.67.
