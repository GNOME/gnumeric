2004-09-29  Jody Goldberg <jody@gnome.org>

	* src/commands.c (cmd_object_move) : extend to handle insertion too.

	* src/gnumeric-pane.c (cb_control_point_event) : Play fast and lose
	  with the undo records when duplicating an object by ctrl-click.
	  Assign the object the sheet as soon as we duplicate it but do not
	  list the undo until we record the resize on button release.

	* src/workbook-view.c (gnm_mailto_url_show) : fix.

	* src/session.c : suppress warning in the --without-gnome case

	* src/sheet-control-gui.c (scg_set_current_object) : new. uses the
	  handy dandy unrealized signal on a SheetObject.  With code split from
	(scg_object_stop_editing) : here.
	(scg_mode_edit_object) : and here.
	* src/gnumeric-pane.c (cb_control_point_event) : so that we could use
	  it here.

2004-09-28  Jody Goldberg <jody@gnome.org>

	* src/sheet-control-gui.c (scg_mode_edit_object) :  fall back to edit
	  mode if the object is unrealized.

	* src/sheet-object.c (sheet_object_clear_sheet.) : merge some of the
	  nice features from finalize
	(sheet_object_finalize) : use sheet_object_clear_sheet.
	* src/sheet.c (sheet_destroy) : ditto.

	* src/gnumeric-pane.c (cb_control_point_event) : Make the copy
	  operation undo-able.

2004-09-28  Morten Welinder  <terra@gnome.org>

	* configure.in: Add check for pango_context_set_matrix.  We're
	going to need that for rotated text.

2004-09-28  Jody Goldberg <jody@gnome.org>

	* src/commands.c (cmd_object_raise_redo) : Don't use MAXINT/MININT it
	  causes trouble becaue -MININT is not expressable

2004-09-28  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=153871
	* src/gnm-so-filled.c (cb_filled_update_bounds) : line width counts
	  when sizing.

	* src/commands.c (cmd_object_delete) : Take an optional descriptor
	  string.  All callers changed.

	* src/application.c (gnm_app_clipboard_cut_copy_obj) : Use
	  cmd_object_delete for cuts to get undo.

	* src/sheet-object.c (sheet_objects_relocate) : properly clear the
	  sheet before we unref an object.
	(sheet_objects_get) : use range_contained.
	(sheet_objects_clear) : ditto.  This simplifies undo/redo.

2004-09-27  Jody Goldberg <jody@gnome.org>

	* src/application.c (gnm_app_clipboard_cut_copy_obj) : translate the
	  anchor back to a pseudo origin to make pasting easier.

	* src/clipboard.c (clipboard_paste_region) : handle paste contents
	  with only objects.  No need to do tiling or to clear things.

	* src/gutils.c (gnm_ptr_array_insert) : Make this smarter.
	  Just append if the requested element is >= len

	* src/item-grid.c (item_grid_event) : only auto-slide when we're
	  outside.  Inside we handle it locally fixes artificial movement that
	  seems to jump back to the start of the previous row/col

	* src/gnumeric-pane.c (cb_control_point_event) : Store the button that
	  initiated the object drag and check that when releasing.

	* src/commands.c (cmd_paste_copy) : handle pasting objects with no
	  content.

	* src/gutils.h : Fix the name spacing to be gnm_ in all cases.
	  gnumeric_ is too damn big, and we have not business using g_
	* src/gutils.c (gnm_usr_dir) : Check for empty home_dir

	* src/graph.c (gnm_go_data_vector_load_len) : handle missing
	  expression

	* src/gnm-so-filled.c (gnm_so_filled_read_xml_dom) : We still need to
	  Type field even though it is ugly.

	* src/xml-io.c (xml_cellregion_write) : cut-n-paste-o to fix
	  inter-process pasting
	(xml_cellregion_read) : Actually store the resulting objects
	(xml_read_sheet_object) : Don't set the sheet when extracting a
	  cellregion.

2004-09-27  Morten Welinder  <terra@gnome.org>

	* src/workbook-view.c (wb_view_sendto): Bring !WITH_GNOME case a
	lot closer to sanity.  Properly handle case where mkdir fails.
	(gnm_mailto_url_show): New function factored out from
	wb_view_sendto.

2004-09-27  Jody Goldberg <jody@gnome.org>

	* configure.in : drop the test for caddr_t we do not need it and it
	  does not work win32.
	  Export the epoch, major, minor version elements

	* src/workbook-view.c (wb_view_sendto) : a win32 portability patch for
	  mkdir.

2004-09-26  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (gnumeric_xml_write_workbook) : respect the xml
	  compression preference a bit.  It's still uncompressed, or
	  compressed.  We'll need to patch gsf to be able to tune that
	  parameter.

2004-09-26  Jody Goldberg <jody@gnome.org>

	* src/workbook-view.c (wb_view_sendto) : encode the right portion of
	  the url.

2004-09-26  Jody Goldberg <jody@gnome.org>

	* src/workbook-view.c (wb_view_sendto) : cleanup and use the new url
	  encoding routine.

2004-09-26  Jody Goldberg <jody@gnome.org>

	* src/GNOME_Gnumeric-gtk.xml : Add InsertCurrentDateTime

	* src/wbcg-actions.c (cb_insert_current_date_time) : new

	* src/format.c (style_format_default_date_time) : new return
	  concatination of default date and time formats

2004-09-26  Jody Goldberg <jody@gnome.org>

	* src/workbook-view.c (wbv_save_to_uri) : renamed from wbv_save_to_file
	  to clarify that it does not work for a simple path.
	(wb_view_sendto) : fix to use a uri.

2004-09-26  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-pane.c (cb_sheet_object_canvas_event) : Use the pane in
	  GnmCanvas rather than adding one to GnmSimpleCanvas

2004-09-26  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-pane.c (gnm_pane_object_move) :  handle symetric
	  movement via ctrl-click and object duplicate via ctrl-click on
	  acetate

	* src/gnumeric-pane.c (build_so_menu) : new
	(display_object_menu) : create a GtkMenu based on the actions.

	* src/sheet-object.c (sheet_object_populate_menu) : Rework the
	  interface to return action descririptors rather than a GtkMenu
	  Change all implementations

2004-09-26  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (xml_cellregion_read) : read objects
	(xml_cellregion_write) : write them too

2004-09-25  Jody Goldberg <jody@gnome.org>

	* src/wbcg-actions.c (cb_edit_copy) : Use
	  gnm_app_clipboard_cut_copy_obj for objects
	(cb_edit_cut) : ditto.

	* src/sheet-object.c (sheet_object_populate_menu) : put the stacking
	  items into a sub menu.

2004-09-24  Jody Goldberg <jody@gnome.org>

	* src/clipboard.c (paste_object) : new.
	(clipboard_paste_region) : use it.
	(cb_dup_objects) : new.
	(clipboard_copy_range) : dup the objects in the range.
	(cellregion_new) : init the object list
	(cellregion_unref) : free the object list

	* src/sheet-object.c (sheet_object_dup) : make public, and tweak
	  interface.
	(sheet_object_clone_sheet) : adjust to the interface change.

2004-09-24  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-image.c (sheet_object_image_copy) : implement

	* src/wbcg-actions.c : update the actions to handle the new drawing
	  object types.

	* src/sheet-object.c (sheet_object_clone) : Change the interface to
	  have the wrapper create the object.  Then s/clone/copy/ and have it
	  just do the assignament rather, not allocation.
	* src/sheet-object*.c : s/clone/copy/ with related semantic changes

	* src/rendered-value.c (rendered_value_render) : trivial
	  constification

	* src/main-application.c (main) : Use bonobo_main WITH_GNOME just in
	  case.

	* src/gnumeric-pane.c (gnm_pane_object_register) : Change return type
	  to GObject.  There's no need to be more specific.
	(gnm_pane_widget_register) : ditto.

	* src/gnm-so-filled.c : Rewrite of the old SheetObjectGraphic
	  to use GogStyle, merge text into the base, and use GObject properties
	* src/gnm-so-line.c : Rewrite of the old SheetObjectFilled
	  to use GogStyle  and use GObject properties

	* src/Makefile.am : Adjust to the file changes for
	  sheet-object-graphic.c

2004-09-13  Stepan Kasal  <kasal@ucw.cz>

	* configure.in (GCONF_SCHEMAS_INSTALL): AM_CONDITIONAL has to be
	  called in all branches.

2004-09-24  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (xml_read_sheet_object) : add hooks to the old names
	  for GnmSOFilled, and GnmSOLine

2004-09-23  Jody Goldberg <jody@gnome.org>

	* src/commands.c (cmd_object_format) : undo redo for the new line and
	  filled objects.

2004-09-23  Jody Goldberg <jody@gnome.org>

	* configure.in (GNUMERIC_PLUGIN_LDFLAGS) : new macro to give the win32
	  folk a hook for the plugins.
	* plugins/*/Makefile.am : Use it
	* plugins/*/plugin.xml.in : Remove the .la for module names.  Core of
	  glib adds just before checking platform specific names.

2004-09-23  Jody Goldberg <jody@gnome.org>

	* src/wbcg-actions.c (cb_view_zoom_out) : in and out were reversed
	(cb_view_zoom_in) : ditto

2004-09-24  Morten Welinder  <terra@gnome.org>

	* src/print-cell.c (print_cell): New wrapper function.  Turn on
	new printing by default.

	* src/gui-util.c (entry_to_int): Plug leak.
	(entry_to_float_with_format): Plug leak.

2004-09-23  Morten Welinder  <terra@gnome.org>

	* src/gui-util.c (cb_activate_default): New function to avoid
	endless recursion.
	(gnumeric_editable_enters): Activate via cb_activate_default.

	* src/rendered-value.c (rendered_value_recontext): Don't require
	Pango 1.6, but use it if we have it.

2004-09-23  Morten Welinder  <terra@gnome.org>

	* src/rendered-value.c (rendered_value_recontext): Force
	wrap==FALSE when the source layout has only one line.
	(Mostly fixes #152265)

	* src/rendered-value.h (struct _RenderedValue): switch
	layout_natural_width and layout_natural_height be in terms of
	pango units.  All users changed.

	* src/cell-draw.c (cell_calc_layout): Switch srguments width,
	height, h_center, res_x, and res_y to be in terms of pango units.
	Ditto for internal variables rect_x, rect_y, hoffset, indent, and
	text_base.  All callers changed.

2004-09-23  Morten Welinder  <terra@gnome.org>

	* src/rendered-value.c (rendered_value_remeasure): New function.
	(rendered_value_new): Use rendered_value_remeasure.
	(rendered_value_recontext): New function.

	* src/cell-draw.c (cell_calc_layout): Use
	rendered_value_remeasure.

	* src/print-cell.c (print_cell_NEW): Use rendered_value_recontext.

2004-09-22  Morten Welinder  <terra@gnome.org>

	* src/colrow.c (cb_clear_variable_width_content): Force a redraw.

	* src/cell-draw.c (cell_calc_layout): Drop rect argument.  Replace
	printing argument by y_direction argument.  Drop x1 and y1
	arguments.  Callers changed.
	(cell_calc_layout): Insert zero_width_space characters in the
	right spot.

	* src/print-cell.c (print_cell_NEW): Use size_pts.

2004-09-22  Morten Welinder  <terra@gnome.org>

	* src/print-cell.c (print_merged_range, print_cell): Take extra
	  PangoContext argument.  All callers changed.
	(print_cell_range): Create a pango context.

	(print_cell_OLD): Renamed from print_cell.
	(print_cell_NEW): New function.
	(print_cell): New macro to call _OLD or _NEW as appropriate.

	* src/rendered-value.c (rendered_value_new): Get rid of quantify
	  artifacts.

2004-09-22  Morten Welinder  <terra@gnome.org>

	* src/cell-draw.c (cell_draw): Get rid of quantify artefacts.
	(cell_calc_layout): Add rv and printing arguments, drop res_layout
	argument.  Make extern.  Caller changed.

2004-09-21  Morten Welinder  <terra@gnome.org>

	* src/print.c (print_hf_element): Print using pango layouts when
	possible.  Code adapted from bug #152939, kzamir@walla.co.il.

2004-09-16  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (cb_clear_rendered_cells) : fix the 'Serious Error'
	  warnings on zoom changes.

	* src/workbook-control-gui.c (wbcg_create_status_area) : drop some
	  frames in the status area and use GtkStatusbar to get the resize grip

	http://bugzilla.gnome.org/show_bug.cgi?id=152636
	* src/style.c (style_font_new_simple) : sizes in pts should not
	  include the zoom scaling, pretend that we actually measure that.

	http://bugzilla.gnome.org/show_bug.cgi?id=152244
	* src/sheet-object.c (cell_offset_calc_pixel) : return double to avoid
	  problems when we are at integer-epsilon, which would round to
	  integer-1 and systematicly lose precision.
	* src/sheet-control-gui.c (scg_object_view_position) : Use
	  foo_canvas_window_to_world instead of foo_canvas_w2c to move the
	  pixels back into canvas space.

	http://bugzilla.gnome.org/show_bug.cgi?id=152512
	* src/gnumeric-pane.c (control_point_set_cursor) : new.
	(cb_control_point_event) : use it.
	(new_control_point) : no longer a  need to specify the cursor
	(set_item_x_y) : ditto.
	(gnm_pane_object_set_bounds) : cursor are dynamic now.
	(set_acetate_coords) : ditto.

2004-09-14  Morten Welinder  <terra@gnome.org>

	* src/sheet-object-image.c (soi_get_image_fmt): g_free is a poor
	substitute for g_slist_free.

2004-09-10  Jody Goldberg <jody@gnome.org>

	* src/commands.c (cmd_colrow_hide_correct_selection) : disable because
	  it irritates me.

	* src/wbcg-actions.c : Add ctrl-9, ctrl-shift-9 (hide,unhide rows)
	Add ctrl-0, ctrl-shift-0 (hide,unhide cols)

	* src/wbc-gtk.c (cb_add_menus_toolbars) : toggle std toolbar should be
	  ctrl-7

2004-09-10  Morten Welinder  <terra@gnome.org>

	* src/workbook.c (workbook_new): Generate a proper URI here.

2004-09-09  Jody Goldberg <jody@gnome.org>

	* configure.in : Post release bump

2004-09-08  Jody Goldberg <jody@gnome.org>

	* Release 1.3.90

2004-09-08  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (wbcg_toggle_visibility) : remember
	  whether to keep a toolbar when in fullscreen mode.
	(cb_visibility) : simplify.

	* src/wbcg-actions.c (cb_view_fullscreen) : new.
	(cb_help_irc) : throw something together.

	* src/wbc-gtk.c (wbc_gtk_create_status_area) : hide statusbar by
	  default in fullscreen mode.
	(cb_add_menus_toolbars) : hide toolbars by default in fullscreen mode.
	(cb_toolbar_activate) : simplify.
	(cb_handlebox_visible) : ditto.
	(cb_toggle_visibility) : new.
	(cb_wbcg_window_state_event) : handle fullscreen transitions.
	(wbc_gtk_init) : init the window_state_event handler.

2004-09-08  Jody Goldberg <jody@gnome.org>

	* src/stf.c (csv_tsv_probe) : accept files < 80 characters long

2004-09-08  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/wbcg-actions.c: Correct Z-Test menu item description and 
	  title. We do not allow large sample calculations.

2004-09-07  Jody Goldberg <jody@gnome.org>

	* src/pixmaps/Makefile.am : Move to the splash for 1.4

2004-09-07  Jon K Hellan  <hellan@acm.org>

	* src/gui-util.[hc] (gnumeric_notice, gnumeric_notice,
	gnumeric_dialog_run, gnumeric_error_info_dialog_show): Replace
	WorkboookControlGUI first paremeter with GtkWindow.

	* src/gui-file.c (go_file_is_writable, gui_get_image_save_info,
	check_multiple_sheet_support_if_needed, do_save_as,
	gui_file_save_as): Use updated gui-utils

	* src/item-cursor.c (item_cursor_target_region_ok): Ditto

	* src/print.c (sheet_print): Ditto.

	* src/session.c (interaction_function): Ditto.

	* src/wbcg-actions.c (cb_edit_search_replace_query): Ditto.

	* src/workbook-control-gui.c (wbcg_error_error) Ditto.
	(wbcg_close_if_user_permits): 

2004-09-06  Jody Goldberg <jody@gnome.org>

	* configure.in : Add a --disable-ssconvert for development.
	  Constantly linking gnumeric and ssconvert is irritating, but we do
	  want ssconvert enabled for releases.

2004-09-06  Jody Goldberg <jody@gnome.org>

	* src/GNOME_Gnumeric-gtk.xml : Update to reflect some input from ui
	  review
	* src/wbcg-actions.c (actions) : ditto
	  s/Search/Find/
	  s/Search and Replace/Replace/

2004-09-02  Stepan Kasal  <kasal@ucw.cz>

	* configure.in (gnumeric_with_gnome): Fix typo.

2004-09-05  Jon K Hellan  <hellan@acm.org>

	* configure.in (GConf): Fix typo.

2004-09-04  Jon K Hellan  <hellan@acm.org>

	* src/wbc-gtk.c (wbc_gtk_init_undo_redo): Update action group of
	Repeat.

	* src/sheet-object-graphic.c (sheet_object_text_get_property,
	sheet_object_text_class_init): Add "label" property.

2004-09-03  Jody Goldberg <jody@gnome.org>

	* configure.in : expand the --with-gtk tests and make --with-gnome
	  conditional on --with-gtk

2004-09-02  Stepan Kasal  <kasal@ucw.cz>

	* configure.in: start implementing --with-gui via the WITH_GTK
	  conditional.  Check also for pango, which is required even if no GUI
	  is used.  We use gtk+-2.0 >= 2.4.0 which requires pango >= 1.4.0; so
	  we ask pango >= 1.4.0 too.
	* configure.in: Implement --disable-solver option, --enable-plugins hack.
	* src/Makefile.am: Conditionalize solver, start using WITH_GTK.
	* plugins/Makefile.am: compile the mps plugin only if ENABLE_SOLVER
	  is set; --enable-plugins can override the plugin list.
	* src/solver.h: Don't declare anything if not !ENABLE_SOLVER; supply
	  a few stub macros instead.
	* src/wbcg-actions.c: Conditionalize on ENABLE_SOLVER.
	* src/xml-io.c (xml_read_solver, xml_write_solver): Likewise.

2004-07-31  Stepan Kasal  <kasal@ucw.cz>

	* configure.in: Gnomish autogen.sh uses ACLOCAL_FLAGS, if some of the
	  macros are in nonstandard places.  If you touch configure.in then,
	  aclocal.m4 is regenerated, but without ACLOCAL_FLAGS.  This change
	  ensures that ACLOCAL_FLAGS is propagated to the Makefile.
	* Makefile.am: ACLOCAL_AMFLAGS = @ACLOCAL_FLAGS@

	* src/ssconvert.c: s/exporter/importer/

2004-08-31  Morten Welinder  <terra@gnome.org>

	* src/wbc-gtk.c (cb_chain_sensitivity): Renamed from
	cb_set_repeat_sensitivity and changed to take action directly.
	Caller changed.

2004-08-31  Jon K Hellan  <hellan@acm.org>

	* src/sheet-object-graphic.c (sheet_object_polygon_class_init):
	Initialize sheet_object_class.

2004-08-30  Jon K Hellan  <hellan@acm.org>

	* src/commands.c (cmd_merge_cells_repeat): Shut up warning.

	* src/gui-file.c (gui_wb_view_show): Remove bogus return.

2004-08-30  Morten Welinder  <terra@gnome.org>

	* src/workbook-control-gui.c (wbcg_finalize): Destroy
	visibility_widgets.
	(wbcg_toggle_visibility): New function.
	(wbcg_copy_toolbar_visibility): Reinstate.
	(workbook_control_gui_init): Initialize visibility_widgets.

	* src/wbcg-actions.c (GNM_ACTION_DEF): Use new
	wbcg_toggle_visibility.

	* src/wbc-gtk.c (wbc_gtk_create_status_area): Add status bar to
	visibility widgets.
	(cb_toolbar_activate): Simplify.
	(cb_add_menus_toolbars): Add toolbars to visibility widgets.
	(wbc_gtk_set_toggle_action_state): Also look in toolbar actions.
	Ick -- this gets uglier by the day.

	* src/workbook-control-gui-priv.h (struct WorkbookControlGUI):
	Replace statusbar member by visibility_widgets.

2004-08-29  Jody Goldberg <jody@gnome.org>

	* configure.in :  post release bump to .90 to indicate transition to
	  beta status.

2004-08-29  Jody Goldberg <jody@gnome.org>

	* Release 1.3.2

2004-08-29   Emmanuel Pacaud <emmanuel.pacaud@univ-poitiers.fr>

	* src/item-bar.c (item_bar_draw): Fix group lines in row/column
	headers.

2004-08-28  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (sheet_new_with_type) : Renamed from sheet_new_special,
	  that name was not terribly clear.

2004-08-28  Jody Goldberg <jody@gnome.org>

	* src/pixmaps/Makefile.am : Add halign-fill and halign-general
	* src/application.c (gnumeric_application_setup_icons) : ditto

2004-08-28  Jody Goldberg <jody@gnome.org>

	* src/commands.c (cmd_merge_cells) : optionally center the merged
	  region
	* src/wbcg-actions.c (cb_merge_and_center) : new

2004-08-28  Jody Goldberg <jody@gnome.org>

	* src/GNOME_Gnumeric-gtk.xml : Reorder Delete menu to put Col before
	  Row to be consistent with the other menus

2004-08-28  Jody Goldberg <jody@gnome.org>

	* src/wbcg-actions.c (cb_view_zoom_in) : new
	(cb_view_zoom_out) : new

2004-08-28  Jody Goldberg <jody@gnome.org>

	* src/wbcg-actions.c : Add ctrl +/- as accelerators for ins/del cells

2004-08-27  Jody Goldberg <jody@gnome.org>

	* src/plugin-service.c (plugin_service_file_opener_read_xml) :
	  simplify parsing of 'file_pattern' for importer filename probing.
	  All we every really needed was suffix matching.  None of the power
	  of fnmatch or optional case sensitivity was every used.
	(gnm_plugin_file_opener_probe) : use a nice simple suffix match.

2004-08-27  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-graphic.c :  convert markup to a property for
	  SheetObjectText

	* src/sheet-object-cell-comment.c : Add a property 'markup' to be used
	  eventually.

2004-08-27  Jon K Hellan  <hellan@acm.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=151152
	
	* src/workbook-control-gui.c (wbcg_close_if_user_permits): Define
	responses GNM_RESPONSE_SAVE_ALL, GNM_RESPONSE_DISCARD_ALL. These
	are negative, to work with druid logic in gnumeric_dialog_run.

2004-08-26  Jon K Hellan  <hellan@acm.org>

	* src/gui-file.c (gui_wb_view_show): New. Factored out of
	gui_file_read. Show  view in a wbcg. Use current or new wbcg
	according to policy. 
	(gui_file_read): Use it.

2004-08-26  Morten Welinder  <terra@gnome.org>

	* src/wbcg-actions.c (cb_help_bug, cb_help_web): Do something
	useful here.  (Based on patch from ynakai@redhat.com.)

2004-08-25  Jody Goldberg <jody@gnome.org>

	* src/sheet-filter.c (cb_filter_bounds_changed) : fix typo in cast
	  from new code for bounds-changed

2004-08-24  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=150530
	* src/sheet-object-cell-comment.c (cell_comment_write_xml_sax) : fix
	  in libgsf, but patched here too to tide us over until the next
	  libgsf release.

2004-08-24  Jody Goldberg <jody@gnome.org>

	* src/sheet-object.c (sheet_object_class_init) : declare a
	  bounds-changed signal.
	(sheet_object_update_bounds) : emit bounds-changed and assume the
	  views will do the right thing.  No need to manually walk the
	  realized list.  That should go away.

	* src/sheet-filter.c :  Adjust to using the bounds-changed signal
	  instead of doing it directly.
	* src/sheet-object-cell-comment.c : ditto.
	* src/sheet-object-graph.c : ditto.
	* src/sheet-object-graphic.c : ditto.
	* src/sheet-object-image.c : ditto.
	* src/sheet-object-widget.c : ditto.

	* src/sheet-control-gui.c (cb_scg_object_bounds_changed) :  new
	(scg_object_stop_editing) : disconnect the bounds changed signal here.
	(scg_mode_edit_object) : connect to it here.

	* src/gnumeric-pane.c (display_object_menu) : no need to use
	  sheet_object_view_control.  We can pull the info from the canvas.
	(cb_sheet_object_canvas_event) : ditto.
	(cb_sheet_object_widget_canvas_event) : ditto.
	(cb_sheet_object_view_destroyed) : ditto.
	(gnm_pane_object_register) : Add some convenience arguments to hook up
	  the bounds-changed handler and set the initial size.
	(gnm_pane_widget_register) :

2004-08-24  Jody Goldberg <jody@gnome.org>

	* src/application.c :  signals are guint, not GQuark.  Probably does
	  not matter, but it can't hurt to match the glib headers

	* src/sheet-object-cell-comment.c (cell_comment_write_xml_sax) : gsf
	  was more anal than libxml about handling NULL as strings.  new gsf
	  is more relaxed, but add some protection here until that is in
	  circulation.

	* src/xml-io.c (gnumeric_xml_read_workbook) : default to using the sax
	  exporter
	(xml_init) : cleanup.

	http://bugzilla.gnome.org/show_bug.cgi?id=150792
	* src/sheet.c (colrow_move) : Only ignore non-existent cells, not all
	  Blanks.  That includes things with VALUE_EMPTY which includes cells
	  whose expressions were just re-written.
	(sheet_move_range) : ditto.

2004-08-24  Morten Welinder  <terra@gnome.org>

	* src/workbook-control-gui.c (cb_wbcg_drag_data_received): Take
	advantage of newly minted go_file_split_uris.

2004-08-22  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-gui.c (cb_wbcg_drag_data_received): Remove
	gnome-vfs dependency.

2004-08-14  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-image.c (sheet_object_image_write_xml_sax) : add a
	  'size-bytes' attribute to make optimization easier.

2004-08-22  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-gui.c (cb_wbcg_drag_data_received): Convert
	uri to string before use.

2004-08-21  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (sheet_set_zoom_factor) : forward port the zoom kludge.
	  There is no time to do RenderedRegion for 1.4

2004-08-21  Andreas J. Guelzow <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=149945
	* src/value.c (find_column_of_field): Correct offset.

2004-08-21  Kjartan Maraas  <kmaraas@gnome.org>

	* configure.in: Add «nb» to ALL_LINGUAS.

2004-08-20  Jody Goldberg <jody@gnome.org>

	* src/sheet.c (sheet_new_special) : renamed from sheet_new, and a
	  'type' added.  Not used yet.

2004-08-20  Morten Welinder  <terra@gnome.org>

	* configure.in: Check for asinh, acosh, atanh.

	* src/gutils.c (asinhgnum, acoshgnum, atanhgnum): Provide if
	needed.

	* src/parser.y (yylex): Take extra care not to run off the edge.

2004-08-17  Morten Welinder  <terra@gnome.org>

	* src/mathfunc.c (mathfunc_init): Greatly simplify using goffice
	code.

	* src/libgnumeric.c (gnm_common_init): Init mathfunc after
	goffice.

2004-08-19  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* configure.in: Bumped the libgsf-gnome-1 requirement to make it
	consistent with the libgsf-1 requirement.

2004-08-18  Jon K Hellan  <hellan@acm.org>

	* configure.in (psiconv): Update psiconv.

2004-08-17  Etsushi Kato  <ekato@ees.hokudai.ac.jp>

	* src/gnumeric-canvas.c (gnm_canvas_key_press):
	gtk_im_context_reset(gcanvas->im_context) should be called after
	checking gtk_im_context_filter_keypress() and GDK_SHIFT_L, GTK_Alt_L,
	and GDK_Control_L. (bug #148473)

2004-08-17  Jon K Hellan  <hellan@acm.org>

	* src/wbcg-actions.c (cb_insert_image): is_save parameter to
	gui_image_file_select no longer needed.

	* src/sheet-object-image.c (soi_gdk_pixbuf_save): New. Callback
	which writes via gsf.
	(soi_get_image_fmt): New. Get a format descriptor for the original
	data in a SheetObjectImage.
	(soi_free_image_fmt): New. Free a format descriptor.
	(soi_cb_save_as): New. Choose file name and format and save
	image.
	(sheet_object_image_populate_menu): New. Put a "save as" entry in
	the object's context menu.

	* src/sheet-object-graph.c (soi_cb_save_as): Choose image format
	from a list.

	* src/gui-file.h (GnmImageFormat): Struct which describes an
	(image) file format.

	* src/gui-file.c (gui_image_file_select): Split the parts common
	to save and open into new function gui_image_chooser_new. Drop
	is_save parameter to _select.
	(gui_get_image_save_info): The parts of _select which have to do
	with saving go here. Add a format chooser.

	* src/file.[ch] (gnm_file_saver_fix_file_name): Rename to
	gnm_vrfy_uri_ext. Take an extension instead of a GnmFileSaver as
	1st parameter.

2004-08-16  Morten Welinder  <terra@gnome.org>

	* src/main-application.c (main): Plug leak.

2004-08-16  Emmanuel Pacaud <emmanuel.pacaud@univ-poitiers.fr>

	* src/item-bar.c (item_bar_draw): Fix black line in row/column
	headers.

2004-08-14  Jon K Hellan  <hellan@acm.org>

	* src/workbook-control-gui.c (wbcg_create_edit_area): Fix typo.

	* src/sheet-control-gui.c (sheet_control_gui_new): Ditto.

2004-08-13  Jon K Hellan  <hellan@acm.org>

	* src/sheet-object-image.c (sheet_object_image_read_xml_dom): Read
	image.

2004-08-11  Jon K Hellan  <hellan@acm.org>

	* src/sheet-object-image.c (sheet_object_image_new): Simplify
	using g_memdup.
	(sheet_object_image_print): fix up types to make gmorten happy.

2004-08-09  Jon K Hellan  <hellan@acm.org>

	* src/sheet-object-image.c (sheet_object_image_new): strdup the
	image type.
	(sheet_object_image_finalize): Free the image type.
	(soi_info_cb): New callback used to find image type.
	(soi_get_pixbuf): Install callback on pixbuf loader in order to
	find image type.
	(sheet_object_image_get_property): New gobject method to return
	type, data or pixbuf as object parameters.
	(sheet_object_image_class_init): Install properties.

2004-08-11  Morten Welinder  <terra@gnome.org>

	* src/ssconvert.c (main): Handle non-URI output destinations.

2004-08-09  Emmanuel Pacaud <emmanuel.pacaud@univ-poitiers.fr>

	* src/sheet-object-graph.c (cb_save_as) : Set zoom to 1.0 when
	exporting to SVG.

2004-08-02  Jody Goldberg <jody@gnome.org>

	* src/expr.c (gnm_expr_eval) : Functions returning an array when only
	  scalar results are permitted produce #VALUE!

	* src/style.c (style_default_halign) : Fix drilling down into arrays

	* src/wbc-gtk.c (cb_add_menus_toolbars) : Init state.

2004-08-01  Jody Goldberg <jody@gnome.org>

	* src/func.c (function_call_with_list) : Array parms seem to accept
	  scalars.

	* src/value.c (value_dup) : Accept NULL

	* src/expr.c (gnm_expr_eval) : do intersection for constant arrays too

2004-07-30  Jody Goldberg <jody@gnome.org>

	* src/wbc-gtk.c (wbc_gtk_init_zoom) : We need a label for the action
	  in case it is a menu item.

2004-07-30  Morten Welinder  <terra@gnome.org>

	* src/wbc-gtk.c (cb_add_menus_toolbars): Plug leaks.

	* src/file.c (gnm_file_saver_unregister): First use, then free.

2004-07-30  Jon K Hellan  <hellan@acm.org>

	* src/command-context.c (format_message): Strange things happen if
	we treat the unknown string we are passed as a format string.

2004-07-30  Yukihiro Nakai  <nakai@gnome.gr.jp>

	* src/wbcg-actions.c: Don't forget to mark with N_()
	http://bugzilla.gnome.org/show_bug.cgi?id=148746

2004-07-28  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/hlink.h (GNM_HLINK_URL_TYPE): new
	(GNM_HLINK_URL): new
	(IS_GNM_HLINK_URL): new

2004-07-27  Morten Welinder  <terra@gnome.org>

	* configure.in: Check for log1p also.

2004-07-27  Morten Welinder  <terra@gnome.org>

	* src/gnumeric-gconf.c (gnm_conf_init_printer_decoration_font): (void).
	* src/application.c (cb_flag_windows_changed): Ditto.

2004-07-27  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* configure.in: use AM_PROG_LEX rather than AC_PROG_LEX
	
2004-07-27  Jody Goldberg <jody@gnome.org>

	* src/wbc-gtk.c (cb_regenerate_window_menu) : new.

2004-07-26  Jody Goldberg <jody@gnome.org>

	* configure.in :  bump pxlib req to 0.3.0 per Uwe's request

	http://bugzilla.gnome.org/show_bug.cgi?id=148412
	* src/workbook-control-gui-priv.h : typo in the new combos

2004-07-26  Morten Welinder  <terra@gnome.org>

	* src/sheet.c (sheet_colrow_group_ungroup): Don't use ?: result
	as a structure.  Go via pointers.

2004-07-23  Morten Welinder  <terra@gnome.org>

	* src/wbcg-actions.c: Add Ctrl-Shift-D for double underline.

	* src/commands.c (cmd_merge_data): Fix 0/NULL mixup.
	* src/complete.c (complete_finalize): Ditto.
	* src/sheet.c (sheet_range_calc_spans, sheet_toggle_hide_zeros): Ditto.
	* src/colrow.c (colrow_set_sizes, colrow_restore_state_group): Ditto.
	* src/gui-util.c (gnumeric_popup_menu): Ditto.
	* src/item-cursor.c (item_cursor_unrealize): Ditto.
	* src/value.c (value_peek_string): Ditto.

	* src/expr.c (cb_bin_arith): Add const-casts.

	* src/format.c (format_entry_set_fmt): Use g_strdup, not plain
	strdup.

	* src/wbcg-actions.c: Add Ctrl-5 for strikethough.

2004-07-22  Jody Goldberg <jody@gnome.org>

	* src/workbook-edit.c (wbcg_edit_finish) : change 'accept' into an
	  enum and handle arrays and range fills here.

	* src/parser.y : Add distinct productions for array elements with
	  {1\2\3;4\5\6} vs {1,2,3;4,5,6}
	(build_array) : add some error messages empty and asymetric arrays.

2004-07-22  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (wbcg_set_standard_toolbar_visible) : delete
	(wbcg_set_format_toolbar_visible) : delete
	(wbcg_set_object_toolbar_visible) : delete
	(wbcg_copy_toolbar_visibility) : make virtual for now

	* src/wbcg-actions.c (cb_view_standard_toolbar) : delete
	(cb_view_format_toolbar) : delete
	(cb_view_object_toolbar) : delete

2004-07-22  Jody Goldberg <jody@gnome.org>

	* src/wbc-gtk.c (cb_handlebox_visible) : new.
	(cb_add_menus_toolbars) : connect it here and create a menu entry in
	  the view menu to toggle the visibility.

2004-07-21  Morten Welinder  <terra@gnome.org>

	* src/gutils.c (expm1gnum): Supply this when missing.

2004-07-20  Jody Goldberg <jody@gnome.org>

	* configure.in : add test for sysconf as per Mark's request

	* src/gnumeric-pane.c (cb_pane_popup_menu) : cheese up a little hack
	  to get 'popup-menu' binding context menus for col/row headers too.
	(gnm_pane_clear_obj_size_tip) : new
	(gnm_pane_display_obj_size_tip) : new
	(gnm_pane_object_move) : use gnm_pane_display_obj_size_tip to provide
	 an indication of the object size.

2004-07-20  Morten Welinder  <terra@gnome.org>

	* src/mathfunc.c (lbeta3): Use lgamma_rgnum.

	* src/gutils.c (lgamma_rgnum): When needed, supply this.

	* src/numbers.h (lgamma_rgnum): Add definition for this.

	* configure.in (lgamma_r): Check for this.  Check for long double
	version when needed.

2004-07-20  Morten Welinder  <terra@gnome.org>

	* src/ranges.c (range_is_infinite): Fix.  (Still unused, though.)

2004-07-19  Jody Goldberg <jody@gnome.org>
	win32 portability patch from Mark Gilbert

	* src/io-context.c (io_progress_update) : use g_get_current_time
	  instead of gettimeofday.

2004-07-19  Jody Goldberg <jody@gnome.org>

	* src/dialogs/dialog-about.c : Update a bit.  Add
	* doc/C/about-authors.xml  : ditto
	    - Emmanuel
	    - Jean
	    - Hal
	    - Uwe
	    - Michael Devine

2004-07-19  Jody Goldberg <jody@gnome.org>

	* src/xml-io.c (xml_init) : make the dom exporter a lower priority
	  than the sax exporter so that we can start phasing it out.

2004-07-19  Jody Goldberg <jody@gnome.org>
	Uwe Steinmann <uwe@steinmann.cx>

	* plugins/Makefile.am : merge in the paradox importer

2004-07-19  Jody Goldberg <jody@gnome.org>

	* configure.in : Post release version bump

2004-07-19  Jody Goldberg <jody@gnome.org>

	* Release 1.3.1

2004-07-19  Jody Goldberg <jody@gnome.org>

	* src/ssconvert.c (main) : some typos

2004-07-17  Jody Goldberg <jody@gnome.org>

	* configure.in : Add a test for signgam

2004-07-19  Jody Goldberg <jody@gnome.org>

	* src/wbcg-actions.c (wbcg_set_selection_halign) :  Make public
	  somewhat.
	(wbcg_set_selection_valign) : ditto.

	* src/wbc-gtk.c :  Adjust the borders to use stock items in place of
	  the old inline pixbuf silliness.  Add a valignment and halignment
	  combo.  Still need some way to indicate 'General' for both.

	* src/application.c (gnumeric_application_setup_icons) : add the
	  border icons to the set of stock items.

2004-07-17  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=147756
	* src/sheet-autofill.c (autofill_cell) : An ancient bug.

2004-07-17  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-general.schemas.in: Correct compression level
	  description

2004-07-16  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-paths.sh.in : Add version

2004-07-15  Jody Goldberg <jody@gnome.org>

	Some Seth UI feedback
	* src/wbcg-actions.c : s/Launch Guru/Insert Chart/

2004-07-13  Morten Welinder  <terra@gnome.org>

	* src/commands.c (cmd_copyrel): New command.

	* src/wbcg-actions.c (cb_copydown, cb_copyright): Implement.

2004-07-12  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (wbcg_cur_sheet) :  new convenience
	  routine

	* src/wbcg-actions.c : tidy up a bit

	* src/wbc-gtk.c (wbc_gtk_init_undo_redo) : tie sensitivity of repeat
	  to undo.

2004-07-11  Jody Goldberg <jody@gnome.org>

	* src/commands.c (cmd_set_text_repeat) : new
	  (missing validation support)
	(cmd_area_set_text_repeat) :  new.
	(cmd_ins_del_colrow_repeat) : new.
	(cmd_clear_repeat) :  new.
	(cmd_format_repeat) :  new.
	(cmd_colrow_hide_repeat) :  new.
	(cmd_group_repeat) : new.
	(cmd_paste_copy_repeat) : new.
	(cmd_autofill_repeat) : new.
	(cmd_autoformat_repeat) : new.
	(cmd_unmerge_cells_repeat) : new.
	(cmd_merge_cells_repeat) : new.
	(cmd_clone_sheet_repeat) : new.

2004-07-09  Jody Goldberg <jody@gnome.org>

	* src/GNOME_Gnumeric-gtk.xml : Add repeat as an accelerator
	* src/commands.c (func) : add some hooks for repeat

2004-07-12  Morten Welinder  <terra@gnome.org>

	* src/wbcg-actions.c: Use gtk about icon if available.

2004-07-09  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=146486
	* src/expr.c (cb_bin_arith) : handle VALUE_EMPTY for implicit
	  iteration with arithmetic operators.

	http://bugzilla.gnome.org/show_bug.cgi?id=146511
	* src/func.c (function_call_with_list) : Use value_get rather than
	  value_fetch
	* src/sheet.c (sheet_foreach_cell_in_range) : check for empty values too

2004-07-07  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gnumeric-gconf.c (go_conf_get_short_desc): Check for NULL 
	  pointer
	(go_conf_get_long_desc): ditto

2004-07-05  Jody Goldberg <jody@gnome.org>

	* src/workbook-cmd-format.c (workbook_cmd_mutate_borders) :  move into
	  wbcg-actions.c

	* src/sheet-autofill.c (fill_item_new) : fix an old leak

	* src/gnumeric-canvas.c (gnm_canvas_key_mode_sheet) :  no need to
	  check for accelerators here any more.
	(gnm_canvas_commit_cb) :  nor here.
	(gnm_check_ctrl_mask) :  delete and make these real accelerators the
	  way they belong.

	* src/wbcg-actions.c
	(cb_format_as_number) : a real accelerator
	(cb_format_as_currency) : ditto
	(cb_format_as_accounting) : ditto
	(cb_format_as_percentage) : ditto
	(cb_format_as_scientific) : ditto
	(cb_format_as_time) : ditto
	(cb_format_as_date) : ditto
	(cb_format_add_borders) : ditto
	(cb_format_clear_borders) : ditto

	* src/GNOME_Gnumeric-gtk.xml :  Add the new accelerators
	* src/application.c (gnumeric_application_setup_icons) : Rename the
	  icons to match the verbs (Percentage, Accounting)

2004-07-02  Jody Goldberg <jody@gnome.org>

	* configure.in : Make gconf conditional and test for uname

2004-07-01  Jody Goldberg <jody@gnome.org>

	* src/cmd-edit.c (sv_select_cur_depends) : find deps even for empty
	  cells.

2004-06-30  Jody Goldberg <jody@gnome.org>

	* src/stf.c (stf_init) : cvs exporter is one sheet only

	* src/gnumeric-gconf.c (get_schema) : typo
	(go_conf_get_type) : implement for #ifdef WITH_GNOME

2004-06-23  Jean Brefort  <jean.brefort@ac-dijon.fr>

	* configure.in:
	* src/Makefile.am:
	* src/cut-n-paste-code/Makefile.am: removed pcre subdir.
	* src/graph.c: (cb_assign_val), (gnm_go_data_vector_load_values),
	(gnm_go_data_vector_get_value): changed gnm_nan to go_nan.
	* src/format.h:  replaced gnumeric_reg* by go_reg*
	* src/formats.c: (my_regerror), (currency_date_format_init),
	(currency_date_format_shutdown), (cell_format_simple_number),
	(cell_format_is_number), (cell_format_is_fraction): ditto.
	* src/number-match.c: (format_match_release),
	(format_match_create), (format_match): ditto.
	* src/plugin-service.c: (plugin_service_define): ditto.
	* src/regutf8.c: (gnumeric_regcomp_XL): ditto.
	* src/regutf8.h: ditto.
	* src/search.c: (search_replace_free), (search_replace_compile),
	(search_match_string), (search_replace_string): ditto.
	* src/search.h: ditto.
	* src/sheet-filter.c: (filter_expr_release), (filter_expr_eval): ditto.
	* src/widgets/widget-format-selector.c: (populate_menu): ditto.
	* src/workbook-control-gui.c: (wbcg_sheet_focus),
	(cb_notebook_switch_page): Added missing spaces.
	* src/cut-n-paste-code/pcre: Moved whole tree to goffice.
	* tools/import-pcre: Updated to the new path and replaced gnumeric_ by go_.

2004-06-22  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=134014
	* src/print-cell.c (print_merged_range) : sync with canvas item
	  recalling that y-coords are negative.  Enable diagonals.

2004-06-20  Jody Goldberg <jody@gnome.org>

	* src/Makefile.am : re-enable ssconvert as a test program for now to
	  avoid rebuilding it all the time.

2004-06-15  Jody Goldberg <jody@gnome.org>

	* src/sheet-object.c (sheet_objects_get) : don't reverse the z
	  ordering

2004-06-17  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/consolidate.c (simple_consolidate): dao_set_cell_expr now
	  absorbs the expr reference.
	(colrow_consolidate): ditto

2004-06-16  Morten Welinder  <terra@gnome.org>

	* src/workbook-view.c (wbv_save_to_file): Simplify using
	go_file_create.

	* src/wbc-gtk.c (wbc_gtk_reload_recent_file_menu): Convert
	filename to UTF-8 before constructing the label.  Use uri if the
	filename cannot be represented in UTF-8.

	* src/sheet-object-graph.c (cb_save_as): Handle dumping to uris.

	* src/gui-file.c (gui_image_file_select): Take and return uris.

	* src/workbook-control-gui.c (cb_wbcg_drag_data_received):
	Simplify with go_file_open.

2004-06-15  Andreas J. Guelzow <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=142700
	* src/workbook-view.c (wb_view_sheet_focus): set current_sheet
	  before adjusting focus.

2004-06-15  Morten Welinder  <terra@gnome.org>

	* src/history.c (history_item_label): Fix thinko.  Avoid double
	UTF-8 encoding.

2004-06-14  Morten Welinder  <terra@gnome.org>

	* src/wbc-gtk.c (wbc_gtk_reload_recent_file_menu): If available,
	use just filename for tooltip.  (Non-ascii looks nicer, and it's
	shorter.)

2004-06-13  Jody Goldberg <jody@gnome.org>

	* src/command-context-stderr.c : fix class decl to match change to
	  interface

2004-06-13  Jody Goldberg <jody@gnome.org>

	* configure.in : bump req for libgsf to 1.10.0 (still in cvs)

2004-06-11  Morten Welinder  <terra@gnome.org>

	* src/workbook-view.c (wbv_save_to_file): Make this work with uris.

	* src/history.c (history_item_label): Now gets uri argument.

	* src/workbook.c (workbook_set_uri): Ranamed from
	workbook_set_filename.
	(workbook_get_uri): Renamed from workbook_get_filename.

	* src/application.c (gnm_app_history_add): Change to take uri.
	All callers changed.

	* src/wbc-gtk.c (wbc_gtk_reload_recent_file_menu): Adapt to uris.

	* src/gui-file.c (gui_file_read, do_save_as, go_file_is_writable):
	Changed to take uri.  All callers changed.
	
	* src/workbook-view.c (wb_view_new_from_uri): Renamed from
	wb_view_new_from_file and adapted to take uri.  All callers
	changed.
	(wb_view_save_as): Change to take uri.  All callers changed.

2004-06-08  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=143577
	* src/style-border.c (style_border_print_diag) : handle NULL and none
	(style_border_set_pc) : back out my incorrect fix and sync with gui.

2004-06-08  Morten Welinder  <terra@gnome.org>

	* src/gutils.c (gnm_destroy_password): New function.

2004-06-05  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-image.c : add sax export, and actually dump the
	  images.
	* src/sheet-object-widget.c : add sax export
	* src/sheet-object-graph.c : ditto.
	* src/sheet-object-cell-comment.c : ditto.

	* src/workbook-view.c (wbv_save_to_file) : warning suppression

	* src/xml-io.c (gnm_xml_out_add_color) : new
	(gnm_xml_out_add_cellpos) : new.

2004-06-04  Morten Welinder  <terra@gnome.org>

	* src/parser.y (arg_list): handle the empty arg in =IF(TRUE,)
	properly.

	* src/expr.c (gnm_expr_get_func_argcount): New function.

2004-05-31  Jody Goldberg <jody@gnome.org>

	* src/graph.c (gnm_go_data_get_sheet) : new.
	(gnm_go_data_get_expr) : new.

	http://bugzilla.gnome.org/show_bug.cgi?id=143367
	* src/item-grid.c (item_grid_realize) : make the seperator a dark
	  colour rather than black.

2004-05-27  Jody Goldberg <jody@gnome.org>

	* src/workbook.c (workbook_sheet_hide_controls) : split out from.
	(workbook_sheet_detach) : here.

	* src/dependent.c (dependent_queue_recalc_list) : fix dynamic depends.

	* src/workbook-control-gui.c (cb_wbcg_drag_data_received) : handle
	  dragging from nautilus -> gnumeric too.

	* src/main-application.c (main) : Use the new virtuals

	* src/io-context.c (gnm_io_context_set_num_files) : new
	(gnm_io_context_processing_file) : new.

	* src/io-context-gtk.c (icg_processing_file) : renamed from
	  icg_inc_files_done.
	(icg_set_num_files) : renamed from icg_set_files_total.
	(icg_class_init) : hook up the file handlers to the new virtual.

	* src/expr.c (gnm_expr_extract_ref) : return a RangeRef
	(gnm_expr_range_op) : new to handle intersection and union properly
	(gnm_expr_eval) : split the common code out of here.

2004-05-26  Morten Welinder  <terra@gnome.org>

	* src/parser.y (yylex): Ignore spaces in lots of places, notably
	before and after operators.  (XL has chosen space as an operator,
	but luckily it only makes sense in a few places.)

2004-05-26  Jean Brefort  <jean.brefort@ac-dijon.fr>

	* src/sheet-object-widget.c: (sheet_widget_combo_create_widget):
	replaced GnmComboText by GoComboText.

2004-05-25  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/application.c: add "Gnumeric_Visible" icon
	* src/pixmaps/visible.png: new
	* src/pixmaps/Makefile.am: include src/pixmaps/visible.png
	* src/commands.h (cmd_reorganize_sheets): add arguments
	* src/commands.c: add NULL arguments to all calls to
	  cmd_reorganize_sheets throughout.
	(cmd_reorganize_sheets_*): handle visibility changes 
	* src/sheet.h (sheet_set_visibility): new
	(sheet): add is_visible field
	* src/sheet.c (sheet_set_visibility): new
	(sheet_new): initalize is_visible field
	* src/workbook-control-gui.c: add NULL arguments to all calls to 
	  cmd_reorganize_sheets
	* src/workbook.h (workbook_sheet_change_visibility): new
	* src/workbook.c (workbook_sheet_change_visibility): new

2004-05-24  Morten Welinder  <terra@gnome.org>

	* src/expr.c (negate_value): New function, extracted from
	gnm_expr_eval and cb_iter_unary_neg.
	(gnm_expr_eval, cb_iter_unary_neg): Use it.
	(cb_iter_unary_neg, cb_iter_percentage): Fix crash for empties.

2004-05-22  Jean Brefort  <jean.brefort@ac-dijon.fr>

	* src/expr.c: (cb_iter_unary_neg), (cb_iter_percentage): make it compile again by changing
	variable names "a" and "pos" by "v" and "ep".
	* src/gui-util.c: (gnumeric_notice_nonmodal), (cb_parent_mapped),
	(gnumeric_combo_enters): replaced gtk_signal by g_signal and deleted
	gnumeric_combo_enters as it is not used anymore and I could not find a replacement
	for gtk_combo_disable_activate usable with GtkComboBoxEntry.
	* src/gui-util.h: removed gnumeric_combo_enters.

2004-05-21  Jody Goldberg <jody@gnome.org>

	* src/expr.c : support implicit iteration for operators.  We now
	  support all major evaluation mechanisms in ms excel.

2004-05-19  Jody Goldberg <jody@gnome.org>

	* configure.in : bump libglade req to 2.3.6 to get the new combos
	  Merge in an as yet unused test for mono while we're in here.

2004-05-11  Andreas J. Guelzow <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=142836
	* src/stf.c (stf_write_csv): use current sheet rather than first 
	  sheet. 
	
2004-05-17  Morten Welinder  <terra@gnome.org>

	* src/sheet-autofill.c (autofill_cell): Handle default case, just
	in case.

2004-05-16  Adrian Custer <acuster@gnome.org>

	* src/ssconvert.c: exports -> exporters in user visible
	strings. Added translation tags.

2004-05-15  Jody Goldberg <jody@gnome.org>

	* src/format.c (format_value_gstring) : if nothing matches for numbers
	  use the first fmt, other types == general.
	(style_format_condition) : errors do not match strings, but bools do
	(format_compile) : assign std conditions to any element without one,
	  even the last.

2004-05-16  Jean Brefort  <jean.brefort@ac-dijon.fr>

	* src/dialogs/autofilter-expression.glade: replaced GtkOptionMenu by GtkComboBox.
	* src/dialogs/autofilter-top10.glade: ditto.
	* src/dialogs/autoformat.glade: ditto.
	* src/dialogs/cell-format.glade: ditto.
	* src/dialogs/consolidate.glade: ditto.
	* src/dialogs/dao.glade: ditto.
	* src/dialogs/dialog-autofilter.c: (map_op), (cb_autofilter_ok),
	(cb_top10_type_changed), (init_operator), (dialog_auto_filter):
	* src/dialogs/dialog-autoformat.c: (cb_category_changed),
	(dialog_autoformat): ditto.
	* src/dialogs/dialog-cell-format.c: (cb_rotate_canvas_realize),
	(validation_rebuild_validation),
	(cb_validation_error_action_changed), (cb_validation_sensitivity),
	(build_validation_error_combo), (fmt_dialog_init_validation_page),
	(cb_fmt_dialog_dialog_buttons): ditto.
	* src/dialogs/dialog-consolidate.c: (construct_consolidate),
	(setup_widgets): ditto.
	* src/dialogs/dialog-hyperlink.c: (dhl_cb_menu_changed),
	(dhl_init): ditto.
	* src/dialogs/dialog-printer-setup.c: (do_header_customize),
	(do_footer_customize), (header_changed), (footer_changed),
	(fill_hf), (do_setup_hf_menus), (do_setup_hf),
	(print_setup_get_sheet), (do_setup_sheet_selector): ditto.
	* src/dialogs/dialog-stf-format-page.c:
	(format_page_trim_menu_changed), (stf_dialog_format_page_prepare),
	(stf_dialog_format_page_init): ditto.
	* src/dialogs/dialog-stf.glade: ditto.
	* src/dialogs/hyperlink.glade: ditto.
	* src/dialogs/print.glade: ditto.
	* src/widgets/gnm-dao.c: (gnm_dao_init), (gnm_dao_get_data),
	(gnm_dao_set_put): ditto.
	* src/dialogs/dialog-stf-export.c:
	(sheet_page_separator_menu_changed),
	(stf_export_dialog_format_page_init), (stf_export_dialog_finish): ditto.
		Replaced also GtkCombo by GtkComboBoxEntry.
	* src/dialogs/dialog-stf-export.glade: ditto.

2004-05-11  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/workbook-view.c (wbv_save_to_file): add omitted declaration

2004-05-07  Jody Goldberg <jody@gnome.org>

	* src/command-context-priv.h : Make this an interface
	* src/command-context.c : support the change here.
	* src/command-context-stderr.c : here.
	* src/io-context-gtk.c : here
	* src/io-context-priv.h : here
	* src/io-context.c : here.
	* src/workbook-control-gui.c : here
	* src/workbook-control.c : and here

	* src/GNOME_Gnumeric-gtk.xml : Move the toolbars out, they will be
	  generated.  Add FullScreen.

	* configure.in : bump libgsf dep and add the new goffice/app directory

2004-05-03  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=140671
	* src/commands.c (cmd_paste_cut_undo) : we don't know the SheetView
	  associated with the origin sheet.

	* src/selection.c (sv_selection_set) : add some safety

2004-05-04  Morten Welinder  <terra@gnome.org>

	* src/validation.c (validation_new): Make sure
	VALIDATION_TYPE_CUSTOM is only paired with VALIDATION_OP_NONE.
	(validation_eval): Balance recounting.

2004-04-27  Jody Goldberg <jody@gnome.org>

	* src/file.c (go_file_open) : fix the gnome-vfs case

2004-04-22  Morten Welinder  <terra@gnome.org>

	* src/print-info.c (print_info_get_orientation): Plug leak.

2004-04-22  Jody Goldberg <jody@gnome.org>

	* src/sheet-autofill.c (autofill_cell) : Assign the value format in
	  all cases accept expressions.  Use cell_set_value, not
	  sheet_cell_set_value so that we can assign the format before we
	  render, and to avoid doing things piece meal.

2004-04-21  Morten Welinder  <terra@gnome.org>

	* src/format.c (format_destroy): Let's try unref in here.

	* src/stf-export.c (stf_export): Fix compilation.

2004-04-20  Jody Goldberg <jody@gnome.org>

	* src/stf-export.c (stf_export_sheet) : simplify

2004-04-20  Morten Welinder  <terra@gnome.org>

	* src/stf-parse.c (stf_parse_sheet): Handle the case of more
	columns than we have room for in the sheet.

2004-04-19  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* README: Corrected the Debian package names.

2004-04-19  Jody Goldberg <jody@gnome.org>

	* src/workbook-edit.c (cb_entry_insert_text) : be clear which values
	  are measured in bytes (PangoAttribute) and which are in characters
	  (GtkEditable)
	(cb_entry_cursor_pos) : ditto.
	(cb_entry_delete_text) : ditto.
	(wbcg_edit_add_markup) : ditto.

2004-04-19  Jody Goldberg <jody@gnome.org>

	* src/rendered-value.c (rendered_value_new) : don't apply markup to
	  the shared set of attributes associated with the style make a local
	  copy.

2004-04-17  Jody Goldberg <jody@gnome.org>

	* src/item-edit.c (item_edit_draw) : tidy up a bit and check for pixel
	  matching stock cell drawing so that things do not shift.
	(ie_layout) : ditto.

	* src/value.c (parse_database_criteria) : revert change from 2004-03-31
	  rather than moving to g_new/g_free to make the g_free work, leave
	  the g_alloca and remove the unnecessary g_free.

2004-04-16  Morten Welinder  <terra@gnome.org>

	* src/rangefunc.c (range_mode): Use g_hash_table_new_full.
	(cb_range_mode): Delete.

2004-04-15  Morten Welinder  <terra@gnome.org>

	* src/mathfunc.c (phyper): New implementation.

2004-04-13  Morten Welinder  <terra@gnome.org>

	* src/wbc-gtk.c (wbc_gtk_set_action_label): Set the right tooltip.

2004-04-12  Jody Goldberg <jody@gnome.org>

	* src/format.c (style_format_new_markup) : new.

	* src/commands.c (cmd_set_text*) : Handle markup

2004-04-12  Morten Welinder  <terra@gnome.org>

	* src/mathfunc.c (pow1p, pow1pm1): New functions.
	(random_levy_skew): Use pow1p.

2004-04-12  Morten Welinder  <terra@gnome.org>

	* src/mathfunc.c (pf): New implementation.

	* src/history.c (history_item_label): Handle accel_number >= 10
	better.  Handle "_" properly.

2004-04-09  Morten Welinder  <terra@gnome.org>

	* src/mathfunc.c (pcauchy): New implementation.

	* src/gutils.c (erfgnum): Improve precision for small x.
	(modfgnum): Fix precision for huge x.
	(frexpgnum): Fix precision for huge x.

	* src/mathfunc.c (pbeta): New implementation.
	(lgamma1p, swap_log_tail, log1pmx): New function.

2004-04-08  Morten Welinder  <terra@gnome.org>

	* src/wbc-gtk.c (check_underlines): Make UTF-8 safe.

2004-04-08  Jean Brefort  <jean.brefort@ac-dijon.fr>

	* src/selection.c: (sv_selection_to_plot): skip errors dims.

2004-04-08  Jody Goldberg <jody@gnome.org>

	* src/gnumeric-gconf.c (gnm_conf_init_essential) : move the live
	  scroll delay and the autocompletion status here from.
	(gnm_conf_init_extras) : here.  So that we initialize it before we
	  copy it when creating aworkbookview.

2004-04-07  Morten Welinder  <terra@gnome.org>

	* src/gui-file.c (gui_file_read): Make sure new windows appear
	on the right screen.
	* src/wbcg-actions.c (cb_file_new): Make sure new windows appear
	on the right screen.

2004-04-07  Morten Welinder  <terra@gnome.org>

	* src/wbcg-actions.c (cb_file_new): Copy toolbar visibility to new
	window.
	* src/gui-file.c (gui_file_read): Copy toolbar visibility to new
	window.

	* src/wbc-gtk.c (wbc_gtk_create_status_area): Show statusbar.
	(check_underlines): New code to debug underline collisions.
	(wbc_gtk_init): Show everything here.

	* src/workbook-control-gui.c (wbcg_set_toolbar_visible): Update
	menus too.
	(wbcg_copy_toolbar_visibility): New function.
	(show_gui): Call gtk_widget_show, not gtk_widget_show_all, so as
	not to interfere with toolbar visibility.

	* src/wbcg-actions.c (cb_view_standard_toolbar,
	cb_view_format_toolbar, cb_view_object_toolbar,
	cb_view_statusbar): Only do something when we're not already
	updating the ui.
	(var actions): Fix underline collissions.

2004-04-07  J.H.M. Dassen (Ray) <jdassen@debian.org>

	* configure.in: substitute WARN_CFLAGS as
	src/cut-n-paste-code/foocanvas/libfoocanvas/Makefile references it
	directly.

2004-04-05  Morten Welinder  <terra@gnome.org>

	* src/wbc-gtk.c (cb_add_menus_toolbars): Identify toolbars.
	(cb_handlebox_popup): Remove this.
	(cb_handlebox_dock_status): Fiddle with style to work around
	gtk_handle_box bug.
	* src/workbook-control-gui.c (wbcg_set_standard_toolbar_visible,
	wbcg_set_format_toolbar_visible, wbcg_set_object_toolbar_visible,
	wbcg_set_statusbar_visible): New functions.

	* src/wbcg-actions.c (cb_view_standard_toolbar,
	cb_view_format_toolbar, cb_view_object_toolbar,
	cb_view_statusbar): New functions.
	(var toggle_actions): Hook them up.

2004-04-02  Morten Welinder  <terra@gnome.org>

	* src/gui-file.c (gui_file_open): Use savers' extensions as a
	proxy for all spreadsheet files.  this is not ideal, but far
	better than hardcoding "*.gnumeric" and "*.xls".
	(gui_file_save_as): Ditto.

	* src/wbc-gtk.c (wbc_gtk_finalize): New function.
	(wbc_gtk_class_init): Hook it up.

2004-04-01  Jody Goldberg <jody@gnome.org>

	* src/style-border.c (style_border_draw_diag) : sync with the printing
	  code to not draw into the center of bordering double borders

	* src/item-edit.c (item_edit_event) : basic cursor position support.

	* src/print-cell.c (print_cell_background) : draw diagonals.
	* src/style-border.c (style_border_print_diag) : fill in.  Where did
	  this code go ?  I could have sworn I implemented this years ago.

2004-04-01  Morten Welinder  <terra@gnome.org>

	* src/format.c (append_hour_elapsed): Fix precision issues.
	http://bugzilla.gnome.org/show_bug.cgi?id=138182.

2004-04-01  Christian Neumair  <chris@gnome-de.org>

	* src/sheet-control-gui.c:
	* src/wbcg-actions.c:
	* src/GNOME_Gnumeric-gtk.xml: Put delete actions from edit main menu
	into their own submenu, add stock icon to clear submenu.

2004-03-31  Morten Welinder  <terra@gnome.org>

	* src/value.c (parse_database_criteria): Since we're g_free-ing,
	allocate with g_new and not g_alloca.

	* src/gui-file.c (gui_file_save_as): Don't create an extra, bogus
	combo box.

2004-03-30  Jody Goldberg <jody@gnome.org>

	* configure.in : post release bump

2004-03-30  Jody Goldberg <jody@gnome.org>

	* Release 1.3.0

	* Makefile.am : Add distcleancheck_listfiles, and distuninstallcheck_listfiles
	  to keep automake from complaining about the docs.
	  Clean the .desktop and .keys file
	  Dist the new gnome-common auto installed xmldoc.make and omf.make

	* autogen.sh : require automake 1.7.2 to get the *_listfiles support
	  required to make the doc build pass distcheck.

	* omf-install/* : delete

	* configure.in : remove omf-install, plugins/gb/Makefile,
	  plugins/uihello/Makefile

	* schemas/Makefile.am : clean the generated schema files

	* src/cell-draw.c (cell_calc_layout) : mark hashed values as variable
	  width so that they resize when columns change size.

	* src/item-grid.c (item_grid_event) : clear the cursor timer when the
	  mouse leaves the grid (eg enters the edit item)

2004-03-30  Jody Goldberg <jody@gnome.org>

	Test case.  Enter string into C3 that spans into E3 then change
	alignment
	* src/commands.c (cmd_format_undo) : be lazy, queue a full redraw in
	  case spans changed.
	(cmd_format_redo) : ditto.

2004-03-28  Jody Goldberg <jody@gnome.org>

	* src/wbcg-actions.c : cheat and install a SheetInsert action to avoid
	  having an 'Insert' entry in the insert menu because we named the
	  InsertSheet action for the Sheet menu.

	* src/item-edit.c (ie_layout) : Support rich text.

	* src/wbc-gtk.c (wbc_gtk_style_feedback) : Pull the values from
	  @changes if it is supplied.
	(cb_post_activate) : new.
	(wbc_gtk_init) :  Only restore focus when we aren't editing.
	  Otherwise every time the style feedback changes we lose focus.

2004-03-26  Jody Goldberg <jody@gnome.org>

	* src/workbook-edit.c (cb_delete_filter) : first step in syncing the
	  markup when content changes.
	(cb_entry_delete_text) : ditto.

2004-03-25  Jody Goldberg <jody@gnome.org>

	* src/wbcg-actions.c (cb_help_docs) : quick an dirty

2004-03-26  Morten Welinder  <terra@gnome.org>

	* src/wbc-gtk.c (wbc_gtk_reload_recent_file_menu): Make UTF-8 safe
	and stop using tooltips for storing filenames.

	* src/history.c (history_item_label): Make this UTF-8 safe.

2004-03-25  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=137818
	* src/style.c (required_updates_for_style) : redraw for h-align,
	  striketrough, underline, and font colour changes.

	* src/application.c (gnumeric_application_setup_icons) : pull in some
	  icons

2004-03-20  Jody Goldberg <jody@gnome.org>

	* src/wbcg-actions.c : Move the font actions into a distinct group.

	* src/wbc-gtk.c (wbc_gtk_actions_sensitive) : start to account for
	  font vs normal actions.  This interface sucks.  We'll need something
	  more functional as the number of action groups increases (eg clipboard)
	(wbc_gtk_init_color_fore) : move into font group
	(wbc_gtk_init_font_name) : move into font group
	(wbc_gtk_init_font_size) : move into font group
	(wbc_gtk_set_toggle_action_state) : split font actions into a distinct
	  group
	(cb_handlebox_dock_status) : ditto.
	(wbc_gtk_init) : ditto.

2004-03-19  Morten Welinder  <terra@gnome.org>

	* src/plugin-util.c (gnumeric_fopen): Ditto.
	* src/format-template.c (format_template_save): Delete unused
	function.

2004-03-18  Morten Welinder  <terra@gnome.org>

	* src/gnumeric-canvas.c (row_scroll_step): Use a continious
	function, not a step function.
	(col_scroll_step): Ditto.

2004-03-18  Guntupalli Karunakar  <karunakar@freedomink.org>

	* configure.in: Added "mr" for Marathi to ALL_LINGUAS.

2004-03-17  Morten Welinder  <terra@gnome.org>

	* src/gutils.c (gnm_string_append_gstring): New function.

	* src/format.c (format_get_decimal, format_get_thousand,
	format_get_currency): Return a GString*.  All callers changed and
	happy since they don't need to call strlen.
	(convert1): Operate of GString.

2004-03-17  Christopher James Lahey  <clahey@ximian.com>

	* configure.in: Added
	src/cut-n-paste-code/goffice/libpresent/Makefile and
	src/cut-n-paste-code/goffice/test/Makefile.

2004-03-16  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=137357
	* src/item-bar.c : Use a custom detail 'GnmItemBarCell' rather than
	  the more generic 'button' to keep some themes 'industrial and gorilla'
	  from freaking out at the lack of button.

2004-03-16  Jody Goldberg <jody@gnome.org>

	* configure.in : bump the gtk req to reflect the churn in the filesel

2004-03-16  Morten Welinder  <terra@gnome.org>

	* src/sheet-autofill.c (autofill_cell): Kill some read-only
	warnings.

2004-03-16  Jean Brefort  <jean.brefort@ac-dijon.fr>

	* configure.in: add src/cut-n-paste-code/goffice/data/Makefile.in

2004-03-11  Jody Goldberg <jody@gnome.org>

	* src/stf.c (csv_tsv_probe) : Be more forgiving about what might be
	text.  Accept
	    1) *.txt
	    2) Anything that has no null characters in the first 80 bytes
	It won't catch everything, but it should be marginally better.

2004-03-08  Jody Goldberg <jody@gnome.org>

	* src/wbc-gtk.c (wbc_gtk_init) : split the menus into a distinct
	  group.  There's no need to senstize them

2004-03-12  Jean Brefort  <jean.brefort@ac-dijon.fr>

	* src/graph.c (gnm_go_data_vector_load_values): changed initial maximum
	from G_MINDOUBLE to - G_MAXDOUBLE.
	
2004-03-13  Christopher James Lahey  <clahey@ximian.com>

	* configure.in: Added
	src/cut-n-paste-code/goffice/drawing/Makefile and
	src/cut-n-paste-code/goffice/ms-compat/Makefile.

2004-03-11  Kjartan Maraas  <kmaraas@gnome.org>

	* src/wbc-bonobo.c: (wbcb_style_feedback): Remove extraenous
	semicolon from a test.
	* src/wbc-gtk.c: (wbc_gtk_style_feedback): Same here. Closes
	bug #136849.

2004-03-09  Morten Welinder  <terra@gnome.org>

	* src/workbook-control-gui.c (wbcg_close_if_user_permits): Set the
	ATK_ROLE_ALERT for dialog.

	* src/item-bar.c (ib_draw_cell, item_bar_draw): Avoid deprecated
	gtk_draw_shadow call.

2004-03-06  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-graphic.c (sheet_object_text_finalize) : release
	  the markup.
	(sheet_object_text_new_view) : set the attributes.
	(sheet_object_text_clone) : handle the attributes.
	(gnm_so_text_set_font_color) : delete.
	(gnm_so_text_set_markup) : new.

2004-03-05  Jody Goldberg <jody@gnome.org>

	* src/colrow.c (colrow_set_sizes) : force re-render of variable width cells
	(colrow_restore_state_group) : ditto

	* src/rendered-value.c (rendered_value_render) : privatize

	* src/style.c (required_updates_for_style) : Now that rendered values
	  contain size info too we can dispense with the distinction between
	  rendering and sizing.  Without this changing the font size would not
	  resize because the rendered value cached the size and was not
	  re-rendered until draw, rather than at row-height calc.

2004-03-05  Morten Welinder  <terra@gnome.org>

	* src/gui-file.c (gui_file_save_as): We no longer need to show
	extra-widgets in the file chooser outselves.

2004-03-05  Christian Neumair  <chris@gnome-de.org>

	* src/gui-file.c: free from deprecated GtkOptionMenu, use
	  GtkComboBox instead.

2004-03-04  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-widget.c : rework the List and combo to use a
	  shared base.  Then store and restore the dependents in xml

	http://bugzilla.gnome.org/show_bug.cgi?id=135946
	* src/formats.c : Add mmmmm-yy and mmmmm as defaults
	* src/format.c (append_month) : support them.

	* src/main-application.c (gnumeric_arg_parse) : When we don't need a
	  gui we still need to initialize gobject.

2004-03-01  Morten Welinder  <terra@gnome.org>

	* src/gui-file.c (gui_image_file_select): Adapt to latest gtk+ cvs
	head.

2004-02-29  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=126563
	* src/sheet.c (sheet_dup) :

2004-02-28  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=74205
	* src/item-edit.c : Display blue range designator even in other panes

2004-02-27  Morten Welinder  <terra@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=135609
	* src/parse-util.c (rangeref_as_string): Before dropping the
	second half of the range, make sure the $-designations agree also.

2004-02-26  Morten Welinder  <terra@gnome.org>

	* src/gui-util.c (fsel_key_event, fsel_delete_event,
	fsel_handle_cancel, fsel_handle_ok, fsel_dialog_finish): Delete.
	(gnumeric_dialog_file_selection): Remove GtkFileSelector version.

2004-02-25  Morten Welinder  <terra@gnome.org>

	* src/gui-file.c (update_preview_cb): Keep the preview, possibly
	blank, at all times to avoid flicker.

2004-02-23  Morten Welinder  <terra@gnome.org>

	* src/gui-file.c (gui_image_file_select): New arg "is_save" for
	button and dialog naming.  All callers changed.

	* src/sheet-object-graph.c (cb_save_as): Use
	gui_image_file_select.  Plug leak.

2004-02-22  J.H.M. Dassen (Ray) <jdassen@debian.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=135044
	* src/commands.c (cmd_resize_colrow): Fixed incorrect string

2004-02-21  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=134627
	* src/workbook-view.c (wb_view_selection_desc) : Display name of edit
	  position after releasing Shift key, not the top left

	* src/workbook-control-gui.c (cb_wbcg_drag_data_received) : disable
	  the gnome-vfs portions.  They did not work anyway.  We can probably
	  just #ifdef it in the future, I can't see an easy way to put that into
	  a plugin.

	* src/wbc-gtk.c (cb_font_name_changed) : quick and dirty enabling.
	(cb_font_size_changed) : ditto.

	* src/stf.c (stf_write_workbook) : remove the pointless wrapping of a
	  pointer and just return the result directly.

	http://bugzilla.gnome.org/show_bug.cgi?id=97216
	* src/sheet-control-gui.c (scg_mode_create_object) : Go back to the
	  primary sheet when creating an object

	http://bugzilla.gnome.org/show_bug.cgi?id=131588
	* src/rangefunc.c (range_sum) : use long double if it is available

	* src/mstyle.c (mstyle_new_default) : remove the gconf usage it did
	  not belong here.
	* src/style.c (font_init) : ditto.

	* src/normal-args.c : deleted. content moved

	* src/main-application.c : Move the arg handling into here, and #ifdef
	  it rather than using external files.  It makes it easier to read.
	  For the non gnome case we need to manually add gtk deps.  Now that
	  we're not so dependent on gnome we can do more magic and move to a
	  more abi-style approach with --convert and abi-commands in place of
	  ssconvert

	* src/libgnumeric.h : drop the arg handler stubs

	* src/libgnumeric.c (gnm_shutdown) : gconf shutdown is handled
	  internally now.

	* src/hlink.c (gnm_hlink_url_activate) : conditionalize gnome depend.

	* src/gutils.c (gnumeric_sys_data_dir) : Use g_build_path, just to be
	  pedantic.
	(gnumeric_sys_lib_dir) : ditto.

	* src/gui-util.c (gnumeric_dialog_run) : Don't destroy the dialog
	  until a stock response comes in (useful for druids)
	(gnumeric_help_display) : conditionalize gnome.
	(gnumeric_icondir) : new.
	(gnumeric_load_image) : use it.
	(gnumeric_load_pixbuf) : use it.

	* src/gnumeric-gconf.c (gnm_app_get_gconf_client) : moved to here.
	(gnm_conf_init_essential) : handle the font stuff here.

	* src/gnumeric-gconf-priv.h : Clean up the default font keys and move
	  them here.

	* src/application.c : remove the gconf_client
	(gnm_app_get_gconf_client) : move for now.
	(gnm_app_release_gconf_client) : delete.

	* src/Makefile.am : Further down the path of making gnome optional

	* icons/Makefile.am : Add the new about box image, dunno where/how to
	  use it yet.

	* configure.in : corba is dependent on gnome for now.
	  Move libgnome* into the gnome specific libs
	  Add the new radar plot engine

	* src/wbc-gtk.c (cb_show_menu_tip) : fix leak.

2004-02-20  Jon K Hellan  <hellan@acm.org>

	* src/gui-util.c: Don't include preview-file-selector.h.

	* src/workbook-control-gui.c: Ditto.

	* src/wbcg-actions.c: Ditto.

2004-02-19  Morten Welinder  <terra@gnome.org>

	* src/gui-file.c (gui_image_file_select): Add new "initial"
	argument.  Caller changed.

2004-02-18  Morten Welinder  <terra@gnome.org>

	* src/gui-file.c (gui_image_file_select): New function.

	* src/wbcg-actions.c (GNM_ACTION_DEF): Use gui_image_file_select.

	* src/gui-file.c (file_format_changed_cb): Use
	gtk_widget_set_sensitive.

	* src/gui-util.c (gnm_fixup_filechooser_size): Remove this.  No
	longer needed.

2004-02-17  Morten Welinder  <terra@gnome.org>

	* src/gui-file.c (gui_file_open): Destroy file selector before
	calling opener.  (File selector grabs focus so stf-import could
	not be interacted with.)

	* src/print.c (compute_scale_fit_to): For 0 pages, just return
	100%.

2004-02-13  Morten Welinder  <terra@gnome.org>

	* src/gui-util.c (gnm_fixup_filechooser_size): New function.
	(gnumeric_dialog_dir_selection): Delete.

	* src/gui-file.c (gui_file_save_as, gui_file_open): Use
	gnm_fixup_filechooser_size.

2004-02-11  Morten Welinder  <terra@gnome.org>

	* src/print.c (compute_scale_fit_to): Guard against pages <= 0.
	Use doubles, not floats.
	(print_range_down_then_right, print_range_right_then_down,
	compute_group): Use doubles, not floats.

2004-02-09  Morten Welinder  <terra@gnome.org>

	* src/workbook-object-toolbar.c: Properly include
	<gnumeric-config.h> so the tests will work.

2004-02-04  Morten Welinder  <terra@gnome.org>

	* src/parser.y (yylex): Accept a few unicode characters.

2004-02-04  Jody Goldberg <jody@gnome.org>

	* src/sheet.c : Make Sheet a cheesy sort of GObject.  Leave the macros
	  as the old signature based variants for now.

2004-02-04  Jody Goldberg <jody@gnome.org>

	* src/gui-file.c (gui_file_open) : add a label and mnemonic for the
	  type selector.

2004-02-02  Jody Goldberg <jody@gnome.org>

	* src/session.c : make conditional on WITH_GNOME

2004-02-03  Morten Welinder  <terra@gnome.org>

	* src/wbcg-actions.c (toggle_current_font_attr): Remove debug
	spew.

2004-02-01  Jody Goldberg <jody@gnome.org>

	* src/wbc-gtk.c (cb_custom_color_created) : mark the custom dialog as
	  a transient of the wbcg.

2004-02-01  Jody Goldberg <jody@gnome.org>

	* src/workbook-control-gui.c (wbcg_toolbar_timer_clear) : people
	  didn't like it so remove it to allow custom color selection to work.
	  With it in place the action was still insensitive when the
	  color_changed fired so the activation was ignored.

	* src/wbc-gtk.c (wbc_gtk_init) : connect the post_activate signal
	  as a swapped_object to avoid calling it after we use an accelerator
	  to quit.

2004-02-01  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gui-util.c (gu_delete_handler): new
	(gnumeric_dialog_file_selection): catch window manager deletion 
	  of the dialog.

2004-01-28  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=131933
	* src/format.c (update_lc) : catch mismatched monetary and numeric
	  locales that set result in the decimal seperator and thousands
	  seperator being the same.

2004-01-28  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* schemas/gnumeric-dialogs.schemas.in: Add schemas correponding to 
	  the new printing keys.

2004-01-28  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gnumeric-gconf-priv.h: add many more printing related keys
	* src/gnumeric-gconf.c (gnm_conf_init_essential): initialize 
	  printing variables from gconf
	(gnm_gconf_set_print_center_horizontally): implement
	(gnm_gconf_set_print_center_vertically): implement
	(gnm_gconf_set_print_grid_lines): implement
	(gnm_gconf_set_print_even_if_only_styles): implement
	(gnm_gconf_set_print_black_and_white): implement
	(gnm_gconf_set_print_titles): implement
	(gnm_gconf_set_print_order_right_then_down): implement
	(gnm_gconf_set_print_scale_percentage): implement
	(gnm_gconf_set_print_scale_percentage_value): implement
	(gnm_gconf_set_print_scale_width): implement
	(gnm_gconf_set_print_scale_height): implement
	(gnm_gconf_set_print_repeat_top): implement
	(gnm_gconf_set_print_repeat_left): implement
	(gnm_gconf_set_print_tb_margins): implement
	(gnm_gconf_set_print_header_formats): implement
	* src/print-info.c (load_formats): add saved custom formats

2004-01-28  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/gnumeric-gconf.c (gnm_conf_init_essential): initialize new
	  configuration variables
	(gnm_conf_init_extra): move some items to essential
	(gnm_gconf_set_print_center_horizontally): new stub
	(gnm_gconf_set_print_center_vertically): new stub
	(gnm_gconf_set_print_grid_lines): new stub
	(gnm_gconf_set_print_even_if_only_styles): new stub
	(gnm_gconf_set_print_black_and_white): new stub
	(gnm_gconf_set_print_titles): new stub
	(gnm_gconf_set_print_order_right_then_down): new stub
	(gnm_gconf_set_print_scale_percentage): new stub
	(gnm_gconf_set_print_scale_percentage_valuee): new stub
	(gnm_gconf_set_print_scale_width): new stub
	(gnm_gconf_set_print_scale_height): new stub
	(gnm_gconf_set_print_repeat_top): new stub
	(gnm_gconf_set_print_repeat_left): new stub
	(gnm_gconf_set_print_tb_margins): new stub
	(gnm_gconf_set_print_header_formats): new stub
	* src/gnumeric-gconf.h: various new functions (see above) and 
	  fields to the pref structure.
	* src/print-info.c: remove dependence on libgnome/gnome-config.h
	(load_margin): deleted
	(load_hf): deleted
	(load_range): deleted
	(load_formats): remove gnome-config stuff
	(print_info_new): switch to gconf functions
	(save_margin): deleted
	(save_range): deleted
	(save_hf): deleted
	(save_formats): use gconf
	(print_info_save): use new gconf functions
	(print_info_set_orientation): new
	(print_info_get_orientation): new
	* src/print-info.h: remove orientation field in pi
	(print_info_set_orientation): new
	(print_info_get_orientation): new
	* src/xml-io.c (xml_write_print_info): use print_info_get_orientation
	(xml_read_print_info): use print_info_set_orientation

2004-01-27  Morten Welinder  <terra@gnome.org>

	* src/gui-file.c (gui_file_save_as): Switch to file chooser.

2004-01-27  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/print.c (sheet_print): remove warnings

2004-01-27  Morten Welinder  <terra@gnome.org>

	* src/gui-file.c (gui_file_open): Cleanup and hack a better size.

2004-01-26  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* configure.in: bump libgnomeprint[ui] requirement to 2.5.2
	* src/print.c (sheet_print): don't close the print dialog on preview
	  and use gnome_print_dialog_run to avoid overwriting files without
	  dialog

2004-01-26  Morten Welinder  <terra@gnome.org>

	* src/gui-file.c (gui_file_open): Switch to file chooser.

	* src/gui-util.c (gnumeric_dialog_file_selection): Handle file
	chooser widgets too.

2004-01-26  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=132448
	* src/wbcg-actions.c (cb_auto_filter) : fix
	* src/selection.c (selection_first_range) : improve readability of
	  error message.

	http://bugzilla.gnome.org/show_bug.cgi?id=127138
	* src/wbcg-actions.c (cb_view_freeze_panes) : Don't get confused by an
	  attempt to freeze without centering when the top or left is not 0.

2004-01-24  Andreas J. Guelzow <aguelzow@taliesin.ca>

	* src/cell-draw.c (cell_calc_layout): new
	(cell_draw): move the pango layout code into cell_calc_layout

2004-01-24  Jody Goldberg <jody@gnome.org>

	* src/sheet-object-graphic.c : defaults for color combos are now more
	  useful.  The actions can set them up for toolbars in one place
	  rather than users setting the combo in dozens.

2004-01-23  Jody Goldberg <jody@gnome.org>

	* src/workbook.c (workbook_find_command) : new utility

	* src/wbc-gtk.c (cb_undo_activated) : port to new interface
	(cb_redo_activated) : port to new interface

	* src/sheet-control-gui.c (scg_object_update_bbox) : silence
	  irritating warning.

2004-01-23  Jody Goldberg <jody@gnome.org>

	* configure.in : bump the gtk and glib depends to yesterday's releases

2004-01-22  Jody Goldberg <jody@gnome.org>

	* src/wbc-gtk.c : clean up the border combo and adapt to its new api

2004-01-16  Jody Goldberg <jody@gnome.org>

	* configure.in : check for symbolic link support
	* src/Makefile.am : install executable as
	    gnumeric-<version>
	  with a symlink to that from gnumeric

2004-01-16  Jody Goldberg <jody@gnome.org>

	* src/stf.c (stf_write_workbook) : update the string and drop the
	  warning.

	* src/wbc-gtk.c (wbc_gtk_init) : enable translations for menus and
	  toolbars.

2004-01-16  Jody Goldberg <jody@gnome.org>

	* src/wbc-gtk.c : Fix some accelerators and enable colour combos.
	  Some undo/redo is working too.

	* src/style-color.c (style_color_new_go) : new.

	* configure.in : Push the goffice include up here until it can get a
	  pkg file.

	* autogen.sh (REQUIRED_AUTOMAKE_VERSION) : bump automake version to
	  get stricter distchecks.

2004-01-14  Jody Goldberg <jody@gnome.org>

	* gnumeric.mime : prune this to just types gnome-mime-data does not
	  appear to have.

2004-01-15  Andreas J. Guelzow  <aguelzow@taliesin.ca>

	http://bugzilla.gnome.org/show_bug.cgi?id=131343
	* src/print.c (print_job_info_update_from_config): new
	(print_job_info_get): move some code into 
	  print_job_info_update_from_config
	(sheet_print): call print_job_info_update_from_config after the
	  user may have changed the paper info in the print dialog.

2004-01-14  Jon K Hellan  <hellan@acm.org>

	* README: Spellcheck

2004-01-14  Jody Goldberg <jody@gnome.org>

	* src/wbc-gtk.c : silence some warnings from the zoom combo.  It's not
	  functional yet so why spew errors.
	- Add status line display of menu tooltips
	- Fix accel for the display formula toggle

2004-01-13  Jody Goldberg <jody@gnome.org>

	* src/func.c (function_call_with_list) : fix the address tests by
	  allowing missing optional args to get passed as NULL.

2004-01-12  Morten Welinder  <terra@gnome.org>

	* src/GNOME_Gnumeric-gtk.xml: remove menu entris for bold, etc.
	(Probably accidentally committed.)

2004-01-11  Jon K Hellan  <hellan@acm.org>

	* src/GNOME_Gnumeric-gtk.xml: Add accelerators for bold, italic
	and underline.

2004-01-10  Jody Goldberg <jody@gnome.org>

	* src/wbc-gtk.c : Display the progress bar
	  enable the sensitzation/desensitization of the actions.  NOTE :
	  requires a gtk patch that is not in cvs yet.
	  Set a tooltip for the border and colour combos, requires another gtk
	  patch that is not in cvs.

	* src/gnumeric-pane.c : Conditionally disable the stipple border for
	  now, but fix it to scale properly with zoom anyway.

	* src/Makefile.am (bonobo_component_ui_DATA) : install the GtkAtion ui
	  file for now.  We can cleanup later.  Display ssconvert too, that
	  needs to merge or move to a new dir.  It doubles link time.

2004-01-09  Morten Welinder  <terra@gnome.org>

	* src/wbcg-actions.c: Add invisible CopyDown and CopyRight
	actions.  Stubbed so far.
	Remove accelerator for double underline as it collided with
	single underline.

2004-01-08  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=130172
	* src/func.c (function_call_with_list) : A major change
	  Do not do the empty conversion to int(0) in expr_eval
	  ALLOW scalars to return empty/NULL, the convert them to empty for
	  most types, and int(0) for float/bool.  Which makes
	  'S' the same as 's' for all purposes accept documentation.

	* src/GNOME_Gnumeric-gtk.xml : No need to name items their action is
	  sufficient as long as they are unique in their parent.

	* src/cell.h (CELL_HAS_NEW_EXPR) : AARRRGGH.  Actually a sign a
	  _unique_ value to it.

	* src/gnumeric-pane.c (cb_control_point_event) : change the cursor
	  when dragging.  Only start dragging on button 1 down.  Ignore other
	  buttons while dragging.
	(cb_sheet_object_canvas_event) : ditto.

	* src/main-application.c (main) : set the app name.

2004-01-07  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=130700
	* src/format.c (format_entry_ctor) : init the new 'suppress_minus'
	  entry.
	(format_compile) : initialize supress minus if the condition is of the
	  form [<=(val <= 0)] or [<(val < 0)] I hope this is a reasonable
	  approximation of MS Excel.
	(render_number) : pull out all the old elements that added minus signs
	(format_number) : handle the new entry based suppress minus operator
	  here, and prepend the sign.

	* src/wbcg-actions.c : Sync labels and mnemonics with the old
	  bonobo/gnomeui menus

2004-01-06  Jody Goldberg <jody@gnome.org>

	* src/wbc-gtk.c (cb_add_menus_toolbars) : Enable/Disable the arrow
	  contraction on the toolbars if the handlbox is docked/undocked.
	  This avoids having floating toolbars with nothing but the collapse
	  arrow.

	* configure.in : re-enable the *DEPRECATED*
	and add a pile of #undef/#warning to make sure things still work

2004-01-06  Jody Goldberg <jody@gnome.org>

	The initial pass at GtkAction custom combos are mucho broken
	* src/sheet.c (sheet_toggle_hide_zeros) : move this out of the macro
	  in wbcg.
	(sheet_toggle_show_formula) : ditto.

	* src/sheet-object-graph.c (cb_save_as) : add jpg, and translate the
	  error message now that string freeze is done.

	* src/gui-util.c : restore DISABLE_DEPRECATED
	(gnumeric_toolbar_insert_with_eventbox) : delete.
	(gnumeric_toolbar_append_with_eventbox) : delete.
	(gtk_button_stock_alignment_set) : delete.
	(gnumeric_toolbar_new) : delete.
	(gnumeric_inject_widget_into_bonoboui) : move the wbc-bonobo.c
	(gnumeric_toolbar_get_widget) : delete.
	(gnm_widget_disable_focus) : move here from workbook-format-toolbar.c

	* workbook-format-toolbar.{c,h} : move contents into
	* wbcg-actions.c : this new file
	* wbc-gtk.c : or this new file
	* wbc-bonobo.c : or this new file (WHICH DOES NOT COMPILE OR WORK)
	  Should probably merge into workbook-control-component or something
	  like that

	* src/gnm-marshalers.list (VOID) : Use the stock marshallers in glib
	  directly rather than adding our own wrappers.
	* src/application.c : here

	* src/GNOME_Gnumeric.xml : rename FileExit -> FileQuit to be consistent
	* src/GNOME_Gnumeric-gtk.xml : new file for GtkAction
	  NOTE NOTE NOTE
	  You must be running in gnumeric/src
	  I Repeat
	  YOU MUST BE RUNNING IN gnumeric/src
	  for anything to work right now.  I don't quite know how I want to
	  handle the file yet (the bonobo approach was irritating) we'll see.

	* configure.in :
	- Add goffice/gui-utils
	- Get rid of --with-bonobo
	- Add --with-gnome
	- Add --enable-bonobo-component
	* plugins/Makefile.am : Adapt to that.
	* src/Makefile.am : ditto, and add the new files.

2004-01-05  Jody Goldberg <jody@gnome.org>

	http://bugzilla.gnome.org/show_bug.cgi?id=130424
	* src/commands.c (cmd_set_text_redo) : remove manual kludge.
	* src/dependent.h (cell_eval) : move from here
	* src/cell.h (cell_eval) : to here.  Add a new flag CELL_HAS_NEW_EXPR
	* src/cell.c (cell_set_expr_internal) : set the flag here.
	* src/rendered-value.c (rendered_value_new) : test it here.

	http://bugzilla.gnome.org/show_bug.cgi?id=130582
	* src/sheet-control-gui.c (scg_cursor_move) : don't scroll the other
	  panes unless we absolutely have to.  Apparently we only fuxed normal
	  cursor movement for http://bugzilla.gnome.org/show_bug.cgi?id=77303
	  This fixes rangesel too.

2003-12-29  Jody Goldberg <jody@gnome.org>

	* * : Move everything to glib/gi18n.h in place of gnumeric-i18n.h
	* gnumeric-i18n.h : delete

	* configure.in : Looks like we're really requiring gtk/glib 2.3.1 at a
	  minimum.  In reality it's probably closer to CVS at this point.  I'm
	  kinda looking forward to the gtk freeze.

2003-12-24  Morten Welinder  <terra@gnome.org>

	* src/io-context-gtk.c (cb_realize): Remove workaround for old
	gtk.
	* src/stf-parse.c (stf_parse_lines): Ditto.
	* src/workbook-control-gui.c (wbcg_get_gtk_settings): Ditto.
	(show_gui): Ditto.

	* src/gui-util.c (gdk_cursor_new_from_pixbuf): Remove.

2003-12-23  Jody Goldberg <jody@gnome.org>

	* configure.in : post BRANCH bump
	  require gtk/glib 2.3.0, that will probably go up shortly
	  as we depend more on head directly
